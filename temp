model type <class '__main__.DebertaModel'>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 0 0x7dc9ac0 forward
new bytecode: 

0: [33mLOAD_FAST[0m(6, output_attentions) 
1: [33mLOAD_CONST[0m(0, None) 
2: [33mIS_OP[0m(1, 1) 
3: [33mPOP_JUMP_IF_FALSE[0m(12, 12)  -> inst 6
4: [33mLOAD_FAST[0m(6, output_attentions) 
5: [33mJUMP_FORWARD[0m(6, 18)  -> inst 9
6: [33mLOAD_DEREF[0m(0, self) 
7: [33mLOAD_ATTR[0m(0, config) 
8: [33mLOAD_ATTR[0m(1, output_attentions) 
9: [33mSTORE_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(7, output_hidden_states) 
11: [33mLOAD_CONST[0m(0, None) 
12: [33mIS_OP[0m(1, 1) 
13: [33mPOP_JUMP_IF_FALSE[0m(32, 32)  -> inst 16
14: [33mLOAD_FAST[0m(7, output_hidden_states) 
15: [33mJUMP_FORWARD[0m(6, 38)  -> inst 19
16: [33mLOAD_DEREF[0m(0, self) 
17: [33mLOAD_ATTR[0m(0, config) 
18: [33mLOAD_ATTR[0m(2, output_hidden_states) 
19: [33mSTORE_FAST[0m(7, output_hidden_states) 
20: [33mLOAD_FAST[0m(8, return_dict) 
21: [33mLOAD_CONST[0m(0, None) 
22: [33mIS_OP[0m(1, 1) 
23: [33mPOP_JUMP_IF_FALSE[0m(52, 52)  -> inst 26
24: [33mLOAD_FAST[0m(8, return_dict) 
25: [33mJUMP_FORWARD[0m(6, 58)  -> inst 29
26: [33mLOAD_DEREF[0m(0, self) 
27: [33mLOAD_ATTR[0m(0, config) 
28: [33mLOAD_ATTR[0m(3, use_return_dict) 
29: [33mSTORE_FAST[0m(8, return_dict) 
30: [33mLOAD_FAST[0m(1, input_ids) 
31: [33mLOAD_CONST[0m(0, None) 
32: [33mIS_OP[0m(1, 1) 
33: [33mPOP_JUMP_IF_FALSE[0m(86, 86)  -> inst 43
34: [33mLOAD_FAST[0m(5, inputs_embeds) 
35: [33mLOAD_CONST[0m(0, None) 
36: [33mIS_OP[0m(1, 1) 
37: [33mPOP_JUMP_IF_FALSE[0m(86, 86)  -> inst 43
38: [33mLOAD_GLOBAL[0m(4, ValueError) 
39: [33mLOAD_CONST[0m(1, You cannot specify both input_ids and inputs_embeds at the same time) 
40: [33mCALL_FUNCTION[0m(1, 1) 
41: [33mRAISE_VARARGS[0m(1, 1) 
42: [33mJUMP_FORWARD[0m(52, 138)  -> inst 69
43: [33mLOAD_FAST[0m(1, input_ids) 
44: [33mLOAD_CONST[0m(0, None) 
45: [33mIS_OP[0m(1, 1) 
46: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
47: [33mLOAD_FAST[0m(1, input_ids) 
48: [33mLOAD_METHOD[0m(5, size) 
49: [33mCALL_METHOD[0m(0, 0) 
50: [33mSTORE_FAST[0m(9, input_shape) 
51: [33mJUMP_FORWARD[0m(34, 138)  -> inst 69
52: [33mLOAD_FAST[0m(5, inputs_embeds) 
53: [33mLOAD_CONST[0m(0, None) 
54: [33mIS_OP[0m(1, 1) 
55: [33mPOP_JUMP_IF_FALSE[0m(130, 130)  -> inst 65
56: [33mLOAD_FAST[0m(5, inputs_embeds) 
57: [33mLOAD_METHOD[0m(5, size) 
58: [33mCALL_METHOD[0m(0, 0) 
59: [33mLOAD_CONST[0m(0, None) 
60: [33mLOAD_CONST[0m(2, -1) 
61: [33mBUILD_SLICE[0m(2, 2) 
62: [33mBINARY_SUBSCR[0m(None, None) 
63: [33mSTORE_FAST[0m(9, input_shape) 
64: [33mJUMP_FORWARD[0m(8, 138)  -> inst 69
65: [33mLOAD_GLOBAL[0m(4, ValueError) 
66: [33mLOAD_CONST[0m(3, You have to specify either input_ids or inputs_embeds) 
67: [33mCALL_FUNCTION[0m(1, 1) 
68: [33mRAISE_VARARGS[0m(1, 1) 
69: [33mLOAD_FAST[0m(1, input_ids) 
70: [33mLOAD_CONST[0m(0, None) 
71: [33mIS_OP[0m(1, 1) 
72: [33mPOP_JUMP_IF_FALSE[0m(152, 152)  -> inst 76
73: [33mLOAD_FAST[0m(1, input_ids) 
74: [33mLOAD_ATTR[0m(6, device) 
75: [33mJUMP_FORWARD[0m(4, 156)  -> inst 78
76: [33mLOAD_FAST[0m(5, inputs_embeds) 
77: [33mLOAD_ATTR[0m(6, device) 
78: [33mSTORE_FAST[0m(10, device) 
79: [33mLOAD_FAST[0m(2, attention_mask) 
80: [33mLOAD_CONST[0m(0, None) 
81: [33mIS_OP[0m(0, 0) 
82: [33mPOP_JUMP_IF_FALSE[0m(180, 180)  -> inst 90
83: [33mLOAD_GLOBAL[0m(7, torch) 
84: [33mLOAD_ATTR[0m(8, ones) 
85: [33mLOAD_FAST[0m(9, input_shape) 
86: [33mLOAD_FAST[0m(10, device) 
87: [33mLOAD_CONST[0m(4, ('device',)) 
88: [33mCALL_FUNCTION_KW[0m(2, 2) 
89: [33mSTORE_FAST[0m(2, attention_mask) 
90: [33mLOAD_FAST[0m(3, token_type_ids) 
91: [33mLOAD_CONST[0m(0, None) 
92: [33mIS_OP[0m(0, 0) 
93: [33mPOP_JUMP_IF_FALSE[0m(206, 206)  -> inst 103
94: [33mLOAD_GLOBAL[0m(7, torch) 
95: [33mLOAD_ATTR[0m(9, zeros) 
96: [33mLOAD_FAST[0m(9, input_shape) 
97: [33mLOAD_GLOBAL[0m(7, torch) 
98: [33mLOAD_ATTR[0m(10, long) 
99: [33mLOAD_FAST[0m(10, device) 
100: [33mLOAD_CONST[0m(5, ('dtype', 'device')) 
101: [33mCALL_FUNCTION_KW[0m(3, 3) 
102: [33mSTORE_FAST[0m(3, token_type_ids) 
103: [33mLOAD_DEREF[0m(0, self) 
104: [33mLOAD_ATTR[0m(11, embeddings) 
105: [33mLOAD_FAST[0m(1, input_ids) 
106: [33mLOAD_FAST[0m(3, token_type_ids) 
107: [33mLOAD_FAST[0m(4, position_ids) 
108: [33mLOAD_FAST[0m(2, attention_mask) 
109: [33mLOAD_FAST[0m(5, inputs_embeds) 
110: [33mLOAD_CONST[0m(6, ('input_ids', 'token_type_ids', 'position_ids', 'mask', 'inputs_embeds')) 
111: [33mCALL_FUNCTION_KW[0m(5, 5) 
112: [33mSTORE_FAST[0m(11, embedding_output) 
113: [33mLOAD_DEREF[0m(0, self) 
114: [33mLOAD_ATTR[0m(12, encoder) 
115: [33mLOAD_FAST[0m(11, embedding_output) 
116: [33mLOAD_FAST[0m(2, attention_mask) 
117: [33mLOAD_CONST[0m(7, True) 
118: [33mLOAD_FAST[0m(6, output_attentions) 
119: [33mLOAD_FAST[0m(8, return_dict) 
120: [33mLOAD_CONST[0m(8, ('output_hidden_states', 'output_attentions', 'return_dict')) 
121: [33mCALL_FUNCTION_KW[0m(5, 5) 
122: [33mSTORE_FAST[0m(12, encoder_outputs) 
123: [33mLOAD_FAST[0m(12, encoder_outputs) 
124: [33mLOAD_CONST[0m(9, 1) 
125: [33mBINARY_SUBSCR[0m(None, None) 
126: [33mSTORE_FAST[0m(13, encoded_layers) 
127: [33mLOAD_DEREF[0m(0, self) 
128: [33mLOAD_ATTR[0m(13, z_steps) 
129: [33mLOAD_CONST[0m(9, 1) 
130: [33mCOMPARE_OP[0m(4, >) 
131: [33mEXTENDED_ARG[0m(1, 1) 
132: [33mPOP_JUMP_IF_FALSE[0m(390, 390)  -> inst 195
133: [33mLOAD_FAST[0m(13, encoded_layers) 
134: [33mLOAD_CONST[0m(10, -2) 
135: [33mBINARY_SUBSCR[0m(None, None) 
136: [33mSTORE_FAST[0m(14, hidden_states) 
137: [33mLOAD_CLOSURE[0m(0, self) 
138: [33mBUILD_TUPLE[0m(1, 1) 
139: [33mLOAD_CONST[0m(11, <code object <listcomp> at 0x153c7df4abe0, file "/home/drc/frontend/test/test_model_deberta.py", line 993>) 
140: [33mLOAD_CONST[0m(12, DebertaModel.forward.<locals>.<listcomp>) 
141: [33mMAKE_FUNCTION[0m(8, 8) 
142: [33mLOAD_GLOBAL[0m(14, range) 
143: [33mLOAD_DEREF[0m(0, self) 
144: [33mLOAD_ATTR[0m(13, z_steps) 
145: [33mCALL_FUNCTION[0m(1, 1) 
146: [33mGET_ITER[0m(None, None) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mSTORE_FAST[0m(15, layers) 
149: [33mLOAD_FAST[0m(13, encoded_layers) 
150: [33mLOAD_CONST[0m(2, -1) 
151: [33mBINARY_SUBSCR[0m(None, None) 
152: [33mSTORE_FAST[0m(16, query_states) 
153: [33mLOAD_DEREF[0m(0, self) 
154: [33mLOAD_ATTR[0m(12, encoder) 
155: [33mLOAD_METHOD[0m(15, get_rel_embedding) 
156: [33mCALL_METHOD[0m(0, 0) 
157: [33mSTORE_FAST[0m(17, rel_embeddings) 
158: [33mLOAD_DEREF[0m(0, self) 
159: [33mLOAD_ATTR[0m(12, encoder) 
160: [33mLOAD_METHOD[0m(16, get_attention_mask) 
161: [33mLOAD_FAST[0m(2, attention_mask) 
162: [33mCALL_METHOD[0m(1, 1) 
163: [33mSTORE_FAST[0m(2, attention_mask) 
164: [33mLOAD_DEREF[0m(0, self) 
165: [33mLOAD_ATTR[0m(12, encoder) 
166: [33mLOAD_METHOD[0m(17, get_rel_pos) 
167: [33mLOAD_FAST[0m(11, embedding_output) 
168: [33mCALL_METHOD[0m(1, 1) 
169: [33mSTORE_FAST[0m(18, rel_pos) 
170: [33mLOAD_FAST[0m(15, layers) 
171: [33mLOAD_CONST[0m(9, 1) 
172: [33mLOAD_CONST[0m(0, None) 
173: [33mBUILD_SLICE[0m(2, 2) 
174: [33mBINARY_SUBSCR[0m(None, None) 
175: [33mGET_ITER[0m(None, None) 
176: [33mFOR_ITER[0m(36, 390)  -> inst 195
177: [33mSTORE_FAST[0m(19, layer) 
178: [33mLOAD_FAST[0m(19, layer) 
179: [33mLOAD_FAST[0m(14, hidden_states) 
180: [33mLOAD_FAST[0m(2, attention_mask) 
181: [33mLOAD_CONST[0m(13, False) 
182: [33mLOAD_FAST[0m(16, query_states) 
183: [33mLOAD_FAST[0m(18, rel_pos) 
184: [33mLOAD_FAST[0m(17, rel_embeddings) 
185: [33mLOAD_CONST[0m(14, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
186: [33mCALL_FUNCTION_KW[0m(6, 6) 
187: [33mSTORE_FAST[0m(16, query_states) 
188: [33mLOAD_FAST[0m(13, encoded_layers) 
189: [33mLOAD_METHOD[0m(18, append) 
190: [33mLOAD_FAST[0m(16, query_states) 
191: [33mCALL_METHOD[0m(1, 1) 
192: [33mPOP_TOP[0m(None, None) 
193: [33mEXTENDED_ARG[0m(1, 1) 
194: [33mJUMP_ABSOLUTE[0m(352, 352)  -> inst 176
195: [33mLOAD_FAST[0m(13, encoded_layers) 
196: [33mLOAD_CONST[0m(2, -1) 
197: [33mBINARY_SUBSCR[0m(None, None) 
198: [33mSTORE_FAST[0m(20, sequence_output) 
199: [33mLOAD_FAST[0m(8, return_dict) 
200: [33mEXTENDED_ARG[0m(1, 1) 
201: [33mPOP_JUMP_IF_TRUE[0m(432, 432)  -> inst 216
202: [33mLOAD_FAST[0m(20, sequence_output) 
203: [33mBUILD_TUPLE[0m(1, 1) 
204: [33mLOAD_FAST[0m(12, encoder_outputs) 
205: [33mLOAD_FAST[0m(7, output_hidden_states) 
206: [33mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(420, 420)  -> inst 210
208: [33mLOAD_CONST[0m(9, 1) 
209: [33mJUMP_FORWARD[0m(2, 422)  -> inst 211
210: [33mLOAD_CONST[0m(15, 2) 
211: [33mLOAD_CONST[0m(0, None) 
212: [33mBUILD_SLICE[0m(2, 2) 
213: [33mBINARY_SUBSCR[0m(None, None) 
214: [33mBINARY_ADD[0m(None, None) 
215: [33mRETURN_VALUE[0m(None, None) 
216: [33mLOAD_GLOBAL[0m(19, BaseModelOutput) 
217: [33mLOAD_FAST[0m(20, sequence_output) 
218: [33mLOAD_FAST[0m(7, output_hidden_states) 
219: [33mEXTENDED_ARG[0m(1, 1) 
220: [33mPOP_JUMP_IF_FALSE[0m(448, 448)  -> inst 224
221: [33mLOAD_FAST[0m(12, encoder_outputs) 
222: [33mLOAD_ATTR[0m(20, hidden_states) 
223: [33mJUMP_FORWARD[0m(2, 450)  -> inst 225
224: [33mLOAD_CONST[0m(0, None) 
225: [33mLOAD_FAST[0m(12, encoder_outputs) 
226: [33mLOAD_ATTR[0m(21, attentions) 
227: [33mLOAD_CONST[0m(16, ('last_hidden_state', 'hidden_states', 'attentions')) 
228: [33mCALL_FUNCTION_KW[0m(3, 3) 
229: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'str'>, 'You have to specify either input_ids or inputs_embeds'), (<class 'int'>, -1), (<class 'tuple'>, ('input_ids', 'token_type_ids', 'position_ids', 'mask', 'inputs_embeds')), (<class 'int'>, -2), (<class 'tuple'>, ('output_hidden_states', 'output_attentions', 'return_dict')), (<class 'str'>, 'DebertaModel.forward.<locals>.<listcomp>'), (<class 'tuple'>, ('last_hidden_state', 'hidden_states', 'attentions')), (<class 'NoneType'>, None), (<class 'tuple'>, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')), (<class 'str'>, 'You cannot specify both input_ids and inputs_embeds at the same time'), (<class 'bool'>, True), (<class 'tuple'>, ('device',)), (<class 'tuple'>, ('dtype', 'device')), (<class 'bool'>, False), (<class 'int'>, 2), (<class 'code'>, <code object <listcomp> at 0x153c7df4abe0, file "/home/drc/frontend/test/test_model_deberta.py", line 993>), (<class 'int'>, 0)]
guarded code
0: [32mEXTENDED_ARG[0m(1, 1) 
1: [32mJUMP_ABSOLUTE[0m(468, 468)  -> inst 234
2: [33mLOAD_FAST[0m(6, output_attentions) 
3: [33mLOAD_CONST[0m(8, None) 
4: [33mIS_OP[0m(1, 1) 
5: [33mPOP_JUMP_IF_FALSE[0m(16, 16)  -> inst 8
6: [33mLOAD_FAST[0m(6, output_attentions) 
7: [33mJUMP_FORWARD[0m(6, 22)  -> inst 11
8: [33mLOAD_DEREF[0m(0, self) 
9: [33mLOAD_ATTR[0m(0, config) 
10: [33mLOAD_ATTR[0m(1, output_attentions) 
11: [33mSTORE_FAST[0m(6, output_attentions) 
12: [33mLOAD_FAST[0m(7, output_hidden_states) 
13: [33mLOAD_CONST[0m(8, None) 
14: [33mIS_OP[0m(1, 1) 
15: [33mPOP_JUMP_IF_FALSE[0m(36, 36)  -> inst 18
16: [33mLOAD_FAST[0m(7, output_hidden_states) 
17: [33mJUMP_FORWARD[0m(6, 42)  -> inst 21
18: [33mLOAD_DEREF[0m(0, self) 
19: [33mLOAD_ATTR[0m(0, config) 
20: [33mLOAD_ATTR[0m(2, output_hidden_states) 
21: [33mSTORE_FAST[0m(7, output_hidden_states) 
22: [33mLOAD_FAST[0m(8, return_dict) 
23: [33mLOAD_CONST[0m(8, None) 
24: [33mIS_OP[0m(1, 1) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(8, return_dict) 
27: [33mJUMP_FORWARD[0m(6, 62)  -> inst 31
28: [33mLOAD_DEREF[0m(0, self) 
29: [33mLOAD_ATTR[0m(0, config) 
30: [33mLOAD_ATTR[0m(3, use_return_dict) 
31: [33mSTORE_FAST[0m(8, return_dict) 
32: [33mLOAD_FAST[0m(1, input_ids) 
33: [33mLOAD_CONST[0m(8, None) 
34: [33mIS_OP[0m(1, 1) 
35: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
36: [33mLOAD_FAST[0m(5, inputs_embeds) 
37: [33mLOAD_CONST[0m(8, None) 
38: [33mIS_OP[0m(1, 1) 
39: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
40: [33mLOAD_GLOBAL[0m(4, ValueError) 
41: [33mLOAD_CONST[0m(10, You cannot specify both input_ids and inputs_embeds at the same time) 
42: [33mCALL_FUNCTION[0m(1, 1) 
43: [33mRAISE_VARARGS[0m(1, 1) 
44: [33mJUMP_FORWARD[0m(52, 142)  -> inst 71
45: [33mLOAD_FAST[0m(1, input_ids) 
46: [33mLOAD_CONST[0m(8, None) 
47: [33mIS_OP[0m(1, 1) 
48: [33mPOP_JUMP_IF_FALSE[0m(108, 108)  -> inst 54
49: [33mLOAD_FAST[0m(1, input_ids) 
50: [33mLOAD_METHOD[0m(5, size) 
51: [33mCALL_METHOD[0m(0, 0) 
52: [33mSTORE_FAST[0m(9, input_shape) 
53: [33mJUMP_FORWARD[0m(34, 142)  -> inst 71
54: [33mLOAD_FAST[0m(5, inputs_embeds) 
55: [33mLOAD_CONST[0m(8, None) 
56: [33mIS_OP[0m(1, 1) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_FAST[0m(5, inputs_embeds) 
59: [33mLOAD_METHOD[0m(5, size) 
60: [33mCALL_METHOD[0m(0, 0) 
61: [33mLOAD_CONST[0m(8, None) 
62: [33mLOAD_CONST[0m(2, -1) 
63: [33mBUILD_SLICE[0m(2, 2) 
64: [33mBINARY_SUBSCR[0m(None, None) 
65: [33mSTORE_FAST[0m(9, input_shape) 
66: [33mJUMP_FORWARD[0m(8, 142)  -> inst 71
67: [33mLOAD_GLOBAL[0m(4, ValueError) 
68: [33mLOAD_CONST[0m(1, You have to specify either input_ids or inputs_embeds) 
69: [33mCALL_FUNCTION[0m(1, 1) 
70: [33mRAISE_VARARGS[0m(1, 1) 
71: [33mLOAD_FAST[0m(1, input_ids) 
72: [33mLOAD_CONST[0m(8, None) 
73: [33mIS_OP[0m(1, 1) 
74: [33mPOP_JUMP_IF_FALSE[0m(156, 156)  -> inst 78
75: [33mLOAD_FAST[0m(1, input_ids) 
76: [33mLOAD_ATTR[0m(6, device) 
77: [33mJUMP_FORWARD[0m(4, 160)  -> inst 80
78: [33mLOAD_FAST[0m(5, inputs_embeds) 
79: [33mLOAD_ATTR[0m(6, device) 
80: [33mSTORE_FAST[0m(10, device) 
81: [33mLOAD_FAST[0m(2, attention_mask) 
82: [33mLOAD_CONST[0m(8, None) 
83: [33mIS_OP[0m(0, 0) 
84: [33mPOP_JUMP_IF_FALSE[0m(184, 184)  -> inst 92
85: [33mLOAD_GLOBAL[0m(7, torch) 
86: [33mLOAD_ATTR[0m(8, ones) 
87: [33mLOAD_FAST[0m(9, input_shape) 
88: [33mLOAD_FAST[0m(10, device) 
89: [33mLOAD_CONST[0m(12, ('device',)) 
90: [33mCALL_FUNCTION_KW[0m(2, 2) 
91: [33mSTORE_FAST[0m(2, attention_mask) 
92: [33mLOAD_FAST[0m(3, token_type_ids) 
93: [33mLOAD_CONST[0m(8, None) 
94: [33mIS_OP[0m(0, 0) 
95: [33mPOP_JUMP_IF_FALSE[0m(210, 210)  -> inst 105
96: [33mLOAD_GLOBAL[0m(7, torch) 
97: [33mLOAD_ATTR[0m(9, zeros) 
98: [33mLOAD_FAST[0m(9, input_shape) 
99: [33mLOAD_GLOBAL[0m(7, torch) 
100: [33mLOAD_ATTR[0m(10, long) 
101: [33mLOAD_FAST[0m(10, device) 
102: [33mLOAD_CONST[0m(13, ('dtype', 'device')) 
103: [33mCALL_FUNCTION_KW[0m(3, 3) 
104: [33mSTORE_FAST[0m(3, token_type_ids) 
105: [33mLOAD_DEREF[0m(0, self) 
106: [33mLOAD_ATTR[0m(11, embeddings) 
107: [33mLOAD_FAST[0m(1, input_ids) 
108: [33mLOAD_FAST[0m(3, token_type_ids) 
109: [33mLOAD_FAST[0m(4, position_ids) 
110: [33mLOAD_FAST[0m(2, attention_mask) 
111: [33mLOAD_FAST[0m(5, inputs_embeds) 
112: [33mLOAD_CONST[0m(3, ('input_ids', 'token_type_ids', 'position_ids', 'mask', 'inputs_embeds')) 
113: [33mCALL_FUNCTION_KW[0m(5, 5) 
114: [33mSTORE_FAST[0m(11, embedding_output) 
115: [33mLOAD_DEREF[0m(0, self) 
116: [33mLOAD_ATTR[0m(12, encoder) 
117: [33mLOAD_FAST[0m(11, embedding_output) 
118: [33mLOAD_FAST[0m(2, attention_mask) 
119: [33mLOAD_CONST[0m(11, True) 
120: [33mLOAD_FAST[0m(6, output_attentions) 
121: [33mLOAD_FAST[0m(8, return_dict) 
122: [33mLOAD_CONST[0m(5, ('output_hidden_states', 'output_attentions', 'return_dict')) 
123: [33mCALL_FUNCTION_KW[0m(5, 5) 
124: [33mSTORE_FAST[0m(12, encoder_outputs) 
125: [33mLOAD_FAST[0m(12, encoder_outputs) 
126: [33mLOAD_CONST[0m(0, 1) 
127: [33mBINARY_SUBSCR[0m(None, None) 
128: [33mSTORE_FAST[0m(13, encoded_layers) 
129: [33mLOAD_DEREF[0m(0, self) 
130: [33mLOAD_ATTR[0m(13, z_steps) 
131: [33mLOAD_CONST[0m(0, 1) 
132: [33mCOMPARE_OP[0m(4, >) 
133: [32mEXTENDED_ARG[0m(1, 1) 
134: [33mPOP_JUMP_IF_FALSE[0m(394, 394)  -> inst 197
135: [33mLOAD_FAST[0m(13, encoded_layers) 
136: [33mLOAD_CONST[0m(4, -2) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mSTORE_FAST[0m(14, hidden_states) 
139: [33mLOAD_CLOSURE[0m(0, self) 
140: [33mBUILD_TUPLE[0m(1, 1) 
141: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4abe0, file "/home/drc/frontend/test/test_model_deberta.py", line 993>) 
142: [33mLOAD_CONST[0m(6, DebertaModel.forward.<locals>.<listcomp>) 
143: [33mMAKE_FUNCTION[0m(8, 8) 
144: [33mLOAD_GLOBAL[0m(14, range) 
145: [33mLOAD_DEREF[0m(0, self) 
146: [33mLOAD_ATTR[0m(13, z_steps) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mGET_ITER[0m(None, None) 
149: [33mCALL_FUNCTION[0m(1, 1) 
150: [33mSTORE_FAST[0m(15, layers) 
151: [33mLOAD_FAST[0m(13, encoded_layers) 
152: [33mLOAD_CONST[0m(2, -1) 
153: [33mBINARY_SUBSCR[0m(None, None) 
154: [33mSTORE_FAST[0m(16, query_states) 
155: [33mLOAD_DEREF[0m(0, self) 
156: [33mLOAD_ATTR[0m(12, encoder) 
157: [33mLOAD_METHOD[0m(15, get_rel_embedding) 
158: [33mCALL_METHOD[0m(0, 0) 
159: [33mSTORE_FAST[0m(17, rel_embeddings) 
160: [33mLOAD_DEREF[0m(0, self) 
161: [33mLOAD_ATTR[0m(12, encoder) 
162: [33mLOAD_METHOD[0m(16, get_attention_mask) 
163: [33mLOAD_FAST[0m(2, attention_mask) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(2, attention_mask) 
166: [33mLOAD_DEREF[0m(0, self) 
167: [33mLOAD_ATTR[0m(12, encoder) 
168: [33mLOAD_METHOD[0m(17, get_rel_pos) 
169: [33mLOAD_FAST[0m(11, embedding_output) 
170: [33mCALL_METHOD[0m(1, 1) 
171: [33mSTORE_FAST[0m(18, rel_pos) 
172: [33mLOAD_FAST[0m(15, layers) 
173: [33mLOAD_CONST[0m(0, 1) 
174: [33mLOAD_CONST[0m(8, None) 
175: [33mBUILD_SLICE[0m(2, 2) 
176: [33mBINARY_SUBSCR[0m(None, None) 
177: [33mGET_ITER[0m(None, None) 
178: [33mFOR_ITER[0m(36, 394)  -> inst 197
179: [33mSTORE_FAST[0m(19, layer) 
180: [33mLOAD_FAST[0m(19, layer) 
181: [33mLOAD_FAST[0m(14, hidden_states) 
182: [33mLOAD_FAST[0m(2, attention_mask) 
183: [33mLOAD_CONST[0m(14, False) 
184: [33mLOAD_FAST[0m(16, query_states) 
185: [33mLOAD_FAST[0m(18, rel_pos) 
186: [33mLOAD_FAST[0m(17, rel_embeddings) 
187: [33mLOAD_CONST[0m(9, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
188: [33mCALL_FUNCTION_KW[0m(6, 6) 
189: [33mSTORE_FAST[0m(16, query_states) 
190: [33mLOAD_FAST[0m(13, encoded_layers) 
191: [33mLOAD_METHOD[0m(18, append) 
192: [33mLOAD_FAST[0m(16, query_states) 
193: [33mCALL_METHOD[0m(1, 1) 
194: [33mPOP_TOP[0m(None, None) 
195: [32mEXTENDED_ARG[0m(1, 1) 
196: [33mJUMP_ABSOLUTE[0m(356, 356)  -> inst 178
197: [33mLOAD_FAST[0m(13, encoded_layers) 
198: [33mLOAD_CONST[0m(2, -1) 
199: [33mBINARY_SUBSCR[0m(None, None) 
200: [33mSTORE_FAST[0m(20, sequence_output) 
201: [33mLOAD_FAST[0m(8, return_dict) 
202: [32mEXTENDED_ARG[0m(1, 1) 
203: [33mPOP_JUMP_IF_TRUE[0m(438, 438)  -> inst 219
204: [33mLOAD_FAST[0m(20, sequence_output) 
205: [33mBUILD_TUPLE[0m(1, 1) 
206: [33mLOAD_FAST[0m(12, encoder_outputs) 
207: [33mLOAD_FAST[0m(7, output_hidden_states) 
208: [32mEXTENDED_ARG[0m(1, 1) 
209: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
210: [33mLOAD_CONST[0m(0, 1) 
211: [33mJUMP_FORWARD[0m(2, 426)  -> inst 213
212: [33mLOAD_CONST[0m(15, 2) 
213: [33mLOAD_CONST[0m(8, None) 
214: [33mBUILD_SLICE[0m(2, 2) 
215: [33mBINARY_SUBSCR[0m(None, None) 
216: [33mBINARY_ADD[0m(None, None) 
217: [32mEXTENDED_ARG[0m(1, 1) 
218: [32mJUMP_ABSOLUTE[0m(496, 496)  -> inst 248
219: [33mLOAD_GLOBAL[0m(19, BaseModelOutput) 
220: [33mLOAD_FAST[0m(20, sequence_output) 
221: [33mLOAD_FAST[0m(7, output_hidden_states) 
222: [32mEXTENDED_ARG[0m(1, 1) 
223: [33mPOP_JUMP_IF_FALSE[0m(454, 454)  -> inst 227
224: [33mLOAD_FAST[0m(12, encoder_outputs) 
225: [33mLOAD_ATTR[0m(20, hidden_states) 
226: [33mJUMP_FORWARD[0m(2, 456)  -> inst 228
227: [33mLOAD_CONST[0m(8, None) 
228: [33mLOAD_FAST[0m(12, encoder_outputs) 
229: [33mLOAD_ATTR[0m(21, attentions) 
230: [33mLOAD_CONST[0m(7, ('last_hidden_state', 'hidden_states', 'attentions')) 
231: [33mCALL_FUNCTION_KW[0m(3, 3) 
232: [32mEXTENDED_ARG[0m(1, 1) 
233: [32mJUMP_ABSOLUTE[0m(496, 496)  -> inst 248
234: [32mLOAD_GLOBAL[0m(25, guard_match) 
235: [32mLOAD_CONST[0m(17, 0) 
236: [32mLOAD_CONST[0m(17, 0) 
237: [32mLOAD_GLOBAL[0m(26, locals) 
238: [32mCALL_FUNCTION[0m(0, 0) 
239: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
240: [32mUNPACK_SEQUENCE[0m(2, 2) 
241: [32mSTORE_FAST[0m(22, __case_idx) 
242: [32mSTORE_FAST[0m(21, __graph_fn) 
243: [32mLOAD_GLOBAL[0m(23, enable_trace) 
244: [32mLOAD_CONST[0m(17, 0) 
245: [32mCALL_FUNCTION[0m(1, 1) 
246: [32mPOP_TOP[0m(None, None) 
247: [32mJUMP_ABSOLUTE[0m(4, 4)  -> inst 2
248: [32mLOAD_GLOBAL[0m(22, disable_trace) 
249: [32mLOAD_CONST[0m(17, 0) 
250: [32mCALL_FUNCTION[0m(1, 1) 
251: [32mPOP_TOP[0m(None, None) 
252: [32mRETURN_VALUE[0m(None, None) 

enable_trace
push tracker 0 frame 0x7dd9b30 frame_id 0 read_stack False cf_info <class 'NoneType'> all [0]
tracing opcode POP_TOP None pc=492 frame=0(0x7dd9b30)
restart: running injected code (f_lasti=492)
tracing opcode JUMP_ABSOLUTE None pc=494 frame=0(0x7dd9b30)
restart: running injected code (f_lasti=494)
tracing line /home/drc/frontend/test/test_model_deberta.py:952
tracing opcode LOAD_FAST None pc=4 frame=0(0x7dd9b30)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=6 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=8 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=10 frame=0(0x7dd9b30)
tracing opcode LOAD_DEREF None pc=16 frame=0(0x7dd9b30)
load fast: 23346416248240
tracing opcode LOAD_ATTR None pc=18 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=20 frame=0(0x7dd9b30)
generate any for DebertaConfig {
  "_name_or_path": "microsoft/deberta-base",
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-07,
  "max_position_embeddings": 512,
  "max_relative_positions": -1,
  "model_type": "deberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_dropout": 0,
  "pooler_hidden_act": "gelu",
  "pooler_hidden_size": 768,
  "pos_att_type": [
    "c2p",
    "p2c"
  ],
  "position_biased_input": false,
  "relative_attention": true,
  "return_dict": false,
  "transformers_version": "4.34.0",
  "type_vocab_size": 0,
  "vocab_size": 50265
}
 <class 'transformers.models.deberta.configuration_deberta.DebertaConfig'> [locals['self'].config]
tracing opcode STORE_FAST None pc=22 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:954
tracing opcode LOAD_FAST None pc=24 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=26 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=28 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=30 frame=0(0x7dd9b30)
tracing opcode LOAD_DEREF None pc=36 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=38 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=40 frame=0(0x7dd9b30)
generate any for DebertaConfig {
  "_name_or_path": "microsoft/deberta-base",
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-07,
  "max_position_embeddings": 512,
  "max_relative_positions": -1,
  "model_type": "deberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_dropout": 0,
  "pooler_hidden_act": "gelu",
  "pooler_hidden_size": 768,
  "pos_att_type": [
    "c2p",
    "p2c"
  ],
  "position_biased_input": false,
  "relative_attention": true,
  "return_dict": false,
  "transformers_version": "4.34.0",
  "type_vocab_size": 0,
  "vocab_size": 50265
}
 <class 'transformers.models.deberta.configuration_deberta.DebertaConfig'> [locals['self'].config]
tracing line /home/drc/frontend/test/test_model_deberta.py:953
tracing opcode STORE_FAST None pc=42 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:956
tracing opcode LOAD_FAST None pc=44 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=46 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=48 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=0(0x7dd9b30)
tracing opcode LOAD_DEREF None pc=56 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=58 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=60 frame=0(0x7dd9b30)
generate any for DebertaConfig {
  "_name_or_path": "microsoft/deberta-base",
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-07,
  "max_position_embeddings": 512,
  "max_relative_positions": -1,
  "model_type": "deberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_dropout": 0,
  "pooler_hidden_act": "gelu",
  "pooler_hidden_size": 768,
  "pos_att_type": [
    "c2p",
    "p2c"
  ],
  "position_biased_input": false,
  "relative_attention": true,
  "return_dict": false,
  "transformers_version": "4.34.0",
  "type_vocab_size": 0,
  "vocab_size": 50265
}
 <class 'transformers.models.deberta.configuration_deberta.DebertaConfig'> [locals['self'].config]
tracing opcode STORE_FAST None pc=62 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:958
tracing opcode LOAD_FAST None pc=64 frame=0(0x7dd9b30)
load fast: 23346799785520
tracing opcode LOAD_CONST None pc=66 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=68 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=0(0x7dd9b30)
tracing opcode LOAD_FAST None pc=72 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=74 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=76 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=78 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:960
tracing opcode LOAD_FAST None pc=90 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=92 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=94 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=96 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:961
tracing opcode LOAD_FAST None pc=98 frame=0(0x7dd9b30)
tracing opcode LOAD_METHOD None pc=100 frame=0(0x7dd9b30)
tracing opcode CALL_METHOD None pc=102 frame=0(0x7dd9b30)
tracing opcode STORE_FAST None pc=104 frame=0(0x7dd9b30)
tracing opcode JUMP_FORWARD None pc=106 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:967
tracing opcode LOAD_FAST None pc=142 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=144 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=146 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=148 frame=0(0x7dd9b30)
tracing opcode LOAD_FAST None pc=150 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=152 frame=0(0x7dd9b30)
tracing opcode JUMP_FORWARD None pc=154 frame=0(0x7dd9b30)
tracing opcode STORE_FAST None pc=160 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:969
tracing opcode LOAD_FAST None pc=162 frame=0(0x7dd9b30)
load fast: 23346799762864
tracing opcode LOAD_CONST None pc=164 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=166 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=168 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:971
tracing opcode LOAD_FAST None pc=184 frame=0(0x7dd9b30)
load fast: 23344634186704
tracing opcode LOAD_CONST None pc=186 frame=0(0x7dd9b30)
tracing opcode IS_OP None pc=188 frame=0(0x7dd9b30)
tracing opcode POP_JUMP_IF_FALSE None pc=190 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:974
tracing opcode LOAD_DEREF None pc=210 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=212 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:975
tracing opcode LOAD_FAST None pc=214 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:976
tracing opcode LOAD_FAST None pc=216 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:977
tracing opcode LOAD_FAST None pc=218 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:978
tracing opcode LOAD_FAST None pc=220 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:979
tracing opcode LOAD_FAST None pc=222 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:974
tracing opcode LOAD_CONST None pc=224 frame=0(0x7dd9b30)
tracing opcode CALL_FUNCTION_KW None pc=226 frame=0(0x7dd9b30)
run into user defined function DebertaEmbeddings(
  (word_embeddings): Embedding(50265, 768, padding_idx=0)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 1 0x153bc2c04640 forward
new bytecode: 

0: [33mLOAD_FAST[0m(1, input_ids) 
1: [33mLOAD_CONST[0m(0, None) 
2: [33mIS_OP[0m(1, 1) 
3: [33mPOP_JUMP_IF_FALSE[0m(18, 18)  -> inst 9
4: [33mLOAD_FAST[0m(1, input_ids) 
5: [33mLOAD_METHOD[0m(0, size) 
6: [33mCALL_METHOD[0m(0, 0) 
7: [33mSTORE_FAST[0m(6, input_shape) 
8: [33mJUMP_FORWARD[0m(16, 34)  -> inst 17
9: [33mLOAD_FAST[0m(5, inputs_embeds) 
10: [33mLOAD_METHOD[0m(0, size) 
11: [33mCALL_METHOD[0m(0, 0) 
12: [33mLOAD_CONST[0m(0, None) 
13: [33mLOAD_CONST[0m(1, -1) 
14: [33mBUILD_SLICE[0m(2, 2) 
15: [33mBINARY_SUBSCR[0m(None, None) 
16: [33mSTORE_FAST[0m(6, input_shape) 
17: [33mLOAD_FAST[0m(6, input_shape) 
18: [33mLOAD_CONST[0m(2, 1) 
19: [33mBINARY_SUBSCR[0m(None, None) 
20: [33mSTORE_FAST[0m(7, seq_length) 
21: [33mLOAD_FAST[0m(3, position_ids) 
22: [33mLOAD_CONST[0m(0, None) 
23: [33mIS_OP[0m(0, 0) 
24: [33mPOP_JUMP_IF_FALSE[0m(72, 72)  -> inst 36
25: [33mLOAD_FAST[0m(0, self) 
26: [33mLOAD_ATTR[0m(1, position_ids) 
27: [33mLOAD_CONST[0m(0, None) 
28: [33mLOAD_CONST[0m(0, None) 
29: [33mBUILD_SLICE[0m(2, 2) 
30: [33mLOAD_CONST[0m(0, None) 
31: [33mLOAD_FAST[0m(7, seq_length) 
32: [33mBUILD_SLICE[0m(2, 2) 
33: [33mBUILD_TUPLE[0m(2, 2) 
34: [33mBINARY_SUBSCR[0m(None, None) 
35: [33mSTORE_FAST[0m(3, position_ids) 
36: [33mLOAD_FAST[0m(2, token_type_ids) 
37: [33mLOAD_CONST[0m(0, None) 
38: [33mIS_OP[0m(0, 0) 
39: [33mPOP_JUMP_IF_FALSE[0m(102, 102)  -> inst 51
40: [33mLOAD_GLOBAL[0m(2, torch) 
41: [33mLOAD_ATTR[0m(3, zeros) 
42: [33mLOAD_FAST[0m(6, input_shape) 
43: [33mLOAD_GLOBAL[0m(2, torch) 
44: [33mLOAD_ATTR[0m(4, long) 
45: [33mLOAD_FAST[0m(0, self) 
46: [33mLOAD_ATTR[0m(1, position_ids) 
47: [33mLOAD_ATTR[0m(5, device) 
48: [33mLOAD_CONST[0m(3, ('dtype', 'device')) 
49: [33mCALL_FUNCTION_KW[0m(3, 3) 
50: [33mSTORE_FAST[0m(2, token_type_ids) 
51: [33mLOAD_FAST[0m(5, inputs_embeds) 
52: [33mLOAD_CONST[0m(0, None) 
53: [33mIS_OP[0m(0, 0) 
54: [33mPOP_JUMP_IF_FALSE[0m(120, 120)  -> inst 60
55: [33mLOAD_FAST[0m(0, self) 
56: [33mLOAD_METHOD[0m(6, word_embeddings) 
57: [33mLOAD_FAST[0m(1, input_ids) 
58: [33mCALL_METHOD[0m(1, 1) 
59: [33mSTORE_FAST[0m(5, inputs_embeds) 
60: [33mLOAD_FAST[0m(0, self) 
61: [33mLOAD_ATTR[0m(7, position_embeddings) 
62: [33mLOAD_CONST[0m(0, None) 
63: [33mIS_OP[0m(1, 1) 
64: [33mPOP_JUMP_IF_FALSE[0m(146, 146)  -> inst 73
65: [33mLOAD_FAST[0m(0, self) 
66: [33mLOAD_METHOD[0m(7, position_embeddings) 
67: [33mLOAD_FAST[0m(3, position_ids) 
68: [33mLOAD_METHOD[0m(4, long) 
69: [33mCALL_METHOD[0m(0, 0) 
70: [33mCALL_METHOD[0m(1, 1) 
71: [33mSTORE_FAST[0m(8, position_embeddings) 
72: [33mJUMP_FORWARD[0m(10, 156)  -> inst 78
73: [33mLOAD_GLOBAL[0m(2, torch) 
74: [33mLOAD_METHOD[0m(8, zeros_like) 
75: [33mLOAD_FAST[0m(5, inputs_embeds) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mSTORE_FAST[0m(8, position_embeddings) 
78: [33mLOAD_FAST[0m(5, inputs_embeds) 
79: [33mSTORE_FAST[0m(9, embeddings) 
80: [33mLOAD_FAST[0m(0, self) 
81: [33mLOAD_ATTR[0m(9, position_biased_input) 
82: [33mPOP_JUMP_IF_FALSE[0m(174, 174)  -> inst 87
83: [33mLOAD_FAST[0m(9, embeddings) 
84: [33mLOAD_FAST[0m(8, position_embeddings) 
85: [33mINPLACE_ADD[0m(None, None) 
86: [33mSTORE_FAST[0m(9, embeddings) 
87: [33mLOAD_FAST[0m(0, self) 
88: [33mLOAD_ATTR[0m(10, config) 
89: [33mLOAD_ATTR[0m(11, type_vocab_size) 
90: [33mLOAD_CONST[0m(4, 0) 
91: [33mCOMPARE_OP[0m(4, >) 
92: [33mPOP_JUMP_IF_FALSE[0m(204, 204)  -> inst 102
93: [33mLOAD_FAST[0m(0, self) 
94: [33mLOAD_METHOD[0m(12, token_type_embeddings) 
95: [33mLOAD_FAST[0m(2, token_type_ids) 
96: [33mCALL_METHOD[0m(1, 1) 
97: [33mSTORE_FAST[0m(10, token_type_embeddings) 
98: [33mLOAD_FAST[0m(9, embeddings) 
99: [33mLOAD_FAST[0m(10, token_type_embeddings) 
100: [33mINPLACE_ADD[0m(None, None) 
101: [33mSTORE_FAST[0m(9, embeddings) 
102: [33mLOAD_FAST[0m(0, self) 
103: [33mLOAD_ATTR[0m(13, embedding_size) 
104: [33mLOAD_FAST[0m(0, self) 
105: [33mLOAD_ATTR[0m(10, config) 
106: [33mLOAD_ATTR[0m(14, hidden_size) 
107: [33mCOMPARE_OP[0m(3, !=) 
108: [33mPOP_JUMP_IF_FALSE[0m(228, 228)  -> inst 114
109: [33mLOAD_FAST[0m(0, self) 
110: [33mLOAD_METHOD[0m(15, embed_proj) 
111: [33mLOAD_FAST[0m(9, embeddings) 
112: [33mCALL_METHOD[0m(1, 1) 
113: [33mSTORE_FAST[0m(9, embeddings) 
114: [33mLOAD_FAST[0m(0, self) 
115: [33mLOAD_METHOD[0m(16, LayerNorm) 
116: [33mLOAD_FAST[0m(9, embeddings) 
117: [33mCALL_METHOD[0m(1, 1) 
118: [33mSTORE_FAST[0m(9, embeddings) 
119: [33mLOAD_FAST[0m(4, mask) 
120: [33mLOAD_CONST[0m(0, None) 
121: [33mIS_OP[0m(1, 1) 
122: [33mEXTENDED_ARG[0m(1, 1) 
123: [33mPOP_JUMP_IF_FALSE[0m(326, 326)  -> inst 163
124: [33mLOAD_FAST[0m(4, mask) 
125: [33mLOAD_METHOD[0m(17, dim) 
126: [33mCALL_METHOD[0m(0, 0) 
127: [33mLOAD_FAST[0m(9, embeddings) 
128: [33mLOAD_METHOD[0m(17, dim) 
129: [33mCALL_METHOD[0m(0, 0) 
130: [33mCOMPARE_OP[0m(3, !=) 
131: [33mEXTENDED_ARG[0m(1, 1) 
132: [33mPOP_JUMP_IF_FALSE[0m(306, 306)  -> inst 153
133: [33mLOAD_FAST[0m(4, mask) 
134: [33mLOAD_METHOD[0m(17, dim) 
135: [33mCALL_METHOD[0m(0, 0) 
136: [33mLOAD_CONST[0m(5, 4) 
137: [33mCOMPARE_OP[0m(2, ==) 
138: [33mEXTENDED_ARG[0m(1, 1) 
139: [33mPOP_JUMP_IF_FALSE[0m(296, 296)  -> inst 148
140: [33mLOAD_FAST[0m(4, mask) 
141: [33mLOAD_METHOD[0m(18, squeeze) 
142: [33mLOAD_CONST[0m(2, 1) 
143: [33mCALL_METHOD[0m(1, 1) 
144: [33mLOAD_METHOD[0m(18, squeeze) 
145: [33mLOAD_CONST[0m(2, 1) 
146: [33mCALL_METHOD[0m(1, 1) 
147: [33mSTORE_FAST[0m(4, mask) 
148: [33mLOAD_FAST[0m(4, mask) 
149: [33mLOAD_METHOD[0m(19, unsqueeze) 
150: [33mLOAD_CONST[0m(6, 2) 
151: [33mCALL_METHOD[0m(1, 1) 
152: [33mSTORE_FAST[0m(4, mask) 
153: [33mLOAD_FAST[0m(4, mask) 
154: [33mLOAD_METHOD[0m(20, to) 
155: [33mLOAD_FAST[0m(9, embeddings) 
156: [33mLOAD_ATTR[0m(21, dtype) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mSTORE_FAST[0m(4, mask) 
159: [33mLOAD_FAST[0m(9, embeddings) 
160: [33mLOAD_FAST[0m(4, mask) 
161: [33mBINARY_MULTIPLY[0m(None, None) 
162: [33mSTORE_FAST[0m(9, embeddings) 
163: [33mLOAD_FAST[0m(0, self) 
164: [33mLOAD_METHOD[0m(22, dropout) 
165: [33mLOAD_FAST[0m(9, embeddings) 
166: [33mCALL_METHOD[0m(1, 1) 
167: [33mSTORE_FAST[0m(9, embeddings) 
168: [33mLOAD_FAST[0m(9, embeddings) 
169: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -1), (<class 'int'>, 4), (<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'tuple'>, ('dtype', 'device')), (<class 'int'>, 2)]
guarded code
0: [32mLOAD_GLOBAL[0m(23, disable_trace) 
1: [32mLOAD_CONST[0m(0, 1) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(1, 1) 
5: [32mJUMP_ABSOLUTE[0m(354, 354)  -> inst 177
6: [33mLOAD_FAST[0m(1, input_ids) 
7: [33mLOAD_CONST[0m(4, None) 
8: [33mIS_OP[0m(1, 1) 
9: [33mPOP_JUMP_IF_FALSE[0m(30, 30)  -> inst 15
10: [33mLOAD_FAST[0m(1, input_ids) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mCALL_METHOD[0m(0, 0) 
13: [33mSTORE_FAST[0m(6, input_shape) 
14: [33mJUMP_FORWARD[0m(16, 46)  -> inst 23
15: [33mLOAD_FAST[0m(5, inputs_embeds) 
16: [33mLOAD_METHOD[0m(0, size) 
17: [33mCALL_METHOD[0m(0, 0) 
18: [33mLOAD_CONST[0m(4, None) 
19: [33mLOAD_CONST[0m(1, -1) 
20: [33mBUILD_SLICE[0m(2, 2) 
21: [33mBINARY_SUBSCR[0m(None, None) 
22: [33mSTORE_FAST[0m(6, input_shape) 
23: [33mLOAD_FAST[0m(6, input_shape) 
24: [33mLOAD_CONST[0m(0, 1) 
25: [33mBINARY_SUBSCR[0m(None, None) 
26: [33mSTORE_FAST[0m(7, seq_length) 
27: [33mLOAD_FAST[0m(3, position_ids) 
28: [33mLOAD_CONST[0m(4, None) 
29: [33mIS_OP[0m(0, 0) 
30: [33mPOP_JUMP_IF_FALSE[0m(84, 84)  -> inst 42
31: [33mLOAD_FAST[0m(0, self) 
32: [33mLOAD_ATTR[0m(1, position_ids) 
33: [33mLOAD_CONST[0m(4, None) 
34: [33mLOAD_CONST[0m(4, None) 
35: [33mBUILD_SLICE[0m(2, 2) 
36: [33mLOAD_CONST[0m(4, None) 
37: [33mLOAD_FAST[0m(7, seq_length) 
38: [33mBUILD_SLICE[0m(2, 2) 
39: [33mBUILD_TUPLE[0m(2, 2) 
40: [33mBINARY_SUBSCR[0m(None, None) 
41: [33mSTORE_FAST[0m(3, position_ids) 
42: [33mLOAD_FAST[0m(2, token_type_ids) 
43: [33mLOAD_CONST[0m(4, None) 
44: [33mIS_OP[0m(0, 0) 
45: [33mPOP_JUMP_IF_FALSE[0m(114, 114)  -> inst 57
46: [33mLOAD_GLOBAL[0m(2, torch) 
47: [33mLOAD_ATTR[0m(3, zeros) 
48: [33mLOAD_FAST[0m(6, input_shape) 
49: [33mLOAD_GLOBAL[0m(2, torch) 
50: [33mLOAD_ATTR[0m(4, long) 
51: [33mLOAD_FAST[0m(0, self) 
52: [33mLOAD_ATTR[0m(1, position_ids) 
53: [33mLOAD_ATTR[0m(5, device) 
54: [33mLOAD_CONST[0m(5, ('dtype', 'device')) 
55: [33mCALL_FUNCTION_KW[0m(3, 3) 
56: [33mSTORE_FAST[0m(2, token_type_ids) 
57: [33mLOAD_FAST[0m(5, inputs_embeds) 
58: [33mLOAD_CONST[0m(4, None) 
59: [33mIS_OP[0m(0, 0) 
60: [33mPOP_JUMP_IF_FALSE[0m(132, 132)  -> inst 66
61: [33mLOAD_FAST[0m(0, self) 
62: [33mLOAD_METHOD[0m(6, word_embeddings) 
63: [33mLOAD_FAST[0m(1, input_ids) 
64: [33mCALL_METHOD[0m(1, 1) 
65: [33mSTORE_FAST[0m(5, inputs_embeds) 
66: [33mLOAD_FAST[0m(0, self) 
67: [33mLOAD_ATTR[0m(7, position_embeddings) 
68: [33mLOAD_CONST[0m(4, None) 
69: [33mIS_OP[0m(1, 1) 
70: [33mPOP_JUMP_IF_FALSE[0m(158, 158)  -> inst 79
71: [33mLOAD_FAST[0m(0, self) 
72: [33mLOAD_METHOD[0m(7, position_embeddings) 
73: [33mLOAD_FAST[0m(3, position_ids) 
74: [33mLOAD_METHOD[0m(4, long) 
75: [33mCALL_METHOD[0m(0, 0) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mSTORE_FAST[0m(8, position_embeddings) 
78: [33mJUMP_FORWARD[0m(10, 168)  -> inst 84
79: [33mLOAD_GLOBAL[0m(2, torch) 
80: [33mLOAD_METHOD[0m(8, zeros_like) 
81: [33mLOAD_FAST[0m(5, inputs_embeds) 
82: [33mCALL_METHOD[0m(1, 1) 
83: [33mSTORE_FAST[0m(8, position_embeddings) 
84: [33mLOAD_FAST[0m(5, inputs_embeds) 
85: [33mSTORE_FAST[0m(9, embeddings) 
86: [33mLOAD_FAST[0m(0, self) 
87: [33mLOAD_ATTR[0m(9, position_biased_input) 
88: [33mPOP_JUMP_IF_FALSE[0m(186, 186)  -> inst 93
89: [33mLOAD_FAST[0m(9, embeddings) 
90: [33mLOAD_FAST[0m(8, position_embeddings) 
91: [33mINPLACE_ADD[0m(None, None) 
92: [33mSTORE_FAST[0m(9, embeddings) 
93: [33mLOAD_FAST[0m(0, self) 
94: [33mLOAD_ATTR[0m(10, config) 
95: [33mLOAD_ATTR[0m(11, type_vocab_size) 
96: [33mLOAD_CONST[0m(3, 0) 
97: [33mCOMPARE_OP[0m(4, >) 
98: [33mPOP_JUMP_IF_FALSE[0m(216, 216)  -> inst 108
99: [33mLOAD_FAST[0m(0, self) 
100: [33mLOAD_METHOD[0m(12, token_type_embeddings) 
101: [33mLOAD_FAST[0m(2, token_type_ids) 
102: [33mCALL_METHOD[0m(1, 1) 
103: [33mSTORE_FAST[0m(10, token_type_embeddings) 
104: [33mLOAD_FAST[0m(9, embeddings) 
105: [33mLOAD_FAST[0m(10, token_type_embeddings) 
106: [33mINPLACE_ADD[0m(None, None) 
107: [33mSTORE_FAST[0m(9, embeddings) 
108: [33mLOAD_FAST[0m(0, self) 
109: [33mLOAD_ATTR[0m(13, embedding_size) 
110: [33mLOAD_FAST[0m(0, self) 
111: [33mLOAD_ATTR[0m(10, config) 
112: [33mLOAD_ATTR[0m(14, hidden_size) 
113: [33mCOMPARE_OP[0m(3, !=) 
114: [33mPOP_JUMP_IF_FALSE[0m(240, 240)  -> inst 120
115: [33mLOAD_FAST[0m(0, self) 
116: [33mLOAD_METHOD[0m(15, embed_proj) 
117: [33mLOAD_FAST[0m(9, embeddings) 
118: [33mCALL_METHOD[0m(1, 1) 
119: [33mSTORE_FAST[0m(9, embeddings) 
120: [33mLOAD_FAST[0m(0, self) 
121: [33mLOAD_METHOD[0m(16, LayerNorm) 
122: [33mLOAD_FAST[0m(9, embeddings) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mSTORE_FAST[0m(9, embeddings) 
125: [33mLOAD_FAST[0m(4, mask) 
126: [33mLOAD_CONST[0m(4, None) 
127: [33mIS_OP[0m(1, 1) 
128: [32mEXTENDED_ARG[0m(1, 1) 
129: [33mPOP_JUMP_IF_FALSE[0m(338, 338)  -> inst 169
130: [33mLOAD_FAST[0m(4, mask) 
131: [33mLOAD_METHOD[0m(17, dim) 
132: [33mCALL_METHOD[0m(0, 0) 
133: [33mLOAD_FAST[0m(9, embeddings) 
134: [33mLOAD_METHOD[0m(17, dim) 
135: [33mCALL_METHOD[0m(0, 0) 
136: [33mCOMPARE_OP[0m(3, !=) 
137: [32mEXTENDED_ARG[0m(1, 1) 
138: [33mPOP_JUMP_IF_FALSE[0m(318, 318)  -> inst 159
139: [33mLOAD_FAST[0m(4, mask) 
140: [33mLOAD_METHOD[0m(17, dim) 
141: [33mCALL_METHOD[0m(0, 0) 
142: [33mLOAD_CONST[0m(2, 4) 
143: [33mCOMPARE_OP[0m(2, ==) 
144: [32mEXTENDED_ARG[0m(1, 1) 
145: [33mPOP_JUMP_IF_FALSE[0m(308, 308)  -> inst 154
146: [33mLOAD_FAST[0m(4, mask) 
147: [33mLOAD_METHOD[0m(18, squeeze) 
148: [33mLOAD_CONST[0m(0, 1) 
149: [33mCALL_METHOD[0m(1, 1) 
150: [33mLOAD_METHOD[0m(18, squeeze) 
151: [33mLOAD_CONST[0m(0, 1) 
152: [33mCALL_METHOD[0m(1, 1) 
153: [33mSTORE_FAST[0m(4, mask) 
154: [33mLOAD_FAST[0m(4, mask) 
155: [33mLOAD_METHOD[0m(19, unsqueeze) 
156: [33mLOAD_CONST[0m(6, 2) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mSTORE_FAST[0m(4, mask) 
159: [33mLOAD_FAST[0m(4, mask) 
160: [33mLOAD_METHOD[0m(20, to) 
161: [33mLOAD_FAST[0m(9, embeddings) 
162: [33mLOAD_ATTR[0m(21, dtype) 
163: [33mCALL_METHOD[0m(1, 1) 
164: [33mSTORE_FAST[0m(4, mask) 
165: [33mLOAD_FAST[0m(9, embeddings) 
166: [33mLOAD_FAST[0m(4, mask) 
167: [33mBINARY_MULTIPLY[0m(None, None) 
168: [33mSTORE_FAST[0m(9, embeddings) 
169: [33mLOAD_FAST[0m(0, self) 
170: [33mLOAD_METHOD[0m(22, dropout) 
171: [33mLOAD_FAST[0m(9, embeddings) 
172: [33mCALL_METHOD[0m(1, 1) 
173: [33mSTORE_FAST[0m(9, embeddings) 
174: [33mLOAD_FAST[0m(9, embeddings) 
175: [32mEXTENDED_ARG[0m(1, 1) 
176: [32mJUMP_ABSOLUTE[0m(382, 382)  -> inst 191
177: [32mLOAD_GLOBAL[0m(26, guard_match) 
178: [32mLOAD_CONST[0m(0, 1) 
179: [32mLOAD_CONST[0m(3, 0) 
180: [32mLOAD_GLOBAL[0m(27, locals) 
181: [32mCALL_FUNCTION[0m(0, 0) 
182: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
183: [32mUNPACK_SEQUENCE[0m(2, 2) 
184: [32mSTORE_FAST[0m(12, __case_idx) 
185: [32mSTORE_FAST[0m(11, __graph_fn) 
186: [32mLOAD_GLOBAL[0m(24, enable_trace) 
187: [32mLOAD_CONST[0m(0, 1) 
188: [32mCALL_FUNCTION[0m(1, 1) 
189: [32mPOP_TOP[0m(None, None) 
190: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
191: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:769
tracing opcode LOAD_GLOBAL None pc=0 frame=1(0x7df5270)
push tracker due to record
push tracker 1 frame 0x7df5270 frame_id 1 read_stack False cf_info <class 'NoneType'> all [0, 1]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=1(0x7df5270)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=1(0x7df5270)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 1] frame_id 1
enable_trace
push tracker 1 frame 0x7df5270 frame_id 1 read_stack False cf_info <class 'NoneType'> all [0, 1]
tracing opcode POP_TOP None pc=378 frame=1(0x7df5270)
restart: running injected code (f_lasti=378)
tracing opcode JUMP_ABSOLUTE None pc=380 frame=1(0x7df5270)
restart: running injected code (f_lasti=380)
tracing line /home/drc/frontend/test/test_model_deberta.py:770
tracing opcode LOAD_FAST None pc=12 frame=1(0x7df5270)
load fast: 23346799785520
tracing opcode LOAD_CONST None pc=14 frame=1(0x7df5270)
tracing opcode IS_OP None pc=16 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:771
tracing opcode LOAD_FAST None pc=20 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=22 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=24 frame=1(0x7df5270)
tracing opcode STORE_FAST None pc=26 frame=1(0x7df5270)
tracing opcode JUMP_FORWARD None pc=28 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:775
tracing opcode LOAD_FAST None pc=46 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=48 frame=1(0x7df5270)
tracing opcode BINARY_SUBSCR None pc=50 frame=1(0x7df5270)
tracing opcode STORE_FAST None pc=52 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:777
tracing opcode LOAD_FAST None pc=54 frame=1(0x7df5270)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=56 frame=1(0x7df5270)
tracing opcode IS_OP None pc=58 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:778
tracing opcode LOAD_FAST None pc=62 frame=1(0x7df5270)
load fast: 23346416248288
tracing opcode LOAD_ATTR None pc=64 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=66 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=68 frame=1(0x7df5270)
tracing opcode BUILD_SLICE None pc=70 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=72 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=74 frame=1(0x7df5270)
tracing opcode BUILD_SLICE None pc=76 frame=1(0x7df5270)
tracing opcode BUILD_TUPLE None pc=78 frame=1(0x7df5270)
tracing opcode BINARY_SUBSCR None pc=80 frame=1(0x7df5270)
record function in graph <built-in function getitem>
tracing opcode STORE_FAST None pc=82 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:780
tracing opcode LOAD_FAST None pc=84 frame=1(0x7df5270)
load fast: 23344634186704
tracing opcode LOAD_CONST None pc=86 frame=1(0x7df5270)
tracing opcode IS_OP None pc=88 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:783
tracing opcode LOAD_FAST None pc=114 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=116 frame=1(0x7df5270)
tracing opcode IS_OP None pc=118 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=120 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:784
tracing opcode LOAD_FAST None pc=122 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=124 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=126 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=128 frame=1(0x7df5270)
record function in graph Embedding(50265, 768, padding_idx=0)
tracing opcode STORE_FAST None pc=130 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:786
tracing opcode LOAD_FAST None pc=132 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=134 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=136 frame=1(0x7df5270)
tracing opcode IS_OP None pc=138 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=140 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:789
tracing opcode LOAD_GLOBAL None pc=158 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=160 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=162 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=164 frame=1(0x7df5270)
record function in graph <built-in method zeros_like of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=166 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:791
tracing opcode LOAD_FAST None pc=168 frame=1(0x7df5270)
tracing opcode STORE_FAST None pc=170 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:792
tracing opcode LOAD_FAST None pc=172 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=174 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=176 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:794
tracing opcode LOAD_FAST None pc=186 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=188 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=190 frame=1(0x7df5270)
generate any for DebertaConfig {
  "_name_or_path": "microsoft/deberta-base",
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-07,
  "max_position_embeddings": 512,
  "max_relative_positions": -1,
  "model_type": "deberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_dropout": 0,
  "pooler_hidden_act": "gelu",
  "pooler_hidden_size": 768,
  "pos_att_type": [
    "c2p",
    "p2c"
  ],
  "position_biased_input": false,
  "relative_attention": true,
  "return_dict": false,
  "transformers_version": "4.34.0",
  "type_vocab_size": 0,
  "vocab_size": 50265
}
 <class 'transformers.models.deberta.configuration_deberta.DebertaConfig'> [locals['self'].config]
tracing opcode LOAD_CONST None pc=192 frame=1(0x7df5270)
tracing opcode COMPARE_OP None pc=194 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=196 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:798
tracing opcode LOAD_FAST None pc=216 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=218 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=220 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=222 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=224 frame=1(0x7df5270)
generate any for DebertaConfig {
  "_name_or_path": "microsoft/deberta-base",
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-07,
  "max_position_embeddings": 512,
  "max_relative_positions": -1,
  "model_type": "deberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "pooler_dropout": 0,
  "pooler_hidden_act": "gelu",
  "pooler_hidden_size": 768,
  "pos_att_type": [
    "c2p",
    "p2c"
  ],
  "position_biased_input": false,
  "relative_attention": true,
  "return_dict": false,
  "transformers_version": "4.34.0",
  "type_vocab_size": 0,
  "vocab_size": 50265
}
 <class 'transformers.models.deberta.configuration_deberta.DebertaConfig'> [locals['self'].config]
tracing opcode COMPARE_OP None pc=226 frame=1(0x7df5270)
tracing opcode POP_JUMP_IF_FALSE None pc=228 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:801
tracing opcode LOAD_FAST None pc=240 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=242 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=244 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=246 frame=1(0x7df5270)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
new bytecode: 

0: [33mLOAD_FAST[0m(1, hidden_states) 
1: [33mLOAD_ATTR[0m(0, dtype) 
2: [33mSTORE_FAST[0m(2, input_type) 
3: [33mLOAD_FAST[0m(1, hidden_states) 
4: [33mLOAD_METHOD[0m(1, float) 
5: [33mCALL_METHOD[0m(0, 0) 
6: [33mSTORE_FAST[0m(1, hidden_states) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_ATTR[0m(2, mean) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mLOAD_CONST[0m(2, True) 
11: [33mLOAD_CONST[0m(3, ('keepdim',)) 
12: [33mCALL_FUNCTION_KW[0m(2, 2) 
13: [33mSTORE_FAST[0m(3, mean) 
14: [33mLOAD_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(3, mean) 
16: [33mBINARY_SUBTRACT[0m(None, None) 
17: [33mLOAD_METHOD[0m(3, pow) 
18: [33mLOAD_CONST[0m(4, 2) 
19: [33mCALL_METHOD[0m(1, 1) 
20: [33mLOAD_ATTR[0m(2, mean) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(2, True) 
23: [33mLOAD_CONST[0m(3, ('keepdim',)) 
24: [33mCALL_FUNCTION_KW[0m(2, 2) 
25: [33mSTORE_FAST[0m(4, variance) 
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mLOAD_FAST[0m(3, mean) 
28: [33mBINARY_SUBTRACT[0m(None, None) 
29: [33mLOAD_GLOBAL[0m(4, torch) 
30: [33mLOAD_METHOD[0m(5, sqrt) 
31: [33mLOAD_FAST[0m(4, variance) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(6, variance_epsilon) 
34: [33mBINARY_ADD[0m(None, None) 
35: [33mCALL_METHOD[0m(1, 1) 
36: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
37: [33mSTORE_FAST[0m(1, hidden_states) 
38: [33mLOAD_FAST[0m(1, hidden_states) 
39: [33mLOAD_METHOD[0m(7, to) 
40: [33mLOAD_FAST[0m(2, input_type) 
41: [33mCALL_METHOD[0m(1, 1) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(0, self) 
44: [33mLOAD_ATTR[0m(8, weight) 
45: [33mLOAD_FAST[0m(1, hidden_states) 
46: [33mBINARY_MULTIPLY[0m(None, None) 
47: [33mLOAD_FAST[0m(0, self) 
48: [33mLOAD_ATTR[0m(9, bias) 
49: [33mBINARY_ADD[0m(None, None) 
50: [33mSTORE_FAST[0m(5, y) 
51: [33mLOAD_FAST[0m(5, y) 
52: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'tuple'>, ('keepdim',)), (<class 'int'>, -1), (<class 'NoneType'>, None), (<class 'bool'>, True), (<class 'int'>, 2), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153bc2c6b9f0)
push tracker due to record
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 1, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 1, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 1, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153bc2c6b9f0)
load fast: 23346415212400
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153bc2c6b9f0)
tracing opcode STORE_FAST None pc=14 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153bc2c6b9f0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bc2c91770>
tracing opcode STORE_FAST None pc=36 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153bc2c6b9f0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bc0bcf1d0>
tracing opcode STORE_FAST None pc=60 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153bc2c6b9f0)
load fast: 23346416248384
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153bc2c6b9f0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153bc2c6b9f0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_7 : [#users=4] = placeholder[target=tensor_7]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_7,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_7, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_7, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_7, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 1
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153bc2c91770>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 1, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=248 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:803
tracing opcode LOAD_FAST None pc=250 frame=1(0x7df5270)
load fast: 23346799762864
tracing opcode LOAD_CONST None pc=252 frame=1(0x7df5270)
tracing opcode IS_OP None pc=254 frame=1(0x7df5270)
tracing opcode EXTENDED_ARG None pc=256 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:804
tracing opcode LOAD_FAST None pc=260 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=262 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=264 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=266 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=268 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=270 frame=1(0x7df5270)
tracing opcode COMPARE_OP None pc=272 frame=1(0x7df5270)
tracing opcode EXTENDED_ARG None pc=274 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:805
tracing opcode LOAD_FAST None pc=278 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=280 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=282 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=284 frame=1(0x7df5270)
tracing opcode COMPARE_OP None pc=286 frame=1(0x7df5270)
tracing opcode EXTENDED_ARG None pc=288 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:807
tracing opcode LOAD_FAST None pc=308 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=310 frame=1(0x7df5270)
tracing opcode LOAD_CONST None pc=312 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=314 frame=1(0x7df5270)
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=316 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:808
tracing opcode LOAD_FAST None pc=318 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=320 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=322 frame=1(0x7df5270)
tracing opcode LOAD_ATTR None pc=324 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=326 frame=1(0x7df5270)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=328 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:810
tracing opcode LOAD_FAST None pc=330 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=332 frame=1(0x7df5270)
tracing opcode BINARY_MULTIPLY None pc=334 frame=1(0x7df5270)
record function in graph <built-in function mul>
tracing opcode STORE_FAST None pc=336 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:812
tracing opcode LOAD_FAST None pc=338 frame=1(0x7df5270)
tracing opcode LOAD_METHOD None pc=340 frame=1(0x7df5270)
tracing opcode LOAD_FAST None pc=342 frame=1(0x7df5270)
tracing opcode CALL_METHOD None pc=344 frame=1(0x7df5270)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_ATTR[0m(0, training) 
2: [33mPOP_JUMP_IF_FALSE[0m(32, 32)  -> inst 16
3: [33mLOAD_FAST[0m(0, self) 
4: [33mLOAD_ATTR[0m(1, drop_prob) 
5: [33mLOAD_CONST[0m(1, 0) 
6: [33mCOMPARE_OP[0m(4, >) 
7: [33mPOP_JUMP_IF_FALSE[0m(32, 32)  -> inst 16
8: [33mLOAD_GLOBAL[0m(2, XDropout) 
9: [33mLOAD_METHOD[0m(3, apply) 
10: [33mLOAD_FAST[0m(1, x) 
11: [33mLOAD_FAST[0m(0, self) 
12: [33mLOAD_METHOD[0m(4, get_context) 
13: [33mCALL_METHOD[0m(0, 0) 
14: [33mCALL_METHOD[0m(2, 2) 
15: [33mRETURN_VALUE[0m(None, None) 
16: [33mLOAD_FAST[0m(1, x) 
17: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'str'>, '\n        Call the module\n\n        Args:\n            x (`torch.tensor`): The input tensor to apply dropout\n        '), (<class 'int'>, 0), (<class 'int'>, 3)]
guarded code
0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 1, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 1, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 1, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416248432
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346380865104
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_9 : [#users=0] = placeholder[target=tensor_9]
to merge frameid 3 1
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-0.4745,  0.4795, -0.6835,  ...,  0.7922, -0.1495,  1.2664],
         [-0.2552,  1.4093, -0.5182,  ..., -1.0163,  1.7162,  1.7644],
         [-0.3467,  1.4889,  0.7441,  ..., -0.3843,  1.3751,  1.3166],
         ...,
         [ 0.9130,  1.1131, -0.5668,  ...,  0.3879, -0.5664,  0.8270],
         [ 0.1326,  0.4045, -1.5836,  ...,  1.2737, -0.6294,  0.7159],
         [-1.8158,  1.1578, -0.8414,  ..., -1.4324, -0.1903, -0.1349]]]), modified_attrs={}, prev=None) 23346380964144 23346380865104
obj: tensor([[[-0.4745,  0.4795, -0.6835,  ...,  0.7922, -0.1495,  1.2664],
         [-0.2552,  1.4093, -0.5182,  ..., -1.0163,  1.7162,  1.7644],
         [-0.3467,  1.4889,  0.7441,  ..., -0.3843,  1.3751,  1.3166],
         ...,
         [ 0.9130,  1.1131, -0.5668,  ...,  0.3879, -0.5664,  0.8270],
         [ 0.1326,  0.4045, -1.5836,  ...,  1.2737, -0.6294,  0.7159],
         [-1.8158,  1.1578, -0.8414,  ..., -1.4324, -0.1903, -0.1349]]]) 23346380865104
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.4745,  0.4795, -0.6835,  ...,  0.7922, -0.1495,  1.2664],
         [-0.2552,  1.4093, -0.5182,  ..., -1.0163,  1.7162,  1.7644],
         [-0.3467,  1.4889,  0.7441,  ..., -0.3843,  1.3751,  1.3166],
         ...,
         [ 0.9130,  1.1131, -0.5668,  ...,  0.3879, -0.5664,  0.8270],
         [ 0.1326,  0.4045, -1.5836,  ...,  1.2737, -0.6294,  0.7159],
         [-1.8158,  1.1578, -0.8414,  ..., -1.4324, -0.1903, -0.1349]]]), modified_attrs={}, prev=None) 23346380757792
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 1, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=346 frame=1(0x7df5270)
tracing line /home/drc/frontend/test/test_model_deberta.py:813
tracing opcode LOAD_FAST None pc=348 frame=1(0x7df5270)
tracing opcode EXTENDED_ARG None pc=350 frame=1(0x7df5270)
restart: running injected code (f_lasti=350)
commiting 1 0 169 [32mRETURN_VALUE[0m(None, None)  350
callee is full graph, merge to caller
to merge graph graph():
    %tensor_4 : [#users=1] = placeholder[target=tensor_4]
    %tensor_5 : [#users=1] = placeholder[target=tensor_5]
    %getitem : [#users=0] = call_function[target=operator.getitem](args = (%tensor_5, [slice(None, None, None), slice(None, 256, None)]), kwargs = {})
    %tensor_6 : [#users=0] = placeholder[target=tensor_6]
    %word_embeddings : [#users=5] = call_module[target=word_embeddings](args = (%tensor_4,), kwargs = {})
    %zeros_like : [#users=0] = call_function[target=torch.zeros_like](args = (%word_embeddings,), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%word_embeddings,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%word_embeddings, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%word_embeddings, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%word_embeddings, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
    %tensor_8 : [#users=1] = placeholder[target=tensor_8]
    %unsqueeze : [#users=1] = call_method[target=unsqueeze](args = (%tensor_8, 2), kwargs = {})
    %to_1 : [#users=1] = call_method[target=to](args = (%unsqueeze, torch.float32), kwargs = {})
    %mul_1 : [#users=0] = call_function[target=operator.mul](args = (%add_1, %to_1), kwargs = {})
to merge frameid 1 0
tracing opcode RETURN_VALUE None pc=382 frame=1(0x7df5270)
restart: running injected code (f_lasti=382)
before pop_tracker [0, 1] frame_id 1
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=228 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:982
tracing opcode LOAD_DEREF None pc=230 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=232 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:983
tracing opcode LOAD_FAST None pc=234 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:984
tracing opcode LOAD_FAST None pc=236 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:985
tracing opcode LOAD_CONST None pc=238 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:986
tracing opcode LOAD_FAST None pc=240 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:987
tracing opcode LOAD_FAST None pc=242 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:982
tracing opcode LOAD_CONST None pc=244 frame=0(0x7dd9b30)
tracing opcode CALL_FUNCTION_KW None pc=246 frame=0(0x7dd9b30)
run into user defined function DebertaEncoder(
  (layer): ModuleList(
    (0-11): 12 x DebertaLayer(
      (attention): DebertaAttention(
        (self): DisentangledSelfAttention(
          (in_proj): Linear(in_features=768, out_features=2304, bias=False)
          (pos_dropout): StableDropout()
          (pos_proj): Linear(in_features=768, out_features=768, bias=False)
          (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
          (dropout): StableDropout()
        )
        (output): DebertaSelfOutput(
          (dense): Linear(in_features=768, out_features=768, bias=True)
          (LayerNorm): DebertaLayerNorm()
          (dropout): StableDropout()
        )
      )
      (intermediate): DebertaIntermediate(
        (dense): Linear(in_features=768, out_features=3072, bias=True)
        (intermediate_act_fn): GELUActivation()
      )
      (output): DebertaOutput(
        (dense): Linear(in_features=3072, out_features=768, bias=True)
        (LayerNorm): DebertaLayerNorm()
        (dropout): StableDropout()
      )
    )
  )
  (rel_embeddings): Embedding(1024, 768)
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 4 0x7df2210 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_METHOD[0m(0, get_attention_mask) 
2: [33mLOAD_FAST[0m(2, attention_mask) 
3: [33mCALL_METHOD[0m(1, 1) 
4: [33mSTORE_FAST[0m(2, attention_mask) 
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(1, get_rel_pos) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(5, query_states) 
9: [33mLOAD_FAST[0m(6, relative_pos) 
10: [33mCALL_METHOD[0m(3, 3) 
11: [33mSTORE_FAST[0m(6, relative_pos) 
12: [33mLOAD_FAST[0m(3, output_hidden_states) 
13: [33mPOP_JUMP_IF_FALSE[0m(32, 32)  -> inst 16
14: [33mLOAD_CONST[0m(1, ()) 
15: [33mJUMP_FORWARD[0m(2, 34)  -> inst 17
16: [33mLOAD_CONST[0m(0, None) 
17: [33mSTORE_FAST[0m(8, all_hidden_states) 
18: [33mLOAD_DEREF[0m(0, output_attentions) 
19: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
20: [33mLOAD_CONST[0m(1, ()) 
21: [33mJUMP_FORWARD[0m(2, 46)  -> inst 23
22: [33mLOAD_CONST[0m(0, None) 
23: [33mSTORE_FAST[0m(9, all_attentions) 
24: [33mLOAD_GLOBAL[0m(2, isinstance) 
25: [33mLOAD_FAST[0m(1, hidden_states) 
26: [33mLOAD_GLOBAL[0m(3, Sequence) 
27: [33mCALL_FUNCTION[0m(2, 2) 
28: [33mPOP_JUMP_IF_FALSE[0m(68, 68)  -> inst 34
29: [33mLOAD_FAST[0m(1, hidden_states) 
30: [33mLOAD_CONST[0m(2, 0) 
31: [33mBINARY_SUBSCR[0m(None, None) 
32: [33mSTORE_FAST[0m(10, next_kv) 
33: [33mJUMP_FORWARD[0m(4, 72)  -> inst 36
34: [33mLOAD_FAST[0m(1, hidden_states) 
35: [33mSTORE_FAST[0m(10, next_kv) 
36: [33mLOAD_FAST[0m(0, self) 
37: [33mLOAD_METHOD[0m(4, get_rel_embedding) 
38: [33mCALL_METHOD[0m(0, 0) 
39: [33mSTORE_FAST[0m(11, rel_embeddings) 
40: [33mLOAD_GLOBAL[0m(5, enumerate) 
41: [33mLOAD_FAST[0m(0, self) 
42: [33mLOAD_ATTR[0m(6, layer) 
43: [33mCALL_FUNCTION[0m(1, 1) 
44: [33mGET_ITER[0m(None, None) 
45: [33mFOR_ITER[0m(188, 280)  -> inst 140
46: [33mUNPACK_SEQUENCE[0m(2, 2) 
47: [33mSTORE_FAST[0m(12, i) 
48: [33mSTORE_FAST[0m(13, layer_module) 
49: [33mLOAD_FAST[0m(3, output_hidden_states) 
50: [33mPOP_JUMP_IF_FALSE[0m(112, 112)  -> inst 56
51: [33mLOAD_FAST[0m(8, all_hidden_states) 
52: [33mLOAD_FAST[0m(1, hidden_states) 
53: [33mBUILD_TUPLE[0m(1, 1) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(8, all_hidden_states) 
56: [33mLOAD_FAST[0m(0, self) 
57: [33mLOAD_ATTR[0m(7, gradient_checkpointing) 
58: [33mPOP_JUMP_IF_FALSE[0m(166, 166)  -> inst 83
59: [33mLOAD_FAST[0m(0, self) 
60: [33mLOAD_ATTR[0m(8, training) 
61: [33mPOP_JUMP_IF_FALSE[0m(166, 166)  -> inst 83
62: [33mLOAD_CLOSURE[0m(0, output_attentions) 
63: [33mBUILD_TUPLE[0m(1, 1) 
64: [33mLOAD_CONST[0m(3, <code object create_custom_forward at 0x153c7df4f240, file "/home/drc/frontend/test/test_model_deberta.py", line 460>) 
65: [33mLOAD_CONST[0m(4, DebertaEncoder.forward.<locals>.create_custom_forward) 
66: [33mMAKE_FUNCTION[0m(8, 8) 
67: [33mSTORE_FAST[0m(14, create_custom_forward) 
68: [33mLOAD_GLOBAL[0m(9, torch) 
69: [33mLOAD_ATTR[0m(10, utils) 
70: [33mLOAD_ATTR[0m(11, checkpoint) 
71: [33mLOAD_METHOD[0m(11, checkpoint) 
72: [33mLOAD_FAST[0m(14, create_custom_forward) 
73: [33mLOAD_FAST[0m(13, layer_module) 
74: [33mCALL_FUNCTION[0m(1, 1) 
75: [33mLOAD_FAST[0m(10, next_kv) 
76: [33mLOAD_FAST[0m(2, attention_mask) 
77: [33mLOAD_FAST[0m(5, query_states) 
78: [33mLOAD_FAST[0m(6, relative_pos) 
79: [33mLOAD_FAST[0m(11, rel_embeddings) 
80: [33mCALL_METHOD[0m(6, 6) 
81: [33mSTORE_FAST[0m(1, hidden_states) 
82: [33mJUMP_FORWARD[0m(20, 186)  -> inst 93
83: [33mLOAD_FAST[0m(13, layer_module) 
84: [33mLOAD_FAST[0m(10, next_kv) 
85: [33mLOAD_FAST[0m(2, attention_mask) 
86: [33mLOAD_FAST[0m(5, query_states) 
87: [33mLOAD_FAST[0m(6, relative_pos) 
88: [33mLOAD_FAST[0m(11, rel_embeddings) 
89: [33mLOAD_DEREF[0m(0, output_attentions) 
90: [33mLOAD_CONST[0m(5, ('query_states', 'relative_pos', 'rel_embeddings', 'output_attentions')) 
91: [33mCALL_FUNCTION_KW[0m(6, 6) 
92: [33mSTORE_FAST[0m(1, hidden_states) 
93: [33mLOAD_DEREF[0m(0, output_attentions) 
94: [33mPOP_JUMP_IF_FALSE[0m(198, 198)  -> inst 99
95: [33mLOAD_FAST[0m(1, hidden_states) 
96: [33mUNPACK_SEQUENCE[0m(2, 2) 
97: [33mSTORE_FAST[0m(1, hidden_states) 
98: [33mSTORE_FAST[0m(15, att_m) 
99: [33mLOAD_FAST[0m(5, query_states) 
100: [33mLOAD_CONST[0m(0, None) 
101: [33mIS_OP[0m(1, 1) 
102: [33mEXTENDED_ARG[0m(1, 1) 
103: [33mPOP_JUMP_IF_FALSE[0m(260, 260)  -> inst 130
104: [33mLOAD_FAST[0m(1, hidden_states) 
105: [33mSTORE_FAST[0m(5, query_states) 
106: [33mLOAD_GLOBAL[0m(2, isinstance) 
107: [33mLOAD_FAST[0m(1, hidden_states) 
108: [33mLOAD_GLOBAL[0m(3, Sequence) 
109: [33mCALL_FUNCTION[0m(2, 2) 
110: [33mEXTENDED_ARG[0m(1, 1) 
111: [33mPOP_JUMP_IF_FALSE[0m(264, 264)  -> inst 132
112: [33mLOAD_FAST[0m(12, i) 
113: [33mLOAD_CONST[0m(6, 1) 
114: [33mBINARY_ADD[0m(None, None) 
115: [33mLOAD_GLOBAL[0m(12, len) 
116: [33mLOAD_FAST[0m(0, self) 
117: [33mLOAD_ATTR[0m(6, layer) 
118: [33mCALL_FUNCTION[0m(1, 1) 
119: [33mCOMPARE_OP[0m(0, <) 
120: [33mPOP_JUMP_IF_FALSE[0m(254, 254)  -> inst 127
121: [33mLOAD_FAST[0m(1, hidden_states) 
122: [33mLOAD_FAST[0m(12, i) 
123: [33mLOAD_CONST[0m(6, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mBINARY_SUBSCR[0m(None, None) 
126: [33mJUMP_FORWARD[0m(2, 256)  -> inst 128
127: [33mLOAD_CONST[0m(0, None) 
128: [33mSTORE_FAST[0m(10, next_kv) 
129: [33mJUMP_FORWARD[0m(4, 264)  -> inst 132
130: [33mLOAD_FAST[0m(1, hidden_states) 
131: [33mSTORE_FAST[0m(10, next_kv) 
132: [33mLOAD_DEREF[0m(0, output_attentions) 
133: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
134: [33mLOAD_FAST[0m(9, all_attentions) 
135: [33mLOAD_FAST[0m(15, att_m) 
136: [33mBUILD_TUPLE[0m(1, 1) 
137: [33mBINARY_ADD[0m(None, None) 
138: [33mSTORE_FAST[0m(9, all_attentions) 
139: [33mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
140: [33mLOAD_FAST[0m(3, output_hidden_states) 
141: [33mEXTENDED_ARG[0m(1, 1) 
142: [33mPOP_JUMP_IF_FALSE[0m(296, 296)  -> inst 148
143: [33mLOAD_FAST[0m(8, all_hidden_states) 
144: [33mLOAD_FAST[0m(1, hidden_states) 
145: [33mBUILD_TUPLE[0m(1, 1) 
146: [33mBINARY_ADD[0m(None, None) 
147: [33mSTORE_FAST[0m(8, all_hidden_states) 
148: [33mLOAD_FAST[0m(7, return_dict) 
149: [33mEXTENDED_ARG[0m(1, 1) 
150: [33mPOP_JUMP_IF_TRUE[0m(326, 326)  -> inst 163
151: [33mLOAD_GLOBAL[0m(13, tuple) 
152: [33mLOAD_CONST[0m(7, <code object <genexpr> at 0x153c7df4f2f0, file "/home/drc/frontend/test/test_model_deberta.py", line 501>) 
153: [33mLOAD_CONST[0m(8, DebertaEncoder.forward.<locals>.<genexpr>) 
154: [33mMAKE_FUNCTION[0m(0, 0) 
155: [33mLOAD_FAST[0m(1, hidden_states) 
156: [33mLOAD_FAST[0m(8, all_hidden_states) 
157: [33mLOAD_FAST[0m(9, all_attentions) 
158: [33mBUILD_TUPLE[0m(3, 3) 
159: [33mGET_ITER[0m(None, None) 
160: [33mCALL_FUNCTION[0m(1, 1) 
161: [33mCALL_FUNCTION[0m(1, 1) 
162: [33mRETURN_VALUE[0m(None, None) 
163: [33mLOAD_GLOBAL[0m(14, BaseModelOutput) 
164: [33mLOAD_FAST[0m(1, hidden_states) 
165: [33mLOAD_FAST[0m(8, all_hidden_states) 
166: [33mLOAD_FAST[0m(9, all_attentions) 
167: [33mLOAD_CONST[0m(9, ('last_hidden_state', 'hidden_states', 'attentions')) 
168: [33mCALL_FUNCTION_KW[0m(3, 3) 
169: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'str'>, 'DebertaEncoder.forward.<locals>.create_custom_forward'), (<class 'tuple'>, ('query_states', 'relative_pos', 'rel_embeddings', 'output_attentions')), (<class 'int'>, 1), (<class 'code'>, <code object <genexpr> at 0x153c7df4f2f0, file "/home/drc/frontend/test/test_model_deberta.py", line 501>), (<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'str'>, 'DebertaEncoder.forward.<locals>.<genexpr>'), (<class 'tuple'>, ()), (<class 'code'>, <code object create_custom_forward at 0x153c7df4f240, file "/home/drc/frontend/test/test_model_deberta.py", line 460>), (<class 'tuple'>, ('last_hidden_state', 'hidden_states', 'attentions')), (<class 'int'>, 4)]
guarded code
0: [32mLOAD_GLOBAL[0m(15, disable_trace) 
1: [32mLOAD_CONST[0m(10, 4) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(1, 1) 
5: [32mJUMP_ABSOLUTE[0m(358, 358)  -> inst 179
6: [33mLOAD_FAST[0m(0, self) 
7: [33mLOAD_METHOD[0m(0, get_attention_mask) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mCALL_METHOD[0m(1, 1) 
10: [33mSTORE_FAST[0m(2, attention_mask) 
11: [33mLOAD_FAST[0m(0, self) 
12: [33mLOAD_METHOD[0m(1, get_rel_pos) 
13: [33mLOAD_FAST[0m(1, hidden_states) 
14: [33mLOAD_FAST[0m(5, query_states) 
15: [33mLOAD_FAST[0m(6, relative_pos) 
16: [33mCALL_METHOD[0m(3, 3) 
17: [33mSTORE_FAST[0m(6, relative_pos) 
18: [33mLOAD_FAST[0m(3, output_hidden_states) 
19: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
20: [33mLOAD_CONST[0m(7, ()) 
21: [33mJUMP_FORWARD[0m(2, 46)  -> inst 23
22: [33mLOAD_CONST[0m(5, None) 
23: [33mSTORE_FAST[0m(8, all_hidden_states) 
24: [33mLOAD_DEREF[0m(0, output_attentions) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_CONST[0m(7, ()) 
27: [33mJUMP_FORWARD[0m(2, 58)  -> inst 29
28: [33mLOAD_CONST[0m(5, None) 
29: [33mSTORE_FAST[0m(9, all_attentions) 
30: [33mLOAD_GLOBAL[0m(2, isinstance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_GLOBAL[0m(3, Sequence) 
33: [33mCALL_FUNCTION[0m(2, 2) 
34: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
35: [33mLOAD_FAST[0m(1, hidden_states) 
36: [33mLOAD_CONST[0m(4, 0) 
37: [33mBINARY_SUBSCR[0m(None, None) 
38: [33mSTORE_FAST[0m(10, next_kv) 
39: [33mJUMP_FORWARD[0m(4, 84)  -> inst 42
40: [33mLOAD_FAST[0m(1, hidden_states) 
41: [33mSTORE_FAST[0m(10, next_kv) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(4, get_rel_embedding) 
44: [33mCALL_METHOD[0m(0, 0) 
45: [33mSTORE_FAST[0m(11, rel_embeddings) 
46: [33mLOAD_GLOBAL[0m(5, enumerate) 
47: [33mLOAD_FAST[0m(0, self) 
48: [33mLOAD_ATTR[0m(6, layer) 
49: [33mCALL_FUNCTION[0m(1, 1) 
50: [33mGET_ITER[0m(None, None) 
51: [33mFOR_ITER[0m(190, 294)  -> inst 147
52: [33mUNPACK_SEQUENCE[0m(2, 2) 
53: [33mSTORE_FAST[0m(12, i) 
54: [33mSTORE_FAST[0m(13, layer_module) 
55: [33mLOAD_FAST[0m(3, output_hidden_states) 
56: [33mPOP_JUMP_IF_FALSE[0m(124, 124)  -> inst 62
57: [33mLOAD_FAST[0m(8, all_hidden_states) 
58: [33mLOAD_FAST[0m(1, hidden_states) 
59: [33mBUILD_TUPLE[0m(1, 1) 
60: [33mBINARY_ADD[0m(None, None) 
61: [33mSTORE_FAST[0m(8, all_hidden_states) 
62: [33mLOAD_FAST[0m(0, self) 
63: [33mLOAD_ATTR[0m(7, gradient_checkpointing) 
64: [33mPOP_JUMP_IF_FALSE[0m(178, 178)  -> inst 89
65: [33mLOAD_FAST[0m(0, self) 
66: [33mLOAD_ATTR[0m(8, training) 
67: [33mPOP_JUMP_IF_FALSE[0m(178, 178)  -> inst 89
68: [33mLOAD_CLOSURE[0m(0, output_attentions) 
69: [33mBUILD_TUPLE[0m(1, 1) 
70: [33mLOAD_CONST[0m(8, <code object create_custom_forward at 0x153c7df4f240, file "/home/drc/frontend/test/test_model_deberta.py", line 460>) 
71: [33mLOAD_CONST[0m(0, DebertaEncoder.forward.<locals>.create_custom_forward) 
72: [33mMAKE_FUNCTION[0m(8, 8) 
73: [33mSTORE_FAST[0m(14, create_custom_forward) 
74: [33mLOAD_GLOBAL[0m(9, torch) 
75: [33mLOAD_ATTR[0m(10, utils) 
76: [33mLOAD_ATTR[0m(11, checkpoint) 
77: [33mLOAD_METHOD[0m(11, checkpoint) 
78: [33mLOAD_FAST[0m(14, create_custom_forward) 
79: [33mLOAD_FAST[0m(13, layer_module) 
80: [33mCALL_FUNCTION[0m(1, 1) 
81: [33mLOAD_FAST[0m(10, next_kv) 
82: [33mLOAD_FAST[0m(2, attention_mask) 
83: [33mLOAD_FAST[0m(5, query_states) 
84: [33mLOAD_FAST[0m(6, relative_pos) 
85: [33mLOAD_FAST[0m(11, rel_embeddings) 
86: [33mCALL_METHOD[0m(6, 6) 
87: [33mSTORE_FAST[0m(1, hidden_states) 
88: [33mJUMP_FORWARD[0m(20, 198)  -> inst 99
89: [33mLOAD_FAST[0m(13, layer_module) 
90: [33mLOAD_FAST[0m(10, next_kv) 
91: [33mLOAD_FAST[0m(2, attention_mask) 
92: [33mLOAD_FAST[0m(5, query_states) 
93: [33mLOAD_FAST[0m(6, relative_pos) 
94: [33mLOAD_FAST[0m(11, rel_embeddings) 
95: [33mLOAD_DEREF[0m(0, output_attentions) 
96: [33mLOAD_CONST[0m(1, ('query_states', 'relative_pos', 'rel_embeddings', 'output_attentions')) 
97: [33mCALL_FUNCTION_KW[0m(6, 6) 
98: [33mSTORE_FAST[0m(1, hidden_states) 
99: [33mLOAD_DEREF[0m(0, output_attentions) 
100: [33mPOP_JUMP_IF_FALSE[0m(210, 210)  -> inst 105
101: [33mLOAD_FAST[0m(1, hidden_states) 
102: [33mUNPACK_SEQUENCE[0m(2, 2) 
103: [33mSTORE_FAST[0m(1, hidden_states) 
104: [33mSTORE_FAST[0m(15, att_m) 
105: [33mLOAD_FAST[0m(5, query_states) 
106: [33mLOAD_CONST[0m(5, None) 
107: [33mIS_OP[0m(1, 1) 
108: [32mEXTENDED_ARG[0m(1, 1) 
109: [33mPOP_JUMP_IF_FALSE[0m(274, 274)  -> inst 137
110: [33mLOAD_FAST[0m(1, hidden_states) 
111: [33mSTORE_FAST[0m(5, query_states) 
112: [33mLOAD_GLOBAL[0m(2, isinstance) 
113: [33mLOAD_FAST[0m(1, hidden_states) 
114: [33mLOAD_GLOBAL[0m(3, Sequence) 
115: [33mCALL_FUNCTION[0m(2, 2) 
116: [32mEXTENDED_ARG[0m(1, 1) 
117: [33mPOP_JUMP_IF_FALSE[0m(278, 278)  -> inst 139
118: [33mLOAD_FAST[0m(12, i) 
119: [33mLOAD_CONST[0m(2, 1) 
120: [33mBINARY_ADD[0m(None, None) 
121: [33mLOAD_GLOBAL[0m(12, len) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_ATTR[0m(6, layer) 
124: [33mCALL_FUNCTION[0m(1, 1) 
125: [33mCOMPARE_OP[0m(0, <) 
126: [32mEXTENDED_ARG[0m(1, 1) 
127: [33mPOP_JUMP_IF_FALSE[0m(268, 268)  -> inst 134
128: [33mLOAD_FAST[0m(1, hidden_states) 
129: [33mLOAD_FAST[0m(12, i) 
130: [33mLOAD_CONST[0m(2, 1) 
131: [33mBINARY_ADD[0m(None, None) 
132: [33mBINARY_SUBSCR[0m(None, None) 
133: [33mJUMP_FORWARD[0m(2, 270)  -> inst 135
134: [33mLOAD_CONST[0m(5, None) 
135: [33mSTORE_FAST[0m(10, next_kv) 
136: [33mJUMP_FORWARD[0m(4, 278)  -> inst 139
137: [33mLOAD_FAST[0m(1, hidden_states) 
138: [33mSTORE_FAST[0m(10, next_kv) 
139: [33mLOAD_DEREF[0m(0, output_attentions) 
140: [33mPOP_JUMP_IF_FALSE[0m(102, 102)  -> inst 51
141: [33mLOAD_FAST[0m(9, all_attentions) 
142: [33mLOAD_FAST[0m(15, att_m) 
143: [33mBUILD_TUPLE[0m(1, 1) 
144: [33mBINARY_ADD[0m(None, None) 
145: [33mSTORE_FAST[0m(9, all_attentions) 
146: [33mJUMP_ABSOLUTE[0m(102, 102)  -> inst 51
147: [33mLOAD_FAST[0m(3, output_hidden_states) 
148: [32mEXTENDED_ARG[0m(1, 1) 
149: [33mPOP_JUMP_IF_FALSE[0m(310, 310)  -> inst 155
150: [33mLOAD_FAST[0m(8, all_hidden_states) 
151: [33mLOAD_FAST[0m(1, hidden_states) 
152: [33mBUILD_TUPLE[0m(1, 1) 
153: [33mBINARY_ADD[0m(None, None) 
154: [33mSTORE_FAST[0m(8, all_hidden_states) 
155: [33mLOAD_FAST[0m(7, return_dict) 
156: [32mEXTENDED_ARG[0m(1, 1) 
157: [33mPOP_JUMP_IF_TRUE[0m(342, 342)  -> inst 171
158: [33mLOAD_GLOBAL[0m(13, tuple) 
159: [33mLOAD_CONST[0m(3, <code object <genexpr> at 0x153c7df4f2f0, file "/home/drc/frontend/test/test_model_deberta.py", line 501>) 
160: [33mLOAD_CONST[0m(6, DebertaEncoder.forward.<locals>.<genexpr>) 
161: [33mMAKE_FUNCTION[0m(0, 0) 
162: [33mLOAD_FAST[0m(1, hidden_states) 
163: [33mLOAD_FAST[0m(8, all_hidden_states) 
164: [33mLOAD_FAST[0m(9, all_attentions) 
165: [33mBUILD_TUPLE[0m(3, 3) 
166: [33mGET_ITER[0m(None, None) 
167: [33mCALL_FUNCTION[0m(1, 1) 
168: [33mCALL_FUNCTION[0m(1, 1) 
169: [32mEXTENDED_ARG[0m(1, 1) 
170: [32mJUMP_ABSOLUTE[0m(386, 386)  -> inst 193
171: [33mLOAD_GLOBAL[0m(14, BaseModelOutput) 
172: [33mLOAD_FAST[0m(1, hidden_states) 
173: [33mLOAD_FAST[0m(8, all_hidden_states) 
174: [33mLOAD_FAST[0m(9, all_attentions) 
175: [33mLOAD_CONST[0m(9, ('last_hidden_state', 'hidden_states', 'attentions')) 
176: [33mCALL_FUNCTION_KW[0m(3, 3) 
177: [32mEXTENDED_ARG[0m(1, 1) 
178: [32mJUMP_ABSOLUTE[0m(386, 386)  -> inst 193
179: [32mLOAD_GLOBAL[0m(18, guard_match) 
180: [32mLOAD_CONST[0m(10, 4) 
181: [32mLOAD_CONST[0m(4, 0) 
182: [32mLOAD_GLOBAL[0m(19, locals) 
183: [32mCALL_FUNCTION[0m(0, 0) 
184: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
185: [32mUNPACK_SEQUENCE[0m(2, 2) 
186: [32mSTORE_FAST[0m(17, __case_idx) 
187: [32mSTORE_FAST[0m(16, __graph_fn) 
188: [32mLOAD_GLOBAL[0m(16, enable_trace) 
189: [32mLOAD_CONST[0m(10, 4) 
190: [32mCALL_FUNCTION[0m(1, 1) 
191: [32mPOP_TOP[0m(None, None) 
192: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
193: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:433
tracing opcode LOAD_GLOBAL None pc=0 frame=4(0x7de0fc0)
push tracker due to record
push tracker 4 frame 0x7de0fc0 frame_id 4 read_stack False cf_info <class 'NoneType'> all [0, 4]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=4(0x7de0fc0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=4(0x7de0fc0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4] frame_id 4
enable_trace
push tracker 4 frame 0x7de0fc0 frame_id 4 read_stack False cf_info <class 'NoneType'> all [0, 4]
tracing opcode POP_TOP None pc=382 frame=4(0x7de0fc0)
restart: running injected code (f_lasti=382)
tracing opcode JUMP_ABSOLUTE None pc=384 frame=4(0x7de0fc0)
restart: running injected code (f_lasti=384)
tracing line /home/drc/frontend/test/test_model_deberta.py:443
tracing opcode LOAD_FAST None pc=12 frame=4(0x7de0fc0)
load fast: 23346416248480
tracing opcode LOAD_METHOD None pc=14 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=16 frame=4(0x7de0fc0)
load fast: 23346799762864
tracing opcode CALL_METHOD None pc=18 frame=4(0x7de0fc0)
run into user defined function <bound method DebertaEncoder.get_attention_mask of DebertaEncoder(
  (layer): ModuleList(
    (0-11): 12 x DebertaLayer(
      (attention): DebertaAttention(
        (self): DisentangledSelfAttention(
          (in_proj): Linear(in_features=768, out_features=2304, bias=False)
          (pos_dropout): StableDropout()
          (pos_proj): Linear(in_features=768, out_features=768, bias=False)
          (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
          (dropout): StableDropout()
        )
        (output): DebertaSelfOutput(
          (dense): Linear(in_features=768, out_features=768, bias=True)
          (LayerNorm): DebertaLayerNorm()
          (dropout): StableDropout()
        )
      )
      (intermediate): DebertaIntermediate(
        (dense): Linear(in_features=768, out_features=3072, bias=True)
        (intermediate_act_fn): GELUActivation()
      )
      (output): DebertaOutput(
        (dense): Linear(in_features=3072, out_features=768, bias=True)
        (LayerNorm): DebertaLayerNorm()
        (dropout): StableDropout()
      )
    )
  )
  (rel_embeddings): Embedding(1024, 768)
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 5 0x153bc2c32440 get_attention_mask
new bytecode: 

0: [33mLOAD_FAST[0m(1, attention_mask) 
1: [33mLOAD_METHOD[0m(0, dim) 
2: [33mCALL_METHOD[0m(0, 0) 
3: [33mLOAD_CONST[0m(1, 2) 
4: [33mCOMPARE_OP[0m(1, <=) 
5: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
6: [33mLOAD_FAST[0m(1, attention_mask) 
7: [33mLOAD_METHOD[0m(1, unsqueeze) 
8: [33mLOAD_CONST[0m(2, 1) 
9: [33mCALL_METHOD[0m(1, 1) 
10: [33mLOAD_METHOD[0m(1, unsqueeze) 
11: [33mLOAD_CONST[0m(1, 2) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mSTORE_FAST[0m(2, extended_attention_mask) 
14: [33mLOAD_FAST[0m(2, extended_attention_mask) 
15: [33mLOAD_FAST[0m(2, extended_attention_mask) 
16: [33mLOAD_METHOD[0m(2, squeeze) 
17: [33mLOAD_CONST[0m(3, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_METHOD[0m(1, unsqueeze) 
20: [33mLOAD_CONST[0m(4, -1) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mBINARY_MULTIPLY[0m(None, None) 
23: [33mSTORE_FAST[0m(1, attention_mask) 
24: [33mLOAD_FAST[0m(1, attention_mask) 
25: [33mLOAD_METHOD[0m(3, byte) 
26: [33mCALL_METHOD[0m(0, 0) 
27: [33mSTORE_FAST[0m(1, attention_mask) 
28: [33mJUMP_FORWARD[0m(22, 80)  -> inst 40
29: [33mLOAD_FAST[0m(1, attention_mask) 
30: [33mLOAD_METHOD[0m(0, dim) 
31: [33mCALL_METHOD[0m(0, 0) 
32: [33mLOAD_CONST[0m(5, 3) 
33: [33mCOMPARE_OP[0m(2, ==) 
34: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
35: [33mLOAD_FAST[0m(1, attention_mask) 
36: [33mLOAD_METHOD[0m(1, unsqueeze) 
37: [33mLOAD_CONST[0m(2, 1) 
38: [33mCALL_METHOD[0m(1, 1) 
39: [33mSTORE_FAST[0m(1, attention_mask) 
40: [33mLOAD_FAST[0m(1, attention_mask) 
41: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -1), (<class 'int'>, -2), (<class 'int'>, 3), (<class 'NoneType'>, None), (<class 'int'>, 2), (<class 'int'>, 5), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 5) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(94, 94)  -> inst 47
5: [33mLOAD_FAST[0m(1, attention_mask) 
6: [33mLOAD_METHOD[0m(0, dim) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(5, 2) 
9: [33mCOMPARE_OP[0m(1, <=) 
10: [33mPOP_JUMP_IF_FALSE[0m(68, 68)  -> inst 34
11: [33mLOAD_FAST[0m(1, attention_mask) 
12: [33mLOAD_METHOD[0m(1, unsqueeze) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_METHOD[0m(1, unsqueeze) 
16: [33mLOAD_CONST[0m(5, 2) 
17: [33mCALL_METHOD[0m(1, 1) 
18: [33mSTORE_FAST[0m(2, extended_attention_mask) 
19: [33mLOAD_FAST[0m(2, extended_attention_mask) 
20: [33mLOAD_FAST[0m(2, extended_attention_mask) 
21: [33mLOAD_METHOD[0m(2, squeeze) 
22: [33mLOAD_CONST[0m(2, -2) 
23: [33mCALL_METHOD[0m(1, 1) 
24: [33mLOAD_METHOD[0m(1, unsqueeze) 
25: [33mLOAD_CONST[0m(1, -1) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mBINARY_MULTIPLY[0m(None, None) 
28: [33mSTORE_FAST[0m(1, attention_mask) 
29: [33mLOAD_FAST[0m(1, attention_mask) 
30: [33mLOAD_METHOD[0m(3, byte) 
31: [33mCALL_METHOD[0m(0, 0) 
32: [33mSTORE_FAST[0m(1, attention_mask) 
33: [33mJUMP_FORWARD[0m(22, 90)  -> inst 45
34: [33mLOAD_FAST[0m(1, attention_mask) 
35: [33mLOAD_METHOD[0m(0, dim) 
36: [33mCALL_METHOD[0m(0, 0) 
37: [33mLOAD_CONST[0m(3, 3) 
38: [33mCOMPARE_OP[0m(2, ==) 
39: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
40: [33mLOAD_FAST[0m(1, attention_mask) 
41: [33mLOAD_METHOD[0m(1, unsqueeze) 
42: [33mLOAD_CONST[0m(0, 1) 
43: [33mCALL_METHOD[0m(1, 1) 
44: [33mSTORE_FAST[0m(1, attention_mask) 
45: [33mLOAD_FAST[0m(1, attention_mask) 
46: [32mJUMP_ABSOLUTE[0m(122, 122)  -> inst 61
47: [32mLOAD_GLOBAL[0m(7, guard_match) 
48: [32mLOAD_CONST[0m(6, 5) 
49: [32mLOAD_CONST[0m(7, 0) 
50: [32mLOAD_GLOBAL[0m(8, locals) 
51: [32mCALL_FUNCTION[0m(0, 0) 
52: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
53: [32mUNPACK_SEQUENCE[0m(2, 2) 
54: [32mSTORE_FAST[0m(4, __case_idx) 
55: [32mSTORE_FAST[0m(3, __graph_fn) 
56: [32mLOAD_GLOBAL[0m(5, enable_trace) 
57: [32mLOAD_CONST[0m(6, 5) 
58: [32mCALL_FUNCTION[0m(1, 1) 
59: [32mPOP_TOP[0m(None, None) 
60: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
61: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:417
tracing opcode LOAD_GLOBAL None pc=0 frame=5(0x84e1be0)
push tracker due to record
push tracker 5 frame 0x84e1be0 frame_id 5 read_stack False cf_info <class 'NoneType'> all [0, 4, 5]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=5(0x84e1be0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=5(0x84e1be0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 5] frame_id 5
enable_trace
push tracker 5 frame 0x84e1be0 frame_id 5 read_stack False cf_info <class 'NoneType'> all [0, 4, 5]
tracing opcode POP_TOP None pc=118 frame=5(0x84e1be0)
restart: running injected code (f_lasti=118)
tracing opcode JUMP_ABSOLUTE None pc=120 frame=5(0x84e1be0)
restart: running injected code (f_lasti=120)
tracing line /home/drc/frontend/test/test_model_deberta.py:418
tracing opcode LOAD_FAST None pc=10 frame=5(0x84e1be0)
load fast: 23346799762864
tracing opcode LOAD_METHOD None pc=12 frame=5(0x84e1be0)
tracing opcode CALL_METHOD None pc=14 frame=5(0x84e1be0)
tracing opcode LOAD_CONST None pc=16 frame=5(0x84e1be0)
tracing opcode COMPARE_OP None pc=18 frame=5(0x84e1be0)
tracing opcode POP_JUMP_IF_FALSE None pc=20 frame=5(0x84e1be0)
tracing line /home/drc/frontend/test/test_model_deberta.py:419
tracing opcode LOAD_FAST None pc=22 frame=5(0x84e1be0)
tracing opcode LOAD_METHOD None pc=24 frame=5(0x84e1be0)
tracing opcode LOAD_CONST None pc=26 frame=5(0x84e1be0)
tracing opcode CALL_METHOD None pc=28 frame=5(0x84e1be0)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=30 frame=5(0x84e1be0)
tracing opcode LOAD_CONST None pc=32 frame=5(0x84e1be0)
tracing opcode CALL_METHOD None pc=34 frame=5(0x84e1be0)
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=36 frame=5(0x84e1be0)
tracing line /home/drc/frontend/test/test_model_deberta.py:420
tracing opcode LOAD_FAST None pc=38 frame=5(0x84e1be0)
tracing opcode LOAD_FAST None pc=40 frame=5(0x84e1be0)
tracing opcode LOAD_METHOD None pc=42 frame=5(0x84e1be0)
tracing opcode LOAD_CONST None pc=44 frame=5(0x84e1be0)
tracing opcode CALL_METHOD None pc=46 frame=5(0x84e1be0)
fetch:  -2 <class 'int'>
record function in graph <method 'squeeze' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=48 frame=5(0x84e1be0)
tracing opcode LOAD_CONST None pc=50 frame=5(0x84e1be0)
tracing opcode CALL_METHOD None pc=52 frame=5(0x84e1be0)
fetch:  -1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode BINARY_MULTIPLY None pc=54 frame=5(0x84e1be0)
record function in graph <built-in function mul>
tracing opcode STORE_FAST None pc=56 frame=5(0x84e1be0)
tracing line /home/drc/frontend/test/test_model_deberta.py:421
tracing opcode LOAD_FAST None pc=58 frame=5(0x84e1be0)
tracing opcode LOAD_METHOD None pc=60 frame=5(0x84e1be0)
tracing opcode CALL_METHOD None pc=62 frame=5(0x84e1be0)
record function in graph <method 'byte' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=64 frame=5(0x84e1be0)
tracing opcode JUMP_FORWARD None pc=66 frame=5(0x84e1be0)
tracing line /home/drc/frontend/test/test_model_deberta.py:425
tracing opcode LOAD_FAST None pc=90 frame=5(0x84e1be0)
tracing opcode JUMP_ABSOLUTE None pc=92 frame=5(0x84e1be0)
restart: running injected code (f_lasti=92)
commiting 5 0 41 [32mRETURN_VALUE[0m(None, None)  92
callee is full graph, merge to caller
to merge graph graph():
    %tensor_12 : [#users=1] = placeholder[target=tensor_12]
    %unsqueeze : [#users=1] = call_method[target=unsqueeze](args = (%tensor_12, 1), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%unsqueeze, 2), kwargs = {})
    %squeeze : [#users=1] = call_method[target=squeeze](args = (%unsqueeze_1, -2), kwargs = {})
    %unsqueeze_2 : [#users=1] = call_method[target=unsqueeze](args = (%squeeze, -1), kwargs = {})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%unsqueeze_1, %unsqueeze_2), kwargs = {})
    %byte : [#users=0] = call_method[target=byte](args = (%mul,), kwargs = {})
to merge frameid 5 4
tracing opcode RETURN_VALUE None pc=122 frame=5(0x84e1be0)
restart: running injected code (f_lasti=122)
before pop_tracker [0, 4, 5] frame_id 5
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=20 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:444
tracing opcode LOAD_FAST None pc=22 frame=4(0x7de0fc0)
tracing opcode LOAD_METHOD None pc=24 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=26 frame=4(0x7de0fc0)
load fast: 23346380865104
tracing opcode LOAD_FAST None pc=28 frame=4(0x7de0fc0)
load fast: 23349571986432
tracing opcode LOAD_FAST None pc=30 frame=4(0x7de0fc0)
tracing opcode CALL_METHOD None pc=32 frame=4(0x7de0fc0)
run into user defined function <bound method DebertaEncoder.get_rel_pos of DebertaEncoder(
  (layer): ModuleList(
    (0-11): 12 x DebertaLayer(
      (attention): DebertaAttention(
        (self): DisentangledSelfAttention(
          (in_proj): Linear(in_features=768, out_features=2304, bias=False)
          (pos_dropout): StableDropout()
          (pos_proj): Linear(in_features=768, out_features=768, bias=False)
          (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
          (dropout): StableDropout()
        )
        (output): DebertaSelfOutput(
          (dense): Linear(in_features=768, out_features=768, bias=True)
          (LayerNorm): DebertaLayerNorm()
          (dropout): StableDropout()
        )
      )
      (intermediate): DebertaIntermediate(
        (dense): Linear(in_features=768, out_features=3072, bias=True)
        (intermediate_act_fn): GELUActivation()
      )
      (output): DebertaOutput(
        (dense): Linear(in_features=3072, out_features=768, bias=True)
        (LayerNorm): DebertaLayerNorm()
        (dropout): StableDropout()
      )
    )
  )
  (rel_embeddings): Embedding(1024, 768)
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 6 0x84dec40 get_rel_pos
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_ATTR[0m(0, relative_attention) 
2: [33mPOP_JUMP_IF_FALSE[0m(62, 62)  -> inst 31
3: [33mLOAD_FAST[0m(3, relative_pos) 
4: [33mLOAD_CONST[0m(0, None) 
5: [33mIS_OP[0m(0, 0) 
6: [33mPOP_JUMP_IF_FALSE[0m(62, 62)  -> inst 31
7: [33mLOAD_FAST[0m(2, query_states) 
8: [33mLOAD_CONST[0m(0, None) 
9: [33mIS_OP[0m(1, 1) 
10: [33mPOP_JUMP_IF_FALSE[0m(32, 32)  -> inst 16
11: [33mLOAD_FAST[0m(2, query_states) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(1, -2) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mJUMP_FORWARD[0m(8, 40)  -> inst 20
16: [33mLOAD_FAST[0m(1, hidden_states) 
17: [33mLOAD_METHOD[0m(1, size) 
18: [33mLOAD_CONST[0m(1, -2) 
19: [33mCALL_METHOD[0m(1, 1) 
20: [33mSTORE_FAST[0m(4, q) 
21: [33mLOAD_GLOBAL[0m(2, build_relative_position) 
22: [33mLOAD_FAST[0m(4, q) 
23: [33mLOAD_FAST[0m(1, hidden_states) 
24: [33mLOAD_METHOD[0m(1, size) 
25: [33mLOAD_CONST[0m(1, -2) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mLOAD_FAST[0m(1, hidden_states) 
28: [33mLOAD_ATTR[0m(3, device) 
29: [33mCALL_FUNCTION[0m(3, 3) 
30: [33mSTORE_FAST[0m(3, relative_pos) 
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, -2), (<class 'NoneType'>, None), (<class 'int'>, 6), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(2, 6) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, relative_attention) 
7: [33mPOP_JUMP_IF_FALSE[0m(72, 72)  -> inst 36
8: [33mLOAD_FAST[0m(3, relative_pos) 
9: [33mLOAD_CONST[0m(1, None) 
10: [33mIS_OP[0m(0, 0) 
11: [33mPOP_JUMP_IF_FALSE[0m(72, 72)  -> inst 36
12: [33mLOAD_FAST[0m(2, query_states) 
13: [33mLOAD_CONST[0m(1, None) 
14: [33mIS_OP[0m(1, 1) 
15: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
16: [33mLOAD_FAST[0m(2, query_states) 
17: [33mLOAD_METHOD[0m(1, size) 
18: [33mLOAD_CONST[0m(0, -2) 
19: [33mCALL_METHOD[0m(1, 1) 
20: [33mJUMP_FORWARD[0m(8, 50)  -> inst 25
21: [33mLOAD_FAST[0m(1, hidden_states) 
22: [33mLOAD_METHOD[0m(1, size) 
23: [33mLOAD_CONST[0m(0, -2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mSTORE_FAST[0m(4, q) 
26: [33mLOAD_GLOBAL[0m(2, build_relative_position) 
27: [33mLOAD_FAST[0m(4, q) 
28: [33mLOAD_FAST[0m(1, hidden_states) 
29: [33mLOAD_METHOD[0m(1, size) 
30: [33mLOAD_CONST[0m(0, -2) 
31: [33mCALL_METHOD[0m(1, 1) 
32: [33mLOAD_FAST[0m(1, hidden_states) 
33: [33mLOAD_ATTR[0m(3, device) 
34: [33mCALL_FUNCTION[0m(3, 3) 
35: [33mSTORE_FAST[0m(3, relative_pos) 
36: [33mLOAD_FAST[0m(3, relative_pos) 
37: [32mJUMP_ABSOLUTE[0m(104, 104)  -> inst 52
38: [32mLOAD_GLOBAL[0m(7, guard_match) 
39: [32mLOAD_CONST[0m(2, 6) 
40: [32mLOAD_CONST[0m(3, 0) 
41: [32mLOAD_GLOBAL[0m(8, locals) 
42: [32mCALL_FUNCTION[0m(0, 0) 
43: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
44: [32mUNPACK_SEQUENCE[0m(2, 2) 
45: [32mSTORE_FAST[0m(6, __case_idx) 
46: [32mSTORE_FAST[0m(5, __graph_fn) 
47: [32mLOAD_GLOBAL[0m(5, enable_trace) 
48: [32mLOAD_CONST[0m(2, 6) 
49: [32mCALL_FUNCTION[0m(1, 1) 
50: [32mPOP_TOP[0m(None, None) 
51: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
52: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:427
tracing opcode LOAD_GLOBAL None pc=0 frame=6(0x84dfbc0)
push tracker due to record
push tracker 6 frame 0x84dfbc0 frame_id 6 read_stack False cf_info <class 'NoneType'> all [0, 4, 6]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=6(0x84dfbc0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=6(0x84dfbc0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 6] frame_id 6
enable_trace
push tracker 6 frame 0x84dfbc0 frame_id 6 read_stack False cf_info <class 'NoneType'> all [0, 4, 6]
tracing opcode POP_TOP None pc=100 frame=6(0x84dfbc0)
restart: running injected code (f_lasti=100)
tracing opcode JUMP_ABSOLUTE None pc=102 frame=6(0x84dfbc0)
restart: running injected code (f_lasti=102)
tracing line /home/drc/frontend/test/test_model_deberta.py:428
tracing opcode LOAD_FAST None pc=10 frame=6(0x84dfbc0)
load fast: 23346416248480
tracing opcode LOAD_ATTR None pc=12 frame=6(0x84dfbc0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=6(0x84dfbc0)
tracing opcode LOAD_FAST None pc=16 frame=6(0x84dfbc0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=18 frame=6(0x84dfbc0)
tracing opcode IS_OP None pc=20 frame=6(0x84dfbc0)
tracing opcode POP_JUMP_IF_FALSE None pc=22 frame=6(0x84dfbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:429
tracing opcode LOAD_FAST None pc=24 frame=6(0x84dfbc0)
tracing opcode LOAD_CONST None pc=26 frame=6(0x84dfbc0)
tracing opcode IS_OP None pc=28 frame=6(0x84dfbc0)
tracing opcode POP_JUMP_IF_FALSE None pc=30 frame=6(0x84dfbc0)
tracing opcode LOAD_FAST None pc=42 frame=6(0x84dfbc0)
load fast: 23346380865104
tracing opcode LOAD_METHOD None pc=44 frame=6(0x84dfbc0)
tracing opcode LOAD_CONST None pc=46 frame=6(0x84dfbc0)
tracing opcode CALL_METHOD None pc=48 frame=6(0x84dfbc0)
fetch:  -2 <class 'int'>
tracing opcode STORE_FAST None pc=50 frame=6(0x84dfbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:430
tracing opcode LOAD_GLOBAL None pc=52 frame=6(0x84dfbc0)
tracing opcode LOAD_FAST None pc=54 frame=6(0x84dfbc0)
tracing opcode LOAD_FAST None pc=56 frame=6(0x84dfbc0)
tracing opcode LOAD_METHOD None pc=58 frame=6(0x84dfbc0)
tracing opcode LOAD_CONST None pc=60 frame=6(0x84dfbc0)
tracing opcode CALL_METHOD None pc=62 frame=6(0x84dfbc0)
tracing opcode LOAD_FAST None pc=64 frame=6(0x84dfbc0)
tracing opcode LOAD_ATTR None pc=66 frame=6(0x84dfbc0)
tracing opcode CALL_FUNCTION None pc=68 frame=6(0x84dfbc0)
run into user defined function <function build_relative_position at 0x153bd10d7040>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 7 0x840d0f0 build_relative_position
new bytecode: 

0: [33mLOAD_GLOBAL[0m(0, torch) 
1: [33mLOAD_ATTR[0m(1, arange) 
2: [33mLOAD_FAST[0m(0, query_size) 
3: [33mLOAD_GLOBAL[0m(0, torch) 
4: [33mLOAD_ATTR[0m(2, long) 
5: [33mLOAD_FAST[0m(2, device) 
6: [33mLOAD_CONST[0m(1, ('dtype', 'device')) 
7: [33mCALL_FUNCTION_KW[0m(3, 3) 
8: [33mSTORE_FAST[0m(3, q_ids) 
9: [33mLOAD_GLOBAL[0m(0, torch) 
10: [33mLOAD_ATTR[0m(1, arange) 
11: [33mLOAD_FAST[0m(1, key_size) 
12: [33mLOAD_GLOBAL[0m(0, torch) 
13: [33mLOAD_ATTR[0m(2, long) 
14: [33mLOAD_FAST[0m(2, device) 
15: [33mLOAD_CONST[0m(1, ('dtype', 'device')) 
16: [33mCALL_FUNCTION_KW[0m(3, 3) 
17: [33mSTORE_FAST[0m(4, k_ids) 
18: [33mLOAD_FAST[0m(3, q_ids) 
19: [33mLOAD_CONST[0m(2, None) 
20: [33mLOAD_CONST[0m(2, None) 
21: [33mBUILD_SLICE[0m(2, 2) 
22: [33mLOAD_CONST[0m(2, None) 
23: [33mBUILD_TUPLE[0m(2, 2) 
24: [33mBINARY_SUBSCR[0m(None, None) 
25: [33mLOAD_FAST[0m(4, k_ids) 
26: [33mLOAD_METHOD[0m(3, view) 
27: [33mLOAD_CONST[0m(3, 1) 
28: [33mLOAD_CONST[0m(4, -1) 
29: [33mCALL_METHOD[0m(2, 2) 
30: [33mLOAD_METHOD[0m(4, repeat) 
31: [33mLOAD_FAST[0m(0, query_size) 
32: [33mLOAD_CONST[0m(3, 1) 
33: [33mCALL_METHOD[0m(2, 2) 
34: [33mBINARY_SUBTRACT[0m(None, None) 
35: [33mSTORE_FAST[0m(5, rel_pos_ids) 
36: [33mLOAD_FAST[0m(5, rel_pos_ids) 
37: [33mLOAD_CONST[0m(2, None) 
38: [33mLOAD_FAST[0m(0, query_size) 
39: [33mBUILD_SLICE[0m(2, 2) 
40: [33mLOAD_CONST[0m(2, None) 
41: [33mLOAD_CONST[0m(2, None) 
42: [33mBUILD_SLICE[0m(2, 2) 
43: [33mBUILD_TUPLE[0m(2, 2) 
44: [33mBINARY_SUBSCR[0m(None, None) 
45: [33mSTORE_FAST[0m(5, rel_pos_ids) 
46: [33mLOAD_FAST[0m(5, rel_pos_ids) 
47: [33mLOAD_METHOD[0m(5, unsqueeze) 
48: [33mLOAD_CONST[0m(5, 0) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(5, rel_pos_ids) 
51: [33mLOAD_FAST[0m(5, rel_pos_ids) 
52: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -1), (<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'tuple'>, ('dtype', 'device')), (<class 'str'>, '\n    Build relative position according to the query and key\n\n    We assume the absolute position of query \\(P_q\\) is range from (0, query_size) and the absolute position of key\n    \\(P_k\\) is range from (0, key_size), The relative positions from query to key is \\(R_{q \\rightarrow k} = P_q -\n    P_k\\)\n\n    Args:\n        query_size (int): the length of query\n        key_size (int): the length of key\n\n    Return:\n        `torch.LongTensor`: A tensor with shape [1, query_size, key_size]\n\n    '), (<class 'int'>, 7)]
guarded code
0: [32mLOAD_GLOBAL[0m(6, disable_trace) 
1: [32mLOAD_CONST[0m(6, 7) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_GLOBAL[0m(0, torch) 
6: [33mLOAD_ATTR[0m(1, arange) 
7: [33mLOAD_FAST[0m(0, query_size) 
8: [33mLOAD_GLOBAL[0m(0, torch) 
9: [33mLOAD_ATTR[0m(2, long) 
10: [33mLOAD_FAST[0m(2, device) 
11: [33mLOAD_CONST[0m(4, ('dtype', 'device')) 
12: [33mCALL_FUNCTION_KW[0m(3, 3) 
13: [33mSTORE_FAST[0m(3, q_ids) 
14: [33mLOAD_GLOBAL[0m(0, torch) 
15: [33mLOAD_ATTR[0m(1, arange) 
16: [33mLOAD_FAST[0m(1, key_size) 
17: [33mLOAD_GLOBAL[0m(0, torch) 
18: [33mLOAD_ATTR[0m(2, long) 
19: [33mLOAD_FAST[0m(2, device) 
20: [33mLOAD_CONST[0m(4, ('dtype', 'device')) 
21: [33mCALL_FUNCTION_KW[0m(3, 3) 
22: [33mSTORE_FAST[0m(4, k_ids) 
23: [33mLOAD_FAST[0m(3, q_ids) 
24: [33mLOAD_CONST[0m(3, None) 
25: [33mLOAD_CONST[0m(3, None) 
26: [33mBUILD_SLICE[0m(2, 2) 
27: [33mLOAD_CONST[0m(3, None) 
28: [33mBUILD_TUPLE[0m(2, 2) 
29: [33mBINARY_SUBSCR[0m(None, None) 
30: [33mLOAD_FAST[0m(4, k_ids) 
31: [33mLOAD_METHOD[0m(3, view) 
32: [33mLOAD_CONST[0m(0, 1) 
33: [33mLOAD_CONST[0m(1, -1) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mLOAD_METHOD[0m(4, repeat) 
36: [33mLOAD_FAST[0m(0, query_size) 
37: [33mLOAD_CONST[0m(0, 1) 
38: [33mCALL_METHOD[0m(2, 2) 
39: [33mBINARY_SUBTRACT[0m(None, None) 
40: [33mSTORE_FAST[0m(5, rel_pos_ids) 
41: [33mLOAD_FAST[0m(5, rel_pos_ids) 
42: [33mLOAD_CONST[0m(3, None) 
43: [33mLOAD_FAST[0m(0, query_size) 
44: [33mBUILD_SLICE[0m(2, 2) 
45: [33mLOAD_CONST[0m(3, None) 
46: [33mLOAD_CONST[0m(3, None) 
47: [33mBUILD_SLICE[0m(2, 2) 
48: [33mBUILD_TUPLE[0m(2, 2) 
49: [33mBINARY_SUBSCR[0m(None, None) 
50: [33mSTORE_FAST[0m(5, rel_pos_ids) 
51: [33mLOAD_FAST[0m(5, rel_pos_ids) 
52: [33mLOAD_METHOD[0m(5, unsqueeze) 
53: [33mLOAD_CONST[0m(2, 0) 
54: [33mCALL_METHOD[0m(1, 1) 
55: [33mSTORE_FAST[0m(5, rel_pos_ids) 
56: [33mLOAD_FAST[0m(5, rel_pos_ids) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(9, guard_match) 
59: [32mLOAD_CONST[0m(6, 7) 
60: [32mLOAD_CONST[0m(2, 0) 
61: [32mLOAD_GLOBAL[0m(10, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(7, enable_trace) 
68: [32mLOAD_CONST[0m(6, 7) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:507
tracing opcode LOAD_GLOBAL None pc=0 frame=7(0x84e0bd0)
push tracker due to record
push tracker 7 frame 0x84e0bd0 frame_id 7 read_stack False cf_info <class 'NoneType'> all [0, 4, 6, 7]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=7(0x84e0bd0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=7(0x84e0bd0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 6, 7] frame_id 7
enable_trace
push tracker 7 frame 0x84e0bd0 frame_id 7 read_stack False cf_info <class 'NoneType'> all [0, 4, 6, 7]
tracing opcode POP_TOP None pc=140 frame=7(0x84e0bd0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=7(0x84e0bd0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:524
tracing opcode LOAD_GLOBAL None pc=10 frame=7(0x84e0bd0)
tracing opcode LOAD_ATTR None pc=12 frame=7(0x84e0bd0)
tracing opcode LOAD_FAST None pc=14 frame=7(0x84e0bd0)
load fast: 23349563894160
tracing opcode LOAD_GLOBAL None pc=16 frame=7(0x84e0bd0)
tracing opcode LOAD_ATTR None pc=18 frame=7(0x84e0bd0)
tracing opcode LOAD_FAST None pc=20 frame=7(0x84e0bd0)
load fast: 23346380602320
tracing opcode LOAD_CONST None pc=22 frame=7(0x84e0bd0)
tracing opcode CALL_FUNCTION_KW None pc=24 frame=7(0x84e0bd0)
record function in graph <built-in method arange of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=26 frame=7(0x84e0bd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:525
tracing opcode LOAD_GLOBAL None pc=28 frame=7(0x84e0bd0)
tracing opcode LOAD_ATTR None pc=30 frame=7(0x84e0bd0)
tracing opcode LOAD_FAST None pc=32 frame=7(0x84e0bd0)
tracing opcode LOAD_GLOBAL None pc=34 frame=7(0x84e0bd0)
tracing opcode LOAD_ATTR None pc=36 frame=7(0x84e0bd0)
tracing opcode LOAD_FAST None pc=38 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=40 frame=7(0x84e0bd0)
tracing opcode CALL_FUNCTION_KW None pc=42 frame=7(0x84e0bd0)
record function in graph <built-in method arange of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=44 frame=7(0x84e0bd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:526
tracing opcode LOAD_FAST None pc=46 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=48 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=50 frame=7(0x84e0bd0)
tracing opcode BUILD_SLICE None pc=52 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=54 frame=7(0x84e0bd0)
tracing opcode BUILD_TUPLE None pc=56 frame=7(0x84e0bd0)
tracing opcode BINARY_SUBSCR None pc=58 frame=7(0x84e0bd0)
record function in graph <built-in function getitem>
tracing opcode LOAD_FAST None pc=60 frame=7(0x84e0bd0)
tracing opcode LOAD_METHOD None pc=62 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=64 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=66 frame=7(0x84e0bd0)
tracing opcode CALL_METHOD None pc=68 frame=7(0x84e0bd0)
fetch:  1 <class 'int'>
fetch:  -1 <class 'int'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=70 frame=7(0x84e0bd0)
tracing opcode LOAD_FAST None pc=72 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=74 frame=7(0x84e0bd0)
tracing opcode CALL_METHOD None pc=76 frame=7(0x84e0bd0)
record function in graph <method 'repeat' of 'torch._C._TensorBase' objects>
tracing opcode BINARY_SUBTRACT None pc=78 frame=7(0x84e0bd0)
record function in graph <built-in function sub>
tracing opcode STORE_FAST None pc=80 frame=7(0x84e0bd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:527
tracing opcode LOAD_FAST None pc=82 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=84 frame=7(0x84e0bd0)
tracing opcode LOAD_FAST None pc=86 frame=7(0x84e0bd0)
tracing opcode BUILD_SLICE None pc=88 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=90 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=92 frame=7(0x84e0bd0)
tracing opcode BUILD_SLICE None pc=94 frame=7(0x84e0bd0)
tracing opcode BUILD_TUPLE None pc=96 frame=7(0x84e0bd0)
tracing opcode BINARY_SUBSCR None pc=98 frame=7(0x84e0bd0)
record function in graph <built-in function getitem>
tracing opcode STORE_FAST None pc=100 frame=7(0x84e0bd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:528
tracing opcode LOAD_FAST None pc=102 frame=7(0x84e0bd0)
tracing opcode LOAD_METHOD None pc=104 frame=7(0x84e0bd0)
tracing opcode LOAD_CONST None pc=106 frame=7(0x84e0bd0)
tracing opcode CALL_METHOD None pc=108 frame=7(0x84e0bd0)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=110 frame=7(0x84e0bd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:529
tracing opcode LOAD_FAST None pc=112 frame=7(0x84e0bd0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=7(0x84e0bd0)
restart: running injected code (f_lasti=114)
commiting 7 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %arange : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %arange_1 : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%arange, [slice(None, None, None), None]), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%arange_1, 1, -1), kwargs = {})
    %repeat : [#users=1] = call_method[target=repeat](args = (%view, 256, 1), kwargs = {})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%getitem, %repeat), kwargs = {})
    %getitem_1 : [#users=1] = call_function[target=operator.getitem](args = (%sub, [slice(None, 256, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze : [#users=0] = call_method[target=unsqueeze](args = (%getitem_1, 0), kwargs = {})
to merge frameid 7 6
tracing opcode RETURN_VALUE None pc=144 frame=7(0x84e0bd0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 6, 7] frame_id 7
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=70 frame=6(0x84dfbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:431
tracing opcode LOAD_FAST None pc=72 frame=6(0x84dfbc0)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=6(0x84dfbc0)
restart: running injected code (f_lasti=74)
commiting 6 0 32 [32mRETURN_VALUE[0m(None, None)  74
callee is full graph, merge to caller
to merge graph graph():
    %tensor_14 : [#users=0] = placeholder[target=tensor_14]
    %arange : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %arange_1 : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%arange, [slice(None, None, None), None]), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%arange_1, 1, -1), kwargs = {})
    %repeat : [#users=1] = call_method[target=repeat](args = (%view, 256, 1), kwargs = {})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%getitem, %repeat), kwargs = {})
    %getitem_1 : [#users=1] = call_function[target=operator.getitem](args = (%sub, [slice(None, 256, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze : [#users=0] = call_method[target=unsqueeze](args = (%getitem_1, 0), kwargs = {})
to merge frameid 6 4
tracing opcode RETURN_VALUE None pc=104 frame=6(0x84dfbc0)
restart: running injected code (f_lasti=104)
before pop_tracker [0, 4, 6] frame_id 6
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=34 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:446
tracing opcode LOAD_FAST None pc=36 frame=4(0x7de0fc0)
load fast: 23349571903904
tracing opcode POP_JUMP_IF_FALSE None pc=38 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=40 frame=4(0x7de0fc0)
tracing opcode JUMP_FORWARD None pc=42 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=46 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:447
tracing opcode LOAD_DEREF None pc=48 frame=4(0x7de0fc0)
load fast: 23349571903936
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=56 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=58 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:449
tracing opcode LOAD_GLOBAL None pc=60 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=62 frame=4(0x7de0fc0)
tracing opcode LOAD_GLOBAL None pc=64 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION None pc=66 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:452
tracing opcode LOAD_FAST None pc=80 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=82 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:453
tracing opcode LOAD_FAST None pc=84 frame=4(0x7de0fc0)
tracing opcode LOAD_METHOD None pc=86 frame=4(0x7de0fc0)
tracing opcode CALL_METHOD None pc=88 frame=4(0x7de0fc0)
run into user defined function <bound method DebertaEncoder.get_rel_embedding of DebertaEncoder(
  (layer): ModuleList(
    (0-11): 12 x DebertaLayer(
      (attention): DebertaAttention(
        (self): DisentangledSelfAttention(
          (in_proj): Linear(in_features=768, out_features=2304, bias=False)
          (pos_dropout): StableDropout()
          (pos_proj): Linear(in_features=768, out_features=768, bias=False)
          (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
          (dropout): StableDropout()
        )
        (output): DebertaSelfOutput(
          (dense): Linear(in_features=768, out_features=768, bias=True)
          (LayerNorm): DebertaLayerNorm()
          (dropout): StableDropout()
        )
      )
      (intermediate): DebertaIntermediate(
        (dense): Linear(in_features=768, out_features=3072, bias=True)
        (intermediate_act_fn): GELUActivation()
      )
      (output): DebertaOutput(
        (dense): Linear(in_features=3072, out_features=768, bias=True)
        (LayerNorm): DebertaLayerNorm()
        (dropout): StableDropout()
      )
    )
  )
  (rel_embeddings): Embedding(1024, 768)
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 8 0x84e45a0 get_rel_embedding
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_ATTR[0m(0, relative_attention) 
2: [33mPOP_JUMP_IF_FALSE[0m(14, 14)  -> inst 7
3: [33mLOAD_FAST[0m(0, self) 
4: [33mLOAD_ATTR[0m(1, rel_embeddings) 
5: [33mLOAD_ATTR[0m(2, weight) 
6: [33mJUMP_FORWARD[0m(2, 16)  -> inst 8
7: [33mLOAD_CONST[0m(0, None) 
8: [33mSTORE_FAST[0m(1, rel_embeddings) 
9: [33mLOAD_FAST[0m(1, rel_embeddings) 
10: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'NoneType'>, None), (<class 'int'>, 8), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 8) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(32, 32)  -> inst 16
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, relative_attention) 
7: [33mPOP_JUMP_IF_FALSE[0m(24, 24)  -> inst 12
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, rel_embeddings) 
10: [33mLOAD_ATTR[0m(2, weight) 
11: [33mJUMP_FORWARD[0m(2, 26)  -> inst 13
12: [33mLOAD_CONST[0m(0, None) 
13: [33mSTORE_FAST[0m(1, rel_embeddings) 
14: [33mLOAD_FAST[0m(1, rel_embeddings) 
15: [32mJUMP_ABSOLUTE[0m(60, 60)  -> inst 30
16: [32mLOAD_GLOBAL[0m(6, guard_match) 
17: [32mLOAD_CONST[0m(1, 8) 
18: [32mLOAD_CONST[0m(2, 0) 
19: [32mLOAD_GLOBAL[0m(7, locals) 
20: [32mCALL_FUNCTION[0m(0, 0) 
21: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
22: [32mUNPACK_SEQUENCE[0m(2, 2) 
23: [32mSTORE_FAST[0m(3, __case_idx) 
24: [32mSTORE_FAST[0m(2, __graph_fn) 
25: [32mLOAD_GLOBAL[0m(4, enable_trace) 
26: [32mLOAD_CONST[0m(1, 8) 
27: [32mCALL_FUNCTION[0m(1, 1) 
28: [32mPOP_TOP[0m(None, None) 
29: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
30: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:413
tracing opcode LOAD_GLOBAL None pc=0 frame=8(0x84de320)
push tracker due to record
push tracker 8 frame 0x84de320 frame_id 8 read_stack False cf_info <class 'NoneType'> all [0, 4, 8]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=8(0x84de320)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=8(0x84de320)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 8] frame_id 8
enable_trace
push tracker 8 frame 0x84de320 frame_id 8 read_stack False cf_info <class 'NoneType'> all [0, 4, 8]
tracing opcode POP_TOP None pc=56 frame=8(0x84de320)
restart: running injected code (f_lasti=56)
tracing opcode JUMP_ABSOLUTE None pc=58 frame=8(0x84de320)
restart: running injected code (f_lasti=58)
tracing line /home/drc/frontend/test/test_model_deberta.py:414
tracing opcode LOAD_FAST None pc=10 frame=8(0x84de320)
load fast: 23346416248480
tracing opcode LOAD_ATTR None pc=12 frame=8(0x84de320)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=8(0x84de320)
tracing opcode LOAD_FAST None pc=16 frame=8(0x84de320)
tracing opcode LOAD_ATTR None pc=18 frame=8(0x84de320)
tracing opcode LOAD_ATTR None pc=20 frame=8(0x84de320)
tracing opcode JUMP_FORWARD None pc=22 frame=8(0x84de320)
tracing opcode STORE_FAST None pc=26 frame=8(0x84de320)
tracing line /home/drc/frontend/test/test_model_deberta.py:415
tracing opcode LOAD_FAST None pc=28 frame=8(0x84de320)
tracing opcode JUMP_ABSOLUTE None pc=30 frame=8(0x84de320)
restart: running injected code (f_lasti=30)
commiting 8 0 10 [32mRETURN_VALUE[0m(None, None)  30
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 8 4
tracing opcode RETURN_VALUE None pc=60 frame=8(0x84de320)
restart: running injected code (f_lasti=60)
before pop_tracker [0, 4, 8] frame_id 8
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=90 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode LOAD_GLOBAL None pc=92 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=94 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=96 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION None pc=98 frame=4(0x7de0fc0)
tracing opcode GET_ITER None pc=100 frame=4(0x7de0fc0)
generate any for <enumerate object at 0x153bc0b05e00> <class 'enumerate'> [enumerate(locals['self'].layer)]
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_ATTR[0m(0, attention) 
2: [33mLOAD_FAST[0m(1, hidden_states) 
3: [33mLOAD_FAST[0m(2, attention_mask) 
4: [33mLOAD_FAST[0m(6, output_attentions) 
5: [33mLOAD_FAST[0m(3, query_states) 
6: [33mLOAD_FAST[0m(4, relative_pos) 
7: [33mLOAD_FAST[0m(5, rel_embeddings) 
8: [33mLOAD_CONST[0m(1, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
9: [33mCALL_FUNCTION_KW[0m(6, 6) 
10: [33mSTORE_FAST[0m(7, attention_output) 
11: [33mLOAD_FAST[0m(6, output_attentions) 
12: [33mPOP_JUMP_IF_FALSE[0m(34, 34)  -> inst 17
13: [33mLOAD_FAST[0m(7, attention_output) 
14: [33mUNPACK_SEQUENCE[0m(2, 2) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mSTORE_FAST[0m(8, att_matrix) 
17: [33mLOAD_FAST[0m(0, self) 
18: [33mLOAD_METHOD[0m(1, intermediate) 
19: [33mLOAD_FAST[0m(7, attention_output) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(9, intermediate_output) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(2, output) 
24: [33mLOAD_FAST[0m(9, intermediate_output) 
25: [33mLOAD_FAST[0m(7, attention_output) 
26: [33mCALL_METHOD[0m(2, 2) 
27: [33mSTORE_FAST[0m(10, layer_output) 
28: [33mLOAD_FAST[0m(6, output_attentions) 
29: [33mPOP_JUMP_IF_FALSE[0m(68, 68)  -> inst 34
30: [33mLOAD_FAST[0m(10, layer_output) 
31: [33mLOAD_FAST[0m(8, att_matrix) 
32: [33mBUILD_TUPLE[0m(2, 2) 
33: [33mRETURN_VALUE[0m(None, None) 
34: [33mLOAD_FAST[0m(10, layer_output) 
35: [33mRETURN_VALUE[0m(None, None) 
36: [33mLOAD_CONST[0m(0, None) 
37: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'tuple'>, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')), (<class 'NoneType'>, None), (<class 'int'>, 9), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0x85010f0)
push tracker due to record
push tracker 9 frame 0x85010f0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0x85010f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0x85010f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0x85010f0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0x85010f0)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0x85010f0)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0x85010f0)
load fast: 23346416248576
tracing opcode LOAD_ATTR None pc=12 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0x85010f0)
load fast: 23346380865104
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0x85010f0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0x85010f0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0x85010f0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0x85010f0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0x85010f0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0x85010f0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0x85010f0)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_ATTR[0m(0, self) 
2: [33mLOAD_FAST[0m(1, hidden_states) 
3: [33mLOAD_FAST[0m(2, attention_mask) 
4: [33mLOAD_FAST[0m(3, output_attentions) 
5: [33mLOAD_FAST[0m(4, query_states) 
6: [33mLOAD_FAST[0m(5, relative_pos) 
7: [33mLOAD_FAST[0m(6, rel_embeddings) 
8: [33mLOAD_CONST[0m(1, ('query_states', 'relative_pos', 'rel_embeddings')) 
9: [33mCALL_FUNCTION_KW[0m(6, 6) 
10: [33mSTORE_FAST[0m(7, self_output) 
11: [33mLOAD_FAST[0m(3, output_attentions) 
12: [33mPOP_JUMP_IF_FALSE[0m(34, 34)  -> inst 17
13: [33mLOAD_FAST[0m(7, self_output) 
14: [33mUNPACK_SEQUENCE[0m(2, 2) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mSTORE_FAST[0m(8, att_matrix) 
17: [33mLOAD_FAST[0m(4, query_states) 
18: [33mLOAD_CONST[0m(0, None) 
19: [33mIS_OP[0m(0, 0) 
20: [33mPOP_JUMP_IF_FALSE[0m(46, 46)  -> inst 23
21: [33mLOAD_FAST[0m(1, hidden_states) 
22: [33mSTORE_FAST[0m(4, query_states) 
23: [33mLOAD_FAST[0m(0, self) 
24: [33mLOAD_METHOD[0m(1, output) 
25: [33mLOAD_FAST[0m(7, self_output) 
26: [33mLOAD_FAST[0m(4, query_states) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(9, attention_output) 
29: [33mLOAD_FAST[0m(3, output_attentions) 
30: [33mPOP_JUMP_IF_FALSE[0m(70, 70)  -> inst 35
31: [33mLOAD_FAST[0m(9, attention_output) 
32: [33mLOAD_FAST[0m(8, att_matrix) 
33: [33mBUILD_TUPLE[0m(2, 2) 
34: [33mRETURN_VALUE[0m(None, None) 
35: [33mLOAD_FAST[0m(9, attention_output) 
36: [33mRETURN_VALUE[0m(None, None) 
37: [33mLOAD_CONST[0m(0, None) 
38: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'tuple'>, ('query_states', 'relative_pos', 'rel_embeddings')), (<class 'NoneType'>, None), (<class 'int'>, 10), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0x85052a0)
push tracker due to record
push tracker 10 frame 0x85052a0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0x85052a0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0x85052a0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0x85052a0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0x85052a0)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0x85052a0)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0x85052a0)
load fast: 23346416248672
tracing opcode LOAD_ATTR None pc=12 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0x85052a0)
load fast: 23346380865104
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0x85052a0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0x85052a0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0x85052a0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0x85052a0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0x85052a0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0x85052a0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0x85052a0)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
new bytecode: 

0: [33mLOAD_FAST[0m(4, query_states) 
1: [33mLOAD_CONST[0m(1, None) 
2: [33mIS_OP[0m(0, 0) 
3: [33mPOP_JUMP_IF_FALSE[0m(46, 46)  -> inst 23
4: [33mLOAD_DEREF[0m(4, self) 
5: [33mLOAD_METHOD[0m(0, in_proj) 
6: [33mLOAD_DEREF[0m(0, hidden_states) 
7: [33mCALL_METHOD[0m(1, 1) 
8: [33mSTORE_FAST[0m(7, qp) 
9: [33mLOAD_DEREF[0m(4, self) 
10: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
11: [33mLOAD_FAST[0m(7, qp) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mLOAD_ATTR[0m(2, chunk) 
14: [33mLOAD_CONST[0m(2, 3) 
15: [33mLOAD_CONST[0m(3, -1) 
16: [33mLOAD_CONST[0m(4, ('dim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mUNPACK_SEQUENCE[0m(3, 3) 
19: [33mSTORE_FAST[0m(8, query_layer) 
20: [33mSTORE_FAST[0m(9, key_layer) 
21: [33mSTORE_FAST[0m(10, value_layer) 
22: [33mJUMP_FORWARD[0m(164, 210)  -> inst 105
23: [33mLOAD_CONST[0m(5, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
24: [33mLOAD_CONST[0m(6, DisentangledSelfAttention.forward.<locals>.linear) 
25: [33mMAKE_FUNCTION[0m(0, 0) 
26: [33mSTORE_DEREF[0m(1, linear) 
27: [33mLOAD_DEREF[0m(4, self) 
28: [33mLOAD_ATTR[0m(0, in_proj) 
29: [33mLOAD_ATTR[0m(3, weight) 
30: [33mLOAD_ATTR[0m(2, chunk) 
31: [33mLOAD_DEREF[0m(4, self) 
32: [33mLOAD_ATTR[0m(4, num_attention_heads) 
33: [33mLOAD_CONST[0m(2, 3) 
34: [33mBINARY_MULTIPLY[0m(None, None) 
35: [33mLOAD_CONST[0m(7, 0) 
36: [33mLOAD_CONST[0m(4, ('dim',)) 
37: [33mCALL_FUNCTION_KW[0m(2, 2) 
38: [33mSTORE_DEREF[0m(5, ws) 
39: [33mLOAD_CLOSURE[0m(4, self) 
40: [33mLOAD_CLOSURE[0m(5, ws) 
41: [33mBUILD_TUPLE[0m(2, 2) 
42: [33mLOAD_CONST[0m(8, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
43: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
44: [33mMAKE_FUNCTION[0m(8, 8) 
45: [33mLOAD_GLOBAL[0m(5, range) 
46: [33mLOAD_CONST[0m(2, 3) 
47: [33mCALL_FUNCTION[0m(1, 1) 
48: [33mGET_ITER[0m(None, None) 
49: [33mCALL_FUNCTION[0m(1, 1) 
50: [33mSTORE_DEREF[0m(3, qkvw) 
51: [33mLOAD_CONST[0m(1, None) 
52: [33mBUILD_LIST[0m(1, 1) 
53: [33mLOAD_CONST[0m(2, 3) 
54: [33mBINARY_MULTIPLY[0m(None, None) 
55: [33mSTORE_DEREF[0m(2, qkvb) 
56: [33mLOAD_DEREF[0m(1, linear) 
57: [33mLOAD_DEREF[0m(3, qkvw) 
58: [33mLOAD_CONST[0m(7, 0) 
59: [33mBINARY_SUBSCR[0m(None, None) 
60: [33mLOAD_DEREF[0m(2, qkvb) 
61: [33mLOAD_CONST[0m(7, 0) 
62: [33mBINARY_SUBSCR[0m(None, None) 
63: [33mLOAD_FAST[0m(4, query_states) 
64: [33mLOAD_ATTR[0m(6, to) 
65: [33mLOAD_DEREF[0m(3, qkvw) 
66: [33mLOAD_CONST[0m(7, 0) 
67: [33mBINARY_SUBSCR[0m(None, None) 
68: [33mLOAD_ATTR[0m(7, dtype) 
69: [33mLOAD_CONST[0m(10, ('dtype',)) 
70: [33mCALL_FUNCTION_KW[0m(1, 1) 
71: [33mCALL_FUNCTION[0m(3, 3) 
72: [33mSTORE_FAST[0m(11, q) 
73: [33mLOAD_CLOSURE[0m(0, hidden_states) 
74: [33mLOAD_CLOSURE[0m(1, linear) 
75: [33mLOAD_CLOSURE[0m(2, qkvb) 
76: [33mLOAD_CLOSURE[0m(3, qkvw) 
77: [33mBUILD_TUPLE[0m(4, 4) 
78: [33mLOAD_CONST[0m(11, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
79: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
80: [33mMAKE_FUNCTION[0m(8, 8) 
81: [33mLOAD_GLOBAL[0m(5, range) 
82: [33mLOAD_CONST[0m(12, 1) 
83: [33mLOAD_CONST[0m(2, 3) 
84: [33mCALL_FUNCTION[0m(2, 2) 
85: [33mGET_ITER[0m(None, None) 
86: [33mCALL_FUNCTION[0m(1, 1) 
87: [33mUNPACK_SEQUENCE[0m(2, 2) 
88: [33mSTORE_FAST[0m(12, k) 
89: [33mSTORE_FAST[0m(13, v) 
90: [33mLOAD_CLOSURE[0m(4, self) 
91: [33mBUILD_TUPLE[0m(1, 1) 
92: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
93: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
94: [33mMAKE_FUNCTION[0m(8, 8) 
95: [33mLOAD_FAST[0m(11, q) 
96: [33mLOAD_FAST[0m(12, k) 
97: [33mLOAD_FAST[0m(13, v) 
98: [33mBUILD_TUPLE[0m(3, 3) 
99: [33mGET_ITER[0m(None, None) 
100: [33mCALL_FUNCTION[0m(1, 1) 
101: [33mUNPACK_SEQUENCE[0m(3, 3) 
102: [33mSTORE_FAST[0m(8, query_layer) 
103: [33mSTORE_FAST[0m(9, key_layer) 
104: [33mSTORE_FAST[0m(10, value_layer) 
105: [33mLOAD_FAST[0m(8, query_layer) 
106: [33mLOAD_DEREF[0m(4, self) 
107: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
108: [33mLOAD_DEREF[0m(4, self) 
109: [33mLOAD_ATTR[0m(8, q_bias) 
110: [33mLOAD_CONST[0m(1, None) 
111: [33mLOAD_CONST[0m(1, None) 
112: [33mLOAD_CONST[0m(1, None) 
113: [33mLOAD_CONST[0m(1, None) 
114: [33mBUILD_SLICE[0m(2, 2) 
115: [33mBUILD_TUPLE[0m(3, 3) 
116: [33mBINARY_SUBSCR[0m(None, None) 
117: [33mCALL_METHOD[0m(1, 1) 
118: [33mBINARY_ADD[0m(None, None) 
119: [33mSTORE_FAST[0m(8, query_layer) 
120: [33mLOAD_FAST[0m(10, value_layer) 
121: [33mLOAD_DEREF[0m(4, self) 
122: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
123: [33mLOAD_DEREF[0m(4, self) 
124: [33mLOAD_ATTR[0m(9, v_bias) 
125: [33mLOAD_CONST[0m(1, None) 
126: [33mLOAD_CONST[0m(1, None) 
127: [33mLOAD_CONST[0m(1, None) 
128: [33mLOAD_CONST[0m(1, None) 
129: [33mBUILD_SLICE[0m(2, 2) 
130: [33mBUILD_TUPLE[0m(3, 3) 
131: [33mBINARY_SUBSCR[0m(None, None) 
132: [33mCALL_METHOD[0m(1, 1) 
133: [33mBINARY_ADD[0m(None, None) 
134: [33mSTORE_FAST[0m(10, value_layer) 
135: [33mLOAD_CONST[0m(1, None) 
136: [33mSTORE_FAST[0m(14, rel_att) 
137: [33mLOAD_CONST[0m(12, 1) 
138: [33mLOAD_GLOBAL[0m(10, len) 
139: [33mLOAD_DEREF[0m(4, self) 
140: [33mLOAD_ATTR[0m(11, pos_att_type) 
141: [33mCALL_FUNCTION[0m(1, 1) 
142: [33mBINARY_ADD[0m(None, None) 
143: [33mSTORE_FAST[0m(15, scale_factor) 
144: [33mLOAD_GLOBAL[0m(12, torch) 
145: [33mLOAD_METHOD[0m(13, sqrt) 
146: [33mLOAD_GLOBAL[0m(12, torch) 
147: [33mLOAD_ATTR[0m(14, tensor) 
148: [33mLOAD_FAST[0m(8, query_layer) 
149: [33mLOAD_METHOD[0m(15, size) 
150: [33mLOAD_CONST[0m(3, -1) 
151: [33mCALL_METHOD[0m(1, 1) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(16, float) 
154: [33mLOAD_CONST[0m(10, ('dtype',)) 
155: [33mCALL_FUNCTION_KW[0m(2, 2) 
156: [33mLOAD_FAST[0m(15, scale_factor) 
157: [33mBINARY_MULTIPLY[0m(None, None) 
158: [33mCALL_METHOD[0m(1, 1) 
159: [33mSTORE_FAST[0m(16, scale) 
160: [33mLOAD_FAST[0m(8, query_layer) 
161: [33mLOAD_FAST[0m(16, scale) 
162: [33mLOAD_ATTR[0m(6, to) 
163: [33mLOAD_FAST[0m(8, query_layer) 
164: [33mLOAD_ATTR[0m(7, dtype) 
165: [33mLOAD_CONST[0m(10, ('dtype',)) 
166: [33mCALL_FUNCTION_KW[0m(1, 1) 
167: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
168: [33mSTORE_FAST[0m(8, query_layer) 
169: [33mLOAD_GLOBAL[0m(12, torch) 
170: [33mLOAD_METHOD[0m(17, matmul) 
171: [33mLOAD_FAST[0m(8, query_layer) 
172: [33mLOAD_FAST[0m(9, key_layer) 
173: [33mLOAD_METHOD[0m(18, transpose) 
174: [33mLOAD_CONST[0m(3, -1) 
175: [33mLOAD_CONST[0m(14, -2) 
176: [33mCALL_METHOD[0m(2, 2) 
177: [33mCALL_METHOD[0m(2, 2) 
178: [33mSTORE_FAST[0m(17, attention_scores) 
179: [33mLOAD_DEREF[0m(4, self) 
180: [33mLOAD_ATTR[0m(19, relative_attention) 
181: [33mEXTENDED_ARG[0m(1, 1) 
182: [33mPOP_JUMP_IF_FALSE[0m(394, 394)  -> inst 197
183: [33mLOAD_DEREF[0m(4, self) 
184: [33mLOAD_METHOD[0m(20, pos_dropout) 
185: [33mLOAD_FAST[0m(6, rel_embeddings) 
186: [33mCALL_METHOD[0m(1, 1) 
187: [33mSTORE_FAST[0m(6, rel_embeddings) 
188: [33mLOAD_DEREF[0m(4, self) 
189: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
190: [33mLOAD_FAST[0m(8, query_layer) 
191: [33mLOAD_FAST[0m(9, key_layer) 
192: [33mLOAD_FAST[0m(5, relative_pos) 
193: [33mLOAD_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_FAST[0m(15, scale_factor) 
195: [33mCALL_METHOD[0m(5, 5) 
196: [33mSTORE_FAST[0m(14, rel_att) 
197: [33mLOAD_FAST[0m(14, rel_att) 
198: [33mLOAD_CONST[0m(1, None) 
199: [33mIS_OP[0m(1, 1) 
200: [33mEXTENDED_ARG[0m(1, 1) 
201: [33mPOP_JUMP_IF_FALSE[0m(412, 412)  -> inst 206
202: [33mLOAD_FAST[0m(17, attention_scores) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mBINARY_ADD[0m(None, None) 
205: [33mSTORE_FAST[0m(17, attention_scores) 
206: [33mLOAD_DEREF[0m(4, self) 
207: [33mLOAD_ATTR[0m(22, talking_head) 
208: [33mEXTENDED_ARG[0m(1, 1) 
209: [33mPOP_JUMP_IF_FALSE[0m(454, 454)  -> inst 227
210: [33mLOAD_DEREF[0m(4, self) 
211: [33mLOAD_METHOD[0m(23, head_logits_proj) 
212: [33mLOAD_FAST[0m(17, attention_scores) 
213: [33mLOAD_METHOD[0m(24, permute) 
214: [33mLOAD_CONST[0m(7, 0) 
215: [33mLOAD_CONST[0m(15, 2) 
216: [33mLOAD_CONST[0m(2, 3) 
217: [33mLOAD_CONST[0m(12, 1) 
218: [33mCALL_METHOD[0m(4, 4) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_METHOD[0m(24, permute) 
221: [33mLOAD_CONST[0m(7, 0) 
222: [33mLOAD_CONST[0m(2, 3) 
223: [33mLOAD_CONST[0m(12, 1) 
224: [33mLOAD_CONST[0m(15, 2) 
225: [33mCALL_METHOD[0m(4, 4) 
226: [33mSTORE_FAST[0m(17, attention_scores) 
227: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
228: [33mLOAD_METHOD[0m(26, apply) 
229: [33mLOAD_FAST[0m(17, attention_scores) 
230: [33mLOAD_FAST[0m(2, attention_mask) 
231: [33mLOAD_CONST[0m(3, -1) 
232: [33mCALL_METHOD[0m(3, 3) 
233: [33mSTORE_FAST[0m(18, attention_probs) 
234: [33mLOAD_DEREF[0m(4, self) 
235: [33mLOAD_METHOD[0m(27, dropout) 
236: [33mLOAD_FAST[0m(18, attention_probs) 
237: [33mCALL_METHOD[0m(1, 1) 
238: [33mSTORE_FAST[0m(18, attention_probs) 
239: [33mLOAD_DEREF[0m(4, self) 
240: [33mLOAD_ATTR[0m(22, talking_head) 
241: [33mEXTENDED_ARG[0m(2, 2) 
242: [33mPOP_JUMP_IF_FALSE[0m(520, 520)  -> inst 260
243: [33mLOAD_DEREF[0m(4, self) 
244: [33mLOAD_METHOD[0m(28, head_weights_proj) 
245: [33mLOAD_FAST[0m(18, attention_probs) 
246: [33mLOAD_METHOD[0m(24, permute) 
247: [33mLOAD_CONST[0m(7, 0) 
248: [33mLOAD_CONST[0m(15, 2) 
249: [33mLOAD_CONST[0m(2, 3) 
250: [33mLOAD_CONST[0m(12, 1) 
251: [33mCALL_METHOD[0m(4, 4) 
252: [33mCALL_METHOD[0m(1, 1) 
253: [33mLOAD_METHOD[0m(24, permute) 
254: [33mLOAD_CONST[0m(7, 0) 
255: [33mLOAD_CONST[0m(2, 3) 
256: [33mLOAD_CONST[0m(12, 1) 
257: [33mLOAD_CONST[0m(15, 2) 
258: [33mCALL_METHOD[0m(4, 4) 
259: [33mSTORE_FAST[0m(18, attention_probs) 
260: [33mLOAD_GLOBAL[0m(12, torch) 
261: [33mLOAD_METHOD[0m(17, matmul) 
262: [33mLOAD_FAST[0m(18, attention_probs) 
263: [33mLOAD_FAST[0m(10, value_layer) 
264: [33mCALL_METHOD[0m(2, 2) 
265: [33mSTORE_FAST[0m(19, context_layer) 
266: [33mLOAD_FAST[0m(19, context_layer) 
267: [33mLOAD_METHOD[0m(24, permute) 
268: [33mLOAD_CONST[0m(7, 0) 
269: [33mLOAD_CONST[0m(15, 2) 
270: [33mLOAD_CONST[0m(12, 1) 
271: [33mLOAD_CONST[0m(2, 3) 
272: [33mCALL_METHOD[0m(4, 4) 
273: [33mLOAD_METHOD[0m(29, contiguous) 
274: [33mCALL_METHOD[0m(0, 0) 
275: [33mSTORE_FAST[0m(19, context_layer) 
276: [33mLOAD_FAST[0m(19, context_layer) 
277: [33mLOAD_METHOD[0m(15, size) 
278: [33mCALL_METHOD[0m(0, 0) 
279: [33mLOAD_CONST[0m(1, None) 
280: [33mLOAD_CONST[0m(14, -2) 
281: [33mBUILD_SLICE[0m(2, 2) 
282: [33mBINARY_SUBSCR[0m(None, None) 
283: [33mLOAD_CONST[0m(16, (-1,)) 
284: [33mBINARY_ADD[0m(None, None) 
285: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
286: [33mLOAD_FAST[0m(19, context_layer) 
287: [33mLOAD_METHOD[0m(30, view) 
288: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
289: [33mCALL_METHOD[0m(1, 1) 
290: [33mSTORE_FAST[0m(19, context_layer) 
291: [33mLOAD_FAST[0m(3, output_attentions) 
292: [33mEXTENDED_ARG[0m(2, 2) 
293: [33mPOP_JUMP_IF_FALSE[0m(596, 596)  -> inst 298
294: [33mLOAD_FAST[0m(19, context_layer) 
295: [33mLOAD_FAST[0m(18, attention_probs) 
296: [33mBUILD_TUPLE[0m(2, 2) 
297: [33mRETURN_VALUE[0m(None, None) 
298: [33mLOAD_FAST[0m(19, context_layer) 
299: [33mRETURN_VALUE[0m(None, None) 
300: [33mLOAD_CONST[0m(1, None) 
301: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -1), (<class 'str'>, "\n        Call the module\n\n        Args:\n            hidden_states (`torch.FloatTensor`):\n                Input states to the module usually the output from previous layer, it will be the Q,K and V in\n                *Attention(Q,K,V)*\n\n            attention_mask (`torch.ByteTensor`):\n                An attention mask matrix of shape [*B*, *N*, *N*] where *B* is the batch size, *N* is the maximum\n                sequence length in which element [i,j] = *1* means the *i* th token in the input can attend to the *j*\n                th token.\n\n            output_attentions (`bool`, optional):\n                Whether return the attention matrix.\n\n            query_states (`torch.FloatTensor`, optional):\n                The *Q* state in *Attention(Q,K,V)*.\n\n            relative_pos (`torch.LongTensor`):\n                The relative position encoding between the tokens in the sequence. It's of shape [*B*, *N*, *N*] with\n                values ranging in [*-max_relative_positions*, *max_relative_positions*].\n\n            rel_embeddings (`torch.FloatTensor`):\n                The embedding of relative distances. It's a tensor of shape [\\(2 \\times\n                \\text{max_relative_positions}\\), *hidden_size*].\n\n\n        "), (<class 'tuple'>, ('dtype',)), (<class 'code'>, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>), (<class 'int'>, -2), (<class 'int'>, 3), (<class 'tuple'>, ('dim',)), (<class 'NoneType'>, None), (<class 'str'>, 'DisentangledSelfAttention.forward.<locals>.linear'), (<class 'int'>, 0), (<class 'tuple'>, (-1,)), (<class 'code'>, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>), (<class 'code'>, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>), (<class 'int'>, 2), (<class 'str'>, 'DisentangledSelfAttention.forward.<locals>.<listcomp>'), (<class 'code'>, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>), (<class 'int'>, 11)]
guarded code
0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0x84f1ae0)
push tracker due to record
push tracker 11 frame 0x84f1ae0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0x84f1ae0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0x84f1ae0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0x84f1ae0)
tracing opcode IS_OP None pc=16 frame=11(0x84f1ae0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0x84f1ae0)
load fast: 23346416248720
tracing opcode LOAD_METHOD None pc=22 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=24 frame=11(0x84f1ae0)
load fast: 23346380865104
tracing opcode CALL_METHOD None pc=26 frame=11(0x84f1ae0)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=32 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=34 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=36 frame=11(0x84f1ae0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
new bytecode: 

0: [33mLOAD_FAST[0m(1, x) 
1: [33mLOAD_METHOD[0m(0, size) 
2: [33mCALL_METHOD[0m(0, 0) 
3: [33mLOAD_CONST[0m(0, None) 
4: [33mLOAD_CONST[0m(1, -1) 
5: [33mBUILD_SLICE[0m(2, 2) 
6: [33mBINARY_SUBSCR[0m(None, None) 
7: [33mLOAD_FAST[0m(0, self) 
8: [33mLOAD_ATTR[0m(1, num_attention_heads) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_TUPLE[0m(2, 2) 
11: [33mBINARY_ADD[0m(None, None) 
12: [33mSTORE_FAST[0m(2, new_x_shape) 
13: [33mLOAD_FAST[0m(1, x) 
14: [33mLOAD_METHOD[0m(2, view) 
15: [33mLOAD_FAST[0m(2, new_x_shape) 
16: [33mCALL_METHOD[0m(1, 1) 
17: [33mSTORE_FAST[0m(1, x) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(3, permute) 
20: [33mLOAD_CONST[0m(2, 0) 
21: [33mLOAD_CONST[0m(3, 2) 
22: [33mLOAD_CONST[0m(4, 1) 
23: [33mLOAD_CONST[0m(5, 3) 
24: [33mCALL_METHOD[0m(4, 4) 
25: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -1), (<class 'int'>, 3), (<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'int'>, 2), (<class 'int'>, 12)]
guarded code
0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346380245728
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416248720
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_23 : [#users=1] = placeholder[target=tensor_23]
    %view : [#users=1] = call_method[target=view](args = (%tensor_23, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=40 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=42 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=44 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0x84f1ae0)
record function in graph <built-in method chunk of Tensor object at 0x153bc0b491d0>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=50 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=52 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=54 frame=11(0x84f1ae0)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=224 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=226 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=228 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=230 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=232 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=234 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=236 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=238 frame=11(0x84f1ae0)
tracing opcode BUILD_SLICE None pc=240 frame=11(0x84f1ae0)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0x84f1ae0)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0x84f1ae0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0x84f1ae0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346380243968
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416248720
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_24 : [#users=1] = placeholder[target=tensor_24]
    %view : [#users=1] = call_method[target=view](args = (%tensor_24, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0x84f1ae0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=254 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=256 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=258 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=260 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=262 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=264 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=266 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=268 frame=11(0x84f1ae0)
tracing opcode BUILD_SLICE None pc=270 frame=11(0x84f1ae0)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0x84f1ae0)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0x84f1ae0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0x84f1ae0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346380022544
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416248720
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_25 : [#users=1] = placeholder[target=tensor_25]
    %view : [#users=1] = call_method[target=view](args = (%tensor_25, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0x84f1ae0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=284 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0x84f1ae0)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=290 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=292 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0x84f1ae0)
tracing opcode BINARY_ADD None pc=296 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=298 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=302 frame=11(0x84f1ae0)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=306 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=308 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=310 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=312 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=314 frame=11(0x84f1ae0)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=318 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=320 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0x84f1ae0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0x84f1ae0)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0x84f1ae0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0x84f1ae0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=334 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=336 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=338 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=340 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=342 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0x84f1ae0)
record function in graph <built-in method to of Tensor object at 0x153bc0b37d60>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0x84f1ae0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=352 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=354 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=356 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=358 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=360 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=362 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=364 frame=11(0x84f1ae0)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0x84f1ae0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=372 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=380 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=382 frame=11(0x84f1ae0)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0x84f1ae0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416248816
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=390 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=392 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=394 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=396 frame=11(0x84f1ae0)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=400 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=402 frame=11(0x84f1ae0)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
new bytecode: 

0: [33mLOAD_FAST[0m(3, relative_pos) 
1: [33mLOAD_CONST[0m(0, None) 
2: [33mIS_OP[0m(0, 0) 
3: [33mPOP_JUMP_IF_FALSE[0m(38, 38)  -> inst 19
4: [33mLOAD_FAST[0m(1, query_layer) 
5: [33mLOAD_METHOD[0m(0, size) 
6: [33mLOAD_CONST[0m(1, -2) 
7: [33mCALL_METHOD[0m(1, 1) 
8: [33mSTORE_FAST[0m(6, q) 
9: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
10: [33mLOAD_FAST[0m(6, q) 
11: [33mLOAD_FAST[0m(2, key_layer) 
12: [33mLOAD_METHOD[0m(0, size) 
13: [33mLOAD_CONST[0m(1, -2) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_ATTR[0m(2, device) 
17: [33mCALL_FUNCTION[0m(3, 3) 
18: [33mSTORE_FAST[0m(3, relative_pos) 
19: [33mLOAD_FAST[0m(3, relative_pos) 
20: [33mLOAD_METHOD[0m(3, dim) 
21: [33mCALL_METHOD[0m(0, 0) 
22: [33mLOAD_CONST[0m(2, 2) 
23: [33mCOMPARE_OP[0m(2, ==) 
24: [33mPOP_JUMP_IF_FALSE[0m(68, 68)  -> inst 34
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(4, unsqueeze) 
27: [33mLOAD_CONST[0m(3, 0) 
28: [33mCALL_METHOD[0m(1, 1) 
29: [33mLOAD_METHOD[0m(4, unsqueeze) 
30: [33mLOAD_CONST[0m(3, 0) 
31: [33mCALL_METHOD[0m(1, 1) 
32: [33mSTORE_FAST[0m(3, relative_pos) 
33: [33mJUMP_FORWARD[0m(54, 122)  -> inst 61
34: [33mLOAD_FAST[0m(3, relative_pos) 
35: [33mLOAD_METHOD[0m(3, dim) 
36: [33mCALL_METHOD[0m(0, 0) 
37: [33mLOAD_CONST[0m(4, 3) 
38: [33mCOMPARE_OP[0m(2, ==) 
39: [33mPOP_JUMP_IF_FALSE[0m(92, 92)  -> inst 46
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(4, unsqueeze) 
42: [33mLOAD_CONST[0m(5, 1) 
43: [33mCALL_METHOD[0m(1, 1) 
44: [33mSTORE_FAST[0m(3, relative_pos) 
45: [33mJUMP_FORWARD[0m(30, 122)  -> inst 61
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(3, dim) 
48: [33mCALL_METHOD[0m(0, 0) 
49: [33mLOAD_CONST[0m(6, 4) 
50: [33mCOMPARE_OP[0m(3, !=) 
51: [33mPOP_JUMP_IF_FALSE[0m(122, 122)  -> inst 61
52: [33mLOAD_GLOBAL[0m(5, ValueError) 
53: [33mLOAD_CONST[0m(7, Relative position ids must be of dim 2 or 3 or 4. ) 
54: [33mLOAD_FAST[0m(3, relative_pos) 
55: [33mLOAD_METHOD[0m(3, dim) 
56: [33mCALL_METHOD[0m(0, 0) 
57: [33mFORMAT_VALUE[0m(0, (None, False)) 
58: [33mBUILD_STRING[0m(2, 2) 
59: [33mCALL_FUNCTION[0m(1, 1) 
60: [33mRAISE_VARARGS[0m(1, 1) 
61: [33mLOAD_GLOBAL[0m(6, min) 
62: [33mLOAD_GLOBAL[0m(7, max) 
63: [33mLOAD_FAST[0m(1, query_layer) 
64: [33mLOAD_METHOD[0m(0, size) 
65: [33mLOAD_CONST[0m(1, -2) 
66: [33mCALL_METHOD[0m(1, 1) 
67: [33mLOAD_FAST[0m(2, key_layer) 
68: [33mLOAD_METHOD[0m(0, size) 
69: [33mLOAD_CONST[0m(1, -2) 
70: [33mCALL_METHOD[0m(1, 1) 
71: [33mCALL_FUNCTION[0m(2, 2) 
72: [33mLOAD_FAST[0m(0, self) 
73: [33mLOAD_ATTR[0m(8, max_relative_positions) 
74: [33mCALL_FUNCTION[0m(2, 2) 
75: [33mSTORE_FAST[0m(7, att_span) 
76: [33mLOAD_FAST[0m(3, relative_pos) 
77: [33mLOAD_METHOD[0m(9, long) 
78: [33mCALL_METHOD[0m(0, 0) 
79: [33mLOAD_METHOD[0m(10, to) 
80: [33mLOAD_FAST[0m(1, query_layer) 
81: [33mLOAD_ATTR[0m(2, device) 
82: [33mCALL_METHOD[0m(1, 1) 
83: [33mSTORE_FAST[0m(3, relative_pos) 
84: [33mLOAD_FAST[0m(4, rel_embeddings) 
85: [33mLOAD_FAST[0m(0, self) 
86: [33mLOAD_ATTR[0m(8, max_relative_positions) 
87: [33mLOAD_FAST[0m(7, att_span) 
88: [33mBINARY_SUBTRACT[0m(None, None) 
89: [33mLOAD_FAST[0m(0, self) 
90: [33mLOAD_ATTR[0m(8, max_relative_positions) 
91: [33mLOAD_FAST[0m(7, att_span) 
92: [33mBINARY_ADD[0m(None, None) 
93: [33mBUILD_SLICE[0m(2, 2) 
94: [33mLOAD_CONST[0m(0, None) 
95: [33mLOAD_CONST[0m(0, None) 
96: [33mBUILD_SLICE[0m(2, 2) 
97: [33mBUILD_TUPLE[0m(2, 2) 
98: [33mBINARY_SUBSCR[0m(None, None) 
99: [33mLOAD_METHOD[0m(4, unsqueeze) 
100: [33mLOAD_CONST[0m(3, 0) 
101: [33mCALL_METHOD[0m(1, 1) 
102: [33mSTORE_FAST[0m(4, rel_embeddings) 
103: [33mLOAD_CONST[0m(3, 0) 
104: [33mSTORE_FAST[0m(8, score) 
105: [33mLOAD_CONST[0m(8, c2p) 
106: [33mLOAD_FAST[0m(0, self) 
107: [33mLOAD_ATTR[0m(11, pos_att_type) 
108: [33mCONTAINS_OP[0m(0, 0) 
109: [33mEXTENDED_ARG[0m(1, 1) 
110: [33mPOP_JUMP_IF_FALSE[0m(320, 320)  -> inst 160
111: [33mLOAD_FAST[0m(0, self) 
112: [33mLOAD_METHOD[0m(12, pos_proj) 
113: [33mLOAD_FAST[0m(4, rel_embeddings) 
114: [33mCALL_METHOD[0m(1, 1) 
115: [33mSTORE_FAST[0m(9, pos_key_layer) 
116: [33mLOAD_FAST[0m(0, self) 
117: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
118: [33mLOAD_FAST[0m(9, pos_key_layer) 
119: [33mCALL_METHOD[0m(1, 1) 
120: [33mSTORE_FAST[0m(9, pos_key_layer) 
121: [33mLOAD_GLOBAL[0m(14, torch) 
122: [33mLOAD_METHOD[0m(15, matmul) 
123: [33mLOAD_FAST[0m(1, query_layer) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mLOAD_METHOD[0m(16, transpose) 
126: [33mLOAD_CONST[0m(9, -1) 
127: [33mLOAD_CONST[0m(1, -2) 
128: [33mCALL_METHOD[0m(2, 2) 
129: [33mCALL_METHOD[0m(2, 2) 
130: [33mSTORE_FAST[0m(10, c2p_att) 
131: [33mLOAD_GLOBAL[0m(14, torch) 
132: [33mLOAD_METHOD[0m(17, clamp) 
133: [33mLOAD_FAST[0m(3, relative_pos) 
134: [33mLOAD_FAST[0m(7, att_span) 
135: [33mBINARY_ADD[0m(None, None) 
136: [33mLOAD_CONST[0m(3, 0) 
137: [33mLOAD_FAST[0m(7, att_span) 
138: [33mLOAD_CONST[0m(2, 2) 
139: [33mBINARY_MULTIPLY[0m(None, None) 
140: [33mLOAD_CONST[0m(5, 1) 
141: [33mBINARY_SUBTRACT[0m(None, None) 
142: [33mCALL_METHOD[0m(3, 3) 
143: [33mSTORE_FAST[0m(11, c2p_pos) 
144: [33mLOAD_GLOBAL[0m(14, torch) 
145: [33mLOAD_ATTR[0m(18, gather) 
146: [33mLOAD_FAST[0m(10, c2p_att) 
147: [33mLOAD_CONST[0m(9, -1) 
148: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
149: [33mLOAD_FAST[0m(11, c2p_pos) 
150: [33mLOAD_FAST[0m(1, query_layer) 
151: [33mLOAD_FAST[0m(3, relative_pos) 
152: [33mCALL_FUNCTION[0m(3, 3) 
153: [33mLOAD_CONST[0m(10, ('dim', 'index')) 
154: [33mCALL_FUNCTION_KW[0m(3, 3) 
155: [33mSTORE_FAST[0m(10, c2p_att) 
156: [33mLOAD_FAST[0m(8, score) 
157: [33mLOAD_FAST[0m(10, c2p_att) 
158: [33mINPLACE_ADD[0m(None, None) 
159: [33mSTORE_FAST[0m(8, score) 
160: [33mLOAD_CONST[0m(11, p2c) 
161: [33mLOAD_FAST[0m(0, self) 
162: [33mLOAD_ATTR[0m(11, pos_att_type) 
163: [33mCONTAINS_OP[0m(0, 0) 
164: [33mEXTENDED_ARG[0m(2, 2) 
165: [33mPOP_JUMP_IF_FALSE[0m(620, 620)  -> inst 310
166: [33mLOAD_FAST[0m(0, self) 
167: [33mLOAD_METHOD[0m(20, pos_q_proj) 
168: [33mLOAD_FAST[0m(4, rel_embeddings) 
169: [33mCALL_METHOD[0m(1, 1) 
170: [33mSTORE_FAST[0m(12, pos_query_layer) 
171: [33mLOAD_FAST[0m(0, self) 
172: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
173: [33mLOAD_FAST[0m(12, pos_query_layer) 
174: [33mCALL_METHOD[0m(1, 1) 
175: [33mSTORE_FAST[0m(12, pos_query_layer) 
176: [33mLOAD_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_GLOBAL[0m(14, torch) 
178: [33mLOAD_METHOD[0m(21, sqrt) 
179: [33mLOAD_GLOBAL[0m(14, torch) 
180: [33mLOAD_ATTR[0m(22, tensor) 
181: [33mLOAD_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_METHOD[0m(0, size) 
183: [33mLOAD_CONST[0m(9, -1) 
184: [33mCALL_METHOD[0m(1, 1) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(23, float) 
187: [33mLOAD_CONST[0m(12, ('dtype',)) 
188: [33mCALL_FUNCTION_KW[0m(2, 2) 
189: [33mLOAD_FAST[0m(5, scale_factor) 
190: [33mBINARY_MULTIPLY[0m(None, None) 
191: [33mCALL_METHOD[0m(1, 1) 
192: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
193: [33mSTORE_FAST[0m(12, pos_query_layer) 
194: [33mLOAD_FAST[0m(1, query_layer) 
195: [33mLOAD_METHOD[0m(0, size) 
196: [33mLOAD_CONST[0m(1, -2) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mLOAD_FAST[0m(2, key_layer) 
199: [33mLOAD_METHOD[0m(0, size) 
200: [33mLOAD_CONST[0m(1, -2) 
201: [33mCALL_METHOD[0m(1, 1) 
202: [33mCOMPARE_OP[0m(3, !=) 
203: [33mEXTENDED_ARG[0m(1, 1) 
204: [33mPOP_JUMP_IF_FALSE[0m(438, 438)  -> inst 219
205: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
206: [33mLOAD_FAST[0m(2, key_layer) 
207: [33mLOAD_METHOD[0m(0, size) 
208: [33mLOAD_CONST[0m(1, -2) 
209: [33mCALL_METHOD[0m(1, 1) 
210: [33mLOAD_FAST[0m(2, key_layer) 
211: [33mLOAD_METHOD[0m(0, size) 
212: [33mLOAD_CONST[0m(1, -2) 
213: [33mCALL_METHOD[0m(1, 1) 
214: [33mLOAD_FAST[0m(1, query_layer) 
215: [33mLOAD_ATTR[0m(2, device) 
216: [33mCALL_FUNCTION[0m(3, 3) 
217: [33mSTORE_FAST[0m(13, r_pos) 
218: [33mJUMP_FORWARD[0m(4, 442)  -> inst 221
219: [33mLOAD_FAST[0m(3, relative_pos) 
220: [33mSTORE_FAST[0m(13, r_pos) 
221: [33mLOAD_GLOBAL[0m(14, torch) 
222: [33mLOAD_METHOD[0m(17, clamp) 
223: [33mLOAD_FAST[0m(13, r_pos) 
224: [33mUNARY_NEGATIVE[0m(None, None) 
225: [33mLOAD_FAST[0m(7, att_span) 
226: [33mBINARY_ADD[0m(None, None) 
227: [33mLOAD_CONST[0m(3, 0) 
228: [33mLOAD_FAST[0m(7, att_span) 
229: [33mLOAD_CONST[0m(2, 2) 
230: [33mBINARY_MULTIPLY[0m(None, None) 
231: [33mLOAD_CONST[0m(5, 1) 
232: [33mBINARY_SUBTRACT[0m(None, None) 
233: [33mCALL_METHOD[0m(3, 3) 
234: [33mSTORE_FAST[0m(14, p2c_pos) 
235: [33mLOAD_GLOBAL[0m(14, torch) 
236: [33mLOAD_METHOD[0m(15, matmul) 
237: [33mLOAD_FAST[0m(2, key_layer) 
238: [33mLOAD_FAST[0m(12, pos_query_layer) 
239: [33mLOAD_METHOD[0m(16, transpose) 
240: [33mLOAD_CONST[0m(9, -1) 
241: [33mLOAD_CONST[0m(1, -2) 
242: [33mCALL_METHOD[0m(2, 2) 
243: [33mLOAD_ATTR[0m(10, to) 
244: [33mLOAD_FAST[0m(2, key_layer) 
245: [33mLOAD_ATTR[0m(24, dtype) 
246: [33mLOAD_CONST[0m(12, ('dtype',)) 
247: [33mCALL_FUNCTION_KW[0m(1, 1) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mSTORE_FAST[0m(15, p2c_att) 
250: [33mLOAD_GLOBAL[0m(14, torch) 
251: [33mLOAD_ATTR[0m(18, gather) 
252: [33mLOAD_FAST[0m(15, p2c_att) 
253: [33mLOAD_CONST[0m(9, -1) 
254: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
255: [33mLOAD_FAST[0m(14, p2c_pos) 
256: [33mLOAD_FAST[0m(1, query_layer) 
257: [33mLOAD_FAST[0m(2, key_layer) 
258: [33mCALL_FUNCTION[0m(3, 3) 
259: [33mLOAD_CONST[0m(10, ('dim', 'index')) 
260: [33mCALL_FUNCTION_KW[0m(3, 3) 
261: [33mLOAD_METHOD[0m(16, transpose) 
262: [33mLOAD_CONST[0m(9, -1) 
263: [33mLOAD_CONST[0m(1, -2) 
264: [33mCALL_METHOD[0m(2, 2) 
265: [33mSTORE_FAST[0m(15, p2c_att) 
266: [33mLOAD_FAST[0m(1, query_layer) 
267: [33mLOAD_METHOD[0m(0, size) 
268: [33mLOAD_CONST[0m(1, -2) 
269: [33mCALL_METHOD[0m(1, 1) 
270: [33mLOAD_FAST[0m(2, key_layer) 
271: [33mLOAD_METHOD[0m(0, size) 
272: [33mLOAD_CONST[0m(1, -2) 
273: [33mCALL_METHOD[0m(1, 1) 
274: [33mCOMPARE_OP[0m(3, !=) 
275: [33mEXTENDED_ARG[0m(2, 2) 
276: [33mPOP_JUMP_IF_FALSE[0m(612, 612)  -> inst 306
277: [33mLOAD_FAST[0m(3, relative_pos) 
278: [33mLOAD_CONST[0m(0, None) 
279: [33mLOAD_CONST[0m(0, None) 
280: [33mBUILD_SLICE[0m(2, 2) 
281: [33mLOAD_CONST[0m(0, None) 
282: [33mLOAD_CONST[0m(0, None) 
283: [33mBUILD_SLICE[0m(2, 2) 
284: [33mLOAD_CONST[0m(0, None) 
285: [33mLOAD_CONST[0m(0, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(3, 0) 
288: [33mBUILD_TUPLE[0m(4, 4) 
289: [33mBINARY_SUBSCR[0m(None, None) 
290: [33mLOAD_METHOD[0m(4, unsqueeze) 
291: [33mLOAD_CONST[0m(9, -1) 
292: [33mCALL_METHOD[0m(1, 1) 
293: [33mSTORE_FAST[0m(16, pos_index) 
294: [33mLOAD_GLOBAL[0m(14, torch) 
295: [33mLOAD_ATTR[0m(18, gather) 
296: [33mLOAD_FAST[0m(15, p2c_att) 
297: [33mLOAD_CONST[0m(1, -2) 
298: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
299: [33mLOAD_FAST[0m(16, pos_index) 
300: [33mLOAD_FAST[0m(15, p2c_att) 
301: [33mLOAD_FAST[0m(2, key_layer) 
302: [33mCALL_FUNCTION[0m(3, 3) 
303: [33mLOAD_CONST[0m(10, ('dim', 'index')) 
304: [33mCALL_FUNCTION_KW[0m(3, 3) 
305: [33mSTORE_FAST[0m(15, p2c_att) 
306: [33mLOAD_FAST[0m(8, score) 
307: [33mLOAD_FAST[0m(15, p2c_att) 
308: [33mINPLACE_ADD[0m(None, None) 
309: [33mSTORE_FAST[0m(8, score) 
310: [33mLOAD_FAST[0m(8, score) 
311: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -2), (<class 'int'>, 4), (<class 'int'>, -1), (<class 'tuple'>, ('dtype',)), (<class 'int'>, 3), (<class 'tuple'>, ('dim', 'index')), (<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'str'>, 'c2p'), (<class 'int'>, 2), (<class 'str'>, 'p2c'), (<class 'str'>, 'Relative position ids must be of dim 2 or 3 or 4. '), (<class 'int'>, 13)]
guarded code
0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0x86a0f90)
push tracker due to record
push tracker 13 frame 0x86a0f90 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0x86a0f90)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0x86a0f90)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0x86a0f90 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0x86a0f90)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0x86a0f90)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0x86a0f90)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0x86a0f90)
tracing opcode IS_OP None pc=16 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=52 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=54 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=56 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=58 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=82 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=84 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=86 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=88 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=94 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=96 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=98 frame=13(0x86a0f90)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0x86a0f90)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=138 frame=13(0x86a0f90)
load fast: 23346380239712
tracing opcode LOAD_METHOD None pc=140 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=142 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=144 frame=13(0x86a0f90)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0x86a0f90)
load fast: 23346380314880
tracing opcode LOAD_METHOD None pc=148 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=150 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=152 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=156 frame=13(0x86a0f90)
load fast: 23346416248720
tracing opcode LOAD_ATTR None pc=158 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=162 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=166 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=168 frame=13(0x86a0f90)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=172 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=174 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=176 frame=13(0x86a0f90)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0x86a0f90)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=184 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=186 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=190 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=192 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=194 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=196 frame=13(0x86a0f90)
tracing opcode BUILD_SLICE None pc=198 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=200 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=202 frame=13(0x86a0f90)
tracing opcode BUILD_SLICE None pc=204 frame=13(0x86a0f90)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0x86a0f90)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0x86a0f90)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=220 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=224 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=226 frame=13(0x86a0f90)
tracing opcode CONTAINS_OP None pc=228 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=236 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=238 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=240 frame=13(0x86a0f90)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=246 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=248 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=250 frame=13(0x86a0f90)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346380664480
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416248720
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_30 : [#users=1] = placeholder[target=tensor_30]
    %view : [#users=1] = call_method[target=view](args = (%tensor_30, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=256 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=258 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=260 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=262 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=264 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=266 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=268 frame=13(0x86a0f90)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0x86a0f90)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=276 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=278 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=280 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=282 frame=13(0x86a0f90)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=286 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=288 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=292 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=296 frame=13(0x86a0f90)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=302 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=304 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=306 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=310 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=312 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=314 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0x86a0f90)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
new bytecode: 

0: [33mLOAD_FAST[0m(0, c2p_pos) 
1: [33mLOAD_METHOD[0m(0, expand) 
2: [33mLOAD_FAST[0m(1, query_layer) 
3: [33mLOAD_METHOD[0m(1, size) 
4: [33mLOAD_CONST[0m(1, 0) 
5: [33mCALL_METHOD[0m(1, 1) 
6: [33mLOAD_FAST[0m(1, query_layer) 
7: [33mLOAD_METHOD[0m(1, size) 
8: [33mLOAD_CONST[0m(2, 1) 
9: [33mCALL_METHOD[0m(1, 1) 
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(1, size) 
12: [33mLOAD_CONST[0m(3, 2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mLOAD_FAST[0m(2, relative_pos) 
15: [33mLOAD_METHOD[0m(1, size) 
16: [33mLOAD_CONST[0m(4, -1) 
17: [33mCALL_METHOD[0m(1, 1) 
18: [33mBUILD_LIST[0m(4, 4) 
19: [33mCALL_METHOD[0m(1, 1) 
20: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -1), (<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'int'>, 2), (<class 'int'>, 14)]
guarded code
0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23346380229904
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23346380239712
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23346380703760
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_31 : [#users=1] = placeholder[target=tensor_31]
    %tensor_32 : [#users=0] = placeholder[target=tensor_32]
    %tensor_33 : [#users=0] = placeholder[target=tensor_33]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_31, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0x86a0f90)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=326 frame=13(0x86a0f90)
tracing opcode INPLACE_ADD None pc=328 frame=13(0x86a0f90)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=334 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=336 frame=13(0x86a0f90)
tracing opcode CONTAINS_OP None pc=338 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=346 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=348 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=350 frame=13(0x86a0f90)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=356 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=358 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=360 frame=13(0x86a0f90)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346380645216
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416248720
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_34 : [#users=1] = placeholder[target=tensor_34]
    %view : [#users=1] = call_method[target=view](args = (%tensor_34, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=368 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=372 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=374 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=376 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=378 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=380 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=384 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=386 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0x86a0f90)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0x86a0f90)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0x86a0f90)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0x86a0f90)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=402 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=404 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=406 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=408 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=410 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=412 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=414 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=416 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=452 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=456 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=458 frame=13(0x86a0f90)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0x86a0f90)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=464 frame=13(0x86a0f90)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=468 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=470 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=474 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=478 frame=13(0x86a0f90)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=484 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=486 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=488 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=490 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=492 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=494 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=496 frame=13(0x86a0f90)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=500 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=502 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=504 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0x86a0f90)
record function in graph <built-in method to of Tensor object at 0x153bc0b9a400>
tracing opcode CALL_METHOD None pc=508 frame=13(0x86a0f90)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=514 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=518 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=522 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=524 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=526 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0x86a0f90)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
new bytecode: 

0: [33mLOAD_FAST[0m(0, c2p_pos) 
1: [33mLOAD_METHOD[0m(0, expand) 
2: [33mLOAD_FAST[0m(1, query_layer) 
3: [33mLOAD_METHOD[0m(1, size) 
4: [33mLOAD_CONST[0m(1, 0) 
5: [33mCALL_METHOD[0m(1, 1) 
6: [33mLOAD_FAST[0m(1, query_layer) 
7: [33mLOAD_METHOD[0m(1, size) 
8: [33mLOAD_CONST[0m(2, 1) 
9: [33mCALL_METHOD[0m(1, 1) 
10: [33mLOAD_FAST[0m(2, key_layer) 
11: [33mLOAD_METHOD[0m(1, size) 
12: [33mLOAD_CONST[0m(3, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mLOAD_FAST[0m(2, key_layer) 
15: [33mLOAD_METHOD[0m(1, size) 
16: [33mLOAD_CONST[0m(3, -2) 
17: [33mCALL_METHOD[0m(1, 1) 
18: [33mBUILD_LIST[0m(4, 4) 
19: [33mCALL_METHOD[0m(1, 1) 
20: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'int'>, -2), (<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'int'>, 15)]
guarded code
0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23346380230224
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23346380239712
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23346380314880
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_35 : [#users=1] = placeholder[target=tensor_35]
    %tensor_36 : [#users=0] = placeholder[target=tensor_36]
    %tensor_37 : [#users=0] = placeholder[target=tensor_37]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_35, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0x86a0f90)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=538 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0x86a0f90)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=546 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=548 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=550 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=552 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=554 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=556 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=558 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=560 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=626 frame=13(0x86a0f90)
tracing opcode INPLACE_ADD None pc=628 frame=13(0x86a0f90)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0x86a0f90)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_27 : [#users=1] = placeholder[target=tensor_27]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_27, 1), kwargs = {})
    %tensor_28 : [#users=1] = placeholder[target=tensor_28]
    %tensor_29 : [#users=1] = placeholder[target=tensor_29]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_28, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_29, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0x86a0f90)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=408 frame=11(0x84f1ae0)
tracing opcode IS_OP None pc=410 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=418 frame=11(0x84f1ae0)
tracing opcode BINARY_ADD None pc=420 frame=11(0x84f1ae0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=426 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=468 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=470 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=472 frame=11(0x84f1ae0)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=476 frame=11(0x84f1ae0)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
new bytecode: 

0: [33mLOAD_FAST[0m(3, dim) 
1: [33mLOAD_FAST[0m(0, self) 
2: [33mSTORE_ATTR[0m(0, dim) 
3: [33mLOAD_FAST[0m(2, mask) 
4: [33mLOAD_METHOD[0m(1, to) 
5: [33mLOAD_GLOBAL[0m(2, torch) 
6: [33mLOAD_ATTR[0m(3, bool) 
7: [33mCALL_METHOD[0m(1, 1) 
8: [33mUNARY_INVERT[0m(None, None) 
9: [33mSTORE_FAST[0m(4, rmask) 
10: [33mLOAD_FAST[0m(1, input) 
11: [33mLOAD_METHOD[0m(4, masked_fill) 
12: [33mLOAD_FAST[0m(4, rmask) 
13: [33mLOAD_GLOBAL[0m(2, torch) 
14: [33mLOAD_METHOD[0m(5, tensor) 
15: [33mLOAD_GLOBAL[0m(2, torch) 
16: [33mLOAD_METHOD[0m(6, finfo) 
17: [33mLOAD_FAST[0m(1, input) 
18: [33mLOAD_ATTR[0m(7, dtype) 
19: [33mCALL_METHOD[0m(1, 1) 
20: [33mLOAD_ATTR[0m(8, min) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mCALL_METHOD[0m(2, 2) 
23: [33mSTORE_FAST[0m(5, output) 
24: [33mLOAD_GLOBAL[0m(2, torch) 
25: [33mLOAD_METHOD[0m(9, softmax) 
26: [33mLOAD_FAST[0m(5, output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_ATTR[0m(0, dim) 
29: [33mCALL_METHOD[0m(2, 2) 
30: [33mSTORE_FAST[0m(5, output) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_METHOD[0m(10, masked_fill_) 
33: [33mLOAD_FAST[0m(4, rmask) 
34: [33mLOAD_CONST[0m(1, 0) 
35: [33mCALL_METHOD[0m(2, 2) 
36: [33mPOP_TOP[0m(None, None) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_METHOD[0m(11, save_for_backward) 
39: [33mLOAD_FAST[0m(5, output) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(5, output) 
43: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 0), (<class 'NoneType'>, None), (<class 'int'>, 16)]
guarded code
0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b13040)
push tracker due to record
push tracker 16 frame 0x153bc0b13040 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b13040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b13040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b13040 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b13040)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b13040)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b13040)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b13040)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b400> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654852096
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b13040)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b400> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b13040)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b13040)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b13040)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b13040)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b13040)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b13040)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b13040)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b13040)
load fast: 23346380411744
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b13040)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b13040)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b13040)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b13040)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b13040)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b13040)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b13040)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b13040)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b13040)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b13040)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b13040)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b13040)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b13040)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b13040)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b13040)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b13040)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b13040)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b13040)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b13040)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b13040)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b13040)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b13040)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b13040)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b13040)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b13040)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b13040)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b13040)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b13040)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b13040)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b13040)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b13040)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b13040)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b13040)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_39 : [#users=1] = placeholder[target=tensor_39]
    %to : [#users=1] = call_method[target=to](args = (%tensor_39, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_40 : [#users=1] = placeholder[target=tensor_40]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_40, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b13040)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=482 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=484 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=486 frame=11(0x84f1ae0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416249008
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346380510928
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_41 : [#users=0] = placeholder[target=tensor_41]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0038, 0.0037, 0.0042,  ..., 0.0034, 0.0043, 0.0041],
          [0.0041, 0.0037, 0.0036,  ..., 0.0051, 0.0041, 0.0028],
          [0.0046, 0.0030, 0.0040,  ..., 0.0035, 0.0043, 0.0030],
          ...,
          [0.0040, 0.0043, 0.0037,  ..., 0.0029, 0.0038, 0.0032],
          [0.0051, 0.0034, 0.0034,  ..., 0.0041, 0.0034, 0.0037],
          [0.0045, 0.0041, 0.0039,  ..., 0.0037, 0.0046, 0.0040]],

         [[0.0033, 0.0051, 0.0035,  ..., 0.0045, 0.0035, 0.0048],
          [0.0038, 0.0039, 0.0033,  ..., 0.0042, 0.0033, 0.0038],
          [0.0035, 0.0031, 0.0031,  ..., 0.0033, 0.0043, 0.0048],
          ...,
          [0.0035, 0.0052, 0.0033,  ..., 0.0046, 0.0033, 0.0027],
          [0.0049, 0.0031, 0.0038,  ..., 0.0034, 0.0041, 0.0043],
          [0.0030, 0.0035, 0.0041,  ..., 0.0038, 0.0041, 0.0034]],

         [[0.0026, 0.0044, 0.0036,  ..., 0.0036, 0.0044, 0.0041],
          [0.0034, 0.0025, 0.0032,  ..., 0.0039, 0.0040, 0.0039],
          [0.0036, 0.0044, 0.0041,  ..., 0.0034, 0.0049, 0.0042],
          ...,
          [0.0033, 0.0031, 0.0040,  ..., 0.0023, 0.0043, 0.0042],
          [0.0033, 0.0039, 0.0039,  ..., 0.0036, 0.0036, 0.0038],
          [0.0048, 0.0042, 0.0032,  ..., 0.0032, 0.0031, 0.0050]],

         ...,

         [[0.0036, 0.0031, 0.0042,  ..., 0.0041, 0.0039, 0.0029],
          [0.0031, 0.0037, 0.0030,  ..., 0.0046, 0.0039, 0.0036],
          [0.0032, 0.0035, 0.0043,  ..., 0.0043, 0.0032, 0.0047],
          ...,
          [0.0031, 0.0038, 0.0049,  ..., 0.0046, 0.0030, 0.0035],
          [0.0030, 0.0049, 0.0049,  ..., 0.0036, 0.0038, 0.0036],
          [0.0038, 0.0035, 0.0035,  ..., 0.0044, 0.0037, 0.0034]],

         [[0.0031, 0.0062, 0.0041,  ..., 0.0051, 0.0035, 0.0037],
          [0.0050, 0.0035, 0.0031,  ..., 0.0037, 0.0053, 0.0029],
          [0.0046, 0.0038, 0.0048,  ..., 0.0061, 0.0034, 0.0052],
          ...,
          [0.0040, 0.0036, 0.0035,  ..., 0.0043, 0.0037, 0.0041],
          [0.0042, 0.0035, 0.0035,  ..., 0.0032, 0.0034, 0.0044],
          [0.0033, 0.0036, 0.0038,  ..., 0.0031, 0.0038, 0.0033]],

         [[0.0035, 0.0038, 0.0038,  ..., 0.0040, 0.0038, 0.0047],
          [0.0038, 0.0036, 0.0047,  ..., 0.0046, 0.0034, 0.0040],
          [0.0044, 0.0051, 0.0037,  ..., 0.0040, 0.0040, 0.0036],
          ...,
          [0.0038, 0.0030, 0.0044,  ..., 0.0033, 0.0039, 0.0038],
          [0.0031, 0.0030, 0.0037,  ..., 0.0050, 0.0037, 0.0039],
          [0.0039, 0.0047, 0.0039,  ..., 0.0044, 0.0047, 0.0037]]]]), modified_attrs={}, prev=None) 23346379597184 23346380510928
obj: tensor([[[[0.0038, 0.0037, 0.0042,  ..., 0.0034, 0.0043, 0.0041],
          [0.0041, 0.0037, 0.0036,  ..., 0.0051, 0.0041, 0.0028],
          [0.0046, 0.0030, 0.0040,  ..., 0.0035, 0.0043, 0.0030],
          ...,
          [0.0040, 0.0043, 0.0037,  ..., 0.0029, 0.0038, 0.0032],
          [0.0051, 0.0034, 0.0034,  ..., 0.0041, 0.0034, 0.0037],
          [0.0045, 0.0041, 0.0039,  ..., 0.0037, 0.0046, 0.0040]],

         [[0.0033, 0.0051, 0.0035,  ..., 0.0045, 0.0035, 0.0048],
          [0.0038, 0.0039, 0.0033,  ..., 0.0042, 0.0033, 0.0038],
          [0.0035, 0.0031, 0.0031,  ..., 0.0033, 0.0043, 0.0048],
          ...,
          [0.0035, 0.0052, 0.0033,  ..., 0.0046, 0.0033, 0.0027],
          [0.0049, 0.0031, 0.0038,  ..., 0.0034, 0.0041, 0.0043],
          [0.0030, 0.0035, 0.0041,  ..., 0.0038, 0.0041, 0.0034]],

         [[0.0026, 0.0044, 0.0036,  ..., 0.0036, 0.0044, 0.0041],
          [0.0034, 0.0025, 0.0032,  ..., 0.0039, 0.0040, 0.0039],
          [0.0036, 0.0044, 0.0041,  ..., 0.0034, 0.0049, 0.0042],
          ...,
          [0.0033, 0.0031, 0.0040,  ..., 0.0023, 0.0043, 0.0042],
          [0.0033, 0.0039, 0.0039,  ..., 0.0036, 0.0036, 0.0038],
          [0.0048, 0.0042, 0.0032,  ..., 0.0032, 0.0031, 0.0050]],

         ...,

         [[0.0036, 0.0031, 0.0042,  ..., 0.0041, 0.0039, 0.0029],
          [0.0031, 0.0037, 0.0030,  ..., 0.0046, 0.0039, 0.0036],
          [0.0032, 0.0035, 0.0043,  ..., 0.0043, 0.0032, 0.0047],
          ...,
          [0.0031, 0.0038, 0.0049,  ..., 0.0046, 0.0030, 0.0035],
          [0.0030, 0.0049, 0.0049,  ..., 0.0036, 0.0038, 0.0036],
          [0.0038, 0.0035, 0.0035,  ..., 0.0044, 0.0037, 0.0034]],

         [[0.0031, 0.0062, 0.0041,  ..., 0.0051, 0.0035, 0.0037],
          [0.0050, 0.0035, 0.0031,  ..., 0.0037, 0.0053, 0.0029],
          [0.0046, 0.0038, 0.0048,  ..., 0.0061, 0.0034, 0.0052],
          ...,
          [0.0040, 0.0036, 0.0035,  ..., 0.0043, 0.0037, 0.0041],
          [0.0042, 0.0035, 0.0035,  ..., 0.0032, 0.0034, 0.0044],
          [0.0033, 0.0036, 0.0038,  ..., 0.0031, 0.0038, 0.0033]],

         [[0.0035, 0.0038, 0.0038,  ..., 0.0040, 0.0038, 0.0047],
          [0.0038, 0.0036, 0.0047,  ..., 0.0046, 0.0034, 0.0040],
          [0.0044, 0.0051, 0.0037,  ..., 0.0040, 0.0040, 0.0036],
          ...,
          [0.0038, 0.0030, 0.0044,  ..., 0.0033, 0.0039, 0.0038],
          [0.0031, 0.0030, 0.0037,  ..., 0.0050, 0.0037, 0.0039],
          [0.0039, 0.0047, 0.0039,  ..., 0.0044, 0.0047, 0.0037]]]]) 23346380510928
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0038, 0.0037, 0.0042,  ..., 0.0034, 0.0043, 0.0041],
          [0.0041, 0.0037, 0.0036,  ..., 0.0051, 0.0041, 0.0028],
          [0.0046, 0.0030, 0.0040,  ..., 0.0035, 0.0043, 0.0030],
          ...,
          [0.0040, 0.0043, 0.0037,  ..., 0.0029, 0.0038, 0.0032],
          [0.0051, 0.0034, 0.0034,  ..., 0.0041, 0.0034, 0.0037],
          [0.0045, 0.0041, 0.0039,  ..., 0.0037, 0.0046, 0.0040]],

         [[0.0033, 0.0051, 0.0035,  ..., 0.0045, 0.0035, 0.0048],
          [0.0038, 0.0039, 0.0033,  ..., 0.0042, 0.0033, 0.0038],
          [0.0035, 0.0031, 0.0031,  ..., 0.0033, 0.0043, 0.0048],
          ...,
          [0.0035, 0.0052, 0.0033,  ..., 0.0046, 0.0033, 0.0027],
          [0.0049, 0.0031, 0.0038,  ..., 0.0034, 0.0041, 0.0043],
          [0.0030, 0.0035, 0.0041,  ..., 0.0038, 0.0041, 0.0034]],

         [[0.0026, 0.0044, 0.0036,  ..., 0.0036, 0.0044, 0.0041],
          [0.0034, 0.0025, 0.0032,  ..., 0.0039, 0.0040, 0.0039],
          [0.0036, 0.0044, 0.0041,  ..., 0.0034, 0.0049, 0.0042],
          ...,
          [0.0033, 0.0031, 0.0040,  ..., 0.0023, 0.0043, 0.0042],
          [0.0033, 0.0039, 0.0039,  ..., 0.0036, 0.0036, 0.0038],
          [0.0048, 0.0042, 0.0032,  ..., 0.0032, 0.0031, 0.0050]],

         ...,

         [[0.0036, 0.0031, 0.0042,  ..., 0.0041, 0.0039, 0.0029],
          [0.0031, 0.0037, 0.0030,  ..., 0.0046, 0.0039, 0.0036],
          [0.0032, 0.0035, 0.0043,  ..., 0.0043, 0.0032, 0.0047],
          ...,
          [0.0031, 0.0038, 0.0049,  ..., 0.0046, 0.0030, 0.0035],
          [0.0030, 0.0049, 0.0049,  ..., 0.0036, 0.0038, 0.0036],
          [0.0038, 0.0035, 0.0035,  ..., 0.0044, 0.0037, 0.0034]],

         [[0.0031, 0.0062, 0.0041,  ..., 0.0051, 0.0035, 0.0037],
          [0.0050, 0.0035, 0.0031,  ..., 0.0037, 0.0053, 0.0029],
          [0.0046, 0.0038, 0.0048,  ..., 0.0061, 0.0034, 0.0052],
          ...,
          [0.0040, 0.0036, 0.0035,  ..., 0.0043, 0.0037, 0.0041],
          [0.0042, 0.0035, 0.0035,  ..., 0.0032, 0.0034, 0.0044],
          [0.0033, 0.0036, 0.0038,  ..., 0.0031, 0.0038, 0.0033]],

         [[0.0035, 0.0038, 0.0038,  ..., 0.0040, 0.0038, 0.0047],
          [0.0038, 0.0036, 0.0047,  ..., 0.0046, 0.0034, 0.0040],
          [0.0044, 0.0051, 0.0037,  ..., 0.0040, 0.0040, 0.0036],
          ...,
          [0.0038, 0.0030, 0.0044,  ..., 0.0033, 0.0039, 0.0038],
          [0.0031, 0.0030, 0.0037,  ..., 0.0050, 0.0037, 0.0039],
          [0.0039, 0.0047, 0.0039,  ..., 0.0044, 0.0047, 0.0037]]]]), modified_attrs={}, prev=None) 23346379181936
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=492 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=534 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=536 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=538 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=540 frame=11(0x84f1ae0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=546 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=548 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=550 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=552 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=554 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=556 frame=11(0x84f1ae0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=560 frame=11(0x84f1ae0)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=566 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=568 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=570 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=572 frame=11(0x84f1ae0)
tracing opcode BUILD_SLICE None pc=574 frame=11(0x84f1ae0)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=578 frame=11(0x84f1ae0)
tracing opcode BINARY_ADD None pc=580 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=582 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=586 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=588 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=590 frame=11(0x84f1ae0)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_22 : [#users=1] = placeholder[target=tensor_22]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_22,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_26 : [#users=1] = placeholder[target=tensor_26]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_26, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_27 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_27, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_38 : [#users=1] = placeholder[target=tensor_38]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_38, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_39 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_39), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0x85052a0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0x85052a0)
tracing opcode LOAD_CONST None pc=46 frame=10(0x85052a0)
tracing opcode IS_OP None pc=48 frame=10(0x85052a0)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0x85052a0)
tracing opcode STORE_FAST None pc=54 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0x85052a0)
tracing opcode LOAD_METHOD None pc=58 frame=10(0x85052a0)
tracing opcode LOAD_FAST None pc=60 frame=10(0x85052a0)
tracing opcode LOAD_FAST None pc=62 frame=10(0x85052a0)
tracing opcode CALL_METHOD None pc=64 frame=10(0x85052a0)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_METHOD[0m(0, dense) 
2: [33mLOAD_FAST[0m(1, hidden_states) 
3: [33mCALL_METHOD[0m(1, 1) 
4: [33mSTORE_FAST[0m(1, hidden_states) 
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(1, dropout) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(2, LayerNorm) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_FAST[0m(2, input_tensor) 
14: [33mBINARY_ADD[0m(None, None) 
15: [33mCALL_METHOD[0m(1, 1) 
16: [33mSTORE_FAST[0m(1, hidden_states) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'NoneType'>, None), (<class 'int'>, 17), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bc0ad7040)
push tracker due to record
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bc0ad7040)
load fast: 23346654537952
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bc0ad7040)
load fast: 23346380904064
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bc0ad7040)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bc0ad7040)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bc0ad7040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346654536080
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346380303552
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_43 : [#users=0] = placeholder[target=tensor_43]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-0.0085, -0.0087, -0.0219,  ..., -0.0124,  0.0232,  0.0329],
         [-0.0014, -0.0097, -0.0242,  ..., -0.0050,  0.0191,  0.0311],
         [-0.0026, -0.0107, -0.0248,  ..., -0.0145,  0.0136,  0.0277],
         ...,
         [-0.0106, -0.0096, -0.0281,  ..., -0.0098,  0.0157,  0.0312],
         [ 0.0027, -0.0143, -0.0179,  ..., -0.0093,  0.0219,  0.0250],
         [-0.0085, -0.0018, -0.0195,  ..., -0.0161,  0.0193,  0.0258]]]), modified_attrs={}, prev=None) 23346378935888 23346380303552
obj: tensor([[[-0.0085, -0.0087, -0.0219,  ..., -0.0124,  0.0232,  0.0329],
         [-0.0014, -0.0097, -0.0242,  ..., -0.0050,  0.0191,  0.0311],
         [-0.0026, -0.0107, -0.0248,  ..., -0.0145,  0.0136,  0.0277],
         ...,
         [-0.0106, -0.0096, -0.0281,  ..., -0.0098,  0.0157,  0.0312],
         [ 0.0027, -0.0143, -0.0179,  ..., -0.0093,  0.0219,  0.0250],
         [-0.0085, -0.0018, -0.0195,  ..., -0.0161,  0.0193,  0.0258]]]) 23346380303552
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.0085, -0.0087, -0.0219,  ..., -0.0124,  0.0232,  0.0329],
         [-0.0014, -0.0097, -0.0242,  ..., -0.0050,  0.0191,  0.0311],
         [-0.0026, -0.0107, -0.0248,  ..., -0.0145,  0.0136,  0.0277],
         ...,
         [-0.0106, -0.0096, -0.0281,  ..., -0.0098,  0.0157,  0.0312],
         [ 0.0027, -0.0143, -0.0179,  ..., -0.0093,  0.0219,  0.0250],
         [-0.0085, -0.0018, -0.0195,  ..., -0.0161,  0.0193,  0.0258]]]), modified_attrs={}, prev=None) 23346379021280
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bc0ad7040)
load fast: 23346380865104
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bc0ad7040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bc0ad7040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153bc2c6b9f0)
push tracker due to record
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153bc2c6b9f0)
load fast: 23346378923440
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153bc2c6b9f0)
tracing opcode STORE_FAST None pc=14 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153bc2c6b9f0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bc09f5db0>
tracing opcode STORE_FAST None pc=36 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153bc2c6b9f0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bc0a02d60>
tracing opcode STORE_FAST None pc=60 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153bc2c6b9f0)
load fast: 23346654537328
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153bc2c6b9f0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153bc2c6b9f0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_45 : [#users=4] = placeholder[target=tensor_45]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_45,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_45, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_45, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_45, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153bc09f5db0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bc0ad7040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_42 : [#users=1] = placeholder[target=tensor_42]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_42,), kwargs = {})
    %tensor_44 : [#users=1] = placeholder[target=tensor_44]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_44), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0x85052a0)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0x85052a0)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0x85052a0)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_19 : [#users=2] = placeholder[target=tensor_19]
    %tensor_20 : [#users=1] = placeholder[target=tensor_20]
    %tensor_21 : [#users=1] = placeholder[target=tensor_21]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_19,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_21, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_27 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_27, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_20, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_39 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_39), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_19), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0x85052a0)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0x85010f0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0x85010f0)
tracing opcode LOAD_METHOD None pc=46 frame=9(0x85010f0)
tracing opcode LOAD_FAST None pc=48 frame=9(0x85010f0)
tracing opcode CALL_METHOD None pc=50 frame=9(0x85010f0)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_METHOD[0m(0, dense) 
2: [33mLOAD_FAST[0m(1, hidden_states) 
3: [33mCALL_METHOD[0m(1, 1) 
4: [33mSTORE_FAST[0m(1, hidden_states) 
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(1, hidden_states) 
11: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'NoneType'>, None), (<class 'int'>, 18), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x86b7920)
push tracker due to record
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x86b7920)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x86b7920)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x86b7920)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x86b7920)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x86b7920)
load fast: 23346654539008
tracing opcode LOAD_METHOD None pc=12 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=14 frame=18(0x86b7920)
load fast: 23346378922560
tracing opcode CALL_METHOD None pc=16 frame=18(0x86b7920)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x86b7920)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=24 frame=18(0x86b7920)
tracing opcode CALL_METHOD None pc=26 frame=18(0x86b7920)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_METHOD[0m(0, act) 
2: [33mLOAD_FAST[0m(1, input) 
3: [33mCALL_METHOD[0m(1, 1) 
4: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'NoneType'>, None), (<class 'int'>, 19), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0x7dd42f0)
push tracker due to record
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0x7dd42f0)
load fast: 23346654538288
tracing opcode LOAD_METHOD None pc=12 frame=19(0x7dd42f0)
tracing opcode LOAD_FAST None pc=14 frame=19(0x7dd42f0)
load fast: 23346305617984
tracing opcode CALL_METHOD None pc=16 frame=19(0x7dd42f0)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_47 : [#users=1] = placeholder[target=tensor_47]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_47,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x86b7920)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x86b7920)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_46 : [#users=1] = placeholder[target=tensor_46]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_46,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x86b7920)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0x85010f0)
tracing opcode LOAD_METHOD None pc=56 frame=9(0x85010f0)
tracing opcode LOAD_FAST None pc=58 frame=9(0x85010f0)
tracing opcode LOAD_FAST None pc=60 frame=9(0x85010f0)
tracing opcode CALL_METHOD None pc=62 frame=9(0x85010f0)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
new bytecode: 

0: [33mLOAD_FAST[0m(0, self) 
1: [33mLOAD_METHOD[0m(0, dense) 
2: [33mLOAD_FAST[0m(1, hidden_states) 
3: [33mCALL_METHOD[0m(1, 1) 
4: [33mSTORE_FAST[0m(1, hidden_states) 
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(1, dropout) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(2, LayerNorm) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_FAST[0m(2, input_tensor) 
14: [33mBINARY_ADD[0m(None, None) 
15: [33mCALL_METHOD[0m(1, 1) 
16: [33mSTORE_FAST[0m(1, hidden_states) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'NoneType'>, None), (<class 'int'>, 20), (<class 'int'>, 0)]
guarded code
0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x153bc0a3a040)
push tracker due to record
push tracker 20 frame 0x153bc0a3a040 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x153bc0a3a040 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x153bc0a3a040)
load fast: 23346654539392
tracing opcode LOAD_METHOD None pc=12 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=14 frame=20(0x153bc0a3a040)
load fast: 23346305667216
tracing opcode CALL_METHOD None pc=16 frame=20(0x153bc0a3a040)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x153bc0a3a040)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=24 frame=20(0x153bc0a3a040)
tracing opcode CALL_METHOD None pc=26 frame=20(0x153bc0a3a040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346654538000
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346305620464
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_49 : [#users=0] = placeholder[target=tensor_49]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.1023, -0.0269,  0.1353,  ..., -0.4565,  0.2736,  0.3277],
         [-0.5779, -0.1118, -0.1157,  ...,  0.1261,  0.3733, -0.2070],
         [-0.1756, -0.6195, -0.1062,  ..., -0.2487, -0.6641,  0.2832],
         ...,
         [-0.5134,  0.0451, -0.5521,  ...,  0.0105,  0.0384,  0.2311],
         [-0.4795,  0.1027, -0.1683,  ...,  0.3099, -0.0504, -0.0868],
         [-0.5576, -0.6940,  0.0457,  ..., -0.2849,  0.2713,  0.3301]]]), modified_attrs={}, prev=None) 23346305700720 23346305620464
obj: tensor([[[ 0.1023, -0.0269,  0.1353,  ..., -0.4565,  0.2736,  0.3277],
         [-0.5779, -0.1118, -0.1157,  ...,  0.1261,  0.3733, -0.2070],
         [-0.1756, -0.6195, -0.1062,  ..., -0.2487, -0.6641,  0.2832],
         ...,
         [-0.5134,  0.0451, -0.5521,  ...,  0.0105,  0.0384,  0.2311],
         [-0.4795,  0.1027, -0.1683,  ...,  0.3099, -0.0504, -0.0868],
         [-0.5576, -0.6940,  0.0457,  ..., -0.2849,  0.2713,  0.3301]]]) 23346305620464
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.1023, -0.0269,  0.1353,  ..., -0.4565,  0.2736,  0.3277],
         [-0.5779, -0.1118, -0.1157,  ...,  0.1261,  0.3733, -0.2070],
         [-0.1756, -0.6195, -0.1062,  ..., -0.2487, -0.6641,  0.2832],
         ...,
         [-0.5134,  0.0451, -0.5521,  ...,  0.0105,  0.0384,  0.2311],
         [-0.4795,  0.1027, -0.1683,  ...,  0.3099, -0.0504, -0.0868],
         [-0.5576, -0.6940,  0.0457,  ..., -0.2849,  0.2713,  0.3301]]]), modified_attrs={}, prev=None) 23346305598752
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x153bc0a3a040)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=34 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=36 frame=20(0x153bc0a3a040)
load fast: 23346378922560
tracing opcode BINARY_ADD None pc=38 frame=20(0x153bc0a3a040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x153bc0a3a040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x84d9090)
push tracker due to record
push tracker 2 frame 0x84d9090 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x84d9090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x84d9090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0x84d9090 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x84d9090)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x84d9090)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x84d9090)
load fast: 23346305670096
tracing opcode LOAD_ATTR None pc=12 frame=2(0x84d9090)
tracing opcode STORE_FAST None pc=14 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x84d9090)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x84d9090)
tracing opcode CALL_METHOD None pc=20 frame=2(0x84d9090)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x84d9090)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=28 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=30 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=32 frame=2(0x84d9090)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x84d9090)
record function in graph <built-in method mean of Tensor object at 0x153bbc419bd0>
tracing opcode STORE_FAST None pc=36 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=40 frame=2(0x84d9090)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x84d9090)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=46 frame=2(0x84d9090)
tracing opcode CALL_METHOD None pc=48 frame=2(0x84d9090)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=52 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=54 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=56 frame=2(0x84d9090)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x84d9090)
record function in graph <built-in method mean of Tensor object at 0x153bbc419f40>
tracing opcode STORE_FAST None pc=60 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=64 frame=2(0x84d9090)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x84d9090)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x84d9090)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=72 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=74 frame=2(0x84d9090)
load fast: 23346654538336
tracing opcode LOAD_ATTR None pc=76 frame=2(0x84d9090)
tracing opcode BINARY_ADD None pc=78 frame=2(0x84d9090)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x84d9090)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x84d9090)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x84d9090)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=90 frame=2(0x84d9090)
tracing opcode CALL_METHOD None pc=92 frame=2(0x84d9090)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x84d9090)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=100 frame=2(0x84d9090)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x84d9090)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x84d9090)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x84d9090)
tracing opcode BINARY_ADD None pc=108 frame=2(0x84d9090)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x84d9090)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x84d9090)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_51 : [#users=4] = placeholder[target=tensor_51]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_51,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_51, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_51, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_51, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153bbc419bd0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x84d9090)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x153bc0a3a040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_48 : [#users=1] = placeholder[target=tensor_48]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_48,), kwargs = {})
    %tensor_50 : [#users=1] = placeholder[target=tensor_50]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_50), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0x85010f0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0x85010f0)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0x85010f0)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_16 : [#users=2] = placeholder[target=tensor_16]
    %tensor_17 : [#users=1] = placeholder[target=tensor_17]
    %tensor_18 : [#users=1] = placeholder[target=tensor_18]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_16,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_18, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_27 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_27, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_17, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_39 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_39), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_16), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0x85010f0)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0x8c6fb30)
push tracker due to record
push tracker 9 frame 0x8c6fb30 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0x8c6fb30)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0x8c6fb30)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0x8c6fb30 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0x8c6fb30)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0x8c6fb30)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0x8c6fb30)
load fast: 23346654539344
tracing opcode LOAD_ATTR None pc=12 frame=9(0x8c6fb30)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0x8c6fb30)
load fast: 23346305719008
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0x8c6fb30)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0x8c6fb30)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0x8c6fb30)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0x8c6fb30)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0x8c6fb30)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0x8c6fb30)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0x8c6fb30)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0x84f6f40)
push tracker due to record
push tracker 10 frame 0x84f6f40 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0x84f6f40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0x84f6f40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0x84f6f40 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0x84f6f40)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0x84f6f40)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0x84f6f40)
load fast: 23346654538384
tracing opcode LOAD_ATTR None pc=12 frame=10(0x84f6f40)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0x84f6f40)
load fast: 23346305719008
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0x84f6f40)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0x84f6f40)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0x84f6f40)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0x84f6f40)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0x84f6f40)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0x84f6f40)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0x84f6f40)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0x8c6d070)
push tracker due to record
push tracker 11 frame 0x8c6d070 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0x8c6d070)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0x8c6d070)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0x8c6d070 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0x8c6d070)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0x8c6d070)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0x8c6d070)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0x8c6d070)
tracing opcode IS_OP None pc=16 frame=11(0x8c6d070)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0x8c6d070)
load fast: 23346654538192
tracing opcode LOAD_METHOD None pc=22 frame=11(0x8c6d070)
tracing opcode LOAD_DEREF None pc=24 frame=11(0x8c6d070)
load fast: 23346305719008
tracing opcode CALL_METHOD None pc=26 frame=11(0x8c6d070)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=32 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=34 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=36 frame=11(0x8c6d070)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346057709344
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346654538192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_59 : [#users=1] = placeholder[target=tensor_59]
    %view : [#users=1] = call_method[target=view](args = (%tensor_59, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=40 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=42 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=44 frame=11(0x8c6d070)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0x8c6d070)
record function in graph <built-in method chunk of Tensor object at 0x153bad78ad60>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0x8c6d070)
tracing opcode STORE_FAST None pc=50 frame=11(0x8c6d070)
tracing opcode STORE_FAST None pc=52 frame=11(0x8c6d070)
tracing opcode STORE_FAST None pc=54 frame=11(0x8c6d070)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0x8c6d070)
tracing opcode LOAD_DEREF None pc=224 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=226 frame=11(0x8c6d070)
tracing opcode LOAD_DEREF None pc=228 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=230 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=232 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=234 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=236 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=238 frame=11(0x8c6d070)
tracing opcode BUILD_SLICE None pc=240 frame=11(0x8c6d070)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0x8c6d070)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0x8c6d070)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0x8c6d070)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346057701952
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346654538192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_60 : [#users=1] = placeholder[target=tensor_60]
    %view : [#users=1] = call_method[target=view](args = (%tensor_60, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0x8c6d070)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0x8c6d070)
tracing opcode LOAD_DEREF None pc=254 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=256 frame=11(0x8c6d070)
tracing opcode LOAD_DEREF None pc=258 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=260 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=262 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=264 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=266 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=268 frame=11(0x8c6d070)
tracing opcode BUILD_SLICE None pc=270 frame=11(0x8c6d070)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0x8c6d070)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0x8c6d070)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0x8c6d070)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346305668736
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346654538192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_61 : [#users=1] = placeholder[target=tensor_61]
    %view : [#users=1] = call_method[target=view](args = (%tensor_61, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0x8c6d070)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0x8c6d070)
tracing opcode STORE_FAST None pc=284 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0x8c6d070)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0x8c6d070)
tracing opcode LOAD_DEREF None pc=290 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=292 frame=11(0x8c6d070)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0x8c6d070)
tracing opcode BINARY_ADD None pc=296 frame=11(0x8c6d070)
tracing opcode STORE_FAST None pc=298 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=302 frame=11(0x8c6d070)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=306 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=308 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=310 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=312 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=314 frame=11(0x8c6d070)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=318 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=320 frame=11(0x8c6d070)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0x8c6d070)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0x8c6d070)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0x8c6d070)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0x8c6d070)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=334 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=336 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=338 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=340 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=342 frame=11(0x8c6d070)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0x8c6d070)
record function in graph <built-in method to of Tensor object at 0x153bad74ba40>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0x8c6d070)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=352 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=354 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=356 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=358 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=360 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=362 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=364 frame=11(0x8c6d070)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0x8c6d070)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=372 frame=11(0x8c6d070)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=380 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=382 frame=11(0x8c6d070)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0x8c6d070)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346654538048
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=390 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=392 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=394 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=396 frame=11(0x8c6d070)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=400 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=402 frame=11(0x8c6d070)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0x86a0f90)
push tracker due to record
push tracker 13 frame 0x86a0f90 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0x86a0f90)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0x86a0f90)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0x86a0f90 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0x86a0f90)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0x86a0f90)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0x86a0f90)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0x86a0f90)
tracing opcode IS_OP None pc=16 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=52 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=54 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=56 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=58 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=82 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=84 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=86 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=88 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=94 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=96 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=98 frame=13(0x86a0f90)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0x86a0f90)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=138 frame=13(0x86a0f90)
load fast: 23346378975008
tracing opcode LOAD_METHOD None pc=140 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=142 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=144 frame=13(0x86a0f90)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0x86a0f90)
load fast: 23346305621584
tracing opcode LOAD_METHOD None pc=148 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=150 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=152 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=156 frame=13(0x86a0f90)
load fast: 23346654538192
tracing opcode LOAD_ATTR None pc=158 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=162 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=166 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=168 frame=13(0x86a0f90)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=172 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=174 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=176 frame=13(0x86a0f90)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0x86a0f90)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=184 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=186 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=190 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=192 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=194 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=196 frame=13(0x86a0f90)
tracing opcode BUILD_SLICE None pc=198 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=200 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=202 frame=13(0x86a0f90)
tracing opcode BUILD_SLICE None pc=204 frame=13(0x86a0f90)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0x86a0f90)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0x86a0f90)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=220 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=224 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=226 frame=13(0x86a0f90)
tracing opcode CONTAINS_OP None pc=228 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=236 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=238 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=240 frame=13(0x86a0f90)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=246 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=248 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=250 frame=13(0x86a0f90)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346057265776
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346654538192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_66 : [#users=1] = placeholder[target=tensor_66]
    %view : [#users=1] = call_method[target=view](args = (%tensor_66, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=256 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=258 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=260 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=262 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=264 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=266 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=268 frame=13(0x86a0f90)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0x86a0f90)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=276 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=278 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=280 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=282 frame=13(0x86a0f90)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=286 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=288 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=292 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=296 frame=13(0x86a0f90)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=302 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=304 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=306 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=310 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=312 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=314 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0x86a0f90)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23346057327696
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23346378975008
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23346057237664
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_67 : [#users=1] = placeholder[target=tensor_67]
    %tensor_68 : [#users=0] = placeholder[target=tensor_68]
    %tensor_69 : [#users=0] = placeholder[target=tensor_69]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_67, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0x86a0f90)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=326 frame=13(0x86a0f90)
tracing opcode INPLACE_ADD None pc=328 frame=13(0x86a0f90)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=334 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=336 frame=13(0x86a0f90)
tracing opcode CONTAINS_OP None pc=338 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=346 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=348 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=350 frame=13(0x86a0f90)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=356 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=358 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=360 frame=13(0x86a0f90)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346057450016
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346654538192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_70 : [#users=1] = placeholder[target=tensor_70]
    %view : [#users=1] = call_method[target=view](args = (%tensor_70, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=368 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=372 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=374 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=376 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=378 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=380 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=384 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=386 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0x86a0f90)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0x86a0f90)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0x86a0f90)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0x86a0f90)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=402 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=404 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=406 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=408 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=410 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=412 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=414 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=416 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=452 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=456 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=458 frame=13(0x86a0f90)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0x86a0f90)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=464 frame=13(0x86a0f90)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=468 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=470 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=474 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=478 frame=13(0x86a0f90)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=484 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=486 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=488 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=490 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=492 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=494 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=496 frame=13(0x86a0f90)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=500 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=502 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=504 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0x86a0f90)
record function in graph <built-in method to of Tensor object at 0x153bad761310>
tracing opcode CALL_METHOD None pc=508 frame=13(0x86a0f90)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=514 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=518 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=522 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=524 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=526 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0x86a0f90)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23346057328336
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23346378975008
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23346305621584
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_71 : [#users=1] = placeholder[target=tensor_71]
    %tensor_72 : [#users=0] = placeholder[target=tensor_72]
    %tensor_73 : [#users=0] = placeholder[target=tensor_73]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_71, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0x86a0f90)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=538 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0x86a0f90)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=546 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=548 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=550 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=552 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=554 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=556 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=558 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=560 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=626 frame=13(0x86a0f90)
tracing opcode INPLACE_ADD None pc=628 frame=13(0x86a0f90)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0x86a0f90)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_63 : [#users=1] = placeholder[target=tensor_63]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_63, 1), kwargs = {})
    %tensor_64 : [#users=1] = placeholder[target=tensor_64]
    %tensor_65 : [#users=1] = placeholder[target=tensor_65]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_64, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_65, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0x86a0f90)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=408 frame=11(0x8c6d070)
tracing opcode IS_OP None pc=410 frame=11(0x8c6d070)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=418 frame=11(0x8c6d070)
tracing opcode BINARY_ADD None pc=420 frame=11(0x8c6d070)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=426 frame=11(0x8c6d070)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=468 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=470 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=472 frame=11(0x8c6d070)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=476 frame=11(0x8c6d070)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b4f0> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654852336
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b4f0> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23346057223520
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_75 : [#users=1] = placeholder[target=tensor_75]
    %to : [#users=1] = call_method[target=to](args = (%tensor_75, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_76 : [#users=1] = placeholder[target=tensor_76]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_76, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=482 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=484 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=486 frame=11(0x8c6d070)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346654537280
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346057204496
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_77 : [#users=0] = placeholder[target=tensor_77]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0036, 0.0040, 0.0039,  ..., 0.0035, 0.0032, 0.0027],
          [0.0032, 0.0034, 0.0036,  ..., 0.0040, 0.0034, 0.0036],
          [0.0042, 0.0037, 0.0039,  ..., 0.0041, 0.0042, 0.0044],
          ...,
          [0.0030, 0.0026, 0.0030,  ..., 0.0037, 0.0036, 0.0041],
          [0.0033, 0.0037, 0.0042,  ..., 0.0045, 0.0044, 0.0039],
          [0.0053, 0.0032, 0.0039,  ..., 0.0041, 0.0033, 0.0040]],

         [[0.0036, 0.0032, 0.0044,  ..., 0.0048, 0.0036, 0.0045],
          [0.0048, 0.0054, 0.0038,  ..., 0.0040, 0.0041, 0.0046],
          [0.0034, 0.0047, 0.0048,  ..., 0.0044, 0.0040, 0.0050],
          ...,
          [0.0045, 0.0034, 0.0028,  ..., 0.0036, 0.0051, 0.0043],
          [0.0045, 0.0036, 0.0045,  ..., 0.0043, 0.0044, 0.0040],
          [0.0027, 0.0037, 0.0035,  ..., 0.0031, 0.0036, 0.0037]],

         [[0.0037, 0.0041, 0.0033,  ..., 0.0034, 0.0042, 0.0040],
          [0.0039, 0.0030, 0.0028,  ..., 0.0035, 0.0034, 0.0046],
          [0.0036, 0.0038, 0.0044,  ..., 0.0038, 0.0047, 0.0042],
          ...,
          [0.0047, 0.0034, 0.0027,  ..., 0.0036, 0.0043, 0.0049],
          [0.0039, 0.0047, 0.0037,  ..., 0.0038, 0.0045, 0.0024],
          [0.0029, 0.0056, 0.0037,  ..., 0.0047, 0.0044, 0.0035]],

         ...,

         [[0.0031, 0.0029, 0.0039,  ..., 0.0044, 0.0039, 0.0040],
          [0.0049, 0.0030, 0.0041,  ..., 0.0036, 0.0034, 0.0046],
          [0.0038, 0.0040, 0.0027,  ..., 0.0034, 0.0048, 0.0044],
          ...,
          [0.0032, 0.0045, 0.0043,  ..., 0.0034, 0.0038, 0.0042],
          [0.0038, 0.0034, 0.0061,  ..., 0.0038, 0.0042, 0.0040],
          [0.0043, 0.0038, 0.0030,  ..., 0.0035, 0.0033, 0.0041]],

         [[0.0037, 0.0035, 0.0027,  ..., 0.0048, 0.0031, 0.0033],
          [0.0040, 0.0048, 0.0042,  ..., 0.0049, 0.0037, 0.0031],
          [0.0039, 0.0038, 0.0030,  ..., 0.0031, 0.0039, 0.0037],
          ...,
          [0.0043, 0.0039, 0.0037,  ..., 0.0041, 0.0039, 0.0039],
          [0.0034, 0.0039, 0.0033,  ..., 0.0032, 0.0040, 0.0040],
          [0.0037, 0.0045, 0.0037,  ..., 0.0042, 0.0045, 0.0035]],

         [[0.0038, 0.0039, 0.0033,  ..., 0.0036, 0.0034, 0.0043],
          [0.0055, 0.0039, 0.0032,  ..., 0.0035, 0.0046, 0.0036],
          [0.0027, 0.0048, 0.0033,  ..., 0.0042, 0.0040, 0.0039],
          ...,
          [0.0026, 0.0043, 0.0033,  ..., 0.0039, 0.0037, 0.0050],
          [0.0039, 0.0035, 0.0033,  ..., 0.0053, 0.0047, 0.0039],
          [0.0043, 0.0033, 0.0048,  ..., 0.0038, 0.0035, 0.0038]]]]), modified_attrs={}, prev=None) 23346057107536 23346057204496
obj: tensor([[[[0.0036, 0.0040, 0.0039,  ..., 0.0035, 0.0032, 0.0027],
          [0.0032, 0.0034, 0.0036,  ..., 0.0040, 0.0034, 0.0036],
          [0.0042, 0.0037, 0.0039,  ..., 0.0041, 0.0042, 0.0044],
          ...,
          [0.0030, 0.0026, 0.0030,  ..., 0.0037, 0.0036, 0.0041],
          [0.0033, 0.0037, 0.0042,  ..., 0.0045, 0.0044, 0.0039],
          [0.0053, 0.0032, 0.0039,  ..., 0.0041, 0.0033, 0.0040]],

         [[0.0036, 0.0032, 0.0044,  ..., 0.0048, 0.0036, 0.0045],
          [0.0048, 0.0054, 0.0038,  ..., 0.0040, 0.0041, 0.0046],
          [0.0034, 0.0047, 0.0048,  ..., 0.0044, 0.0040, 0.0050],
          ...,
          [0.0045, 0.0034, 0.0028,  ..., 0.0036, 0.0051, 0.0043],
          [0.0045, 0.0036, 0.0045,  ..., 0.0043, 0.0044, 0.0040],
          [0.0027, 0.0037, 0.0035,  ..., 0.0031, 0.0036, 0.0037]],

         [[0.0037, 0.0041, 0.0033,  ..., 0.0034, 0.0042, 0.0040],
          [0.0039, 0.0030, 0.0028,  ..., 0.0035, 0.0034, 0.0046],
          [0.0036, 0.0038, 0.0044,  ..., 0.0038, 0.0047, 0.0042],
          ...,
          [0.0047, 0.0034, 0.0027,  ..., 0.0036, 0.0043, 0.0049],
          [0.0039, 0.0047, 0.0037,  ..., 0.0038, 0.0045, 0.0024],
          [0.0029, 0.0056, 0.0037,  ..., 0.0047, 0.0044, 0.0035]],

         ...,

         [[0.0031, 0.0029, 0.0039,  ..., 0.0044, 0.0039, 0.0040],
          [0.0049, 0.0030, 0.0041,  ..., 0.0036, 0.0034, 0.0046],
          [0.0038, 0.0040, 0.0027,  ..., 0.0034, 0.0048, 0.0044],
          ...,
          [0.0032, 0.0045, 0.0043,  ..., 0.0034, 0.0038, 0.0042],
          [0.0038, 0.0034, 0.0061,  ..., 0.0038, 0.0042, 0.0040],
          [0.0043, 0.0038, 0.0030,  ..., 0.0035, 0.0033, 0.0041]],

         [[0.0037, 0.0035, 0.0027,  ..., 0.0048, 0.0031, 0.0033],
          [0.0040, 0.0048, 0.0042,  ..., 0.0049, 0.0037, 0.0031],
          [0.0039, 0.0038, 0.0030,  ..., 0.0031, 0.0039, 0.0037],
          ...,
          [0.0043, 0.0039, 0.0037,  ..., 0.0041, 0.0039, 0.0039],
          [0.0034, 0.0039, 0.0033,  ..., 0.0032, 0.0040, 0.0040],
          [0.0037, 0.0045, 0.0037,  ..., 0.0042, 0.0045, 0.0035]],

         [[0.0038, 0.0039, 0.0033,  ..., 0.0036, 0.0034, 0.0043],
          [0.0055, 0.0039, 0.0032,  ..., 0.0035, 0.0046, 0.0036],
          [0.0027, 0.0048, 0.0033,  ..., 0.0042, 0.0040, 0.0039],
          ...,
          [0.0026, 0.0043, 0.0033,  ..., 0.0039, 0.0037, 0.0050],
          [0.0039, 0.0035, 0.0033,  ..., 0.0053, 0.0047, 0.0039],
          [0.0043, 0.0033, 0.0048,  ..., 0.0038, 0.0035, 0.0038]]]]) 23346057204496
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0036, 0.0040, 0.0039,  ..., 0.0035, 0.0032, 0.0027],
          [0.0032, 0.0034, 0.0036,  ..., 0.0040, 0.0034, 0.0036],
          [0.0042, 0.0037, 0.0039,  ..., 0.0041, 0.0042, 0.0044],
          ...,
          [0.0030, 0.0026, 0.0030,  ..., 0.0037, 0.0036, 0.0041],
          [0.0033, 0.0037, 0.0042,  ..., 0.0045, 0.0044, 0.0039],
          [0.0053, 0.0032, 0.0039,  ..., 0.0041, 0.0033, 0.0040]],

         [[0.0036, 0.0032, 0.0044,  ..., 0.0048, 0.0036, 0.0045],
          [0.0048, 0.0054, 0.0038,  ..., 0.0040, 0.0041, 0.0046],
          [0.0034, 0.0047, 0.0048,  ..., 0.0044, 0.0040, 0.0050],
          ...,
          [0.0045, 0.0034, 0.0028,  ..., 0.0036, 0.0051, 0.0043],
          [0.0045, 0.0036, 0.0045,  ..., 0.0043, 0.0044, 0.0040],
          [0.0027, 0.0037, 0.0035,  ..., 0.0031, 0.0036, 0.0037]],

         [[0.0037, 0.0041, 0.0033,  ..., 0.0034, 0.0042, 0.0040],
          [0.0039, 0.0030, 0.0028,  ..., 0.0035, 0.0034, 0.0046],
          [0.0036, 0.0038, 0.0044,  ..., 0.0038, 0.0047, 0.0042],
          ...,
          [0.0047, 0.0034, 0.0027,  ..., 0.0036, 0.0043, 0.0049],
          [0.0039, 0.0047, 0.0037,  ..., 0.0038, 0.0045, 0.0024],
          [0.0029, 0.0056, 0.0037,  ..., 0.0047, 0.0044, 0.0035]],

         ...,

         [[0.0031, 0.0029, 0.0039,  ..., 0.0044, 0.0039, 0.0040],
          [0.0049, 0.0030, 0.0041,  ..., 0.0036, 0.0034, 0.0046],
          [0.0038, 0.0040, 0.0027,  ..., 0.0034, 0.0048, 0.0044],
          ...,
          [0.0032, 0.0045, 0.0043,  ..., 0.0034, 0.0038, 0.0042],
          [0.0038, 0.0034, 0.0061,  ..., 0.0038, 0.0042, 0.0040],
          [0.0043, 0.0038, 0.0030,  ..., 0.0035, 0.0033, 0.0041]],

         [[0.0037, 0.0035, 0.0027,  ..., 0.0048, 0.0031, 0.0033],
          [0.0040, 0.0048, 0.0042,  ..., 0.0049, 0.0037, 0.0031],
          [0.0039, 0.0038, 0.0030,  ..., 0.0031, 0.0039, 0.0037],
          ...,
          [0.0043, 0.0039, 0.0037,  ..., 0.0041, 0.0039, 0.0039],
          [0.0034, 0.0039, 0.0033,  ..., 0.0032, 0.0040, 0.0040],
          [0.0037, 0.0045, 0.0037,  ..., 0.0042, 0.0045, 0.0035]],

         [[0.0038, 0.0039, 0.0033,  ..., 0.0036, 0.0034, 0.0043],
          [0.0055, 0.0039, 0.0032,  ..., 0.0035, 0.0046, 0.0036],
          [0.0027, 0.0048, 0.0033,  ..., 0.0042, 0.0040, 0.0039],
          ...,
          [0.0026, 0.0043, 0.0033,  ..., 0.0039, 0.0037, 0.0050],
          [0.0039, 0.0035, 0.0033,  ..., 0.0053, 0.0047, 0.0039],
          [0.0043, 0.0033, 0.0048,  ..., 0.0038, 0.0035, 0.0038]]]]), modified_attrs={}, prev=None) 23346057066096
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0x8c6d070)
tracing opcode LOAD_ATTR None pc=492 frame=11(0x8c6d070)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=534 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=536 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=538 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=540 frame=11(0x8c6d070)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=546 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=548 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=550 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=552 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=554 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=556 frame=11(0x8c6d070)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=560 frame=11(0x8c6d070)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=566 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=568 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=570 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=572 frame=11(0x8c6d070)
tracing opcode BUILD_SLICE None pc=574 frame=11(0x8c6d070)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0x8c6d070)
tracing opcode LOAD_CONST None pc=578 frame=11(0x8c6d070)
tracing opcode BINARY_ADD None pc=580 frame=11(0x8c6d070)
tracing opcode STORE_FAST None pc=582 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0x8c6d070)
tracing opcode LOAD_METHOD None pc=586 frame=11(0x8c6d070)
tracing opcode LOAD_FAST None pc=588 frame=11(0x8c6d070)
tracing opcode CALL_METHOD None pc=590 frame=11(0x8c6d070)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0x8c6d070)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0x8c6d070)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0x8c6d070)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0x8c6d070)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_58 : [#users=1] = placeholder[target=tensor_58]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_58,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_62 : [#users=1] = placeholder[target=tensor_62]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_62, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_63 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_63, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_74 : [#users=1] = placeholder[target=tensor_74]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_74, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_75 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_75), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0x8c6d070)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0x84f6f40)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0x84f6f40)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0x84f6f40)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0x84f6f40)
tracing opcode LOAD_CONST None pc=46 frame=10(0x84f6f40)
tracing opcode IS_OP None pc=48 frame=10(0x84f6f40)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0x84f6f40)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0x84f6f40)
tracing opcode STORE_FAST None pc=54 frame=10(0x84f6f40)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0x84f6f40)
tracing opcode LOAD_METHOD None pc=58 frame=10(0x84f6f40)
tracing opcode LOAD_FAST None pc=60 frame=10(0x84f6f40)
tracing opcode LOAD_FAST None pc=62 frame=10(0x84f6f40)
tracing opcode CALL_METHOD None pc=64 frame=10(0x84f6f40)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bc0ad7040)
push tracker due to record
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bc0ad7040)
load fast: 23346654536800
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bc0ad7040)
load fast: 23346057206816
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bc0ad7040)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bc0ad7040)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bc0ad7040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416249056
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346056959136
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_79 : [#users=0] = placeholder[target=tensor_79]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-0.0302, -0.0773,  0.0260,  ..., -0.0301,  0.0116,  0.0067],
         [-0.0346, -0.0781,  0.0258,  ..., -0.0269,  0.0065, -0.0011],
         [-0.0274, -0.0710,  0.0198,  ..., -0.0328,  0.0125,  0.0003],
         ...,
         [-0.0269, -0.0730,  0.0263,  ..., -0.0251,  0.0106,  0.0013],
         [-0.0285, -0.0756,  0.0245,  ..., -0.0227,  0.0066, -0.0063],
         [-0.0253, -0.0696,  0.0215,  ..., -0.0295,  0.0071,  0.0015]]]), modified_attrs={}, prev=None) 23346056954592 23346056959136
obj: tensor([[[-0.0302, -0.0773,  0.0260,  ..., -0.0301,  0.0116,  0.0067],
         [-0.0346, -0.0781,  0.0258,  ..., -0.0269,  0.0065, -0.0011],
         [-0.0274, -0.0710,  0.0198,  ..., -0.0328,  0.0125,  0.0003],
         ...,
         [-0.0269, -0.0730,  0.0263,  ..., -0.0251,  0.0106,  0.0013],
         [-0.0285, -0.0756,  0.0245,  ..., -0.0227,  0.0066, -0.0063],
         [-0.0253, -0.0696,  0.0215,  ..., -0.0295,  0.0071,  0.0015]]]) 23346056959136
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.0302, -0.0773,  0.0260,  ..., -0.0301,  0.0116,  0.0067],
         [-0.0346, -0.0781,  0.0258,  ..., -0.0269,  0.0065, -0.0011],
         [-0.0274, -0.0710,  0.0198,  ..., -0.0328,  0.0125,  0.0003],
         ...,
         [-0.0269, -0.0730,  0.0263,  ..., -0.0251,  0.0106,  0.0013],
         [-0.0285, -0.0756,  0.0245,  ..., -0.0227,  0.0066, -0.0063],
         [-0.0253, -0.0696,  0.0215,  ..., -0.0295,  0.0071,  0.0015]]]), modified_attrs={}, prev=None) 23346056956320
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bc0ad7040)
load fast: 23346305719008
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bc0ad7040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bc0ad7040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153bc2c6b9f0)
push tracker due to record
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153bc2c6b9f0)
load fast: 23346056960176
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153bc2c6b9f0)
tracing opcode STORE_FAST None pc=14 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153bc2c6b9f0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bad6e98b0>
tracing opcode STORE_FAST None pc=36 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153bc2c6b9f0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bad6aed10>
tracing opcode STORE_FAST None pc=60 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153bc2c6b9f0)
load fast: 23346654537664
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153bc2c6b9f0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153bc2c6b9f0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_81 : [#users=4] = placeholder[target=tensor_81]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_81,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_81, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_81, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_81, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153bad6e98b0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bc0ad7040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_78 : [#users=1] = placeholder[target=tensor_78]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_78,), kwargs = {})
    %tensor_80 : [#users=1] = placeholder[target=tensor_80]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_80), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0x84f6f40)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0x84f6f40)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0x84f6f40)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0x84f6f40)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0x84f6f40)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_55 : [#users=2] = placeholder[target=tensor_55]
    %tensor_56 : [#users=1] = placeholder[target=tensor_56]
    %tensor_57 : [#users=1] = placeholder[target=tensor_57]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_55,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_57, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_63 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_63, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_56, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_75 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_75), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_55), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0x84f6f40)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0x8c6fb30)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0x8c6fb30)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0x8c6fb30)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0x8c6fb30)
tracing opcode LOAD_METHOD None pc=46 frame=9(0x8c6fb30)
tracing opcode LOAD_FAST None pc=48 frame=9(0x8c6fb30)
tracing opcode CALL_METHOD None pc=50 frame=9(0x8c6fb30)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x86b7920)
push tracker due to record
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x86b7920)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x86b7920)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x86b7920)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x86b7920)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x86b7920)
load fast: 23346416247184
tracing opcode LOAD_METHOD None pc=12 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=14 frame=18(0x86b7920)
load fast: 23346056701008
tracing opcode CALL_METHOD None pc=16 frame=18(0x86b7920)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x86b7920)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=24 frame=18(0x86b7920)
tracing opcode CALL_METHOD None pc=26 frame=18(0x86b7920)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0x7dd42f0)
push tracker due to record
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0x7dd42f0)
load fast: 23346416247664
tracing opcode LOAD_METHOD None pc=12 frame=19(0x7dd42f0)
tracing opcode LOAD_FAST None pc=14 frame=19(0x7dd42f0)
load fast: 23346056422960
tracing opcode CALL_METHOD None pc=16 frame=19(0x7dd42f0)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_83 : [#users=1] = placeholder[target=tensor_83]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_83,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x86b7920)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x86b7920)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_82 : [#users=1] = placeholder[target=tensor_82]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_82,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x86b7920)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0x8c6fb30)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0x8c6fb30)
tracing opcode LOAD_METHOD None pc=56 frame=9(0x8c6fb30)
tracing opcode LOAD_FAST None pc=58 frame=9(0x8c6fb30)
tracing opcode LOAD_FAST None pc=60 frame=9(0x8c6fb30)
tracing opcode CALL_METHOD None pc=62 frame=9(0x8c6fb30)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x153bc0a3a040)
push tracker due to record
push tracker 20 frame 0x153bc0a3a040 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x153bc0a3a040 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x153bc0a3a040)
load fast: 23346416247472
tracing opcode LOAD_METHOD None pc=12 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=14 frame=20(0x153bc0a3a040)
load fast: 23346056466496
tracing opcode CALL_METHOD None pc=16 frame=20(0x153bc0a3a040)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x153bc0a3a040)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=24 frame=20(0x153bc0a3a040)
tracing opcode CALL_METHOD None pc=26 frame=20(0x153bc0a3a040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc0beac40)
push tracker due to record
push tracker 3 frame 0x153bc0beac40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc0beac40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc0beac40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc0beac40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc0beac40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc0beac40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc0beac40)
load fast: 23346416246992
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc0beac40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc0beac40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc0beac40)
load fast: 23346056469216
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc0beac40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_85 : [#users=0] = placeholder[target=tensor_85]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0797,  0.0307,  0.7143,  ..., -0.5133, -0.5925,  0.2807],
         [ 0.7398, -0.0208,  0.4043,  ..., -0.2036,  0.0176, -0.1191],
         [ 0.2968,  0.1619, -0.2038,  ..., -0.3151, -0.0535,  0.2045],
         ...,
         [ 0.1081, -0.2532,  0.5753,  ...,  0.0527, -0.3326,  0.0827],
         [ 0.6282,  0.1491, -0.2091,  ..., -0.3279,  0.8550,  0.0727],
         [ 0.0327, -0.4909, -0.5801,  ..., -0.5983, -0.3540,  0.3990]]]), modified_attrs={}, prev=None) 23346056510192 23346056469216
obj: tensor([[[ 0.0797,  0.0307,  0.7143,  ..., -0.5133, -0.5925,  0.2807],
         [ 0.7398, -0.0208,  0.4043,  ..., -0.2036,  0.0176, -0.1191],
         [ 0.2968,  0.1619, -0.2038,  ..., -0.3151, -0.0535,  0.2045],
         ...,
         [ 0.1081, -0.2532,  0.5753,  ...,  0.0527, -0.3326,  0.0827],
         [ 0.6282,  0.1491, -0.2091,  ..., -0.3279,  0.8550,  0.0727],
         [ 0.0327, -0.4909, -0.5801,  ..., -0.5983, -0.3540,  0.3990]]]) 23346056469216
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0797,  0.0307,  0.7143,  ..., -0.5133, -0.5925,  0.2807],
         [ 0.7398, -0.0208,  0.4043,  ..., -0.2036,  0.0176, -0.1191],
         [ 0.2968,  0.1619, -0.2038,  ..., -0.3151, -0.0535,  0.2045],
         ...,
         [ 0.1081, -0.2532,  0.5753,  ...,  0.0527, -0.3326,  0.0827],
         [ 0.6282,  0.1491, -0.2091,  ..., -0.3279,  0.8550,  0.0727],
         [ 0.0327, -0.4909, -0.5801,  ..., -0.5983, -0.3540,  0.3990]]]), modified_attrs={}, prev=None) 23346056488464
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc0beac40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x153bc0a3a040)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=34 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=36 frame=20(0x153bc0a3a040)
load fast: 23346056701008
tracing opcode BINARY_ADD None pc=38 frame=20(0x153bc0a3a040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x153bc0a3a040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x9f30f70)
push tracker due to record
push tracker 2 frame 0x9f30f70 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x9f30f70)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x9f30f70)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0x9f30f70 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x9f30f70)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x9f30f70)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x9f30f70)
load fast: 23346056512032
tracing opcode LOAD_ATTR None pc=12 frame=2(0x9f30f70)
tracing opcode STORE_FAST None pc=14 frame=2(0x9f30f70)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x9f30f70)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x9f30f70)
tracing opcode CALL_METHOD None pc=20 frame=2(0x9f30f70)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x9f30f70)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x9f30f70)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x9f30f70)
tracing opcode LOAD_CONST None pc=28 frame=2(0x9f30f70)
tracing opcode LOAD_CONST None pc=30 frame=2(0x9f30f70)
tracing opcode LOAD_CONST None pc=32 frame=2(0x9f30f70)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x9f30f70)
record function in graph <built-in method mean of Tensor object at 0x153bad67c220>
tracing opcode STORE_FAST None pc=36 frame=2(0x9f30f70)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x9f30f70)
tracing opcode LOAD_FAST None pc=40 frame=2(0x9f30f70)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x9f30f70)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x9f30f70)
tracing opcode LOAD_CONST None pc=46 frame=2(0x9f30f70)
tracing opcode CALL_METHOD None pc=48 frame=2(0x9f30f70)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x9f30f70)
tracing opcode LOAD_CONST None pc=52 frame=2(0x9f30f70)
tracing opcode LOAD_CONST None pc=54 frame=2(0x9f30f70)
tracing opcode LOAD_CONST None pc=56 frame=2(0x9f30f70)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x9f30f70)
record function in graph <built-in method mean of Tensor object at 0x153bad6844a0>
tracing opcode STORE_FAST None pc=60 frame=2(0x9f30f70)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x9f30f70)
tracing opcode LOAD_FAST None pc=64 frame=2(0x9f30f70)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x9f30f70)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x9f30f70)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x9f30f70)
tracing opcode LOAD_FAST None pc=72 frame=2(0x9f30f70)
tracing opcode LOAD_FAST None pc=74 frame=2(0x9f30f70)
load fast: 23346416247136
tracing opcode LOAD_ATTR None pc=76 frame=2(0x9f30f70)
tracing opcode BINARY_ADD None pc=78 frame=2(0x9f30f70)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x9f30f70)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x9f30f70)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x9f30f70)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x9f30f70)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x9f30f70)
tracing opcode LOAD_FAST None pc=90 frame=2(0x9f30f70)
tracing opcode CALL_METHOD None pc=92 frame=2(0x9f30f70)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x9f30f70)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x9f30f70)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x9f30f70)
tracing opcode LOAD_FAST None pc=100 frame=2(0x9f30f70)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x9f30f70)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x9f30f70)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x9f30f70)
tracing opcode BINARY_ADD None pc=108 frame=2(0x9f30f70)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x9f30f70)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x9f30f70)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x9f30f70)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_87 : [#users=4] = placeholder[target=tensor_87]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_87,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_87, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_87, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_87, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153bad67c220>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x9f30f70)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x153bc0a3a040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_84 : [#users=1] = placeholder[target=tensor_84]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_84,), kwargs = {})
    %tensor_86 : [#users=1] = placeholder[target=tensor_86]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_86), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0x8c6fb30)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0x8c6fb30)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0x8c6fb30)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0x8c6fb30)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0x8c6fb30)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_52 : [#users=2] = placeholder[target=tensor_52]
    %tensor_53 : [#users=1] = placeholder[target=tensor_53]
    %tensor_54 : [#users=1] = placeholder[target=tensor_54]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_52,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_54, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_63 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_63, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_53, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_75 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_75), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_52), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0x8c6fb30)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0x85010f0)
push tracker due to record
push tracker 9 frame 0x85010f0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0x85010f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0x85010f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0x85010f0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0x85010f0)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0x85010f0)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0x85010f0)
load fast: 23346416247232
tracing opcode LOAD_ATTR None pc=12 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0x85010f0)
load fast: 23346056547040
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0x85010f0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0x85010f0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0x85010f0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0x85010f0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0x85010f0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0x85010f0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0x85010f0)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0x85052a0)
push tracker due to record
push tracker 10 frame 0x85052a0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0x85052a0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0x85052a0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0x85052a0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0x85052a0)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0x85052a0)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0x85052a0)
load fast: 23346416247568
tracing opcode LOAD_ATTR None pc=12 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0x85052a0)
load fast: 23346056547040
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0x85052a0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0x85052a0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0x85052a0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0x85052a0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0x85052a0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0x85052a0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0x85052a0)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0x84f1ae0)
push tracker due to record
push tracker 11 frame 0x84f1ae0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0x84f1ae0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0x84f1ae0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0x84f1ae0)
tracing opcode IS_OP None pc=16 frame=11(0x84f1ae0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0x84f1ae0)
load fast: 23346416247808
tracing opcode LOAD_METHOD None pc=22 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=24 frame=11(0x84f1ae0)
load fast: 23346056547040
tracing opcode CALL_METHOD None pc=26 frame=11(0x84f1ae0)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=32 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=34 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=36 frame=11(0x84f1ae0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346056831200
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416247808
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_95 : [#users=1] = placeholder[target=tensor_95]
    %view : [#users=1] = call_method[target=view](args = (%tensor_95, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=40 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=42 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=44 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0x84f1ae0)
record function in graph <built-in method chunk of Tensor object at 0x153bc0af8680>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=50 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=52 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=54 frame=11(0x84f1ae0)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=224 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=226 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=228 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=230 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=232 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=234 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=236 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=238 frame=11(0x84f1ae0)
tracing opcode BUILD_SLICE None pc=240 frame=11(0x84f1ae0)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0x84f1ae0)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0x84f1ae0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0x84f1ae0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346380239472
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416247808
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_96 : [#users=1] = placeholder[target=tensor_96]
    %view : [#users=1] = call_method[target=view](args = (%tensor_96, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0x84f1ae0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=254 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=256 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=258 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=260 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=262 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=264 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=266 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=268 frame=11(0x84f1ae0)
tracing opcode BUILD_SLICE None pc=270 frame=11(0x84f1ae0)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0x84f1ae0)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0x84f1ae0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0x84f1ae0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346057222000
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416247808
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_97 : [#users=1] = placeholder[target=tensor_97]
    %view : [#users=1] = call_method[target=view](args = (%tensor_97, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0x84f1ae0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=284 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0x84f1ae0)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0x84f1ae0)
tracing opcode LOAD_DEREF None pc=290 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=292 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0x84f1ae0)
tracing opcode BINARY_ADD None pc=296 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=298 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=302 frame=11(0x84f1ae0)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=306 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=308 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=310 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=312 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=314 frame=11(0x84f1ae0)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=318 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=320 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0x84f1ae0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0x84f1ae0)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0x84f1ae0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0x84f1ae0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=334 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=336 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=338 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=340 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=342 frame=11(0x84f1ae0)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0x84f1ae0)
record function in graph <built-in method to of Tensor object at 0x153bc0b02d60>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0x84f1ae0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=352 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=354 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=356 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=358 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=360 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=362 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=364 frame=11(0x84f1ae0)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0x84f1ae0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=372 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=380 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=382 frame=11(0x84f1ae0)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0x84f1ae0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416247904
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=390 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=392 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=394 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=396 frame=11(0x84f1ae0)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=400 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=402 frame=11(0x84f1ae0)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0x86a0f90)
push tracker due to record
push tracker 13 frame 0x86a0f90 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0x86a0f90)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0x86a0f90)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0x86a0f90 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0x86a0f90)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0x86a0f90)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0x86a0f90)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0x86a0f90)
tracing opcode IS_OP None pc=16 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=52 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=54 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=56 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=58 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=82 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=84 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=86 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=88 frame=13(0x86a0f90)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=94 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=96 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=98 frame=13(0x86a0f90)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0x86a0f90)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=138 frame=13(0x86a0f90)
load fast: 23346305716688
tracing opcode LOAD_METHOD None pc=140 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=142 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=144 frame=13(0x86a0f90)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0x86a0f90)
load fast: 23346057239504
tracing opcode LOAD_METHOD None pc=148 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=150 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=152 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=156 frame=13(0x86a0f90)
load fast: 23346416247808
tracing opcode LOAD_ATTR None pc=158 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=162 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=166 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=168 frame=13(0x86a0f90)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=172 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=174 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=176 frame=13(0x86a0f90)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0x86a0f90)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=184 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=186 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=190 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=192 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=194 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=196 frame=13(0x86a0f90)
tracing opcode BUILD_SLICE None pc=198 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=200 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=202 frame=13(0x86a0f90)
tracing opcode BUILD_SLICE None pc=204 frame=13(0x86a0f90)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0x86a0f90)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0x86a0f90)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=220 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=224 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=226 frame=13(0x86a0f90)
tracing opcode CONTAINS_OP None pc=228 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=236 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=238 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=240 frame=13(0x86a0f90)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=246 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=248 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=250 frame=13(0x86a0f90)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346056960976
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416247808
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_102 : [#users=1] = placeholder[target=tensor_102]
    %view : [#users=1] = call_method[target=view](args = (%tensor_102, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=256 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=258 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=260 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=262 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=264 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=266 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=268 frame=13(0x86a0f90)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0x86a0f90)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=276 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=278 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=280 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=282 frame=13(0x86a0f90)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=286 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=288 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=292 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=296 frame=13(0x86a0f90)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=302 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=304 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=306 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=310 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=312 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=314 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0x86a0f90)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23346056305536
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23346305716688
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23346056424880
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_103 : [#users=1] = placeholder[target=tensor_103]
    %tensor_104 : [#users=0] = placeholder[target=tensor_104]
    %tensor_105 : [#users=0] = placeholder[target=tensor_105]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_103, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0x86a0f90)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=326 frame=13(0x86a0f90)
tracing opcode INPLACE_ADD None pc=328 frame=13(0x86a0f90)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=334 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=336 frame=13(0x86a0f90)
tracing opcode CONTAINS_OP None pc=338 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=346 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=348 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=350 frame=13(0x86a0f90)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=356 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=358 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=360 frame=13(0x86a0f90)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23346056227152
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416247808
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_106 : [#users=1] = placeholder[target=tensor_106]
    %view : [#users=1] = call_method[target=view](args = (%tensor_106, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=368 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=372 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=374 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=376 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=378 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=380 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=384 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=386 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0x86a0f90)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0x86a0f90)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0x86a0f90)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0x86a0f90)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=402 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=404 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=406 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=408 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=410 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=412 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=414 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=416 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0x86a0f90)
tracing opcode STORE_FAST None pc=452 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=456 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=458 frame=13(0x86a0f90)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0x86a0f90)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0x86a0f90)
tracing opcode BINARY_ADD None pc=464 frame=13(0x86a0f90)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=468 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=470 frame=13(0x86a0f90)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=474 frame=13(0x86a0f90)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=478 frame=13(0x86a0f90)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=484 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=486 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=488 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=490 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=492 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=494 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=496 frame=13(0x86a0f90)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=500 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=502 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=504 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0x86a0f90)
record function in graph <built-in method to of Tensor object at 0x153bad636a90>
tracing opcode CALL_METHOD None pc=508 frame=13(0x86a0f90)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0x86a0f90)
tracing opcode LOAD_ATTR None pc=514 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=518 frame=13(0x86a0f90)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=522 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=524 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=526 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0x86a0f90)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23346380231280
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23346305716688
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23346057239504
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_107 : [#users=1] = placeholder[target=tensor_107]
    %tensor_108 : [#users=0] = placeholder[target=tensor_108]
    %tensor_109 : [#users=0] = placeholder[target=tensor_109]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_107, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0x86a0f90)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0x86a0f90)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=538 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0x86a0f90)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=546 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=548 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=550 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=552 frame=13(0x86a0f90)
tracing opcode LOAD_METHOD None pc=554 frame=13(0x86a0f90)
tracing opcode LOAD_CONST None pc=556 frame=13(0x86a0f90)
tracing opcode CALL_METHOD None pc=558 frame=13(0x86a0f90)
tracing opcode COMPARE_OP None pc=560 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0x86a0f90)
tracing opcode LOAD_FAST None pc=626 frame=13(0x86a0f90)
tracing opcode INPLACE_ADD None pc=628 frame=13(0x86a0f90)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0x86a0f90)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0x86a0f90)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0x86a0f90)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_99 : [#users=1] = placeholder[target=tensor_99]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_99, 1), kwargs = {})
    %tensor_100 : [#users=1] = placeholder[target=tensor_100]
    %tensor_101 : [#users=1] = placeholder[target=tensor_101]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_100, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_101, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0x86a0f90)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=408 frame=11(0x84f1ae0)
tracing opcode IS_OP None pc=410 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=418 frame=11(0x84f1ae0)
tracing opcode BINARY_ADD None pc=420 frame=11(0x84f1ae0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=426 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=468 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=470 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=472 frame=11(0x84f1ae0)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=476 frame=11(0x84f1ae0)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b5e0> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654852576
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b5e0> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23346056227632
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_111 : [#users=1] = placeholder[target=tensor_111]
    %to : [#users=1] = call_method[target=to](args = (%tensor_111, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_112 : [#users=1] = placeholder[target=tensor_112]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_112, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=482 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=484 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=486 frame=11(0x84f1ae0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416248048
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346056370192
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_113 : [#users=0] = placeholder[target=tensor_113]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0047, 0.0036, 0.0048,  ..., 0.0052, 0.0043, 0.0039],
          [0.0040, 0.0038, 0.0038,  ..., 0.0053, 0.0031, 0.0035],
          [0.0054, 0.0043, 0.0035,  ..., 0.0046, 0.0029, 0.0038],
          ...,
          [0.0044, 0.0039, 0.0053,  ..., 0.0037, 0.0039, 0.0056],
          [0.0043, 0.0040, 0.0028,  ..., 0.0061, 0.0028, 0.0035],
          [0.0043, 0.0040, 0.0045,  ..., 0.0051, 0.0036, 0.0050]],

         [[0.0041, 0.0048, 0.0030,  ..., 0.0039, 0.0043, 0.0051],
          [0.0039, 0.0042, 0.0041,  ..., 0.0031, 0.0058, 0.0059],
          [0.0044, 0.0035, 0.0036,  ..., 0.0029, 0.0028, 0.0043],
          ...,
          [0.0042, 0.0028, 0.0031,  ..., 0.0047, 0.0034, 0.0035],
          [0.0044, 0.0038, 0.0037,  ..., 0.0041, 0.0046, 0.0044],
          [0.0047, 0.0026, 0.0034,  ..., 0.0035, 0.0031, 0.0042]],

         [[0.0039, 0.0045, 0.0041,  ..., 0.0048, 0.0034, 0.0036],
          [0.0039, 0.0034, 0.0039,  ..., 0.0040, 0.0042, 0.0034],
          [0.0026, 0.0035, 0.0043,  ..., 0.0049, 0.0043, 0.0034],
          ...,
          [0.0034, 0.0033, 0.0048,  ..., 0.0053, 0.0041, 0.0034],
          [0.0034, 0.0036, 0.0042,  ..., 0.0039, 0.0031, 0.0059],
          [0.0030, 0.0039, 0.0040,  ..., 0.0058, 0.0043, 0.0041]],

         ...,

         [[0.0034, 0.0032, 0.0038,  ..., 0.0038, 0.0048, 0.0042],
          [0.0052, 0.0047, 0.0035,  ..., 0.0046, 0.0040, 0.0031],
          [0.0034, 0.0036, 0.0034,  ..., 0.0035, 0.0035, 0.0039],
          ...,
          [0.0040, 0.0041, 0.0039,  ..., 0.0047, 0.0035, 0.0036],
          [0.0031, 0.0036, 0.0042,  ..., 0.0047, 0.0044, 0.0055],
          [0.0031, 0.0042, 0.0049,  ..., 0.0043, 0.0043, 0.0033]],

         [[0.0055, 0.0036, 0.0036,  ..., 0.0027, 0.0034, 0.0026],
          [0.0043, 0.0036, 0.0038,  ..., 0.0034, 0.0033, 0.0035],
          [0.0049, 0.0042, 0.0048,  ..., 0.0022, 0.0034, 0.0036],
          ...,
          [0.0042, 0.0043, 0.0029,  ..., 0.0034, 0.0045, 0.0063],
          [0.0047, 0.0040, 0.0042,  ..., 0.0046, 0.0032, 0.0053],
          [0.0028, 0.0045, 0.0029,  ..., 0.0032, 0.0055, 0.0048]],

         [[0.0037, 0.0043, 0.0043,  ..., 0.0045, 0.0039, 0.0040],
          [0.0034, 0.0038, 0.0034,  ..., 0.0032, 0.0037, 0.0051],
          [0.0031, 0.0045, 0.0045,  ..., 0.0027, 0.0055, 0.0045],
          ...,
          [0.0036, 0.0038, 0.0046,  ..., 0.0036, 0.0038, 0.0033],
          [0.0032, 0.0034, 0.0035,  ..., 0.0035, 0.0047, 0.0035],
          [0.0031, 0.0044, 0.0034,  ..., 0.0034, 0.0031, 0.0058]]]]), modified_attrs={}, prev=None) 23346379455264 23346056370192
obj: tensor([[[[0.0047, 0.0036, 0.0048,  ..., 0.0052, 0.0043, 0.0039],
          [0.0040, 0.0038, 0.0038,  ..., 0.0053, 0.0031, 0.0035],
          [0.0054, 0.0043, 0.0035,  ..., 0.0046, 0.0029, 0.0038],
          ...,
          [0.0044, 0.0039, 0.0053,  ..., 0.0037, 0.0039, 0.0056],
          [0.0043, 0.0040, 0.0028,  ..., 0.0061, 0.0028, 0.0035],
          [0.0043, 0.0040, 0.0045,  ..., 0.0051, 0.0036, 0.0050]],

         [[0.0041, 0.0048, 0.0030,  ..., 0.0039, 0.0043, 0.0051],
          [0.0039, 0.0042, 0.0041,  ..., 0.0031, 0.0058, 0.0059],
          [0.0044, 0.0035, 0.0036,  ..., 0.0029, 0.0028, 0.0043],
          ...,
          [0.0042, 0.0028, 0.0031,  ..., 0.0047, 0.0034, 0.0035],
          [0.0044, 0.0038, 0.0037,  ..., 0.0041, 0.0046, 0.0044],
          [0.0047, 0.0026, 0.0034,  ..., 0.0035, 0.0031, 0.0042]],

         [[0.0039, 0.0045, 0.0041,  ..., 0.0048, 0.0034, 0.0036],
          [0.0039, 0.0034, 0.0039,  ..., 0.0040, 0.0042, 0.0034],
          [0.0026, 0.0035, 0.0043,  ..., 0.0049, 0.0043, 0.0034],
          ...,
          [0.0034, 0.0033, 0.0048,  ..., 0.0053, 0.0041, 0.0034],
          [0.0034, 0.0036, 0.0042,  ..., 0.0039, 0.0031, 0.0059],
          [0.0030, 0.0039, 0.0040,  ..., 0.0058, 0.0043, 0.0041]],

         ...,

         [[0.0034, 0.0032, 0.0038,  ..., 0.0038, 0.0048, 0.0042],
          [0.0052, 0.0047, 0.0035,  ..., 0.0046, 0.0040, 0.0031],
          [0.0034, 0.0036, 0.0034,  ..., 0.0035, 0.0035, 0.0039],
          ...,
          [0.0040, 0.0041, 0.0039,  ..., 0.0047, 0.0035, 0.0036],
          [0.0031, 0.0036, 0.0042,  ..., 0.0047, 0.0044, 0.0055],
          [0.0031, 0.0042, 0.0049,  ..., 0.0043, 0.0043, 0.0033]],

         [[0.0055, 0.0036, 0.0036,  ..., 0.0027, 0.0034, 0.0026],
          [0.0043, 0.0036, 0.0038,  ..., 0.0034, 0.0033, 0.0035],
          [0.0049, 0.0042, 0.0048,  ..., 0.0022, 0.0034, 0.0036],
          ...,
          [0.0042, 0.0043, 0.0029,  ..., 0.0034, 0.0045, 0.0063],
          [0.0047, 0.0040, 0.0042,  ..., 0.0046, 0.0032, 0.0053],
          [0.0028, 0.0045, 0.0029,  ..., 0.0032, 0.0055, 0.0048]],

         [[0.0037, 0.0043, 0.0043,  ..., 0.0045, 0.0039, 0.0040],
          [0.0034, 0.0038, 0.0034,  ..., 0.0032, 0.0037, 0.0051],
          [0.0031, 0.0045, 0.0045,  ..., 0.0027, 0.0055, 0.0045],
          ...,
          [0.0036, 0.0038, 0.0046,  ..., 0.0036, 0.0038, 0.0033],
          [0.0032, 0.0034, 0.0035,  ..., 0.0035, 0.0047, 0.0035],
          [0.0031, 0.0044, 0.0034,  ..., 0.0034, 0.0031, 0.0058]]]]) 23346056370192
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0047, 0.0036, 0.0048,  ..., 0.0052, 0.0043, 0.0039],
          [0.0040, 0.0038, 0.0038,  ..., 0.0053, 0.0031, 0.0035],
          [0.0054, 0.0043, 0.0035,  ..., 0.0046, 0.0029, 0.0038],
          ...,
          [0.0044, 0.0039, 0.0053,  ..., 0.0037, 0.0039, 0.0056],
          [0.0043, 0.0040, 0.0028,  ..., 0.0061, 0.0028, 0.0035],
          [0.0043, 0.0040, 0.0045,  ..., 0.0051, 0.0036, 0.0050]],

         [[0.0041, 0.0048, 0.0030,  ..., 0.0039, 0.0043, 0.0051],
          [0.0039, 0.0042, 0.0041,  ..., 0.0031, 0.0058, 0.0059],
          [0.0044, 0.0035, 0.0036,  ..., 0.0029, 0.0028, 0.0043],
          ...,
          [0.0042, 0.0028, 0.0031,  ..., 0.0047, 0.0034, 0.0035],
          [0.0044, 0.0038, 0.0037,  ..., 0.0041, 0.0046, 0.0044],
          [0.0047, 0.0026, 0.0034,  ..., 0.0035, 0.0031, 0.0042]],

         [[0.0039, 0.0045, 0.0041,  ..., 0.0048, 0.0034, 0.0036],
          [0.0039, 0.0034, 0.0039,  ..., 0.0040, 0.0042, 0.0034],
          [0.0026, 0.0035, 0.0043,  ..., 0.0049, 0.0043, 0.0034],
          ...,
          [0.0034, 0.0033, 0.0048,  ..., 0.0053, 0.0041, 0.0034],
          [0.0034, 0.0036, 0.0042,  ..., 0.0039, 0.0031, 0.0059],
          [0.0030, 0.0039, 0.0040,  ..., 0.0058, 0.0043, 0.0041]],

         ...,

         [[0.0034, 0.0032, 0.0038,  ..., 0.0038, 0.0048, 0.0042],
          [0.0052, 0.0047, 0.0035,  ..., 0.0046, 0.0040, 0.0031],
          [0.0034, 0.0036, 0.0034,  ..., 0.0035, 0.0035, 0.0039],
          ...,
          [0.0040, 0.0041, 0.0039,  ..., 0.0047, 0.0035, 0.0036],
          [0.0031, 0.0036, 0.0042,  ..., 0.0047, 0.0044, 0.0055],
          [0.0031, 0.0042, 0.0049,  ..., 0.0043, 0.0043, 0.0033]],

         [[0.0055, 0.0036, 0.0036,  ..., 0.0027, 0.0034, 0.0026],
          [0.0043, 0.0036, 0.0038,  ..., 0.0034, 0.0033, 0.0035],
          [0.0049, 0.0042, 0.0048,  ..., 0.0022, 0.0034, 0.0036],
          ...,
          [0.0042, 0.0043, 0.0029,  ..., 0.0034, 0.0045, 0.0063],
          [0.0047, 0.0040, 0.0042,  ..., 0.0046, 0.0032, 0.0053],
          [0.0028, 0.0045, 0.0029,  ..., 0.0032, 0.0055, 0.0048]],

         [[0.0037, 0.0043, 0.0043,  ..., 0.0045, 0.0039, 0.0040],
          [0.0034, 0.0038, 0.0034,  ..., 0.0032, 0.0037, 0.0051],
          [0.0031, 0.0045, 0.0045,  ..., 0.0027, 0.0055, 0.0045],
          ...,
          [0.0036, 0.0038, 0.0046,  ..., 0.0036, 0.0038, 0.0033],
          [0.0032, 0.0034, 0.0035,  ..., 0.0035, 0.0047, 0.0035],
          [0.0031, 0.0044, 0.0034,  ..., 0.0034, 0.0031, 0.0058]]]]), modified_attrs={}, prev=None) 23346379484560
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0x84f1ae0)
tracing opcode LOAD_ATTR None pc=492 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=534 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=536 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=538 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=540 frame=11(0x84f1ae0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=546 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=548 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=550 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=552 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=554 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=556 frame=11(0x84f1ae0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=560 frame=11(0x84f1ae0)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=566 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=568 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=570 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=572 frame=11(0x84f1ae0)
tracing opcode BUILD_SLICE None pc=574 frame=11(0x84f1ae0)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0x84f1ae0)
tracing opcode LOAD_CONST None pc=578 frame=11(0x84f1ae0)
tracing opcode BINARY_ADD None pc=580 frame=11(0x84f1ae0)
tracing opcode STORE_FAST None pc=582 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0x84f1ae0)
tracing opcode LOAD_METHOD None pc=586 frame=11(0x84f1ae0)
tracing opcode LOAD_FAST None pc=588 frame=11(0x84f1ae0)
tracing opcode CALL_METHOD None pc=590 frame=11(0x84f1ae0)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0x84f1ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0x84f1ae0)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_94 : [#users=1] = placeholder[target=tensor_94]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_94,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_98 : [#users=1] = placeholder[target=tensor_98]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_98, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_99 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_99, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_110 : [#users=1] = placeholder[target=tensor_110]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_110, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_111 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_111), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0x84f1ae0)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0x85052a0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0x85052a0)
tracing opcode LOAD_CONST None pc=46 frame=10(0x85052a0)
tracing opcode IS_OP None pc=48 frame=10(0x85052a0)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0x85052a0)
tracing opcode STORE_FAST None pc=54 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0x85052a0)
tracing opcode LOAD_METHOD None pc=58 frame=10(0x85052a0)
tracing opcode LOAD_FAST None pc=60 frame=10(0x85052a0)
tracing opcode LOAD_FAST None pc=62 frame=10(0x85052a0)
tracing opcode CALL_METHOD None pc=64 frame=10(0x85052a0)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bc0ad7040)
push tracker due to record
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bc0ad7040)
load fast: 23346416248096
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bc0ad7040)
load fast: 23346056246432
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bc0ad7040)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bc0ad7040)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bc0ad7040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416247616
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346056013280
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_115 : [#users=0] = placeholder[target=tensor_115]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0178,  0.0470,  0.0311,  ..., -0.0599, -0.0504, -0.0279],
         [ 0.0154,  0.0438,  0.0325,  ..., -0.0561, -0.0447, -0.0285],
         [ 0.0161,  0.0507,  0.0349,  ..., -0.0525, -0.0448, -0.0284],
         ...,
         [ 0.0198,  0.0481,  0.0313,  ..., -0.0534, -0.0503, -0.0308],
         [ 0.0198,  0.0447,  0.0283,  ..., -0.0604, -0.0447, -0.0279],
         [ 0.0170,  0.0495,  0.0262,  ..., -0.0549, -0.0555, -0.0282]]]), modified_attrs={}, prev=None) 23346379551936 23346056013280
obj: tensor([[[ 0.0178,  0.0470,  0.0311,  ..., -0.0599, -0.0504, -0.0279],
         [ 0.0154,  0.0438,  0.0325,  ..., -0.0561, -0.0447, -0.0285],
         [ 0.0161,  0.0507,  0.0349,  ..., -0.0525, -0.0448, -0.0284],
         ...,
         [ 0.0198,  0.0481,  0.0313,  ..., -0.0534, -0.0503, -0.0308],
         [ 0.0198,  0.0447,  0.0283,  ..., -0.0604, -0.0447, -0.0279],
         [ 0.0170,  0.0495,  0.0262,  ..., -0.0549, -0.0555, -0.0282]]]) 23346056013280
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0178,  0.0470,  0.0311,  ..., -0.0599, -0.0504, -0.0279],
         [ 0.0154,  0.0438,  0.0325,  ..., -0.0561, -0.0447, -0.0285],
         [ 0.0161,  0.0507,  0.0349,  ..., -0.0525, -0.0448, -0.0284],
         ...,
         [ 0.0198,  0.0481,  0.0313,  ..., -0.0534, -0.0503, -0.0308],
         [ 0.0198,  0.0447,  0.0283,  ..., -0.0604, -0.0447, -0.0279],
         [ 0.0170,  0.0495,  0.0262,  ..., -0.0549, -0.0555, -0.0282]]]), modified_attrs={}, prev=None) 23346379236544
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bc0ad7040)
load fast: 23346056547040
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bc0ad7040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bc0ad7040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153bc2c6b9f0)
push tracker due to record
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153bc2c6b9f0)
load fast: 23346055947984
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153bc2c6b9f0)
tracing opcode STORE_FAST None pc=14 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153bc2c6b9f0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bad5f26d0>
tracing opcode STORE_FAST None pc=36 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153bc2c6b9f0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153bad5fd400>
tracing opcode STORE_FAST None pc=60 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153bc2c6b9f0)
load fast: 23346416248192
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153bc2c6b9f0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153bc2c6b9f0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_117 : [#users=4] = placeholder[target=tensor_117]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_117,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_117, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_117, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_117, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153bad5f26d0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bc0ad7040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_114 : [#users=1] = placeholder[target=tensor_114]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_114,), kwargs = {})
    %tensor_116 : [#users=1] = placeholder[target=tensor_116]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_116), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0x85052a0)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0x85052a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0x85052a0)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0x85052a0)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_91 : [#users=2] = placeholder[target=tensor_91]
    %tensor_92 : [#users=1] = placeholder[target=tensor_92]
    %tensor_93 : [#users=1] = placeholder[target=tensor_93]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_91,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_93, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_99 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_99, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_92, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_111 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_111), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_91), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0x85052a0)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0x85010f0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0x85010f0)
tracing opcode LOAD_METHOD None pc=46 frame=9(0x85010f0)
tracing opcode LOAD_FAST None pc=48 frame=9(0x85010f0)
tracing opcode CALL_METHOD None pc=50 frame=9(0x85010f0)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x86b7920)
push tracker due to record
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x86b7920)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x86b7920)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x86b7920)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x86b7920)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x86b7920)
load fast: 23346416247712
tracing opcode LOAD_METHOD None pc=12 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=14 frame=18(0x86b7920)
load fast: 23346055994080
tracing opcode CALL_METHOD None pc=16 frame=18(0x86b7920)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x86b7920)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=24 frame=18(0x86b7920)
tracing opcode CALL_METHOD None pc=26 frame=18(0x86b7920)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0x7dd42f0)
push tracker due to record
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0x7dd42f0)
load fast: 23346416247328
tracing opcode LOAD_METHOD None pc=12 frame=19(0x7dd42f0)
tracing opcode LOAD_FAST None pc=14 frame=19(0x7dd42f0)
load fast: 23345913323584
tracing opcode CALL_METHOD None pc=16 frame=19(0x7dd42f0)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_119 : [#users=1] = placeholder[target=tensor_119]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_119,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x86b7920)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x86b7920)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_118 : [#users=1] = placeholder[target=tensor_118]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_118,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x86b7920)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0x85010f0)
tracing opcode LOAD_METHOD None pc=56 frame=9(0x85010f0)
tracing opcode LOAD_FAST None pc=58 frame=9(0x85010f0)
tracing opcode LOAD_FAST None pc=60 frame=9(0x85010f0)
tracing opcode CALL_METHOD None pc=62 frame=9(0x85010f0)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x153bc0a3a040)
push tracker due to record
push tracker 20 frame 0x153bc0a3a040 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x153bc0a3a040 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x153bc0a3a040)
load fast: 23346416247280
tracing opcode LOAD_METHOD None pc=12 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=14 frame=20(0x153bc0a3a040)
load fast: 23345913325424
tracing opcode CALL_METHOD None pc=16 frame=20(0x153bc0a3a040)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x153bc0a3a040)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=24 frame=20(0x153bc0a3a040)
tracing opcode CALL_METHOD None pc=26 frame=20(0x153bc0a3a040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc0a3ac40)
push tracker due to record
push tracker 3 frame 0x153bc0a3ac40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc0a3ac40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc0a3ac40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc0a3ac40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc0a3ac40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc0a3ac40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc0a3ac40)
load fast: 23346416246944
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc0a3ac40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc0a3ac40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc0a3ac40)
load fast: 23345913377232
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc0a3ac40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_121 : [#users=0] = placeholder[target=tensor_121]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-0.6927, -0.0406, -0.7632,  ...,  0.5332, -0.4254, -0.0573],
         [-0.2524,  0.2769,  0.3008,  ...,  0.7379,  0.4343, -0.2345],
         [-0.5197,  0.4073,  0.2283,  ..., -0.2715, -0.4387,  0.8296],
         ...,
         [ 0.6294,  0.4903,  0.2211,  ...,  0.4511,  0.0461,  0.3761],
         [ 0.1857,  0.1701, -0.0776,  ...,  0.5300, -0.0538, -0.0444],
         [-0.1272, -0.5307,  0.3894,  ..., -0.3862,  0.2257,  0.3300]]]), modified_attrs={}, prev=None) 23346379676064 23345913377232
obj: tensor([[[-0.6927, -0.0406, -0.7632,  ...,  0.5332, -0.4254, -0.0573],
         [-0.2524,  0.2769,  0.3008,  ...,  0.7379,  0.4343, -0.2345],
         [-0.5197,  0.4073,  0.2283,  ..., -0.2715, -0.4387,  0.8296],
         ...,
         [ 0.6294,  0.4903,  0.2211,  ...,  0.4511,  0.0461,  0.3761],
         [ 0.1857,  0.1701, -0.0776,  ...,  0.5300, -0.0538, -0.0444],
         [-0.1272, -0.5307,  0.3894,  ..., -0.3862,  0.2257,  0.3300]]]) 23345913377232
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.6927, -0.0406, -0.7632,  ...,  0.5332, -0.4254, -0.0573],
         [-0.2524,  0.2769,  0.3008,  ...,  0.7379,  0.4343, -0.2345],
         [-0.5197,  0.4073,  0.2283,  ..., -0.2715, -0.4387,  0.8296],
         ...,
         [ 0.6294,  0.4903,  0.2211,  ...,  0.4511,  0.0461,  0.3761],
         [ 0.1857,  0.1701, -0.0776,  ...,  0.5300, -0.0538, -0.0444],
         [-0.1272, -0.5307,  0.3894,  ..., -0.3862,  0.2257,  0.3300]]]), modified_attrs={}, prev=None) 23346379329008
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc0a3ac40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x153bc0a3a040)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=34 frame=20(0x153bc0a3a040)
tracing opcode LOAD_FAST None pc=36 frame=20(0x153bc0a3a040)
load fast: 23346055994080
tracing opcode BINARY_ADD None pc=38 frame=20(0x153bc0a3a040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x153bc0a3a040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x84d9090)
push tracker due to record
push tracker 2 frame 0x84d9090 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x84d9090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x84d9090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0x84d9090 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x84d9090)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x84d9090)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x84d9090)
load fast: 23345913325184
tracing opcode LOAD_ATTR None pc=12 frame=2(0x84d9090)
tracing opcode STORE_FAST None pc=14 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x84d9090)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x84d9090)
tracing opcode CALL_METHOD None pc=20 frame=2(0x84d9090)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x84d9090)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=28 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=30 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=32 frame=2(0x84d9090)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x84d9090)
record function in graph <built-in method mean of Tensor object at 0x153ba4dee680>
tracing opcode STORE_FAST None pc=36 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=40 frame=2(0x84d9090)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x84d9090)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=46 frame=2(0x84d9090)
tracing opcode CALL_METHOD None pc=48 frame=2(0x84d9090)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=52 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=54 frame=2(0x84d9090)
tracing opcode LOAD_CONST None pc=56 frame=2(0x84d9090)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x84d9090)
record function in graph <built-in method mean of Tensor object at 0x153ba4e00b80>
tracing opcode STORE_FAST None pc=60 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=64 frame=2(0x84d9090)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x84d9090)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x84d9090)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=72 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=74 frame=2(0x84d9090)
load fast: 23346416247088
tracing opcode LOAD_ATTR None pc=76 frame=2(0x84d9090)
tracing opcode BINARY_ADD None pc=78 frame=2(0x84d9090)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x84d9090)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x84d9090)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x84d9090)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=90 frame=2(0x84d9090)
tracing opcode CALL_METHOD None pc=92 frame=2(0x84d9090)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x84d9090)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x84d9090)
tracing opcode LOAD_FAST None pc=100 frame=2(0x84d9090)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x84d9090)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x84d9090)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x84d9090)
tracing opcode BINARY_ADD None pc=108 frame=2(0x84d9090)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x84d9090)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x84d9090)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x84d9090)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_123 : [#users=4] = placeholder[target=tensor_123]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_123,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_123, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_123, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_123, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153ba4dee680>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x84d9090)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x153bc0a3a040)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x153bc0a3a040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_120 : [#users=1] = placeholder[target=tensor_120]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_120,), kwargs = {})
    %tensor_122 : [#users=1] = placeholder[target=tensor_122]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_122), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x153bc0a3a040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0x85010f0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0x85010f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0x85010f0)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0x85010f0)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_88 : [#users=2] = placeholder[target=tensor_88]
    %tensor_89 : [#users=1] = placeholder[target=tensor_89]
    %tensor_90 : [#users=1] = placeholder[target=tensor_90]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_88,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_90, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_99 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_99, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_89, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_111 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_111), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_88), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0x85010f0)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0x84f6ae0)
push tracker due to record
push tracker 9 frame 0x84f6ae0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0x84f6ae0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0x84f6ae0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0x84f6ae0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0x84f6ae0)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0x84f6ae0)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0x84f6ae0)
load fast: 23346416249104
tracing opcode LOAD_ATTR None pc=12 frame=9(0x84f6ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0x84f6ae0)
load fast: 23345913442848
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0x84f6ae0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0x84f6ae0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0x84f6ae0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0x84f6ae0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0x84f6ae0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0x84f6ae0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0x84f6ae0)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0x9f54a30)
push tracker due to record
push tracker 10 frame 0x9f54a30 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0x9f54a30)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0x9f54a30)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0x9f54a30 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0x9f54a30)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0x9f54a30)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0x9f54a30)
load fast: 23346416249152
tracing opcode LOAD_ATTR None pc=12 frame=10(0x9f54a30)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0x9f54a30)
load fast: 23345913442848
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0x9f54a30)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0x9f54a30)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0x9f54a30)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0x9f54a30)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0x9f54a30)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0x9f54a30)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0x9f54a30)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0x84f5eb0)
push tracker due to record
push tracker 11 frame 0x84f5eb0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0x84f5eb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0x84f5eb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0x84f5eb0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0x84f5eb0)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0x84f5eb0)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0x84f5eb0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0x84f5eb0)
tracing opcode IS_OP None pc=16 frame=11(0x84f5eb0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0x84f5eb0)
load fast: 23346416249200
tracing opcode LOAD_METHOD None pc=22 frame=11(0x84f5eb0)
tracing opcode LOAD_DEREF None pc=24 frame=11(0x84f5eb0)
load fast: 23345913442848
tracing opcode CALL_METHOD None pc=26 frame=11(0x84f5eb0)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=32 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=34 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=36 frame=11(0x84f5eb0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23345806385856
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416249200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_131 : [#users=1] = placeholder[target=tensor_131]
    %view : [#users=1] = call_method[target=view](args = (%tensor_131, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=40 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=42 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=44 frame=11(0x84f5eb0)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0x84f5eb0)
record function in graph <built-in method chunk of Tensor object at 0x153ba4e1fe00>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0x84f5eb0)
tracing opcode STORE_FAST None pc=50 frame=11(0x84f5eb0)
tracing opcode STORE_FAST None pc=52 frame=11(0x84f5eb0)
tracing opcode STORE_FAST None pc=54 frame=11(0x84f5eb0)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0x84f5eb0)
tracing opcode LOAD_DEREF None pc=224 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=226 frame=11(0x84f5eb0)
tracing opcode LOAD_DEREF None pc=228 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=230 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=232 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=234 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=236 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=238 frame=11(0x84f5eb0)
tracing opcode BUILD_SLICE None pc=240 frame=11(0x84f5eb0)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0x84f5eb0)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0x84f5eb0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0x84f5eb0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23345806414768
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416249200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_132 : [#users=1] = placeholder[target=tensor_132]
    %view : [#users=1] = call_method[target=view](args = (%tensor_132, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0x84f5eb0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0x84f5eb0)
tracing opcode LOAD_DEREF None pc=254 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=256 frame=11(0x84f5eb0)
tracing opcode LOAD_DEREF None pc=258 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=260 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=262 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=264 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=266 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=268 frame=11(0x84f5eb0)
tracing opcode BUILD_SLICE None pc=270 frame=11(0x84f5eb0)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0x84f5eb0)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0x84f5eb0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0x84f5eb0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23345806437328
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416249200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_133 : [#users=1] = placeholder[target=tensor_133]
    %view : [#users=1] = call_method[target=view](args = (%tensor_133, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0x84f5eb0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0x84f5eb0)
tracing opcode STORE_FAST None pc=284 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0x84f5eb0)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0x84f5eb0)
tracing opcode LOAD_DEREF None pc=290 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=292 frame=11(0x84f5eb0)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0x84f5eb0)
tracing opcode BINARY_ADD None pc=296 frame=11(0x84f5eb0)
tracing opcode STORE_FAST None pc=298 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=302 frame=11(0x84f5eb0)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=306 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=308 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=310 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=312 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=314 frame=11(0x84f5eb0)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=318 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=320 frame=11(0x84f5eb0)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0x84f5eb0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0x84f5eb0)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0x84f5eb0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0x84f5eb0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=334 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=336 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=338 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=340 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=342 frame=11(0x84f5eb0)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0x84f5eb0)
record function in graph <built-in method to of Tensor object at 0x153b9e813ae0>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0x84f5eb0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=352 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=354 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=356 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=358 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=360 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=362 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=364 frame=11(0x84f5eb0)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0x84f5eb0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=372 frame=11(0x84f5eb0)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=380 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=382 frame=11(0x84f5eb0)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0x84f5eb0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416249296
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=390 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=392 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=394 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=396 frame=11(0x84f5eb0)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=400 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=402 frame=11(0x84f5eb0)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0x84ec740)
push tracker due to record
push tracker 13 frame 0x84ec740 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0x84ec740)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0x84ec740)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0x84ec740 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0x84ec740)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0x84ec740)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0x84ec740)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0x84ec740)
tracing opcode IS_OP None pc=16 frame=13(0x84ec740)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=52 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=54 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=56 frame=13(0x84ec740)
tracing opcode COMPARE_OP None pc=58 frame=13(0x84ec740)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=82 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=84 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=86 frame=13(0x84ec740)
tracing opcode COMPARE_OP None pc=88 frame=13(0x84ec740)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=94 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=96 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=98 frame=13(0x84ec740)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0x84ec740)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0x84ec740)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=138 frame=13(0x84ec740)
load fast: 23345806417408
tracing opcode LOAD_METHOD None pc=140 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=142 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=144 frame=13(0x84ec740)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0x84ec740)
load fast: 23345806425120
tracing opcode LOAD_METHOD None pc=148 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=150 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=152 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=156 frame=13(0x84ec740)
load fast: 23346416249200
tracing opcode LOAD_ATTR None pc=158 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0x84ec740)
tracing opcode STORE_FAST None pc=162 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=166 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=168 frame=13(0x84ec740)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=172 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=174 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=176 frame=13(0x84ec740)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0x84ec740)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=184 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=186 frame=13(0x84ec740)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=190 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=192 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=194 frame=13(0x84ec740)
tracing opcode BINARY_ADD None pc=196 frame=13(0x84ec740)
tracing opcode BUILD_SLICE None pc=198 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=200 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=202 frame=13(0x84ec740)
tracing opcode BUILD_SLICE None pc=204 frame=13(0x84ec740)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0x84ec740)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0x84ec740)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0x84ec740)
tracing opcode STORE_FAST None pc=220 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=224 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=226 frame=13(0x84ec740)
tracing opcode CONTAINS_OP None pc=228 frame=13(0x84ec740)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=236 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=238 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=240 frame=13(0x84ec740)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=246 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=248 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=250 frame=13(0x84ec740)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23345806389792
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416249200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_138 : [#users=1] = placeholder[target=tensor_138]
    %view : [#users=1] = call_method[target=view](args = (%tensor_138, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=256 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=258 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=260 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=262 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=264 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=266 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=268 frame=13(0x84ec740)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0x84ec740)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=276 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=278 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=280 frame=13(0x84ec740)
tracing opcode BINARY_ADD None pc=282 frame=13(0x84ec740)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=286 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=288 frame=13(0x84ec740)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=292 frame=13(0x84ec740)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=296 frame=13(0x84ec740)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=302 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=304 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=306 frame=13(0x84ec740)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=310 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=312 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=314 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0x84ec740)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23345699370464
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23345806417408
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23345806485040
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_139 : [#users=1] = placeholder[target=tensor_139]
    %tensor_140 : [#users=0] = placeholder[target=tensor_140]
    %tensor_141 : [#users=0] = placeholder[target=tensor_141]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_139, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0x84ec740)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=326 frame=13(0x84ec740)
tracing opcode INPLACE_ADD None pc=328 frame=13(0x84ec740)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=334 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=336 frame=13(0x84ec740)
tracing opcode CONTAINS_OP None pc=338 frame=13(0x84ec740)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=346 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=348 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=350 frame=13(0x84ec740)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=356 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=358 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=360 frame=13(0x84ec740)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23345699537920
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416249200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_142 : [#users=1] = placeholder[target=tensor_142]
    %view : [#users=1] = call_method[target=view](args = (%tensor_142, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0x84ec740)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=368 frame=13(0x84ec740)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=372 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=374 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=376 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=378 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=380 frame=13(0x84ec740)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=384 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=386 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0x84ec740)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0x84ec740)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0x84ec740)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0x84ec740)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0x84ec740)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=402 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=404 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=406 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=408 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=410 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=412 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=414 frame=13(0x84ec740)
tracing opcode COMPARE_OP None pc=416 frame=13(0x84ec740)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0x84ec740)
tracing opcode STORE_FAST None pc=452 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=456 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=458 frame=13(0x84ec740)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0x84ec740)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0x84ec740)
tracing opcode BINARY_ADD None pc=464 frame=13(0x84ec740)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=468 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=470 frame=13(0x84ec740)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=474 frame=13(0x84ec740)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=478 frame=13(0x84ec740)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=484 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=486 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=488 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=490 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=492 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=494 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=496 frame=13(0x84ec740)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=500 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=502 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=504 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0x84ec740)
record function in graph <built-in method to of Tensor object at 0x153b9820c4f0>
tracing opcode CALL_METHOD None pc=508 frame=13(0x84ec740)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0x84ec740)
tracing opcode LOAD_ATTR None pc=514 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=518 frame=13(0x84ec740)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=522 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=524 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=526 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0x84ec740)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23345806391232
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23345806417408
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23345806425120
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_143 : [#users=1] = placeholder[target=tensor_143]
    %tensor_144 : [#users=0] = placeholder[target=tensor_144]
    %tensor_145 : [#users=0] = placeholder[target=tensor_145]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_143, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0x84ec740)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0x84ec740)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=538 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0x84ec740)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=546 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=548 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=550 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=552 frame=13(0x84ec740)
tracing opcode LOAD_METHOD None pc=554 frame=13(0x84ec740)
tracing opcode LOAD_CONST None pc=556 frame=13(0x84ec740)
tracing opcode CALL_METHOD None pc=558 frame=13(0x84ec740)
tracing opcode COMPARE_OP None pc=560 frame=13(0x84ec740)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0x84ec740)
tracing opcode LOAD_FAST None pc=626 frame=13(0x84ec740)
tracing opcode INPLACE_ADD None pc=628 frame=13(0x84ec740)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0x84ec740)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0x84ec740)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0x84ec740)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_135 : [#users=1] = placeholder[target=tensor_135]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_135, 1), kwargs = {})
    %tensor_136 : [#users=1] = placeholder[target=tensor_136]
    %tensor_137 : [#users=1] = placeholder[target=tensor_137]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_136, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_137, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0x84ec740)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=408 frame=11(0x84f5eb0)
tracing opcode IS_OP None pc=410 frame=11(0x84f5eb0)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=418 frame=11(0x84f5eb0)
tracing opcode BINARY_ADD None pc=420 frame=11(0x84f5eb0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=426 frame=11(0x84f5eb0)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=468 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=470 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=472 frame=11(0x84f5eb0)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=476 frame=11(0x84f5eb0)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b7c0> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654853056
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b7c0> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23345806437168
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_147 : [#users=1] = placeholder[target=tensor_147]
    %to : [#users=1] = call_method[target=to](args = (%tensor_147, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_148 : [#users=1] = placeholder[target=tensor_148]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_148, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=482 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=484 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=486 frame=11(0x84f5eb0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416249440
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23345699492624
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_149 : [#users=0] = placeholder[target=tensor_149]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0038, 0.0039, 0.0040,  ..., 0.0033, 0.0041, 0.0027],
          [0.0033, 0.0046, 0.0042,  ..., 0.0047, 0.0040, 0.0048],
          [0.0041, 0.0053, 0.0037,  ..., 0.0037, 0.0047, 0.0046],
          ...,
          [0.0036, 0.0038, 0.0041,  ..., 0.0043, 0.0037, 0.0038],
          [0.0042, 0.0051, 0.0035,  ..., 0.0044, 0.0030, 0.0042],
          [0.0037, 0.0033, 0.0039,  ..., 0.0046, 0.0043, 0.0040]],

         [[0.0037, 0.0046, 0.0044,  ..., 0.0033, 0.0047, 0.0033],
          [0.0037, 0.0039, 0.0039,  ..., 0.0040, 0.0044, 0.0040],
          [0.0043, 0.0035, 0.0046,  ..., 0.0038, 0.0044, 0.0034],
          ...,
          [0.0039, 0.0041, 0.0034,  ..., 0.0035, 0.0043, 0.0045],
          [0.0046, 0.0033, 0.0044,  ..., 0.0029, 0.0050, 0.0030],
          [0.0036, 0.0047, 0.0042,  ..., 0.0036, 0.0032, 0.0045]],

         [[0.0033, 0.0040, 0.0032,  ..., 0.0025, 0.0028, 0.0040],
          [0.0041, 0.0034, 0.0045,  ..., 0.0036, 0.0038, 0.0037],
          [0.0031, 0.0035, 0.0034,  ..., 0.0036, 0.0050, 0.0036],
          ...,
          [0.0035, 0.0036, 0.0039,  ..., 0.0038, 0.0045, 0.0048],
          [0.0050, 0.0042, 0.0042,  ..., 0.0033, 0.0033, 0.0037],
          [0.0036, 0.0036, 0.0038,  ..., 0.0040, 0.0045, 0.0038]],

         ...,

         [[0.0030, 0.0036, 0.0028,  ..., 0.0025, 0.0041, 0.0046],
          [0.0040, 0.0037, 0.0050,  ..., 0.0038, 0.0036, 0.0040],
          [0.0038, 0.0040, 0.0038,  ..., 0.0043, 0.0063, 0.0041],
          ...,
          [0.0041, 0.0035, 0.0029,  ..., 0.0027, 0.0030, 0.0046],
          [0.0039, 0.0044, 0.0040,  ..., 0.0038, 0.0038, 0.0038],
          [0.0040, 0.0038, 0.0038,  ..., 0.0037, 0.0036, 0.0048]],

         [[0.0039, 0.0033, 0.0036,  ..., 0.0041, 0.0049, 0.0041],
          [0.0057, 0.0043, 0.0045,  ..., 0.0038, 0.0046, 0.0036],
          [0.0029, 0.0041, 0.0032,  ..., 0.0039, 0.0041, 0.0043],
          ...,
          [0.0051, 0.0034, 0.0055,  ..., 0.0042, 0.0037, 0.0030],
          [0.0062, 0.0039, 0.0054,  ..., 0.0056, 0.0048, 0.0037],
          [0.0045, 0.0041, 0.0029,  ..., 0.0035, 0.0034, 0.0033]],

         [[0.0035, 0.0033, 0.0044,  ..., 0.0044, 0.0036, 0.0042],
          [0.0030, 0.0038, 0.0033,  ..., 0.0041, 0.0032, 0.0034],
          [0.0046, 0.0042, 0.0036,  ..., 0.0037, 0.0038, 0.0038],
          ...,
          [0.0051, 0.0027, 0.0051,  ..., 0.0026, 0.0032, 0.0044],
          [0.0039, 0.0031, 0.0038,  ..., 0.0042, 0.0045, 0.0043],
          [0.0052, 0.0031, 0.0044,  ..., 0.0038, 0.0026, 0.0036]]]]), modified_attrs={}, prev=None) 23346056173600 23345699492624
obj: tensor([[[[0.0038, 0.0039, 0.0040,  ..., 0.0033, 0.0041, 0.0027],
          [0.0033, 0.0046, 0.0042,  ..., 0.0047, 0.0040, 0.0048],
          [0.0041, 0.0053, 0.0037,  ..., 0.0037, 0.0047, 0.0046],
          ...,
          [0.0036, 0.0038, 0.0041,  ..., 0.0043, 0.0037, 0.0038],
          [0.0042, 0.0051, 0.0035,  ..., 0.0044, 0.0030, 0.0042],
          [0.0037, 0.0033, 0.0039,  ..., 0.0046, 0.0043, 0.0040]],

         [[0.0037, 0.0046, 0.0044,  ..., 0.0033, 0.0047, 0.0033],
          [0.0037, 0.0039, 0.0039,  ..., 0.0040, 0.0044, 0.0040],
          [0.0043, 0.0035, 0.0046,  ..., 0.0038, 0.0044, 0.0034],
          ...,
          [0.0039, 0.0041, 0.0034,  ..., 0.0035, 0.0043, 0.0045],
          [0.0046, 0.0033, 0.0044,  ..., 0.0029, 0.0050, 0.0030],
          [0.0036, 0.0047, 0.0042,  ..., 0.0036, 0.0032, 0.0045]],

         [[0.0033, 0.0040, 0.0032,  ..., 0.0025, 0.0028, 0.0040],
          [0.0041, 0.0034, 0.0045,  ..., 0.0036, 0.0038, 0.0037],
          [0.0031, 0.0035, 0.0034,  ..., 0.0036, 0.0050, 0.0036],
          ...,
          [0.0035, 0.0036, 0.0039,  ..., 0.0038, 0.0045, 0.0048],
          [0.0050, 0.0042, 0.0042,  ..., 0.0033, 0.0033, 0.0037],
          [0.0036, 0.0036, 0.0038,  ..., 0.0040, 0.0045, 0.0038]],

         ...,

         [[0.0030, 0.0036, 0.0028,  ..., 0.0025, 0.0041, 0.0046],
          [0.0040, 0.0037, 0.0050,  ..., 0.0038, 0.0036, 0.0040],
          [0.0038, 0.0040, 0.0038,  ..., 0.0043, 0.0063, 0.0041],
          ...,
          [0.0041, 0.0035, 0.0029,  ..., 0.0027, 0.0030, 0.0046],
          [0.0039, 0.0044, 0.0040,  ..., 0.0038, 0.0038, 0.0038],
          [0.0040, 0.0038, 0.0038,  ..., 0.0037, 0.0036, 0.0048]],

         [[0.0039, 0.0033, 0.0036,  ..., 0.0041, 0.0049, 0.0041],
          [0.0057, 0.0043, 0.0045,  ..., 0.0038, 0.0046, 0.0036],
          [0.0029, 0.0041, 0.0032,  ..., 0.0039, 0.0041, 0.0043],
          ...,
          [0.0051, 0.0034, 0.0055,  ..., 0.0042, 0.0037, 0.0030],
          [0.0062, 0.0039, 0.0054,  ..., 0.0056, 0.0048, 0.0037],
          [0.0045, 0.0041, 0.0029,  ..., 0.0035, 0.0034, 0.0033]],

         [[0.0035, 0.0033, 0.0044,  ..., 0.0044, 0.0036, 0.0042],
          [0.0030, 0.0038, 0.0033,  ..., 0.0041, 0.0032, 0.0034],
          [0.0046, 0.0042, 0.0036,  ..., 0.0037, 0.0038, 0.0038],
          ...,
          [0.0051, 0.0027, 0.0051,  ..., 0.0026, 0.0032, 0.0044],
          [0.0039, 0.0031, 0.0038,  ..., 0.0042, 0.0045, 0.0043],
          [0.0052, 0.0031, 0.0044,  ..., 0.0038, 0.0026, 0.0036]]]]) 23345699492624
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0038, 0.0039, 0.0040,  ..., 0.0033, 0.0041, 0.0027],
          [0.0033, 0.0046, 0.0042,  ..., 0.0047, 0.0040, 0.0048],
          [0.0041, 0.0053, 0.0037,  ..., 0.0037, 0.0047, 0.0046],
          ...,
          [0.0036, 0.0038, 0.0041,  ..., 0.0043, 0.0037, 0.0038],
          [0.0042, 0.0051, 0.0035,  ..., 0.0044, 0.0030, 0.0042],
          [0.0037, 0.0033, 0.0039,  ..., 0.0046, 0.0043, 0.0040]],

         [[0.0037, 0.0046, 0.0044,  ..., 0.0033, 0.0047, 0.0033],
          [0.0037, 0.0039, 0.0039,  ..., 0.0040, 0.0044, 0.0040],
          [0.0043, 0.0035, 0.0046,  ..., 0.0038, 0.0044, 0.0034],
          ...,
          [0.0039, 0.0041, 0.0034,  ..., 0.0035, 0.0043, 0.0045],
          [0.0046, 0.0033, 0.0044,  ..., 0.0029, 0.0050, 0.0030],
          [0.0036, 0.0047, 0.0042,  ..., 0.0036, 0.0032, 0.0045]],

         [[0.0033, 0.0040, 0.0032,  ..., 0.0025, 0.0028, 0.0040],
          [0.0041, 0.0034, 0.0045,  ..., 0.0036, 0.0038, 0.0037],
          [0.0031, 0.0035, 0.0034,  ..., 0.0036, 0.0050, 0.0036],
          ...,
          [0.0035, 0.0036, 0.0039,  ..., 0.0038, 0.0045, 0.0048],
          [0.0050, 0.0042, 0.0042,  ..., 0.0033, 0.0033, 0.0037],
          [0.0036, 0.0036, 0.0038,  ..., 0.0040, 0.0045, 0.0038]],

         ...,

         [[0.0030, 0.0036, 0.0028,  ..., 0.0025, 0.0041, 0.0046],
          [0.0040, 0.0037, 0.0050,  ..., 0.0038, 0.0036, 0.0040],
          [0.0038, 0.0040, 0.0038,  ..., 0.0043, 0.0063, 0.0041],
          ...,
          [0.0041, 0.0035, 0.0029,  ..., 0.0027, 0.0030, 0.0046],
          [0.0039, 0.0044, 0.0040,  ..., 0.0038, 0.0038, 0.0038],
          [0.0040, 0.0038, 0.0038,  ..., 0.0037, 0.0036, 0.0048]],

         [[0.0039, 0.0033, 0.0036,  ..., 0.0041, 0.0049, 0.0041],
          [0.0057, 0.0043, 0.0045,  ..., 0.0038, 0.0046, 0.0036],
          [0.0029, 0.0041, 0.0032,  ..., 0.0039, 0.0041, 0.0043],
          ...,
          [0.0051, 0.0034, 0.0055,  ..., 0.0042, 0.0037, 0.0030],
          [0.0062, 0.0039, 0.0054,  ..., 0.0056, 0.0048, 0.0037],
          [0.0045, 0.0041, 0.0029,  ..., 0.0035, 0.0034, 0.0033]],

         [[0.0035, 0.0033, 0.0044,  ..., 0.0044, 0.0036, 0.0042],
          [0.0030, 0.0038, 0.0033,  ..., 0.0041, 0.0032, 0.0034],
          [0.0046, 0.0042, 0.0036,  ..., 0.0037, 0.0038, 0.0038],
          ...,
          [0.0051, 0.0027, 0.0051,  ..., 0.0026, 0.0032, 0.0044],
          [0.0039, 0.0031, 0.0038,  ..., 0.0042, 0.0045, 0.0043],
          [0.0052, 0.0031, 0.0044,  ..., 0.0038, 0.0026, 0.0036]]]]), modified_attrs={}, prev=None) 23345699354224
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0x84f5eb0)
tracing opcode LOAD_ATTR None pc=492 frame=11(0x84f5eb0)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=534 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=536 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=538 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=540 frame=11(0x84f5eb0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=546 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=548 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=550 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=552 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=554 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=556 frame=11(0x84f5eb0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=560 frame=11(0x84f5eb0)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=566 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=568 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=570 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=572 frame=11(0x84f5eb0)
tracing opcode BUILD_SLICE None pc=574 frame=11(0x84f5eb0)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0x84f5eb0)
tracing opcode LOAD_CONST None pc=578 frame=11(0x84f5eb0)
tracing opcode BINARY_ADD None pc=580 frame=11(0x84f5eb0)
tracing opcode STORE_FAST None pc=582 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0x84f5eb0)
tracing opcode LOAD_METHOD None pc=586 frame=11(0x84f5eb0)
tracing opcode LOAD_FAST None pc=588 frame=11(0x84f5eb0)
tracing opcode CALL_METHOD None pc=590 frame=11(0x84f5eb0)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0x84f5eb0)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0x84f5eb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0x84f5eb0)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0x84f5eb0)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_130 : [#users=1] = placeholder[target=tensor_130]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_130,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_134 : [#users=1] = placeholder[target=tensor_134]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_134, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_135 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_135, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_146 : [#users=1] = placeholder[target=tensor_146]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_146, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_147 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_147), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0x84f5eb0)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0x9f54a30)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0x9f54a30)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0x9f54a30)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0x9f54a30)
tracing opcode LOAD_CONST None pc=46 frame=10(0x9f54a30)
tracing opcode IS_OP None pc=48 frame=10(0x9f54a30)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0x9f54a30)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0x9f54a30)
tracing opcode STORE_FAST None pc=54 frame=10(0x9f54a30)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0x9f54a30)
tracing opcode LOAD_METHOD None pc=58 frame=10(0x9f54a30)
tracing opcode LOAD_FAST None pc=60 frame=10(0x9f54a30)
tracing opcode LOAD_FAST None pc=62 frame=10(0x9f54a30)
tracing opcode CALL_METHOD None pc=64 frame=10(0x9f54a30)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bc0ad7040)
push tracker due to record
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bc0ad7040)
load fast: 23346416249488
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bc0ad7040)
load fast: 23345699577920
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bc0ad7040)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bc0ad7040)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bc0ad7040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416249632
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23345592484064
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_151 : [#users=0] = placeholder[target=tensor_151]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0252,  0.0627, -0.1563,  ...,  0.0492,  0.0290,  0.0266],
         [ 0.0257,  0.0614, -0.1617,  ...,  0.0422,  0.0293,  0.0221],
         [ 0.0212,  0.0586, -0.1503,  ...,  0.0365,  0.0291,  0.0235],
         ...,
         [ 0.0220,  0.0728, -0.1561,  ...,  0.0379,  0.0234,  0.0259],
         [ 0.0216,  0.0666, -0.1511,  ...,  0.0354,  0.0229,  0.0243],
         [ 0.0240,  0.0683, -0.1587,  ...,  0.0402,  0.0238,  0.0295]]]), modified_attrs={}, prev=None) 23346057066240 23345592484064
obj: tensor([[[ 0.0252,  0.0627, -0.1563,  ...,  0.0492,  0.0290,  0.0266],
         [ 0.0257,  0.0614, -0.1617,  ...,  0.0422,  0.0293,  0.0221],
         [ 0.0212,  0.0586, -0.1503,  ...,  0.0365,  0.0291,  0.0235],
         ...,
         [ 0.0220,  0.0728, -0.1561,  ...,  0.0379,  0.0234,  0.0259],
         [ 0.0216,  0.0666, -0.1511,  ...,  0.0354,  0.0229,  0.0243],
         [ 0.0240,  0.0683, -0.1587,  ...,  0.0402,  0.0238,  0.0295]]]) 23345592484064
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0252,  0.0627, -0.1563,  ...,  0.0492,  0.0290,  0.0266],
         [ 0.0257,  0.0614, -0.1617,  ...,  0.0422,  0.0293,  0.0221],
         [ 0.0212,  0.0586, -0.1503,  ...,  0.0365,  0.0291,  0.0235],
         ...,
         [ 0.0220,  0.0728, -0.1561,  ...,  0.0379,  0.0234,  0.0259],
         [ 0.0216,  0.0666, -0.1511,  ...,  0.0354,  0.0229,  0.0243],
         [ 0.0240,  0.0683, -0.1587,  ...,  0.0402,  0.0238,  0.0295]]]), modified_attrs={}, prev=None) 23345592568128
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bc0ad7040)
load fast: 23345913442848
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bc0ad7040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bc0ad7040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153bc2c6b9f0)
push tracker due to record
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153bc2c6b9f0)
load fast: 23345592563888
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153bc2c6b9f0)
tracing opcode STORE_FAST None pc=14 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153bc2c6b9f0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153b91c078b0>
tracing opcode STORE_FAST None pc=36 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153bc2c6b9f0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153b91bf8f40>
tracing opcode STORE_FAST None pc=60 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153bc2c6b9f0)
load fast: 23346416249584
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153bc2c6b9f0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153bc2c6b9f0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_153 : [#users=4] = placeholder[target=tensor_153]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_153,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_153, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_153, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_153, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153b91c078b0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bc0ad7040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_150 : [#users=1] = placeholder[target=tensor_150]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_150,), kwargs = {})
    %tensor_152 : [#users=1] = placeholder[target=tensor_152]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_152), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0x9f54a30)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0x9f54a30)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0x9f54a30)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0x9f54a30)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0x9f54a30)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_127 : [#users=2] = placeholder[target=tensor_127]
    %tensor_128 : [#users=1] = placeholder[target=tensor_128]
    %tensor_129 : [#users=1] = placeholder[target=tensor_129]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_127,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_129, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_135 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_135, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_128, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_147 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_147), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_127), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0x9f54a30)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0x84f6ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0x84f6ae0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0x84f6ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0x84f6ae0)
tracing opcode LOAD_METHOD None pc=46 frame=9(0x84f6ae0)
tracing opcode LOAD_FAST None pc=48 frame=9(0x84f6ae0)
tracing opcode CALL_METHOD None pc=50 frame=9(0x84f6ae0)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x86b7920)
push tracker due to record
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x86b7920)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x86b7920)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x86b7920 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x86b7920)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x86b7920)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x86b7920)
load fast: 23346416249680
tracing opcode LOAD_METHOD None pc=12 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=14 frame=18(0x86b7920)
load fast: 23345592444544
tracing opcode CALL_METHOD None pc=16 frame=18(0x86b7920)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x86b7920)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x86b7920)
tracing opcode LOAD_FAST None pc=24 frame=18(0x86b7920)
tracing opcode CALL_METHOD None pc=26 frame=18(0x86b7920)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0x7dd42f0)
push tracker due to record
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0x7dd42f0 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0x7dd42f0)
load fast: 23346416249776
tracing opcode LOAD_METHOD None pc=12 frame=19(0x7dd42f0)
tracing opcode LOAD_FAST None pc=14 frame=19(0x7dd42f0)
load fast: 23345521150048
tracing opcode CALL_METHOD None pc=16 frame=19(0x7dd42f0)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_155 : [#users=1] = placeholder[target=tensor_155]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_155,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0x7dd42f0)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x86b7920)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x86b7920)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x86b7920)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_154 : [#users=1] = placeholder[target=tensor_154]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_154,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x86b7920)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0x84f6ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0x84f6ae0)
tracing opcode LOAD_METHOD None pc=56 frame=9(0x84f6ae0)
tracing opcode LOAD_FAST None pc=58 frame=9(0x84f6ae0)
tracing opcode LOAD_FAST None pc=60 frame=9(0x84f6ae0)
tracing opcode CALL_METHOD None pc=62 frame=9(0x84f6ae0)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x951af10)
push tracker due to record
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x951af10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x951af10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x951af10)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x951af10)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x951af10)
load fast: 23346416249824
tracing opcode LOAD_METHOD None pc=12 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=14 frame=20(0x951af10)
load fast: 23345592501488
tracing opcode CALL_METHOD None pc=16 frame=20(0x951af10)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=24 frame=20(0x951af10)
tracing opcode CALL_METHOD None pc=26 frame=20(0x951af10)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153bc2c0a610)
push tracker due to record
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153bc2c0a610 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153bc2c0a610)
load fast: 23346416249968
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153bc2c0a610)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153bc2c0a610)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153bc2c0a610)
load fast: 23345521193744
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_157 : [#users=0] = placeholder[target=tensor_157]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-0.0234,  0.2464,  0.2420,  ..., -0.0649, -0.1497, -0.2252],
         [ 0.6665, -0.1165, -0.1286,  ...,  0.4271, -0.0499,  0.3146],
         [-0.1903, -0.3080, -0.0277,  ...,  0.0499,  0.1785,  0.4989],
         ...,
         [-0.2065, -0.2208,  0.0891,  ..., -0.7240,  0.3929, -0.2006],
         [ 0.4100,  0.0146, -0.0983,  ...,  0.6701, -0.6673, -0.0145],
         [-0.3089, -0.2438,  0.5386,  ...,  0.8545, -0.0794, -1.0119]]]), modified_attrs={}, prev=None) 23345521191616 23345521193744
obj: tensor([[[-0.0234,  0.2464,  0.2420,  ..., -0.0649, -0.1497, -0.2252],
         [ 0.6665, -0.1165, -0.1286,  ...,  0.4271, -0.0499,  0.3146],
         [-0.1903, -0.3080, -0.0277,  ...,  0.0499,  0.1785,  0.4989],
         ...,
         [-0.2065, -0.2208,  0.0891,  ..., -0.7240,  0.3929, -0.2006],
         [ 0.4100,  0.0146, -0.0983,  ...,  0.6701, -0.6673, -0.0145],
         [-0.3089, -0.2438,  0.5386,  ...,  0.8545, -0.0794, -1.0119]]]) 23345521193744
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.0234,  0.2464,  0.2420,  ..., -0.0649, -0.1497, -0.2252],
         [ 0.6665, -0.1165, -0.1286,  ...,  0.4271, -0.0499,  0.3146],
         [-0.1903, -0.3080, -0.0277,  ...,  0.0499,  0.1785,  0.4989],
         ...,
         [-0.2065, -0.2208,  0.0891,  ..., -0.7240,  0.3929, -0.2006],
         [ 0.4100,  0.0146, -0.0983,  ...,  0.6701, -0.6673, -0.0145],
         [-0.3089, -0.2438,  0.5386,  ...,  0.8545, -0.0794, -1.0119]]]), modified_attrs={}, prev=None) 23345592371568
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153bc2c0a610)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=34 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=36 frame=20(0x951af10)
load fast: 23345592444544
tracing opcode BINARY_ADD None pc=38 frame=20(0x951af10)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x951af10)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153bc2c6b9f0)
push tracker due to record
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153bc2c6b9f0)
load fast: 23345521196384
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153bc2c6b9f0)
tracing opcode STORE_FAST None pc=14 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153bc2c6b9f0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153b8d7f7d60>
tracing opcode STORE_FAST None pc=36 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153bc2c6b9f0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153b8d7f99f0>
tracing opcode STORE_FAST None pc=60 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153bc2c6b9f0)
load fast: 23346416249920
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153bc2c6b9f0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153bc2c6b9f0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_159 : [#users=4] = placeholder[target=tensor_159]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_159,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_159, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_159, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_159, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153b8d7f7d60>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x951af10)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x951af10)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_156 : [#users=1] = placeholder[target=tensor_156]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_156,), kwargs = {})
    %tensor_158 : [#users=1] = placeholder[target=tensor_158]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_158), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x951af10)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0x84f6ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0x84f6ae0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0x84f6ae0)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0x84f6ae0)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0x84f6ae0)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_124 : [#users=2] = placeholder[target=tensor_124]
    %tensor_125 : [#users=1] = placeholder[target=tensor_125]
    %tensor_126 : [#users=1] = placeholder[target=tensor_126]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_124,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_126, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_135 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_135, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_125, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_147 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_147), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_124), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0x84f6ae0)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0x9f6a270)
push tracker due to record
push tracker 9 frame 0x9f6a270 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0x9f6a270)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0x9f6a270)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0x9f6a270 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0x9f6a270)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0x9f6a270)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0x9f6a270)
load fast: 23346416250016
tracing opcode LOAD_ATTR None pc=12 frame=9(0x9f6a270)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0x9f6a270)
load fast: 23345521283216
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0x9f6a270)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0x9f6a270)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0x9f6a270)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0x9f6a270)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0x9f6a270)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0x9f6a270)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0x9f6a270)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0x8c6c980)
push tracker due to record
push tracker 10 frame 0x8c6c980 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0x8c6c980)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0x8c6c980)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0x8c6c980 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0x8c6c980)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0x8c6c980)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0x8c6c980)
load fast: 23346416250064
tracing opcode LOAD_ATTR None pc=12 frame=10(0x8c6c980)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0x8c6c980)
load fast: 23345521283216
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0x8c6c980)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0x8c6c980)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0x8c6c980)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0x8c6c980)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0x8c6c980)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0x8c6c980)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0x8c6c980)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0x9a640b0)
push tracker due to record
push tracker 11 frame 0x9a640b0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0x9a640b0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0x9a640b0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0x9a640b0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0x9a640b0)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0x9a640b0)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0x9a640b0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0x9a640b0)
tracing opcode IS_OP None pc=16 frame=11(0x9a640b0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0x9a640b0)
load fast: 23346416250112
tracing opcode LOAD_METHOD None pc=22 frame=11(0x9a640b0)
tracing opcode LOAD_DEREF None pc=24 frame=11(0x9a640b0)
load fast: 23345521283216
tracing opcode CALL_METHOD None pc=26 frame=11(0x9a640b0)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=32 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=34 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=36 frame=11(0x9a640b0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23345449953936
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416250112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_167 : [#users=1] = placeholder[target=tensor_167]
    %view : [#users=1] = call_method[target=view](args = (%tensor_167, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=40 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=42 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=44 frame=11(0x9a640b0)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0x9a640b0)
record function in graph <built-in method chunk of Tensor object at 0x153b893f3810>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0x9a640b0)
tracing opcode STORE_FAST None pc=50 frame=11(0x9a640b0)
tracing opcode STORE_FAST None pc=52 frame=11(0x9a640b0)
tracing opcode STORE_FAST None pc=54 frame=11(0x9a640b0)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0x9a640b0)
tracing opcode LOAD_DEREF None pc=224 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=226 frame=11(0x9a640b0)
tracing opcode LOAD_DEREF None pc=228 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=230 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=232 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=234 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=236 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=238 frame=11(0x9a640b0)
tracing opcode BUILD_SLICE None pc=240 frame=11(0x9a640b0)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0x9a640b0)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0x9a640b0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0x9a640b0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23345449968320
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416250112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_168 : [#users=1] = placeholder[target=tensor_168]
    %view : [#users=1] = call_method[target=view](args = (%tensor_168, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0x9a640b0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0x9a640b0)
tracing opcode LOAD_DEREF None pc=254 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=256 frame=11(0x9a640b0)
tracing opcode LOAD_DEREF None pc=258 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=260 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=262 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=264 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=266 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=268 frame=11(0x9a640b0)
tracing opcode BUILD_SLICE None pc=270 frame=11(0x9a640b0)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0x9a640b0)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0x9a640b0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0x9a640b0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344550049088
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416250112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_169 : [#users=1] = placeholder[target=tensor_169]
    %view : [#users=1] = call_method[target=view](args = (%tensor_169, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0x9a640b0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0x9a640b0)
tracing opcode STORE_FAST None pc=284 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0x9a640b0)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0x9a640b0)
tracing opcode LOAD_DEREF None pc=290 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=292 frame=11(0x9a640b0)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0x9a640b0)
tracing opcode BINARY_ADD None pc=296 frame=11(0x9a640b0)
tracing opcode STORE_FAST None pc=298 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=302 frame=11(0x9a640b0)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=306 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=308 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=310 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=312 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=314 frame=11(0x9a640b0)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=318 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=320 frame=11(0x9a640b0)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0x9a640b0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0x9a640b0)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0x9a640b0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0x9a640b0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=334 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=336 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=338 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=340 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=342 frame=11(0x9a640b0)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0x9a640b0)
record function in graph <built-in method to of Tensor object at 0x153b539b4450>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0x9a640b0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=352 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=354 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=356 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=358 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=360 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=362 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=364 frame=11(0x9a640b0)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0x9a640b0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=372 frame=11(0x9a640b0)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=380 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=382 frame=11(0x9a640b0)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0x9a640b0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346416250208
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=390 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=392 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=394 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=396 frame=11(0x9a640b0)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=400 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=402 frame=11(0x9a640b0)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0x8501c60)
push tracker due to record
push tracker 13 frame 0x8501c60 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0x8501c60)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0x8501c60)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0x8501c60 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0x8501c60)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0x8501c60)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0x8501c60)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0x8501c60)
tracing opcode IS_OP None pc=16 frame=13(0x8501c60)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=52 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=54 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=56 frame=13(0x8501c60)
tracing opcode COMPARE_OP None pc=58 frame=13(0x8501c60)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=82 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=84 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=86 frame=13(0x8501c60)
tracing opcode COMPARE_OP None pc=88 frame=13(0x8501c60)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=94 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=96 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=98 frame=13(0x8501c60)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0x8501c60)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0x8501c60)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=138 frame=13(0x8501c60)
load fast: 23345449938272
tracing opcode LOAD_METHOD None pc=140 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=142 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=144 frame=13(0x8501c60)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0x8501c60)
load fast: 23345449923984
tracing opcode LOAD_METHOD None pc=148 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=150 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=152 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=156 frame=13(0x8501c60)
load fast: 23346416250112
tracing opcode LOAD_ATTR None pc=158 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0x8501c60)
tracing opcode STORE_FAST None pc=162 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=166 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=168 frame=13(0x8501c60)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=172 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=174 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=176 frame=13(0x8501c60)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0x8501c60)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=184 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=186 frame=13(0x8501c60)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=190 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=192 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=194 frame=13(0x8501c60)
tracing opcode BINARY_ADD None pc=196 frame=13(0x8501c60)
tracing opcode BUILD_SLICE None pc=198 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=200 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=202 frame=13(0x8501c60)
tracing opcode BUILD_SLICE None pc=204 frame=13(0x8501c60)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0x8501c60)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0x8501c60)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0x8501c60)
tracing opcode STORE_FAST None pc=220 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=224 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=226 frame=13(0x8501c60)
tracing opcode CONTAINS_OP None pc=228 frame=13(0x8501c60)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=236 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=238 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=240 frame=13(0x8501c60)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=246 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=248 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=250 frame=13(0x8501c60)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344549907168
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416250112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_174 : [#users=1] = placeholder[target=tensor_174]
    %view : [#users=1] = call_method[target=view](args = (%tensor_174, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=256 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=258 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=260 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=262 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=264 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=266 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=268 frame=13(0x8501c60)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0x8501c60)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=276 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=278 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=280 frame=13(0x8501c60)
tracing opcode BINARY_ADD None pc=282 frame=13(0x8501c60)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=286 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=288 frame=13(0x8501c60)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=292 frame=13(0x8501c60)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=296 frame=13(0x8501c60)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=302 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=304 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=306 frame=13(0x8501c60)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=310 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=312 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=314 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0x8501c60)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23344549979296
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23345449938272
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23344549940976
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_175 : [#users=1] = placeholder[target=tensor_175]
    %tensor_176 : [#users=0] = placeholder[target=tensor_176]
    %tensor_177 : [#users=0] = placeholder[target=tensor_177]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_175, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0x8501c60)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=326 frame=13(0x8501c60)
tracing opcode INPLACE_ADD None pc=328 frame=13(0x8501c60)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=334 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=336 frame=13(0x8501c60)
tracing opcode CONTAINS_OP None pc=338 frame=13(0x8501c60)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=346 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=348 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=350 frame=13(0x8501c60)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=356 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=358 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=360 frame=13(0x8501c60)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344549962352
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346416250112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_178 : [#users=1] = placeholder[target=tensor_178]
    %view : [#users=1] = call_method[target=view](args = (%tensor_178, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0x8501c60)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=368 frame=13(0x8501c60)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=372 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=374 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=376 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=378 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=380 frame=13(0x8501c60)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=384 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=386 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0x8501c60)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0x8501c60)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0x8501c60)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0x8501c60)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0x8501c60)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=402 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=404 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=406 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=408 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=410 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=412 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=414 frame=13(0x8501c60)
tracing opcode COMPARE_OP None pc=416 frame=13(0x8501c60)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0x8501c60)
tracing opcode STORE_FAST None pc=452 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=456 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=458 frame=13(0x8501c60)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0x8501c60)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0x8501c60)
tracing opcode BINARY_ADD None pc=464 frame=13(0x8501c60)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=468 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=470 frame=13(0x8501c60)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=474 frame=13(0x8501c60)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=478 frame=13(0x8501c60)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=484 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=486 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=488 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=490 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=492 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=494 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=496 frame=13(0x8501c60)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=500 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=502 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=504 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0x8501c60)
record function in graph <built-in method to of Tensor object at 0x153b539ba3b0>
tracing opcode CALL_METHOD None pc=508 frame=13(0x8501c60)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0x8501c60)
tracing opcode LOAD_ATTR None pc=514 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=518 frame=13(0x8501c60)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=522 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=524 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=526 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0x8501c60)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23345521196144
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23345449938272
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23345449923984
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_179 : [#users=1] = placeholder[target=tensor_179]
    %tensor_180 : [#users=0] = placeholder[target=tensor_180]
    %tensor_181 : [#users=0] = placeholder[target=tensor_181]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_179, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0x8501c60)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0x8501c60)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=538 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0x8501c60)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=546 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=548 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=550 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=552 frame=13(0x8501c60)
tracing opcode LOAD_METHOD None pc=554 frame=13(0x8501c60)
tracing opcode LOAD_CONST None pc=556 frame=13(0x8501c60)
tracing opcode CALL_METHOD None pc=558 frame=13(0x8501c60)
tracing opcode COMPARE_OP None pc=560 frame=13(0x8501c60)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0x8501c60)
tracing opcode LOAD_FAST None pc=626 frame=13(0x8501c60)
tracing opcode INPLACE_ADD None pc=628 frame=13(0x8501c60)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0x8501c60)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0x8501c60)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0x8501c60)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_171 : [#users=1] = placeholder[target=tensor_171]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_171, 1), kwargs = {})
    %tensor_172 : [#users=1] = placeholder[target=tensor_172]
    %tensor_173 : [#users=1] = placeholder[target=tensor_173]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_172, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_173, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0x8501c60)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=408 frame=11(0x9a640b0)
tracing opcode IS_OP None pc=410 frame=11(0x9a640b0)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=418 frame=11(0x9a640b0)
tracing opcode BINARY_ADD None pc=420 frame=11(0x9a640b0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=426 frame=11(0x9a640b0)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=468 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=470 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=472 frame=11(0x9a640b0)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=476 frame=11(0x9a640b0)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b8b0> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654853296
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b8b0> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23344550049648
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_183 : [#users=1] = placeholder[target=tensor_183]
    %to : [#users=1] = call_method[target=to](args = (%tensor_183, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_184 : [#users=1] = placeholder[target=tensor_184]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_184, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=482 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=484 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=486 frame=11(0x9a640b0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346416250352
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23344549597968
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_185 : [#users=0] = placeholder[target=tensor_185]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0046, 0.0044, 0.0040,  ..., 0.0045, 0.0037, 0.0038],
          [0.0039, 0.0039, 0.0032,  ..., 0.0039, 0.0052, 0.0036],
          [0.0043, 0.0039, 0.0037,  ..., 0.0043, 0.0046, 0.0034],
          ...,
          [0.0037, 0.0041, 0.0045,  ..., 0.0046, 0.0037, 0.0042],
          [0.0042, 0.0044, 0.0027,  ..., 0.0040, 0.0050, 0.0040],
          [0.0034, 0.0032, 0.0051,  ..., 0.0036, 0.0046, 0.0039]],

         [[0.0039, 0.0047, 0.0037,  ..., 0.0039, 0.0045, 0.0039],
          [0.0039, 0.0032, 0.0041,  ..., 0.0038, 0.0039, 0.0035],
          [0.0034, 0.0045, 0.0052,  ..., 0.0045, 0.0032, 0.0030],
          ...,
          [0.0033, 0.0048, 0.0032,  ..., 0.0038, 0.0031, 0.0042],
          [0.0051, 0.0047, 0.0043,  ..., 0.0037, 0.0045, 0.0035],
          [0.0040, 0.0044, 0.0031,  ..., 0.0046, 0.0038, 0.0038]],

         [[0.0037, 0.0032, 0.0042,  ..., 0.0034, 0.0032, 0.0035],
          [0.0037, 0.0031, 0.0041,  ..., 0.0037, 0.0029, 0.0043],
          [0.0056, 0.0036, 0.0035,  ..., 0.0034, 0.0042, 0.0047],
          ...,
          [0.0037, 0.0036, 0.0046,  ..., 0.0030, 0.0050, 0.0049],
          [0.0039, 0.0050, 0.0032,  ..., 0.0041, 0.0031, 0.0032],
          [0.0043, 0.0043, 0.0034,  ..., 0.0031, 0.0025, 0.0050]],

         ...,

         [[0.0036, 0.0039, 0.0037,  ..., 0.0041, 0.0039, 0.0040],
          [0.0041, 0.0039, 0.0029,  ..., 0.0035, 0.0035, 0.0033],
          [0.0037, 0.0035, 0.0040,  ..., 0.0040, 0.0048, 0.0041],
          ...,
          [0.0036, 0.0038, 0.0033,  ..., 0.0052, 0.0049, 0.0041],
          [0.0039, 0.0036, 0.0041,  ..., 0.0040, 0.0033, 0.0033],
          [0.0030, 0.0042, 0.0038,  ..., 0.0047, 0.0029, 0.0037]],

         [[0.0039, 0.0035, 0.0043,  ..., 0.0025, 0.0029, 0.0060],
          [0.0057, 0.0032, 0.0061,  ..., 0.0032, 0.0035, 0.0042],
          [0.0051, 0.0049, 0.0039,  ..., 0.0021, 0.0042, 0.0041],
          ...,
          [0.0048, 0.0035, 0.0039,  ..., 0.0034, 0.0044, 0.0047],
          [0.0033, 0.0031, 0.0049,  ..., 0.0039, 0.0050, 0.0047],
          [0.0056, 0.0053, 0.0035,  ..., 0.0028, 0.0053, 0.0025]],

         [[0.0036, 0.0042, 0.0031,  ..., 0.0033, 0.0044, 0.0054],
          [0.0039, 0.0038, 0.0043,  ..., 0.0044, 0.0038, 0.0031],
          [0.0055, 0.0031, 0.0035,  ..., 0.0037, 0.0050, 0.0054],
          ...,
          [0.0040, 0.0039, 0.0033,  ..., 0.0042, 0.0039, 0.0039],
          [0.0059, 0.0034, 0.0043,  ..., 0.0041, 0.0050, 0.0041],
          [0.0035, 0.0035, 0.0041,  ..., 0.0048, 0.0041, 0.0027]]]]), modified_attrs={}, prev=None) 23344549816544 23344549597968
obj: tensor([[[[0.0046, 0.0044, 0.0040,  ..., 0.0045, 0.0037, 0.0038],
          [0.0039, 0.0039, 0.0032,  ..., 0.0039, 0.0052, 0.0036],
          [0.0043, 0.0039, 0.0037,  ..., 0.0043, 0.0046, 0.0034],
          ...,
          [0.0037, 0.0041, 0.0045,  ..., 0.0046, 0.0037, 0.0042],
          [0.0042, 0.0044, 0.0027,  ..., 0.0040, 0.0050, 0.0040],
          [0.0034, 0.0032, 0.0051,  ..., 0.0036, 0.0046, 0.0039]],

         [[0.0039, 0.0047, 0.0037,  ..., 0.0039, 0.0045, 0.0039],
          [0.0039, 0.0032, 0.0041,  ..., 0.0038, 0.0039, 0.0035],
          [0.0034, 0.0045, 0.0052,  ..., 0.0045, 0.0032, 0.0030],
          ...,
          [0.0033, 0.0048, 0.0032,  ..., 0.0038, 0.0031, 0.0042],
          [0.0051, 0.0047, 0.0043,  ..., 0.0037, 0.0045, 0.0035],
          [0.0040, 0.0044, 0.0031,  ..., 0.0046, 0.0038, 0.0038]],

         [[0.0037, 0.0032, 0.0042,  ..., 0.0034, 0.0032, 0.0035],
          [0.0037, 0.0031, 0.0041,  ..., 0.0037, 0.0029, 0.0043],
          [0.0056, 0.0036, 0.0035,  ..., 0.0034, 0.0042, 0.0047],
          ...,
          [0.0037, 0.0036, 0.0046,  ..., 0.0030, 0.0050, 0.0049],
          [0.0039, 0.0050, 0.0032,  ..., 0.0041, 0.0031, 0.0032],
          [0.0043, 0.0043, 0.0034,  ..., 0.0031, 0.0025, 0.0050]],

         ...,

         [[0.0036, 0.0039, 0.0037,  ..., 0.0041, 0.0039, 0.0040],
          [0.0041, 0.0039, 0.0029,  ..., 0.0035, 0.0035, 0.0033],
          [0.0037, 0.0035, 0.0040,  ..., 0.0040, 0.0048, 0.0041],
          ...,
          [0.0036, 0.0038, 0.0033,  ..., 0.0052, 0.0049, 0.0041],
          [0.0039, 0.0036, 0.0041,  ..., 0.0040, 0.0033, 0.0033],
          [0.0030, 0.0042, 0.0038,  ..., 0.0047, 0.0029, 0.0037]],

         [[0.0039, 0.0035, 0.0043,  ..., 0.0025, 0.0029, 0.0060],
          [0.0057, 0.0032, 0.0061,  ..., 0.0032, 0.0035, 0.0042],
          [0.0051, 0.0049, 0.0039,  ..., 0.0021, 0.0042, 0.0041],
          ...,
          [0.0048, 0.0035, 0.0039,  ..., 0.0034, 0.0044, 0.0047],
          [0.0033, 0.0031, 0.0049,  ..., 0.0039, 0.0050, 0.0047],
          [0.0056, 0.0053, 0.0035,  ..., 0.0028, 0.0053, 0.0025]],

         [[0.0036, 0.0042, 0.0031,  ..., 0.0033, 0.0044, 0.0054],
          [0.0039, 0.0038, 0.0043,  ..., 0.0044, 0.0038, 0.0031],
          [0.0055, 0.0031, 0.0035,  ..., 0.0037, 0.0050, 0.0054],
          ...,
          [0.0040, 0.0039, 0.0033,  ..., 0.0042, 0.0039, 0.0039],
          [0.0059, 0.0034, 0.0043,  ..., 0.0041, 0.0050, 0.0041],
          [0.0035, 0.0035, 0.0041,  ..., 0.0048, 0.0041, 0.0027]]]]) 23344549597968
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0046, 0.0044, 0.0040,  ..., 0.0045, 0.0037, 0.0038],
          [0.0039, 0.0039, 0.0032,  ..., 0.0039, 0.0052, 0.0036],
          [0.0043, 0.0039, 0.0037,  ..., 0.0043, 0.0046, 0.0034],
          ...,
          [0.0037, 0.0041, 0.0045,  ..., 0.0046, 0.0037, 0.0042],
          [0.0042, 0.0044, 0.0027,  ..., 0.0040, 0.0050, 0.0040],
          [0.0034, 0.0032, 0.0051,  ..., 0.0036, 0.0046, 0.0039]],

         [[0.0039, 0.0047, 0.0037,  ..., 0.0039, 0.0045, 0.0039],
          [0.0039, 0.0032, 0.0041,  ..., 0.0038, 0.0039, 0.0035],
          [0.0034, 0.0045, 0.0052,  ..., 0.0045, 0.0032, 0.0030],
          ...,
          [0.0033, 0.0048, 0.0032,  ..., 0.0038, 0.0031, 0.0042],
          [0.0051, 0.0047, 0.0043,  ..., 0.0037, 0.0045, 0.0035],
          [0.0040, 0.0044, 0.0031,  ..., 0.0046, 0.0038, 0.0038]],

         [[0.0037, 0.0032, 0.0042,  ..., 0.0034, 0.0032, 0.0035],
          [0.0037, 0.0031, 0.0041,  ..., 0.0037, 0.0029, 0.0043],
          [0.0056, 0.0036, 0.0035,  ..., 0.0034, 0.0042, 0.0047],
          ...,
          [0.0037, 0.0036, 0.0046,  ..., 0.0030, 0.0050, 0.0049],
          [0.0039, 0.0050, 0.0032,  ..., 0.0041, 0.0031, 0.0032],
          [0.0043, 0.0043, 0.0034,  ..., 0.0031, 0.0025, 0.0050]],

         ...,

         [[0.0036, 0.0039, 0.0037,  ..., 0.0041, 0.0039, 0.0040],
          [0.0041, 0.0039, 0.0029,  ..., 0.0035, 0.0035, 0.0033],
          [0.0037, 0.0035, 0.0040,  ..., 0.0040, 0.0048, 0.0041],
          ...,
          [0.0036, 0.0038, 0.0033,  ..., 0.0052, 0.0049, 0.0041],
          [0.0039, 0.0036, 0.0041,  ..., 0.0040, 0.0033, 0.0033],
          [0.0030, 0.0042, 0.0038,  ..., 0.0047, 0.0029, 0.0037]],

         [[0.0039, 0.0035, 0.0043,  ..., 0.0025, 0.0029, 0.0060],
          [0.0057, 0.0032, 0.0061,  ..., 0.0032, 0.0035, 0.0042],
          [0.0051, 0.0049, 0.0039,  ..., 0.0021, 0.0042, 0.0041],
          ...,
          [0.0048, 0.0035, 0.0039,  ..., 0.0034, 0.0044, 0.0047],
          [0.0033, 0.0031, 0.0049,  ..., 0.0039, 0.0050, 0.0047],
          [0.0056, 0.0053, 0.0035,  ..., 0.0028, 0.0053, 0.0025]],

         [[0.0036, 0.0042, 0.0031,  ..., 0.0033, 0.0044, 0.0054],
          [0.0039, 0.0038, 0.0043,  ..., 0.0044, 0.0038, 0.0031],
          [0.0055, 0.0031, 0.0035,  ..., 0.0037, 0.0050, 0.0054],
          ...,
          [0.0040, 0.0039, 0.0033,  ..., 0.0042, 0.0039, 0.0039],
          [0.0059, 0.0034, 0.0043,  ..., 0.0041, 0.0050, 0.0041],
          [0.0035, 0.0035, 0.0041,  ..., 0.0048, 0.0041, 0.0027]]]]), modified_attrs={}, prev=None) 23344549818176
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0x9a640b0)
tracing opcode LOAD_ATTR None pc=492 frame=11(0x9a640b0)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=534 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=536 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=538 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=540 frame=11(0x9a640b0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=546 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=548 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=550 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=552 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=554 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=556 frame=11(0x9a640b0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=560 frame=11(0x9a640b0)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=566 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=568 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=570 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=572 frame=11(0x9a640b0)
tracing opcode BUILD_SLICE None pc=574 frame=11(0x9a640b0)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0x9a640b0)
tracing opcode LOAD_CONST None pc=578 frame=11(0x9a640b0)
tracing opcode BINARY_ADD None pc=580 frame=11(0x9a640b0)
tracing opcode STORE_FAST None pc=582 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0x9a640b0)
tracing opcode LOAD_METHOD None pc=586 frame=11(0x9a640b0)
tracing opcode LOAD_FAST None pc=588 frame=11(0x9a640b0)
tracing opcode CALL_METHOD None pc=590 frame=11(0x9a640b0)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0x9a640b0)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0x9a640b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0x9a640b0)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0x9a640b0)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_166 : [#users=1] = placeholder[target=tensor_166]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_166,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_170 : [#users=1] = placeholder[target=tensor_170]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_170, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_171 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_171, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_182 : [#users=1] = placeholder[target=tensor_182]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_182, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_183 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_183), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0x9a640b0)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0x8c6c980)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0x8c6c980)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0x8c6c980)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0x8c6c980)
tracing opcode LOAD_CONST None pc=46 frame=10(0x8c6c980)
tracing opcode IS_OP None pc=48 frame=10(0x8c6c980)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0x8c6c980)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0x8c6c980)
tracing opcode STORE_FAST None pc=54 frame=10(0x8c6c980)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0x8c6c980)
tracing opcode LOAD_METHOD None pc=58 frame=10(0x8c6c980)
tracing opcode LOAD_FAST None pc=60 frame=10(0x8c6c980)
tracing opcode LOAD_FAST None pc=62 frame=10(0x8c6c980)
tracing opcode CALL_METHOD None pc=64 frame=10(0x8c6c980)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bc0ad7040)
push tracker due to record
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bc0ad7040 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bc0ad7040)
load fast: 23346416250400
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bc0ad7040)
load fast: 23344549600688
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bc0ad7040)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bc0ad7040)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bc0ad7040)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346416250544
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23344549631136
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_187 : [#users=0] = placeholder[target=tensor_187]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0275,  0.0756, -0.0470,  ...,  0.0774,  0.0059,  0.0426],
         [ 0.0237,  0.0635, -0.0529,  ...,  0.0781,  0.0128,  0.0507],
         [ 0.0277,  0.0614, -0.0459,  ...,  0.0828,  0.0155,  0.0410],
         ...,
         [ 0.0257,  0.0741, -0.0503,  ...,  0.0772,  0.0138,  0.0472],
         [ 0.0253,  0.0635, -0.0477,  ...,  0.0779,  0.0144,  0.0443],
         [ 0.0264,  0.0633, -0.0457,  ...,  0.0795,  0.0173,  0.0380]]]), modified_attrs={}, prev=None) 23344549706768 23344549631136
obj: tensor([[[ 0.0275,  0.0756, -0.0470,  ...,  0.0774,  0.0059,  0.0426],
         [ 0.0237,  0.0635, -0.0529,  ...,  0.0781,  0.0128,  0.0507],
         [ 0.0277,  0.0614, -0.0459,  ...,  0.0828,  0.0155,  0.0410],
         ...,
         [ 0.0257,  0.0741, -0.0503,  ...,  0.0772,  0.0138,  0.0472],
         [ 0.0253,  0.0635, -0.0477,  ...,  0.0779,  0.0144,  0.0443],
         [ 0.0264,  0.0633, -0.0457,  ...,  0.0795,  0.0173,  0.0380]]]) 23344549631136
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0275,  0.0756, -0.0470,  ...,  0.0774,  0.0059,  0.0426],
         [ 0.0237,  0.0635, -0.0529,  ...,  0.0781,  0.0128,  0.0507],
         [ 0.0277,  0.0614, -0.0459,  ...,  0.0828,  0.0155,  0.0410],
         ...,
         [ 0.0257,  0.0741, -0.0503,  ...,  0.0772,  0.0138,  0.0472],
         [ 0.0253,  0.0635, -0.0477,  ...,  0.0779,  0.0144,  0.0443],
         [ 0.0264,  0.0633, -0.0457,  ...,  0.0795,  0.0173,  0.0380]]]), modified_attrs={}, prev=None) 23344549704272
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bc0ad7040)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bc0ad7040)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bc0ad7040)
load fast: 23345521283216
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bc0ad7040)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bc0ad7040)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153bc2c6b9f0)
push tracker due to record
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153bc2c6b9f0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153bc2c6b9f0)
load fast: 23344549632176
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153bc2c6b9f0)
tracing opcode STORE_FAST None pc=14 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153bc2c6b9f0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153b539698b0>
tracing opcode STORE_FAST None pc=36 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153bc2c6b9f0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method mean of Tensor object at 0x153b5392fcc0>
tracing opcode STORE_FAST None pc=60 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153bc2c6b9f0)
load fast: 23346416250496
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153bc2c6b9f0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153bc2c6b9f0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153bc2c6b9f0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153bc2c6b9f0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153bc2c6b9f0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153bc2c6b9f0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153bc2c6b9f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153bc2c6b9f0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_189 : [#users=4] = placeholder[target=tensor_189]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_189,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_189, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_189, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_189, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153b539698b0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153bc2c6b9f0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bc0ad7040)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bc0ad7040)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_186 : [#users=1] = placeholder[target=tensor_186]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_186,), kwargs = {})
    %tensor_188 : [#users=1] = placeholder[target=tensor_188]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_188), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bc0ad7040)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0x8c6c980)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0x8c6c980)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0x8c6c980)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0x8c6c980)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0x8c6c980)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_163 : [#users=2] = placeholder[target=tensor_163]
    %tensor_164 : [#users=1] = placeholder[target=tensor_164]
    %tensor_165 : [#users=1] = placeholder[target=tensor_165]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_163,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_165, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_171 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_171, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_164, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_183 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_183), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_163), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0x8c6c980)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0x9f6a270)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0x9f6a270)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0x9f6a270)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0x9f6a270)
tracing opcode LOAD_METHOD None pc=46 frame=9(0x9f6a270)
tracing opcode LOAD_FAST None pc=48 frame=9(0x9f6a270)
tracing opcode CALL_METHOD None pc=50 frame=9(0x9f6a270)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x8c78680)
push tracker due to record
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x8c78680)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x8c78680)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x8c78680)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x8c78680)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x8c78680)
load fast: 23346416250592
tracing opcode LOAD_METHOD None pc=12 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=14 frame=18(0x8c78680)
load fast: 23344549327872
tracing opcode CALL_METHOD None pc=16 frame=18(0x8c78680)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x8c78680)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=24 frame=18(0x8c78680)
tracing opcode CALL_METHOD None pc=26 frame=18(0x8c78680)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0xb1e2090)
push tracker due to record
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0xb1e2090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0xb1e2090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0xb1e2090)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0xb1e2090)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0xb1e2090)
load fast: 23346416250688
tracing opcode LOAD_METHOD None pc=12 frame=19(0xb1e2090)
tracing opcode LOAD_FAST None pc=14 frame=19(0xb1e2090)
load fast: 23344549568896
tracing opcode CALL_METHOD None pc=16 frame=19(0xb1e2090)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0xb1e2090)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_191 : [#users=1] = placeholder[target=tensor_191]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_191,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0xb1e2090)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x8c78680)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x8c78680)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_190 : [#users=1] = placeholder[target=tensor_190]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_190,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x8c78680)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0x9f6a270)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0x9f6a270)
tracing opcode LOAD_METHOD None pc=56 frame=9(0x9f6a270)
tracing opcode LOAD_FAST None pc=58 frame=9(0x9f6a270)
tracing opcode LOAD_FAST None pc=60 frame=9(0x9f6a270)
tracing opcode CALL_METHOD None pc=62 frame=9(0x9f6a270)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x951af10)
push tracker due to record
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x951af10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x951af10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x951af10)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x951af10)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x951af10)
load fast: 23346416250736
tracing opcode LOAD_METHOD None pc=12 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=14 frame=20(0x951af10)
load fast: 23344549570896
tracing opcode CALL_METHOD None pc=16 frame=20(0x951af10)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=24 frame=20(0x951af10)
tracing opcode CALL_METHOD None pc=26 frame=20(0x951af10)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415669312
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23344549094320
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_193 : [#users=0] = placeholder[target=tensor_193]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-0.6935,  0.4776,  0.0456,  ...,  0.3568, -0.1577,  0.0574],
         [ 0.2762, -0.4506, -0.0944,  ...,  0.3297,  0.0401, -0.3506],
         [-0.2689, -0.3711,  0.2189,  ..., -0.4697,  0.2266, -0.0359],
         ...,
         [-0.1023, -0.3200, -0.9885,  ...,  0.3795,  0.0974,  0.6117],
         [-0.3425,  0.2687, -0.1066,  ..., -0.2452, -0.0663, -0.3589],
         [ 0.0806,  0.3057, -0.0508,  ..., -0.5553,  0.2486, -0.6221]]]), modified_attrs={}, prev=None) 23344549093328 23344549094320
obj: tensor([[[-0.6935,  0.4776,  0.0456,  ...,  0.3568, -0.1577,  0.0574],
         [ 0.2762, -0.4506, -0.0944,  ...,  0.3297,  0.0401, -0.3506],
         [-0.2689, -0.3711,  0.2189,  ..., -0.4697,  0.2266, -0.0359],
         ...,
         [-0.1023, -0.3200, -0.9885,  ...,  0.3795,  0.0974,  0.6117],
         [-0.3425,  0.2687, -0.1066,  ..., -0.2452, -0.0663, -0.3589],
         [ 0.0806,  0.3057, -0.0508,  ..., -0.5553,  0.2486, -0.6221]]]) 23344549094320
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.6935,  0.4776,  0.0456,  ...,  0.3568, -0.1577,  0.0574],
         [ 0.2762, -0.4506, -0.0944,  ...,  0.3297,  0.0401, -0.3506],
         [-0.2689, -0.3711,  0.2189,  ..., -0.4697,  0.2266, -0.0359],
         ...,
         [-0.1023, -0.3200, -0.9885,  ...,  0.3795,  0.0974,  0.6117],
         [-0.3425,  0.2687, -0.1066,  ..., -0.2452, -0.0663, -0.3589],
         [ 0.0806,  0.3057, -0.0508,  ..., -0.5553,  0.2486, -0.6221]]]), modified_attrs={}, prev=None) 23344549090112
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=34 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=36 frame=20(0x951af10)
load fast: 23344549327872
tracing opcode BINARY_ADD None pc=38 frame=20(0x951af10)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x951af10)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x8c7a7c0)
push tracker due to record
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x8c7a7c0)
load fast: 23344549569936
tracing opcode LOAD_ATTR None pc=12 frame=2(0x8c7a7c0)
tracing opcode STORE_FAST None pc=14 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x8c7a7c0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153b5395a590>
tracing opcode STORE_FAST None pc=36 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x8c7a7c0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153b538eed60>
tracing opcode STORE_FAST None pc=60 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x8c7a7c0)
load fast: 23346416250832
tracing opcode LOAD_ATTR None pc=76 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x8c7a7c0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x8c7a7c0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x8c7a7c0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x8c7a7c0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x8c7a7c0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x8c7a7c0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_195 : [#users=4] = placeholder[target=tensor_195]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_195,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_195, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_195, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_195, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153b5395a590>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x951af10)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x951af10)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_192 : [#users=1] = placeholder[target=tensor_192]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_192,), kwargs = {})
    %tensor_194 : [#users=1] = placeholder[target=tensor_194]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_194), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x951af10)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0x9f6a270)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0x9f6a270)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0x9f6a270)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0x9f6a270)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0x9f6a270)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_160 : [#users=2] = placeholder[target=tensor_160]
    %tensor_161 : [#users=1] = placeholder[target=tensor_161]
    %tensor_162 : [#users=1] = placeholder[target=tensor_162]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_160,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_162, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_171 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_171, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_161, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_183 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_183), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_160), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0x9f6a270)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0xd6e96c0)
push tracker due to record
push tracker 9 frame 0xd6e96c0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0xd6e96c0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0xd6e96c0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0xd6e96c0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0xd6e96c0)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0xd6e96c0)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0xd6e96c0)
load fast: 23346415669360
tracing opcode LOAD_ATTR None pc=12 frame=9(0xd6e96c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0xd6e96c0)
load fast: 23344549180416
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0xd6e96c0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0xd6e96c0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0xd6e96c0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0xd6e96c0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0xd6e96c0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0xd6e96c0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0xd6e96c0)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0xd6ea8a0)
push tracker due to record
push tracker 10 frame 0xd6ea8a0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0xd6ea8a0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0xd6ea8a0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0xd6ea8a0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0xd6ea8a0)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0xd6ea8a0)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0xd6ea8a0)
load fast: 23346415669408
tracing opcode LOAD_ATTR None pc=12 frame=10(0xd6ea8a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0xd6ea8a0)
load fast: 23344549180416
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0xd6ea8a0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0xd6ea8a0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0xd6ea8a0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0xd6ea8a0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0xd6ea8a0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0xd6ea8a0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0xd6ea8a0)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0xc464470)
push tracker due to record
push tracker 11 frame 0xc464470 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0xc464470)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0xc464470)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0xc464470 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0xc464470)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0xc464470)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0xc464470)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0xc464470)
tracing opcode IS_OP None pc=16 frame=11(0xc464470)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0xc464470)
load fast: 23346415669456
tracing opcode LOAD_METHOD None pc=22 frame=11(0xc464470)
tracing opcode LOAD_DEREF None pc=24 frame=11(0xc464470)
load fast: 23344549180416
tracing opcode CALL_METHOD None pc=26 frame=11(0xc464470)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=32 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=34 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=36 frame=11(0xc464470)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344549008304
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415669456
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_203 : [#users=1] = placeholder[target=tensor_203]
    %view : [#users=1] = call_method[target=view](args = (%tensor_203, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=40 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=42 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=44 frame=11(0xc464470)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0xc464470)
record function in graph <built-in method chunk of Tensor object at 0x153b538a4bd0>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0xc464470)
tracing opcode STORE_FAST None pc=50 frame=11(0xc464470)
tracing opcode STORE_FAST None pc=52 frame=11(0xc464470)
tracing opcode STORE_FAST None pc=54 frame=11(0xc464470)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0xc464470)
tracing opcode LOAD_DEREF None pc=224 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=226 frame=11(0xc464470)
tracing opcode LOAD_DEREF None pc=228 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=230 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=232 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=234 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=236 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=238 frame=11(0xc464470)
tracing opcode BUILD_SLICE None pc=240 frame=11(0xc464470)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0xc464470)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0xc464470)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0xc464470)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344548992960
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415669456
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_204 : [#users=1] = placeholder[target=tensor_204]
    %view : [#users=1] = call_method[target=view](args = (%tensor_204, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0xc464470)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0xc464470)
tracing opcode LOAD_DEREF None pc=254 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=256 frame=11(0xc464470)
tracing opcode LOAD_DEREF None pc=258 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=260 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=262 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=264 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=266 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=268 frame=11(0xc464470)
tracing opcode BUILD_SLICE None pc=270 frame=11(0xc464470)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0xc464470)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0xc464470)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0xc464470)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344548911120
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415669456
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_205 : [#users=1] = placeholder[target=tensor_205]
    %view : [#users=1] = call_method[target=view](args = (%tensor_205, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0xc464470)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0xc464470)
tracing opcode STORE_FAST None pc=284 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0xc464470)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0xc464470)
tracing opcode LOAD_DEREF None pc=290 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=292 frame=11(0xc464470)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0xc464470)
tracing opcode BINARY_ADD None pc=296 frame=11(0xc464470)
tracing opcode STORE_FAST None pc=298 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=302 frame=11(0xc464470)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=306 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=308 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=310 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=312 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=314 frame=11(0xc464470)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=318 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=320 frame=11(0xc464470)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0xc464470)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0xc464470)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0xc464470)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0xc464470)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=334 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=336 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=338 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=340 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=342 frame=11(0xc464470)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0xc464470)
record function in graph <built-in method to of Tensor object at 0x153b53877720>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0xc464470)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=352 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=354 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=356 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=358 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=360 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=362 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=364 frame=11(0xc464470)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0xc464470)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=372 frame=11(0xc464470)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=380 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=382 frame=11(0xc464470)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0xc464470)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415669552
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=390 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=392 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=394 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=396 frame=11(0xc464470)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=400 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=402 frame=11(0xc464470)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0xd6d8e00)
push tracker due to record
push tracker 13 frame 0xd6d8e00 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0xd6d8e00 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0xd6d8e00)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0xd6d8e00)
tracing opcode IS_OP None pc=16 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=52 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=54 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=56 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=58 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=82 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=84 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=86 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=88 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=94 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=96 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=98 frame=13(0xd6d8e00)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0xd6d8e00)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=138 frame=13(0xd6d8e00)
load fast: 23344548992480
tracing opcode LOAD_METHOD None pc=140 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=142 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=144 frame=13(0xd6d8e00)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0xd6d8e00)
load fast: 23344549025808
tracing opcode LOAD_METHOD None pc=148 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=150 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=152 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=156 frame=13(0xd6d8e00)
load fast: 23346415669456
tracing opcode LOAD_ATTR None pc=158 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=162 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=166 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=168 frame=13(0xd6d8e00)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=172 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=174 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=176 frame=13(0xd6d8e00)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0xd6d8e00)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=184 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=186 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=190 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=192 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=194 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=196 frame=13(0xd6d8e00)
tracing opcode BUILD_SLICE None pc=198 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=200 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=202 frame=13(0xd6d8e00)
tracing opcode BUILD_SLICE None pc=204 frame=13(0xd6d8e00)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0xd6d8e00)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0xd6d8e00)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=220 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=224 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=226 frame=13(0xd6d8e00)
tracing opcode CONTAINS_OP None pc=228 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=236 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=238 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=240 frame=13(0xd6d8e00)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=246 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=248 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=250 frame=13(0xd6d8e00)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344548641264
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415669456
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_210 : [#users=1] = placeholder[target=tensor_210]
    %view : [#users=1] = call_method[target=view](args = (%tensor_210, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=256 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=258 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=260 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=262 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=264 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=266 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=268 frame=13(0xd6d8e00)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0xd6d8e00)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=276 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=278 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=280 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=282 frame=13(0xd6d8e00)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=286 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=288 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=292 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=296 frame=13(0xd6d8e00)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=302 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=304 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=306 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=310 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=312 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=314 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0xd6d8e00)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23344549166512
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23344548992480
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23344549293328
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_211 : [#users=1] = placeholder[target=tensor_211]
    %tensor_212 : [#users=0] = placeholder[target=tensor_212]
    %tensor_213 : [#users=0] = placeholder[target=tensor_213]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_211, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0xd6d8e00)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=326 frame=13(0xd6d8e00)
tracing opcode INPLACE_ADD None pc=328 frame=13(0xd6d8e00)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=334 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=336 frame=13(0xd6d8e00)
tracing opcode CONTAINS_OP None pc=338 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=346 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=348 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=350 frame=13(0xd6d8e00)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=356 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=358 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=360 frame=13(0xd6d8e00)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23344548756352
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415669456
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_214 : [#users=1] = placeholder[target=tensor_214]
    %view : [#users=1] = call_method[target=view](args = (%tensor_214, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=368 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=372 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=374 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=376 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=378 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=380 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=384 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=386 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0xd6d8e00)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0xd6d8e00)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0xd6d8e00)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0xd6d8e00)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=402 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=404 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=406 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=408 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=410 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=412 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=414 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=416 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=452 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=456 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=458 frame=13(0xd6d8e00)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0xd6d8e00)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=464 frame=13(0xd6d8e00)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=468 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=470 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=474 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=478 frame=13(0xd6d8e00)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=484 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=486 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=488 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=490 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=492 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=494 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=496 frame=13(0xd6d8e00)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=500 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=502 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=504 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0xd6d8e00)
record function in graph <built-in method to of Tensor object at 0x153b53893cc0>
tracing opcode CALL_METHOD None pc=508 frame=13(0xd6d8e00)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=514 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=518 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=522 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=524 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=526 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0xd6d8e00)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23344549517728
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23344548992480
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23344549025808
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_215 : [#users=1] = placeholder[target=tensor_215]
    %tensor_216 : [#users=0] = placeholder[target=tensor_216]
    %tensor_217 : [#users=0] = placeholder[target=tensor_217]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_215, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0xd6d8e00)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=538 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0xd6d8e00)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=546 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=548 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=550 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=552 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=554 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=556 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=558 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=560 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=626 frame=13(0xd6d8e00)
tracing opcode INPLACE_ADD None pc=628 frame=13(0xd6d8e00)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_207 : [#users=1] = placeholder[target=tensor_207]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_207, 1), kwargs = {})
    %tensor_208 : [#users=1] = placeholder[target=tensor_208]
    %tensor_209 : [#users=1] = placeholder[target=tensor_209]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_208, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_209, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=408 frame=11(0xc464470)
tracing opcode IS_OP None pc=410 frame=11(0xc464470)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=418 frame=11(0xc464470)
tracing opcode BINARY_ADD None pc=420 frame=11(0xc464470)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=426 frame=11(0xc464470)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=468 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=470 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=472 frame=11(0xc464470)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=476 frame=11(0xc464470)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b9a0> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654853536
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111b9a0> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23344549518288
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_219 : [#users=1] = placeholder[target=tensor_219]
    %to : [#users=1] = call_method[target=to](args = (%tensor_219, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_220 : [#users=1] = placeholder[target=tensor_220]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_220, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=482 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=484 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=486 frame=11(0xc464470)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415669696
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23344548534688
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_221 : [#users=0] = placeholder[target=tensor_221]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0038, 0.0030, 0.0036,  ..., 0.0039, 0.0031, 0.0027],
          [0.0044, 0.0035, 0.0038,  ..., 0.0044, 0.0031, 0.0048],
          [0.0034, 0.0044, 0.0031,  ..., 0.0042, 0.0033, 0.0035],
          ...,
          [0.0036, 0.0049, 0.0036,  ..., 0.0032, 0.0050, 0.0050],
          [0.0033, 0.0030, 0.0037,  ..., 0.0041, 0.0042, 0.0047],
          [0.0031, 0.0045, 0.0036,  ..., 0.0038, 0.0041, 0.0040]],

         [[0.0041, 0.0034, 0.0036,  ..., 0.0049, 0.0065, 0.0050],
          [0.0035, 0.0044, 0.0036,  ..., 0.0042, 0.0036, 0.0027],
          [0.0044, 0.0035, 0.0038,  ..., 0.0036, 0.0040, 0.0024],
          ...,
          [0.0046, 0.0047, 0.0034,  ..., 0.0041, 0.0042, 0.0036],
          [0.0034, 0.0035, 0.0045,  ..., 0.0044, 0.0045, 0.0036],
          [0.0039, 0.0038, 0.0045,  ..., 0.0035, 0.0040, 0.0035]],

         [[0.0032, 0.0035, 0.0033,  ..., 0.0049, 0.0033, 0.0039],
          [0.0038, 0.0051, 0.0031,  ..., 0.0046, 0.0033, 0.0036],
          [0.0031, 0.0050, 0.0037,  ..., 0.0036, 0.0029, 0.0050],
          ...,
          [0.0031, 0.0042, 0.0033,  ..., 0.0038, 0.0040, 0.0037],
          [0.0031, 0.0053, 0.0029,  ..., 0.0043, 0.0033, 0.0035],
          [0.0041, 0.0043, 0.0041,  ..., 0.0046, 0.0032, 0.0028]],

         ...,

         [[0.0041, 0.0035, 0.0043,  ..., 0.0044, 0.0032, 0.0037],
          [0.0040, 0.0035, 0.0038,  ..., 0.0041, 0.0036, 0.0043],
          [0.0046, 0.0036, 0.0042,  ..., 0.0042, 0.0031, 0.0038],
          ...,
          [0.0037, 0.0035, 0.0032,  ..., 0.0039, 0.0045, 0.0045],
          [0.0038, 0.0038, 0.0047,  ..., 0.0048, 0.0036, 0.0039],
          [0.0029, 0.0031, 0.0027,  ..., 0.0023, 0.0029, 0.0041]],

         [[0.0047, 0.0041, 0.0036,  ..., 0.0053, 0.0045, 0.0033],
          [0.0046, 0.0036, 0.0052,  ..., 0.0037, 0.0036, 0.0030],
          [0.0040, 0.0040, 0.0043,  ..., 0.0055, 0.0035, 0.0032],
          ...,
          [0.0041, 0.0031, 0.0027,  ..., 0.0033, 0.0029, 0.0042],
          [0.0038, 0.0047, 0.0039,  ..., 0.0052, 0.0050, 0.0033],
          [0.0032, 0.0035, 0.0037,  ..., 0.0033, 0.0038, 0.0050]],

         [[0.0049, 0.0039, 0.0039,  ..., 0.0030, 0.0034, 0.0052],
          [0.0044, 0.0045, 0.0038,  ..., 0.0050, 0.0045, 0.0037],
          [0.0040, 0.0036, 0.0034,  ..., 0.0046, 0.0031, 0.0037],
          ...,
          [0.0038, 0.0037, 0.0034,  ..., 0.0036, 0.0040, 0.0033],
          [0.0062, 0.0035, 0.0042,  ..., 0.0041, 0.0038, 0.0042],
          [0.0042, 0.0038, 0.0039,  ..., 0.0026, 0.0045, 0.0054]]]]), modified_attrs={}, prev=None) 23344549538160 23344548534688
obj: tensor([[[[0.0038, 0.0030, 0.0036,  ..., 0.0039, 0.0031, 0.0027],
          [0.0044, 0.0035, 0.0038,  ..., 0.0044, 0.0031, 0.0048],
          [0.0034, 0.0044, 0.0031,  ..., 0.0042, 0.0033, 0.0035],
          ...,
          [0.0036, 0.0049, 0.0036,  ..., 0.0032, 0.0050, 0.0050],
          [0.0033, 0.0030, 0.0037,  ..., 0.0041, 0.0042, 0.0047],
          [0.0031, 0.0045, 0.0036,  ..., 0.0038, 0.0041, 0.0040]],

         [[0.0041, 0.0034, 0.0036,  ..., 0.0049, 0.0065, 0.0050],
          [0.0035, 0.0044, 0.0036,  ..., 0.0042, 0.0036, 0.0027],
          [0.0044, 0.0035, 0.0038,  ..., 0.0036, 0.0040, 0.0024],
          ...,
          [0.0046, 0.0047, 0.0034,  ..., 0.0041, 0.0042, 0.0036],
          [0.0034, 0.0035, 0.0045,  ..., 0.0044, 0.0045, 0.0036],
          [0.0039, 0.0038, 0.0045,  ..., 0.0035, 0.0040, 0.0035]],

         [[0.0032, 0.0035, 0.0033,  ..., 0.0049, 0.0033, 0.0039],
          [0.0038, 0.0051, 0.0031,  ..., 0.0046, 0.0033, 0.0036],
          [0.0031, 0.0050, 0.0037,  ..., 0.0036, 0.0029, 0.0050],
          ...,
          [0.0031, 0.0042, 0.0033,  ..., 0.0038, 0.0040, 0.0037],
          [0.0031, 0.0053, 0.0029,  ..., 0.0043, 0.0033, 0.0035],
          [0.0041, 0.0043, 0.0041,  ..., 0.0046, 0.0032, 0.0028]],

         ...,

         [[0.0041, 0.0035, 0.0043,  ..., 0.0044, 0.0032, 0.0037],
          [0.0040, 0.0035, 0.0038,  ..., 0.0041, 0.0036, 0.0043],
          [0.0046, 0.0036, 0.0042,  ..., 0.0042, 0.0031, 0.0038],
          ...,
          [0.0037, 0.0035, 0.0032,  ..., 0.0039, 0.0045, 0.0045],
          [0.0038, 0.0038, 0.0047,  ..., 0.0048, 0.0036, 0.0039],
          [0.0029, 0.0031, 0.0027,  ..., 0.0023, 0.0029, 0.0041]],

         [[0.0047, 0.0041, 0.0036,  ..., 0.0053, 0.0045, 0.0033],
          [0.0046, 0.0036, 0.0052,  ..., 0.0037, 0.0036, 0.0030],
          [0.0040, 0.0040, 0.0043,  ..., 0.0055, 0.0035, 0.0032],
          ...,
          [0.0041, 0.0031, 0.0027,  ..., 0.0033, 0.0029, 0.0042],
          [0.0038, 0.0047, 0.0039,  ..., 0.0052, 0.0050, 0.0033],
          [0.0032, 0.0035, 0.0037,  ..., 0.0033, 0.0038, 0.0050]],

         [[0.0049, 0.0039, 0.0039,  ..., 0.0030, 0.0034, 0.0052],
          [0.0044, 0.0045, 0.0038,  ..., 0.0050, 0.0045, 0.0037],
          [0.0040, 0.0036, 0.0034,  ..., 0.0046, 0.0031, 0.0037],
          ...,
          [0.0038, 0.0037, 0.0034,  ..., 0.0036, 0.0040, 0.0033],
          [0.0062, 0.0035, 0.0042,  ..., 0.0041, 0.0038, 0.0042],
          [0.0042, 0.0038, 0.0039,  ..., 0.0026, 0.0045, 0.0054]]]]) 23344548534688
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0038, 0.0030, 0.0036,  ..., 0.0039, 0.0031, 0.0027],
          [0.0044, 0.0035, 0.0038,  ..., 0.0044, 0.0031, 0.0048],
          [0.0034, 0.0044, 0.0031,  ..., 0.0042, 0.0033, 0.0035],
          ...,
          [0.0036, 0.0049, 0.0036,  ..., 0.0032, 0.0050, 0.0050],
          [0.0033, 0.0030, 0.0037,  ..., 0.0041, 0.0042, 0.0047],
          [0.0031, 0.0045, 0.0036,  ..., 0.0038, 0.0041, 0.0040]],

         [[0.0041, 0.0034, 0.0036,  ..., 0.0049, 0.0065, 0.0050],
          [0.0035, 0.0044, 0.0036,  ..., 0.0042, 0.0036, 0.0027],
          [0.0044, 0.0035, 0.0038,  ..., 0.0036, 0.0040, 0.0024],
          ...,
          [0.0046, 0.0047, 0.0034,  ..., 0.0041, 0.0042, 0.0036],
          [0.0034, 0.0035, 0.0045,  ..., 0.0044, 0.0045, 0.0036],
          [0.0039, 0.0038, 0.0045,  ..., 0.0035, 0.0040, 0.0035]],

         [[0.0032, 0.0035, 0.0033,  ..., 0.0049, 0.0033, 0.0039],
          [0.0038, 0.0051, 0.0031,  ..., 0.0046, 0.0033, 0.0036],
          [0.0031, 0.0050, 0.0037,  ..., 0.0036, 0.0029, 0.0050],
          ...,
          [0.0031, 0.0042, 0.0033,  ..., 0.0038, 0.0040, 0.0037],
          [0.0031, 0.0053, 0.0029,  ..., 0.0043, 0.0033, 0.0035],
          [0.0041, 0.0043, 0.0041,  ..., 0.0046, 0.0032, 0.0028]],

         ...,

         [[0.0041, 0.0035, 0.0043,  ..., 0.0044, 0.0032, 0.0037],
          [0.0040, 0.0035, 0.0038,  ..., 0.0041, 0.0036, 0.0043],
          [0.0046, 0.0036, 0.0042,  ..., 0.0042, 0.0031, 0.0038],
          ...,
          [0.0037, 0.0035, 0.0032,  ..., 0.0039, 0.0045, 0.0045],
          [0.0038, 0.0038, 0.0047,  ..., 0.0048, 0.0036, 0.0039],
          [0.0029, 0.0031, 0.0027,  ..., 0.0023, 0.0029, 0.0041]],

         [[0.0047, 0.0041, 0.0036,  ..., 0.0053, 0.0045, 0.0033],
          [0.0046, 0.0036, 0.0052,  ..., 0.0037, 0.0036, 0.0030],
          [0.0040, 0.0040, 0.0043,  ..., 0.0055, 0.0035, 0.0032],
          ...,
          [0.0041, 0.0031, 0.0027,  ..., 0.0033, 0.0029, 0.0042],
          [0.0038, 0.0047, 0.0039,  ..., 0.0052, 0.0050, 0.0033],
          [0.0032, 0.0035, 0.0037,  ..., 0.0033, 0.0038, 0.0050]],

         [[0.0049, 0.0039, 0.0039,  ..., 0.0030, 0.0034, 0.0052],
          [0.0044, 0.0045, 0.0038,  ..., 0.0050, 0.0045, 0.0037],
          [0.0040, 0.0036, 0.0034,  ..., 0.0046, 0.0031, 0.0037],
          ...,
          [0.0038, 0.0037, 0.0034,  ..., 0.0036, 0.0040, 0.0033],
          [0.0062, 0.0035, 0.0042,  ..., 0.0041, 0.0038, 0.0042],
          [0.0042, 0.0038, 0.0039,  ..., 0.0026, 0.0045, 0.0054]]]]), modified_attrs={}, prev=None) 23344548661760
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0xc464470)
tracing opcode LOAD_ATTR None pc=492 frame=11(0xc464470)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=534 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=536 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=538 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=540 frame=11(0xc464470)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=546 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=548 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=550 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=552 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=554 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=556 frame=11(0xc464470)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=560 frame=11(0xc464470)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=566 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=568 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=570 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=572 frame=11(0xc464470)
tracing opcode BUILD_SLICE None pc=574 frame=11(0xc464470)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0xc464470)
tracing opcode LOAD_CONST None pc=578 frame=11(0xc464470)
tracing opcode BINARY_ADD None pc=580 frame=11(0xc464470)
tracing opcode STORE_FAST None pc=582 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0xc464470)
tracing opcode LOAD_METHOD None pc=586 frame=11(0xc464470)
tracing opcode LOAD_FAST None pc=588 frame=11(0xc464470)
tracing opcode CALL_METHOD None pc=590 frame=11(0xc464470)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0xc464470)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0xc464470)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0xc464470)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0xc464470)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_202 : [#users=1] = placeholder[target=tensor_202]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_202,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_206 : [#users=1] = placeholder[target=tensor_206]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_206, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_207 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_207, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_218 : [#users=1] = placeholder[target=tensor_218]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_218, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_219 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_219), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0xc464470)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0xd6ea8a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0xd6ea8a0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0xd6ea8a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0xd6ea8a0)
tracing opcode LOAD_CONST None pc=46 frame=10(0xd6ea8a0)
tracing opcode IS_OP None pc=48 frame=10(0xd6ea8a0)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0xd6ea8a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0xd6ea8a0)
tracing opcode STORE_FAST None pc=54 frame=10(0xd6ea8a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0xd6ea8a0)
tracing opcode LOAD_METHOD None pc=58 frame=10(0xd6ea8a0)
tracing opcode LOAD_FAST None pc=60 frame=10(0xd6ea8a0)
tracing opcode LOAD_FAST None pc=62 frame=10(0xd6ea8a0)
tracing opcode CALL_METHOD None pc=64 frame=10(0xd6ea8a0)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bad76e640)
push tracker due to record
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bad76e640)
load fast: 23346415669744
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bad76e640)
load fast: 23344548329168
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bad76e640)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bad76e640)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bad76e640)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415669888
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23344548267088
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_223 : [#users=0] = placeholder[target=tensor_223]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0173,  0.0155, -0.2170,  ..., -0.0052, -0.0346, -0.0845],
         [ 0.0277,  0.0086, -0.2202,  ..., -0.0141, -0.0349, -0.0794],
         [ 0.0195,  0.0131, -0.2108,  ...,  0.0013, -0.0325, -0.0836],
         ...,
         [ 0.0255,  0.0074, -0.2183,  ..., -0.0114, -0.0300, -0.0810],
         [ 0.0342,  0.0134, -0.2190,  ..., -0.0074, -0.0285, -0.0737],
         [ 0.0306,  0.0171, -0.2122,  ..., -0.0099, -0.0240, -0.0701]]]), modified_attrs={}, prev=None) 23344549539072 23344548267088
obj: tensor([[[ 0.0173,  0.0155, -0.2170,  ..., -0.0052, -0.0346, -0.0845],
         [ 0.0277,  0.0086, -0.2202,  ..., -0.0141, -0.0349, -0.0794],
         [ 0.0195,  0.0131, -0.2108,  ...,  0.0013, -0.0325, -0.0836],
         ...,
         [ 0.0255,  0.0074, -0.2183,  ..., -0.0114, -0.0300, -0.0810],
         [ 0.0342,  0.0134, -0.2190,  ..., -0.0074, -0.0285, -0.0737],
         [ 0.0306,  0.0171, -0.2122,  ..., -0.0099, -0.0240, -0.0701]]]) 23344548267088
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0173,  0.0155, -0.2170,  ..., -0.0052, -0.0346, -0.0845],
         [ 0.0277,  0.0086, -0.2202,  ..., -0.0141, -0.0349, -0.0794],
         [ 0.0195,  0.0131, -0.2108,  ...,  0.0013, -0.0325, -0.0836],
         ...,
         [ 0.0255,  0.0074, -0.2183,  ..., -0.0114, -0.0300, -0.0810],
         [ 0.0342,  0.0134, -0.2190,  ..., -0.0074, -0.0285, -0.0737],
         [ 0.0306,  0.0171, -0.2122,  ..., -0.0099, -0.0240, -0.0701]]]), modified_attrs={}, prev=None) 23344548951088
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bad76e640)
load fast: 23344549180416
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bad76e640)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bad76e640)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x8c7a7c0)
push tracker due to record
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x8c7a7c0)
load fast: 23344548268848
tracing opcode LOAD_ATTR None pc=12 frame=2(0x8c7a7c0)
tracing opcode STORE_FAST None pc=14 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x8c7a7c0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153b5381cb30>
tracing opcode STORE_FAST None pc=36 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x8c7a7c0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153b538249f0>
tracing opcode STORE_FAST None pc=60 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x8c7a7c0)
load fast: 23346415669840
tracing opcode LOAD_ATTR None pc=76 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x8c7a7c0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x8c7a7c0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x8c7a7c0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x8c7a7c0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x8c7a7c0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x8c7a7c0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_225 : [#users=4] = placeholder[target=tensor_225]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_225,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_225, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_225, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_225, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153b5381cb30>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bad76e640)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_222 : [#users=1] = placeholder[target=tensor_222]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_222,), kwargs = {})
    %tensor_224 : [#users=1] = placeholder[target=tensor_224]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_224), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0xd6ea8a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0xd6ea8a0)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0xd6ea8a0)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0xd6ea8a0)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0xd6ea8a0)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_199 : [#users=2] = placeholder[target=tensor_199]
    %tensor_200 : [#users=1] = placeholder[target=tensor_200]
    %tensor_201 : [#users=1] = placeholder[target=tensor_201]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_199,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_201, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_207 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_207, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_200, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_219 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_219), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_199), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0xd6ea8a0)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0xd6e96c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0xd6e96c0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0xd6e96c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0xd6e96c0)
tracing opcode LOAD_METHOD None pc=46 frame=9(0xd6e96c0)
tracing opcode LOAD_FAST None pc=48 frame=9(0xd6e96c0)
tracing opcode CALL_METHOD None pc=50 frame=9(0xd6e96c0)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x8c78680)
push tracker due to record
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x8c78680)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x8c78680)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x8c78680)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x8c78680)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x8c78680)
load fast: 23346415669936
tracing opcode LOAD_METHOD None pc=12 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=14 frame=18(0x8c78680)
load fast: 23344548270384
tracing opcode CALL_METHOD None pc=16 frame=18(0x8c78680)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x8c78680)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=24 frame=18(0x8c78680)
tracing opcode CALL_METHOD None pc=26 frame=18(0x8c78680)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0xb1e2090)
push tracker due to record
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0xb1e2090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0xb1e2090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0xb1e2090)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0xb1e2090)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0xb1e2090)
load fast: 23346415670032
tracing opcode LOAD_METHOD None pc=12 frame=19(0xb1e2090)
tracing opcode LOAD_FAST None pc=14 frame=19(0xb1e2090)
load fast: 23343818781456
tracing opcode CALL_METHOD None pc=16 frame=19(0xb1e2090)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0xb1e2090)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_227 : [#users=1] = placeholder[target=tensor_227]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_227,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0xb1e2090)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x8c78680)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x8c78680)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_226 : [#users=1] = placeholder[target=tensor_226]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_226,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x8c78680)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0xd6e96c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0xd6e96c0)
tracing opcode LOAD_METHOD None pc=56 frame=9(0xd6e96c0)
tracing opcode LOAD_FAST None pc=58 frame=9(0xd6e96c0)
tracing opcode LOAD_FAST None pc=60 frame=9(0xd6e96c0)
tracing opcode CALL_METHOD None pc=62 frame=9(0xd6e96c0)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x951af10)
push tracker due to record
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x951af10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x951af10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x951af10)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x951af10)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x951af10)
load fast: 23346415670080
tracing opcode LOAD_METHOD None pc=12 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=14 frame=20(0x951af10)
load fast: 23343818783936
tracing opcode CALL_METHOD None pc=16 frame=20(0x951af10)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=24 frame=20(0x951af10)
tracing opcode CALL_METHOD None pc=26 frame=20(0x951af10)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153b538b8240)
push tracker due to record
push tracker 3 frame 0x153b538b8240 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153b538b8240)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153b538b8240)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153b538b8240 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153b538b8240)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153b538b8240)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153b538b8240)
load fast: 23346415670224
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153b538b8240)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153b538b8240)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153b538b8240)
load fast: 23343818823616
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153b538b8240)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_229 : [#users=0] = placeholder[target=tensor_229]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-5.7831e-02, -4.0934e-01,  4.4650e-01,  ...,  3.2674e-01,
          -3.7446e-01, -4.8585e-02],
         [-4.2137e-01, -9.2431e-03,  6.3641e-01,  ..., -5.8922e-02,
          -8.6618e-04,  5.7339e-03],
         [-6.5767e-01, -2.1946e-01,  1.7159e-01,  ...,  2.6945e-01,
          -3.4335e-01, -5.3297e-02],
         ...,
         [-5.4631e-01,  4.3287e-01, -1.1699e-01,  ..., -1.2198e-01,
           1.7642e-01,  3.5191e-02],
         [ 1.9915e-01, -3.2656e-01,  2.6267e-01,  ..., -1.9888e-01,
          -1.7325e-01,  2.6710e-02],
         [ 9.3922e-01,  1.6643e-01, -3.0122e-01,  ..., -1.8036e-01,
          -3.9677e-01, -1.4556e-01]]]), modified_attrs={}, prev=None) 23343818865104 23343818823616
obj: tensor([[[-5.7831e-02, -4.0934e-01,  4.4650e-01,  ...,  3.2674e-01,
          -3.7446e-01, -4.8585e-02],
         [-4.2137e-01, -9.2431e-03,  6.3641e-01,  ..., -5.8922e-02,
          -8.6618e-04,  5.7339e-03],
         [-6.5767e-01, -2.1946e-01,  1.7159e-01,  ...,  2.6945e-01,
          -3.4335e-01, -5.3297e-02],
         ...,
         [-5.4631e-01,  4.3287e-01, -1.1699e-01,  ..., -1.2198e-01,
           1.7642e-01,  3.5191e-02],
         [ 1.9915e-01, -3.2656e-01,  2.6267e-01,  ..., -1.9888e-01,
          -1.7325e-01,  2.6710e-02],
         [ 9.3922e-01,  1.6643e-01, -3.0122e-01,  ..., -1.8036e-01,
          -3.9677e-01, -1.4556e-01]]]) 23343818823616
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-5.7831e-02, -4.0934e-01,  4.4650e-01,  ...,  3.2674e-01,
          -3.7446e-01, -4.8585e-02],
         [-4.2137e-01, -9.2431e-03,  6.3641e-01,  ..., -5.8922e-02,
          -8.6618e-04,  5.7339e-03],
         [-6.5767e-01, -2.1946e-01,  1.7159e-01,  ...,  2.6945e-01,
          -3.4335e-01, -5.3297e-02],
         ...,
         [-5.4631e-01,  4.3287e-01, -1.1699e-01,  ..., -1.2198e-01,
           1.7642e-01,  3.5191e-02],
         [ 1.9915e-01, -3.2656e-01,  2.6267e-01,  ..., -1.9888e-01,
          -1.7325e-01,  2.6710e-02],
         [ 9.3922e-01,  1.6643e-01, -3.0122e-01,  ..., -1.8036e-01,
          -3.9677e-01, -1.4556e-01]]]), modified_attrs={}, prev=None) 23343818843376
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153b538b8240)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=34 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=36 frame=20(0x951af10)
load fast: 23344548270384
tracing opcode BINARY_ADD None pc=38 frame=20(0x951af10)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x951af10)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x8c422e0)
push tracker due to record
push tracker 2 frame 0x8c422e0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x8c422e0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x8c422e0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0x8c422e0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x8c422e0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x8c422e0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x8c422e0)
load fast: 23343818825376
tracing opcode LOAD_ATTR None pc=12 frame=2(0x8c422e0)
tracing opcode STORE_FAST None pc=14 frame=2(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x8c422e0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x8c422e0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x8c422e0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x8c422e0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x8c422e0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x8c422e0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x8c422e0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x8c422e0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x8c422e0)
record function in graph <built-in method mean of Tensor object at 0x153b28075ea0>
tracing opcode STORE_FAST None pc=36 frame=2(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x8c422e0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x8c422e0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x8c422e0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x8c422e0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x8c422e0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x8c422e0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x8c422e0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x8c422e0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x8c422e0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x8c422e0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x8c422e0)
record function in graph <built-in method mean of Tensor object at 0x153b2808a130>
tracing opcode STORE_FAST None pc=60 frame=2(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x8c422e0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x8c422e0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x8c422e0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x8c422e0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x8c422e0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x8c422e0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x8c422e0)
load fast: 23346415670176
tracing opcode LOAD_ATTR None pc=76 frame=2(0x8c422e0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x8c422e0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x8c422e0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x8c422e0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x8c422e0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x8c422e0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x8c422e0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x8c422e0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x8c422e0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x8c422e0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x8c422e0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x8c422e0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x8c422e0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x8c422e0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x8c422e0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x8c422e0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x8c422e0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_231 : [#users=4] = placeholder[target=tensor_231]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_231,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_231, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_231, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_231, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153b28075ea0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x8c422e0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x951af10)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x951af10)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_228 : [#users=1] = placeholder[target=tensor_228]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_228,), kwargs = {})
    %tensor_230 : [#users=1] = placeholder[target=tensor_230]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_230), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x951af10)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0xd6e96c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0xd6e96c0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0xd6e96c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0xd6e96c0)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0xd6e96c0)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_196 : [#users=2] = placeholder[target=tensor_196]
    %tensor_197 : [#users=1] = placeholder[target=tensor_197]
    %tensor_198 : [#users=1] = placeholder[target=tensor_198]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_196,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_198, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_207 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_207, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_197, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_219 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_219), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_196), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0xd6e96c0)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0xc457580)
push tracker due to record
push tracker 9 frame 0xc457580 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0xc457580)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0xc457580)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0xc457580 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0xc457580)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0xc457580)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0xc457580)
load fast: 23346415670272
tracing opcode LOAD_ATTR None pc=12 frame=9(0xc457580)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0xc457580)
load fast: 23343818909712
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0xc457580)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0xc457580)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0xc457580)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0xc457580)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0xc457580)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0xc457580)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0xc457580)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0xb1db400)
push tracker due to record
push tracker 10 frame 0xb1db400 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0xb1db400)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0xb1db400)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0xb1db400 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0xb1db400)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0xb1db400)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0xb1db400)
load fast: 23346415670320
tracing opcode LOAD_ATTR None pc=12 frame=10(0xb1db400)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0xb1db400)
load fast: 23343818909712
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0xb1db400)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0xb1db400)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0xb1db400)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0xb1db400)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0xb1db400)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0xb1db400)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0xb1db400)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0xacf33c0)
push tracker due to record
push tracker 11 frame 0xacf33c0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0xacf33c0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0xacf33c0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0xacf33c0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0xacf33c0)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0xacf33c0)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0xacf33c0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0xacf33c0)
tracing opcode IS_OP None pc=16 frame=11(0xacf33c0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0xacf33c0)
load fast: 23346415670368
tracing opcode LOAD_METHOD None pc=22 frame=11(0xacf33c0)
tracing opcode LOAD_DEREF None pc=24 frame=11(0xacf33c0)
load fast: 23343818909712
tracing opcode CALL_METHOD None pc=26 frame=11(0xacf33c0)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=32 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=34 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=36 frame=11(0xacf33c0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23343818649008
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415670368
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_239 : [#users=1] = placeholder[target=tensor_239]
    %view : [#users=1] = call_method[target=view](args = (%tensor_239, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=40 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=42 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=44 frame=11(0xacf33c0)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0xacf33c0)
record function in graph <built-in method chunk of Tensor object at 0x153b28033ef0>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0xacf33c0)
tracing opcode STORE_FAST None pc=50 frame=11(0xacf33c0)
tracing opcode STORE_FAST None pc=52 frame=11(0xacf33c0)
tracing opcode STORE_FAST None pc=54 frame=11(0xacf33c0)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0xacf33c0)
tracing opcode LOAD_DEREF None pc=224 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=226 frame=11(0xacf33c0)
tracing opcode LOAD_DEREF None pc=228 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=230 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=232 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=234 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=236 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=238 frame=11(0xacf33c0)
tracing opcode BUILD_SLICE None pc=240 frame=11(0xacf33c0)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0xacf33c0)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0xacf33c0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0xacf33c0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23343818642592
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415670368
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_240 : [#users=1] = placeholder[target=tensor_240]
    %view : [#users=1] = call_method[target=view](args = (%tensor_240, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0xacf33c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0xacf33c0)
tracing opcode LOAD_DEREF None pc=254 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=256 frame=11(0xacf33c0)
tracing opcode LOAD_DEREF None pc=258 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=260 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=262 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=264 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=266 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=268 frame=11(0xacf33c0)
tracing opcode BUILD_SLICE None pc=270 frame=11(0xacf33c0)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0xacf33c0)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0xacf33c0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0xacf33c0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23342879603584
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415670368
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_241 : [#users=1] = placeholder[target=tensor_241]
    %view : [#users=1] = call_method[target=view](args = (%tensor_241, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0xacf33c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0xacf33c0)
tracing opcode STORE_FAST None pc=284 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0xacf33c0)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0xacf33c0)
tracing opcode LOAD_DEREF None pc=290 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=292 frame=11(0xacf33c0)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0xacf33c0)
tracing opcode BINARY_ADD None pc=296 frame=11(0xacf33c0)
tracing opcode STORE_FAST None pc=298 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=302 frame=11(0xacf33c0)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=306 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=308 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=310 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=312 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=314 frame=11(0xacf33c0)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=318 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=320 frame=11(0xacf33c0)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0xacf33c0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0xacf33c0)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0xacf33c0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0xacf33c0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=334 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=336 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=338 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=340 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=342 frame=11(0xacf33c0)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0xacf33c0)
record function in graph <built-in method to of Tensor object at 0x153b5381cd10>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0xacf33c0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=352 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=354 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=356 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=358 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=360 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=362 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=364 frame=11(0xacf33c0)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0xacf33c0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=372 frame=11(0xacf33c0)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=380 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=382 frame=11(0xacf33c0)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0xacf33c0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415670464
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=390 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=392 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=394 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=396 frame=11(0xacf33c0)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=400 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=402 frame=11(0xacf33c0)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0xd6d8e00)
push tracker due to record
push tracker 13 frame 0xd6d8e00 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0xd6d8e00 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0xd6d8e00)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0xd6d8e00)
tracing opcode IS_OP None pc=16 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=52 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=54 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=56 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=58 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=82 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=84 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=86 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=88 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=94 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=96 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=98 frame=13(0xd6d8e00)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0xd6d8e00)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=138 frame=13(0xd6d8e00)
load fast: 23343818867072
tracing opcode LOAD_METHOD None pc=140 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=142 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=144 frame=13(0xd6d8e00)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0xd6d8e00)
load fast: 23343818636240
tracing opcode LOAD_METHOD None pc=148 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=150 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=152 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=156 frame=13(0xd6d8e00)
load fast: 23346415670368
tracing opcode LOAD_ATTR None pc=158 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=162 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=166 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=168 frame=13(0xd6d8e00)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=172 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=174 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=176 frame=13(0xd6d8e00)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0xd6d8e00)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=184 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=186 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=190 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=192 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=194 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=196 frame=13(0xd6d8e00)
tracing opcode BUILD_SLICE None pc=198 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=200 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=202 frame=13(0xd6d8e00)
tracing opcode BUILD_SLICE None pc=204 frame=13(0xd6d8e00)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0xd6d8e00)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0xd6d8e00)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=220 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=224 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=226 frame=13(0xd6d8e00)
tracing opcode CONTAINS_OP None pc=228 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=236 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=238 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=240 frame=13(0xd6d8e00)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=246 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=248 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=250 frame=13(0xd6d8e00)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23342879761088
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415670368
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_246 : [#users=1] = placeholder[target=tensor_246]
    %view : [#users=1] = call_method[target=view](args = (%tensor_246, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=256 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=258 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=260 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=262 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=264 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=266 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=268 frame=13(0xd6d8e00)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0xd6d8e00)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=276 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=278 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=280 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=282 frame=13(0xd6d8e00)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=286 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=288 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=292 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=296 frame=13(0xd6d8e00)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=302 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=304 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=306 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=310 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=312 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=314 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0xd6d8e00)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23342879684224
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23343818867072
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23343818646288
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_247 : [#users=1] = placeholder[target=tensor_247]
    %tensor_248 : [#users=0] = placeholder[target=tensor_248]
    %tensor_249 : [#users=0] = placeholder[target=tensor_249]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_247, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0xd6d8e00)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=326 frame=13(0xd6d8e00)
tracing opcode INPLACE_ADD None pc=328 frame=13(0xd6d8e00)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=334 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=336 frame=13(0xd6d8e00)
tracing opcode CONTAINS_OP None pc=338 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=346 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=348 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=350 frame=13(0xd6d8e00)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=356 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=358 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=360 frame=13(0xd6d8e00)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23342879712256
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415670368
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_250 : [#users=1] = placeholder[target=tensor_250]
    %view : [#users=1] = call_method[target=view](args = (%tensor_250, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=368 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=372 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=374 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=376 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=378 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=380 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=384 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=386 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0xd6d8e00)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0xd6d8e00)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0xd6d8e00)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0xd6d8e00)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=402 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=404 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=406 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=408 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=410 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=412 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=414 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=416 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=452 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=456 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=458 frame=13(0xd6d8e00)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0xd6d8e00)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=464 frame=13(0xd6d8e00)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=468 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=470 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=474 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=478 frame=13(0xd6d8e00)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=484 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=486 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=488 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=490 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=492 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=494 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=496 frame=13(0xd6d8e00)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=500 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=502 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=504 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0xd6d8e00)
record function in graph <built-in method to of Tensor object at 0x153af00da540>
tracing opcode CALL_METHOD None pc=508 frame=13(0xd6d8e00)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=514 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=518 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=522 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=524 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=526 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0xd6d8e00)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23342879762128
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23343818867072
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23343818636240
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_251 : [#users=1] = placeholder[target=tensor_251]
    %tensor_252 : [#users=0] = placeholder[target=tensor_252]
    %tensor_253 : [#users=0] = placeholder[target=tensor_253]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_251, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0xd6d8e00)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=538 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0xd6d8e00)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=546 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=548 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=550 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=552 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=554 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=556 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=558 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=560 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=626 frame=13(0xd6d8e00)
tracing opcode INPLACE_ADD None pc=628 frame=13(0xd6d8e00)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_243 : [#users=1] = placeholder[target=tensor_243]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_243, 1), kwargs = {})
    %tensor_244 : [#users=1] = placeholder[target=tensor_244]
    %tensor_245 : [#users=1] = placeholder[target=tensor_245]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_244, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_245, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=408 frame=11(0xacf33c0)
tracing opcode IS_OP None pc=410 frame=11(0xacf33c0)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=418 frame=11(0xacf33c0)
tracing opcode BINARY_ADD None pc=420 frame=11(0xacf33c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=426 frame=11(0xacf33c0)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=468 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=470 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=472 frame=11(0xacf33c0)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=476 frame=11(0xacf33c0)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111ba90> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654853776
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111ba90> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23343818868672
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_255 : [#users=1] = placeholder[target=tensor_255]
    %to : [#users=1] = call_method[target=to](args = (%tensor_255, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_256 : [#users=1] = placeholder[target=tensor_256]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_256, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=482 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=484 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=486 frame=11(0xacf33c0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415670608
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23342879498944
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_257 : [#users=0] = placeholder[target=tensor_257]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0047, 0.0026, 0.0038,  ..., 0.0034, 0.0036, 0.0042],
          [0.0042, 0.0041, 0.0033,  ..., 0.0040, 0.0037, 0.0044],
          [0.0028, 0.0036, 0.0039,  ..., 0.0032, 0.0047, 0.0048],
          ...,
          [0.0036, 0.0037, 0.0039,  ..., 0.0039, 0.0041, 0.0037],
          [0.0058, 0.0034, 0.0034,  ..., 0.0039, 0.0032, 0.0037],
          [0.0045, 0.0049, 0.0035,  ..., 0.0031, 0.0042, 0.0040]],

         [[0.0042, 0.0031, 0.0031,  ..., 0.0035, 0.0055, 0.0037],
          [0.0039, 0.0037, 0.0036,  ..., 0.0043, 0.0028, 0.0041],
          [0.0037, 0.0046, 0.0050,  ..., 0.0042, 0.0042, 0.0038],
          ...,
          [0.0032, 0.0040, 0.0030,  ..., 0.0043, 0.0043, 0.0030],
          [0.0037, 0.0040, 0.0031,  ..., 0.0036, 0.0053, 0.0043],
          [0.0033, 0.0046, 0.0028,  ..., 0.0046, 0.0040, 0.0033]],

         [[0.0032, 0.0044, 0.0037,  ..., 0.0033, 0.0053, 0.0037],
          [0.0035, 0.0046, 0.0040,  ..., 0.0045, 0.0039, 0.0041],
          [0.0043, 0.0040, 0.0047,  ..., 0.0035, 0.0049, 0.0037],
          ...,
          [0.0033, 0.0035, 0.0040,  ..., 0.0034, 0.0041, 0.0051],
          [0.0036, 0.0045, 0.0054,  ..., 0.0034, 0.0051, 0.0047],
          [0.0042, 0.0038, 0.0050,  ..., 0.0033, 0.0053, 0.0043]],

         ...,

         [[0.0036, 0.0042, 0.0044,  ..., 0.0036, 0.0036, 0.0040],
          [0.0045, 0.0036, 0.0057,  ..., 0.0042, 0.0042, 0.0043],
          [0.0032, 0.0041, 0.0048,  ..., 0.0037, 0.0031, 0.0035],
          ...,
          [0.0036, 0.0033, 0.0034,  ..., 0.0042, 0.0030, 0.0037],
          [0.0042, 0.0036, 0.0040,  ..., 0.0035, 0.0036, 0.0044],
          [0.0047, 0.0032, 0.0036,  ..., 0.0035, 0.0043, 0.0032]],

         [[0.0036, 0.0045, 0.0032,  ..., 0.0033, 0.0040, 0.0041],
          [0.0032, 0.0038, 0.0037,  ..., 0.0039, 0.0042, 0.0030],
          [0.0037, 0.0048, 0.0034,  ..., 0.0040, 0.0056, 0.0039],
          ...,
          [0.0056, 0.0046, 0.0038,  ..., 0.0041, 0.0042, 0.0045],
          [0.0048, 0.0033, 0.0033,  ..., 0.0035, 0.0027, 0.0043],
          [0.0044, 0.0040, 0.0043,  ..., 0.0039, 0.0051, 0.0057]],

         [[0.0046, 0.0044, 0.0042,  ..., 0.0048, 0.0058, 0.0034],
          [0.0047, 0.0044, 0.0050,  ..., 0.0044, 0.0045, 0.0041],
          [0.0048, 0.0037, 0.0054,  ..., 0.0036, 0.0047, 0.0036],
          ...,
          [0.0052, 0.0047, 0.0045,  ..., 0.0041, 0.0038, 0.0049],
          [0.0037, 0.0044, 0.0044,  ..., 0.0033, 0.0046, 0.0035],
          [0.0039, 0.0037, 0.0042,  ..., 0.0038, 0.0038, 0.0034]]]]), modified_attrs={}, prev=None) 23344548952624 23342879498944
obj: tensor([[[[0.0047, 0.0026, 0.0038,  ..., 0.0034, 0.0036, 0.0042],
          [0.0042, 0.0041, 0.0033,  ..., 0.0040, 0.0037, 0.0044],
          [0.0028, 0.0036, 0.0039,  ..., 0.0032, 0.0047, 0.0048],
          ...,
          [0.0036, 0.0037, 0.0039,  ..., 0.0039, 0.0041, 0.0037],
          [0.0058, 0.0034, 0.0034,  ..., 0.0039, 0.0032, 0.0037],
          [0.0045, 0.0049, 0.0035,  ..., 0.0031, 0.0042, 0.0040]],

         [[0.0042, 0.0031, 0.0031,  ..., 0.0035, 0.0055, 0.0037],
          [0.0039, 0.0037, 0.0036,  ..., 0.0043, 0.0028, 0.0041],
          [0.0037, 0.0046, 0.0050,  ..., 0.0042, 0.0042, 0.0038],
          ...,
          [0.0032, 0.0040, 0.0030,  ..., 0.0043, 0.0043, 0.0030],
          [0.0037, 0.0040, 0.0031,  ..., 0.0036, 0.0053, 0.0043],
          [0.0033, 0.0046, 0.0028,  ..., 0.0046, 0.0040, 0.0033]],

         [[0.0032, 0.0044, 0.0037,  ..., 0.0033, 0.0053, 0.0037],
          [0.0035, 0.0046, 0.0040,  ..., 0.0045, 0.0039, 0.0041],
          [0.0043, 0.0040, 0.0047,  ..., 0.0035, 0.0049, 0.0037],
          ...,
          [0.0033, 0.0035, 0.0040,  ..., 0.0034, 0.0041, 0.0051],
          [0.0036, 0.0045, 0.0054,  ..., 0.0034, 0.0051, 0.0047],
          [0.0042, 0.0038, 0.0050,  ..., 0.0033, 0.0053, 0.0043]],

         ...,

         [[0.0036, 0.0042, 0.0044,  ..., 0.0036, 0.0036, 0.0040],
          [0.0045, 0.0036, 0.0057,  ..., 0.0042, 0.0042, 0.0043],
          [0.0032, 0.0041, 0.0048,  ..., 0.0037, 0.0031, 0.0035],
          ...,
          [0.0036, 0.0033, 0.0034,  ..., 0.0042, 0.0030, 0.0037],
          [0.0042, 0.0036, 0.0040,  ..., 0.0035, 0.0036, 0.0044],
          [0.0047, 0.0032, 0.0036,  ..., 0.0035, 0.0043, 0.0032]],

         [[0.0036, 0.0045, 0.0032,  ..., 0.0033, 0.0040, 0.0041],
          [0.0032, 0.0038, 0.0037,  ..., 0.0039, 0.0042, 0.0030],
          [0.0037, 0.0048, 0.0034,  ..., 0.0040, 0.0056, 0.0039],
          ...,
          [0.0056, 0.0046, 0.0038,  ..., 0.0041, 0.0042, 0.0045],
          [0.0048, 0.0033, 0.0033,  ..., 0.0035, 0.0027, 0.0043],
          [0.0044, 0.0040, 0.0043,  ..., 0.0039, 0.0051, 0.0057]],

         [[0.0046, 0.0044, 0.0042,  ..., 0.0048, 0.0058, 0.0034],
          [0.0047, 0.0044, 0.0050,  ..., 0.0044, 0.0045, 0.0041],
          [0.0048, 0.0037, 0.0054,  ..., 0.0036, 0.0047, 0.0036],
          ...,
          [0.0052, 0.0047, 0.0045,  ..., 0.0041, 0.0038, 0.0049],
          [0.0037, 0.0044, 0.0044,  ..., 0.0033, 0.0046, 0.0035],
          [0.0039, 0.0037, 0.0042,  ..., 0.0038, 0.0038, 0.0034]]]]) 23342879498944
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0047, 0.0026, 0.0038,  ..., 0.0034, 0.0036, 0.0042],
          [0.0042, 0.0041, 0.0033,  ..., 0.0040, 0.0037, 0.0044],
          [0.0028, 0.0036, 0.0039,  ..., 0.0032, 0.0047, 0.0048],
          ...,
          [0.0036, 0.0037, 0.0039,  ..., 0.0039, 0.0041, 0.0037],
          [0.0058, 0.0034, 0.0034,  ..., 0.0039, 0.0032, 0.0037],
          [0.0045, 0.0049, 0.0035,  ..., 0.0031, 0.0042, 0.0040]],

         [[0.0042, 0.0031, 0.0031,  ..., 0.0035, 0.0055, 0.0037],
          [0.0039, 0.0037, 0.0036,  ..., 0.0043, 0.0028, 0.0041],
          [0.0037, 0.0046, 0.0050,  ..., 0.0042, 0.0042, 0.0038],
          ...,
          [0.0032, 0.0040, 0.0030,  ..., 0.0043, 0.0043, 0.0030],
          [0.0037, 0.0040, 0.0031,  ..., 0.0036, 0.0053, 0.0043],
          [0.0033, 0.0046, 0.0028,  ..., 0.0046, 0.0040, 0.0033]],

         [[0.0032, 0.0044, 0.0037,  ..., 0.0033, 0.0053, 0.0037],
          [0.0035, 0.0046, 0.0040,  ..., 0.0045, 0.0039, 0.0041],
          [0.0043, 0.0040, 0.0047,  ..., 0.0035, 0.0049, 0.0037],
          ...,
          [0.0033, 0.0035, 0.0040,  ..., 0.0034, 0.0041, 0.0051],
          [0.0036, 0.0045, 0.0054,  ..., 0.0034, 0.0051, 0.0047],
          [0.0042, 0.0038, 0.0050,  ..., 0.0033, 0.0053, 0.0043]],

         ...,

         [[0.0036, 0.0042, 0.0044,  ..., 0.0036, 0.0036, 0.0040],
          [0.0045, 0.0036, 0.0057,  ..., 0.0042, 0.0042, 0.0043],
          [0.0032, 0.0041, 0.0048,  ..., 0.0037, 0.0031, 0.0035],
          ...,
          [0.0036, 0.0033, 0.0034,  ..., 0.0042, 0.0030, 0.0037],
          [0.0042, 0.0036, 0.0040,  ..., 0.0035, 0.0036, 0.0044],
          [0.0047, 0.0032, 0.0036,  ..., 0.0035, 0.0043, 0.0032]],

         [[0.0036, 0.0045, 0.0032,  ..., 0.0033, 0.0040, 0.0041],
          [0.0032, 0.0038, 0.0037,  ..., 0.0039, 0.0042, 0.0030],
          [0.0037, 0.0048, 0.0034,  ..., 0.0040, 0.0056, 0.0039],
          ...,
          [0.0056, 0.0046, 0.0038,  ..., 0.0041, 0.0042, 0.0045],
          [0.0048, 0.0033, 0.0033,  ..., 0.0035, 0.0027, 0.0043],
          [0.0044, 0.0040, 0.0043,  ..., 0.0039, 0.0051, 0.0057]],

         [[0.0046, 0.0044, 0.0042,  ..., 0.0048, 0.0058, 0.0034],
          [0.0047, 0.0044, 0.0050,  ..., 0.0044, 0.0045, 0.0041],
          [0.0048, 0.0037, 0.0054,  ..., 0.0036, 0.0047, 0.0036],
          ...,
          [0.0052, 0.0047, 0.0045,  ..., 0.0041, 0.0038, 0.0049],
          [0.0037, 0.0044, 0.0044,  ..., 0.0033, 0.0046, 0.0035],
          [0.0039, 0.0037, 0.0042,  ..., 0.0038, 0.0038, 0.0034]]]]), modified_attrs={}, prev=None) 23342879498192
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0xacf33c0)
tracing opcode LOAD_ATTR None pc=492 frame=11(0xacf33c0)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=534 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=536 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=538 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=540 frame=11(0xacf33c0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=546 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=548 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=550 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=552 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=554 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=556 frame=11(0xacf33c0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=560 frame=11(0xacf33c0)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=566 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=568 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=570 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=572 frame=11(0xacf33c0)
tracing opcode BUILD_SLICE None pc=574 frame=11(0xacf33c0)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0xacf33c0)
tracing opcode LOAD_CONST None pc=578 frame=11(0xacf33c0)
tracing opcode BINARY_ADD None pc=580 frame=11(0xacf33c0)
tracing opcode STORE_FAST None pc=582 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0xacf33c0)
tracing opcode LOAD_METHOD None pc=586 frame=11(0xacf33c0)
tracing opcode LOAD_FAST None pc=588 frame=11(0xacf33c0)
tracing opcode CALL_METHOD None pc=590 frame=11(0xacf33c0)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0xacf33c0)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0xacf33c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0xacf33c0)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0xacf33c0)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_238 : [#users=1] = placeholder[target=tensor_238]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_238,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_242 : [#users=1] = placeholder[target=tensor_242]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_242, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_243 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_243, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_254 : [#users=1] = placeholder[target=tensor_254]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_254, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_255 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_255), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0xacf33c0)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0xb1db400)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0xb1db400)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0xb1db400)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0xb1db400)
tracing opcode LOAD_CONST None pc=46 frame=10(0xb1db400)
tracing opcode IS_OP None pc=48 frame=10(0xb1db400)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0xb1db400)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0xb1db400)
tracing opcode STORE_FAST None pc=54 frame=10(0xb1db400)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0xb1db400)
tracing opcode LOAD_METHOD None pc=58 frame=10(0xb1db400)
tracing opcode LOAD_FAST None pc=60 frame=10(0xb1db400)
tracing opcode LOAD_FAST None pc=62 frame=10(0xb1db400)
tracing opcode CALL_METHOD None pc=64 frame=10(0xb1db400)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bad76e640)
push tracker due to record
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bad76e640)
load fast: 23346415670656
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bad76e640)
load fast: 23342879500624
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bad76e640)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bad76e640)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bad76e640)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415670800
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23342879479504
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_259 : [#users=0] = placeholder[target=tensor_259]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0593,  0.0563, -0.0060,  ...,  0.0647,  0.0583,  0.1263],
         [ 0.0574,  0.0535, -0.0129,  ...,  0.0716,  0.0656,  0.1251],
         [ 0.0559,  0.0595, -0.0057,  ...,  0.0729,  0.0643,  0.1183],
         ...,
         [ 0.0607,  0.0477, -0.0112,  ...,  0.0662,  0.0657,  0.1207],
         [ 0.0612,  0.0519, -0.0013,  ...,  0.0669,  0.0646,  0.1248],
         [ 0.0529,  0.0576, -0.0049,  ...,  0.0719,  0.0756,  0.1204]]]), modified_attrs={}, prev=None) 23343818746800 23342879479504
obj: tensor([[[ 0.0593,  0.0563, -0.0060,  ...,  0.0647,  0.0583,  0.1263],
         [ 0.0574,  0.0535, -0.0129,  ...,  0.0716,  0.0656,  0.1251],
         [ 0.0559,  0.0595, -0.0057,  ...,  0.0729,  0.0643,  0.1183],
         ...,
         [ 0.0607,  0.0477, -0.0112,  ...,  0.0662,  0.0657,  0.1207],
         [ 0.0612,  0.0519, -0.0013,  ...,  0.0669,  0.0646,  0.1248],
         [ 0.0529,  0.0576, -0.0049,  ...,  0.0719,  0.0756,  0.1204]]]) 23342879479504
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0593,  0.0563, -0.0060,  ...,  0.0647,  0.0583,  0.1263],
         [ 0.0574,  0.0535, -0.0129,  ...,  0.0716,  0.0656,  0.1251],
         [ 0.0559,  0.0595, -0.0057,  ...,  0.0729,  0.0643,  0.1183],
         ...,
         [ 0.0607,  0.0477, -0.0112,  ...,  0.0662,  0.0657,  0.1207],
         [ 0.0612,  0.0519, -0.0013,  ...,  0.0669,  0.0646,  0.1248],
         [ 0.0529,  0.0576, -0.0049,  ...,  0.0719,  0.0756,  0.1204]]]), modified_attrs={}, prev=None) 23342879746224
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bad76e640)
load fast: 23343818909712
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bad76e640)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bad76e640)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x8c7a7c0)
push tracker due to record
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x8c7a7c0)
load fast: 23342879518368
tracing opcode LOAD_ATTR None pc=12 frame=2(0x8c7a7c0)
tracing opcode STORE_FAST None pc=14 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x8c7a7c0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153af00aaea0>
tracing opcode STORE_FAST None pc=36 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x8c7a7c0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153af0086590>
tracing opcode STORE_FAST None pc=60 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x8c7a7c0)
load fast: 23346415670752
tracing opcode LOAD_ATTR None pc=76 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x8c7a7c0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x8c7a7c0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x8c7a7c0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x8c7a7c0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x8c7a7c0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x8c7a7c0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_261 : [#users=4] = placeholder[target=tensor_261]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_261,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_261, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_261, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_261, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153af00aaea0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bad76e640)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_258 : [#users=1] = placeholder[target=tensor_258]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_258,), kwargs = {})
    %tensor_260 : [#users=1] = placeholder[target=tensor_260]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_260), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0xb1db400)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0xb1db400)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0xb1db400)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0xb1db400)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0xb1db400)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_235 : [#users=2] = placeholder[target=tensor_235]
    %tensor_236 : [#users=1] = placeholder[target=tensor_236]
    %tensor_237 : [#users=1] = placeholder[target=tensor_237]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_235,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_237, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_243 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_243, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_236, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_255 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_255), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_235), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0xb1db400)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0xc457580)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0xc457580)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0xc457580)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0xc457580)
tracing opcode LOAD_METHOD None pc=46 frame=9(0xc457580)
tracing opcode LOAD_FAST None pc=48 frame=9(0xc457580)
tracing opcode CALL_METHOD None pc=50 frame=9(0xc457580)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x8c78680)
push tracker due to record
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x8c78680)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x8c78680)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x8c78680)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x8c78680)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x8c78680)
load fast: 23346415670848
tracing opcode LOAD_METHOD None pc=12 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=14 frame=18(0x8c78680)
load fast: 23342879370352
tracing opcode CALL_METHOD None pc=16 frame=18(0x8c78680)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x8c78680)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=24 frame=18(0x8c78680)
tracing opcode CALL_METHOD None pc=26 frame=18(0x8c78680)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0xb1e2090)
push tracker due to record
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0xb1e2090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0xb1e2090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0xb1e2090)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0xb1e2090)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0xb1e2090)
load fast: 23346415670944
tracing opcode LOAD_METHOD None pc=12 frame=19(0xb1e2090)
tracing opcode LOAD_FAST None pc=14 frame=19(0xb1e2090)
load fast: 23342879195440
tracing opcode CALL_METHOD None pc=16 frame=19(0xb1e2090)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0xb1e2090)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_263 : [#users=1] = placeholder[target=tensor_263]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_263,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0xb1e2090)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x8c78680)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x8c78680)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_262 : [#users=1] = placeholder[target=tensor_262]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_262,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x8c78680)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0xc457580)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0xc457580)
tracing opcode LOAD_METHOD None pc=56 frame=9(0xc457580)
tracing opcode LOAD_FAST None pc=58 frame=9(0xc457580)
tracing opcode LOAD_FAST None pc=60 frame=9(0xc457580)
tracing opcode CALL_METHOD None pc=62 frame=9(0xc457580)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x951af10)
push tracker due to record
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x951af10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x951af10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x951af10)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x951af10)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x951af10)
load fast: 23346415670992
tracing opcode LOAD_METHOD None pc=12 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=14 frame=20(0x951af10)
load fast: 23342879195840
tracing opcode CALL_METHOD None pc=16 frame=20(0x951af10)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=24 frame=20(0x951af10)
tracing opcode CALL_METHOD None pc=26 frame=20(0x951af10)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x153af00b4040)
push tracker due to record
push tracker 3 frame 0x153af00b4040 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x153af00b4040)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x153af00b4040)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x153af00b4040 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x153af00b4040)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x153af00b4040)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x153af00b4040)
load fast: 23346415671136
tracing opcode LOAD_ATTR None pc=12 frame=3(0x153af00b4040)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x153af00b4040)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x153af00b4040)
load fast: 23342879249248
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x153af00b4040)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_265 : [#users=0] = placeholder[target=tensor_265]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.6379,  0.2440,  0.2317,  ...,  0.6470,  0.4895,  0.3847],
         [ 0.2717, -0.2487, -0.1082,  ...,  0.3218, -0.6310,  0.4351],
         [-0.4239,  0.1331,  0.0315,  ...,  0.1879,  0.0314,  0.8343],
         ...,
         [ 0.6161,  0.2862,  0.0572,  ..., -1.0416, -0.0792, -0.3384],
         [ 0.3764,  0.2380, -0.3153,  ...,  0.0461,  0.1374,  0.0944],
         [-0.3313, -0.0478,  0.5946,  ..., -0.4971,  0.2893,  0.8972]]]), modified_attrs={}, prev=None) 23342879259328 23342879249248
obj: tensor([[[ 0.6379,  0.2440,  0.2317,  ...,  0.6470,  0.4895,  0.3847],
         [ 0.2717, -0.2487, -0.1082,  ...,  0.3218, -0.6310,  0.4351],
         [-0.4239,  0.1331,  0.0315,  ...,  0.1879,  0.0314,  0.8343],
         ...,
         [ 0.6161,  0.2862,  0.0572,  ..., -1.0416, -0.0792, -0.3384],
         [ 0.3764,  0.2380, -0.3153,  ...,  0.0461,  0.1374,  0.0944],
         [-0.3313, -0.0478,  0.5946,  ..., -0.4971,  0.2893,  0.8972]]]) 23342879249248
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.6379,  0.2440,  0.2317,  ...,  0.6470,  0.4895,  0.3847],
         [ 0.2717, -0.2487, -0.1082,  ...,  0.3218, -0.6310,  0.4351],
         [-0.4239,  0.1331,  0.0315,  ...,  0.1879,  0.0314,  0.8343],
         ...,
         [ 0.6161,  0.2862,  0.0572,  ..., -1.0416, -0.0792, -0.3384],
         [ 0.3764,  0.2380, -0.3153,  ...,  0.0461,  0.1374,  0.0944],
         [-0.3313, -0.0478,  0.5946,  ..., -0.4971,  0.2893,  0.8972]]]), modified_attrs={}, prev=None) 23342879239808
tracing opcode RETURN_VALUE None pc=74 frame=3(0x153af00b4040)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=34 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=36 frame=20(0x951af10)
load fast: 23342879370352
tracing opcode BINARY_ADD None pc=38 frame=20(0x951af10)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x951af10)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xd6e2130)
push tracker due to record
push tracker 2 frame 0xd6e2130 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xd6e2130)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xd6e2130)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0xd6e2130 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xd6e2130)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xd6e2130)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xd6e2130)
load fast: 23342879199040
tracing opcode LOAD_ATTR None pc=12 frame=2(0xd6e2130)
tracing opcode STORE_FAST None pc=14 frame=2(0xd6e2130)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xd6e2130)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xd6e2130)
tracing opcode CALL_METHOD None pc=20 frame=2(0xd6e2130)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xd6e2130)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xd6e2130)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xd6e2130)
tracing opcode LOAD_CONST None pc=28 frame=2(0xd6e2130)
tracing opcode LOAD_CONST None pc=30 frame=2(0xd6e2130)
tracing opcode LOAD_CONST None pc=32 frame=2(0xd6e2130)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xd6e2130)
record function in graph <built-in method mean of Tensor object at 0x153af005cf40>
tracing opcode STORE_FAST None pc=36 frame=2(0xd6e2130)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xd6e2130)
tracing opcode LOAD_FAST None pc=40 frame=2(0xd6e2130)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xd6e2130)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xd6e2130)
tracing opcode LOAD_CONST None pc=46 frame=2(0xd6e2130)
tracing opcode CALL_METHOD None pc=48 frame=2(0xd6e2130)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xd6e2130)
tracing opcode LOAD_CONST None pc=52 frame=2(0xd6e2130)
tracing opcode LOAD_CONST None pc=54 frame=2(0xd6e2130)
tracing opcode LOAD_CONST None pc=56 frame=2(0xd6e2130)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xd6e2130)
record function in graph <built-in method mean of Tensor object at 0x153a5c0aecc0>
tracing opcode STORE_FAST None pc=60 frame=2(0xd6e2130)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xd6e2130)
tracing opcode LOAD_FAST None pc=64 frame=2(0xd6e2130)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xd6e2130)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xd6e2130)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xd6e2130)
tracing opcode LOAD_FAST None pc=72 frame=2(0xd6e2130)
tracing opcode LOAD_FAST None pc=74 frame=2(0xd6e2130)
load fast: 23346415671088
tracing opcode LOAD_ATTR None pc=76 frame=2(0xd6e2130)
tracing opcode BINARY_ADD None pc=78 frame=2(0xd6e2130)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xd6e2130)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xd6e2130)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xd6e2130)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xd6e2130)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xd6e2130)
tracing opcode LOAD_FAST None pc=90 frame=2(0xd6e2130)
tracing opcode CALL_METHOD None pc=92 frame=2(0xd6e2130)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xd6e2130)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xd6e2130)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xd6e2130)
tracing opcode LOAD_FAST None pc=100 frame=2(0xd6e2130)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xd6e2130)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xd6e2130)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xd6e2130)
tracing opcode BINARY_ADD None pc=108 frame=2(0xd6e2130)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xd6e2130)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xd6e2130)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xd6e2130)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_267 : [#users=4] = placeholder[target=tensor_267]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_267,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_267, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_267, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_267, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153af005cf40>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xd6e2130)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x951af10)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x951af10)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_264 : [#users=1] = placeholder[target=tensor_264]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_264,), kwargs = {})
    %tensor_266 : [#users=1] = placeholder[target=tensor_266]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_266), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x951af10)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0xc457580)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0xc457580)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0xc457580)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0xc457580)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0xc457580)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_232 : [#users=2] = placeholder[target=tensor_232]
    %tensor_233 : [#users=1] = placeholder[target=tensor_233]
    %tensor_234 : [#users=1] = placeholder[target=tensor_234]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_232,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_234, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_243 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_243, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_233, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_255 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_255), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_232), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0xc457580)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0xe963990)
push tracker due to record
push tracker 9 frame 0xe963990 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0xe963990)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0xe963990)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0xe963990 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0xe963990)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0xe963990)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0xe963990)
load fast: 23346415671184
tracing opcode LOAD_ATTR None pc=12 frame=9(0xe963990)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0xe963990)
load fast: 23340396553056
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0xe963990)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0xe963990)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0xe963990)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0xe963990)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0xe963990)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0xe963990)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0xe963990)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0x9ca60e0)
push tracker due to record
push tracker 10 frame 0x9ca60e0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0x9ca60e0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0x9ca60e0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0x9ca60e0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0x9ca60e0)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0x9ca60e0)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0x9ca60e0)
load fast: 23346415671232
tracing opcode LOAD_ATTR None pc=12 frame=10(0x9ca60e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0x9ca60e0)
load fast: 23340396553056
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0x9ca60e0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0x9ca60e0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0x9ca60e0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0x9ca60e0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0x9ca60e0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0x9ca60e0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0x9ca60e0)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0xfbee690)
push tracker due to record
push tracker 11 frame 0xfbee690 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0xfbee690)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0xfbee690)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0xfbee690 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0xfbee690)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0xfbee690)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0xfbee690)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0xfbee690)
tracing opcode IS_OP None pc=16 frame=11(0xfbee690)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0xfbee690)
load fast: 23346415671280
tracing opcode LOAD_METHOD None pc=22 frame=11(0xfbee690)
tracing opcode LOAD_DEREF None pc=24 frame=11(0xfbee690)
load fast: 23340396553056
tracing opcode CALL_METHOD None pc=26 frame=11(0xfbee690)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=32 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=34 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=36 frame=11(0xfbee690)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23343818666848
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415671280
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_275 : [#users=1] = placeholder[target=tensor_275]
    %view : [#users=1] = call_method[target=view](args = (%tensor_275, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=40 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=42 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=44 frame=11(0xfbee690)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0xfbee690)
record function in graph <built-in method chunk of Tensor object at 0x153af00815e0>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0xfbee690)
tracing opcode STORE_FAST None pc=50 frame=11(0xfbee690)
tracing opcode STORE_FAST None pc=52 frame=11(0xfbee690)
tracing opcode STORE_FAST None pc=54 frame=11(0xfbee690)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0xfbee690)
tracing opcode LOAD_DEREF None pc=224 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=226 frame=11(0xfbee690)
tracing opcode LOAD_DEREF None pc=228 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=230 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=232 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=234 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=236 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=238 frame=11(0xfbee690)
tracing opcode BUILD_SLICE None pc=240 frame=11(0xfbee690)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0xfbee690)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0xfbee690)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0xfbee690)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340396277824
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415671280
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_276 : [#users=1] = placeholder[target=tensor_276]
    %view : [#users=1] = call_method[target=view](args = (%tensor_276, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0xfbee690)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0xfbee690)
tracing opcode LOAD_DEREF None pc=254 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=256 frame=11(0xfbee690)
tracing opcode LOAD_DEREF None pc=258 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=260 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=262 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=264 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=266 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=268 frame=11(0xfbee690)
tracing opcode BUILD_SLICE None pc=270 frame=11(0xfbee690)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0xfbee690)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0xfbee690)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0xfbee690)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23342879479424
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415671280
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_277 : [#users=1] = placeholder[target=tensor_277]
    %view : [#users=1] = call_method[target=view](args = (%tensor_277, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0xfbee690)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0xfbee690)
tracing opcode STORE_FAST None pc=284 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0xfbee690)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0xfbee690)
tracing opcode LOAD_DEREF None pc=290 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=292 frame=11(0xfbee690)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0xfbee690)
tracing opcode BINARY_ADD None pc=296 frame=11(0xfbee690)
tracing opcode STORE_FAST None pc=298 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=302 frame=11(0xfbee690)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=306 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=308 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=310 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=312 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=314 frame=11(0xfbee690)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=318 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=320 frame=11(0xfbee690)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0xfbee690)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0xfbee690)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0xfbee690)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0xfbee690)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=334 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=336 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=338 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=340 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=342 frame=11(0xfbee690)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0xfbee690)
record function in graph <built-in method to of Tensor object at 0x153a5c08a360>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0xfbee690)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=352 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=354 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=356 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=358 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=360 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=362 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=364 frame=11(0xfbee690)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0xfbee690)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=372 frame=11(0xfbee690)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=380 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=382 frame=11(0xfbee690)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0xfbee690)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415671376
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=390 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=392 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=394 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=396 frame=11(0xfbee690)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=400 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=402 frame=11(0xfbee690)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0xd6d8e00)
push tracker due to record
push tracker 13 frame 0xd6d8e00 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0xd6d8e00 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0xd6d8e00)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0xd6d8e00)
tracing opcode IS_OP None pc=16 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=52 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=54 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=56 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=58 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=82 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=84 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=86 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=88 frame=13(0xd6d8e00)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=94 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=96 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=98 frame=13(0xd6d8e00)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0xd6d8e00)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=138 frame=13(0xd6d8e00)
load fast: 23342879251248
tracing opcode LOAD_METHOD None pc=140 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=142 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=144 frame=13(0xd6d8e00)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0xd6d8e00)
load fast: 23342879248448
tracing opcode LOAD_METHOD None pc=148 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=150 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=152 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=156 frame=13(0xd6d8e00)
load fast: 23346415671280
tracing opcode LOAD_ATTR None pc=158 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=162 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=166 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=168 frame=13(0xd6d8e00)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=172 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=174 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=176 frame=13(0xd6d8e00)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0xd6d8e00)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=184 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=186 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=190 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=192 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=194 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=196 frame=13(0xd6d8e00)
tracing opcode BUILD_SLICE None pc=198 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=200 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=202 frame=13(0xd6d8e00)
tracing opcode BUILD_SLICE None pc=204 frame=13(0xd6d8e00)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0xd6d8e00)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0xd6d8e00)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=220 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=224 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=226 frame=13(0xd6d8e00)
tracing opcode CONTAINS_OP None pc=228 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=236 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=238 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=240 frame=13(0xd6d8e00)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=246 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=248 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=250 frame=13(0xd6d8e00)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340396453216
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415671280
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_282 : [#users=1] = placeholder[target=tensor_282]
    %view : [#users=1] = call_method[target=view](args = (%tensor_282, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=256 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=258 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=260 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=262 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=264 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=266 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=268 frame=13(0xd6d8e00)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0xd6d8e00)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=276 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=278 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=280 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=282 frame=13(0xd6d8e00)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=286 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=288 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=292 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=296 frame=13(0xd6d8e00)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=302 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=304 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=306 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=310 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=312 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=314 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0xd6d8e00)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23340396315008
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23342879251248
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23340396450256
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_283 : [#users=1] = placeholder[target=tensor_283]
    %tensor_284 : [#users=0] = placeholder[target=tensor_284]
    %tensor_285 : [#users=0] = placeholder[target=tensor_285]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_283, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0xd6d8e00)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=326 frame=13(0xd6d8e00)
tracing opcode INPLACE_ADD None pc=328 frame=13(0xd6d8e00)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=334 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=336 frame=13(0xd6d8e00)
tracing opcode CONTAINS_OP None pc=338 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=346 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=348 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=350 frame=13(0xd6d8e00)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=356 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=358 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=360 frame=13(0xd6d8e00)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340396318528
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415671280
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_286 : [#users=1] = placeholder[target=tensor_286]
    %view : [#users=1] = call_method[target=view](args = (%tensor_286, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=368 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=372 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=374 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=376 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=378 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=380 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=384 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=386 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0xd6d8e00)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0xd6d8e00)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0xd6d8e00)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0xd6d8e00)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=402 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=404 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=406 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=408 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=410 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=412 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=414 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=416 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0xd6d8e00)
tracing opcode STORE_FAST None pc=452 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=456 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=458 frame=13(0xd6d8e00)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0xd6d8e00)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0xd6d8e00)
tracing opcode BINARY_ADD None pc=464 frame=13(0xd6d8e00)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=468 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=470 frame=13(0xd6d8e00)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=474 frame=13(0xd6d8e00)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=478 frame=13(0xd6d8e00)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=484 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=486 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=488 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=490 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=492 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=494 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=496 frame=13(0xd6d8e00)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=500 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=502 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=504 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0xd6d8e00)
record function in graph <built-in method to of Tensor object at 0x153a5c0a7090>
tracing opcode CALL_METHOD None pc=508 frame=13(0xd6d8e00)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0xd6d8e00)
tracing opcode LOAD_ATTR None pc=514 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=518 frame=13(0xd6d8e00)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=522 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=524 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=526 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0xd6d8e00)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23340396315648
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23342879251248
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23342879248448
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_287 : [#users=1] = placeholder[target=tensor_287]
    %tensor_288 : [#users=0] = placeholder[target=tensor_288]
    %tensor_289 : [#users=0] = placeholder[target=tensor_289]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_287, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0xd6d8e00)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0xd6d8e00)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=538 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0xd6d8e00)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=546 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=548 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=550 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=552 frame=13(0xd6d8e00)
tracing opcode LOAD_METHOD None pc=554 frame=13(0xd6d8e00)
tracing opcode LOAD_CONST None pc=556 frame=13(0xd6d8e00)
tracing opcode CALL_METHOD None pc=558 frame=13(0xd6d8e00)
tracing opcode COMPARE_OP None pc=560 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0xd6d8e00)
tracing opcode LOAD_FAST None pc=626 frame=13(0xd6d8e00)
tracing opcode INPLACE_ADD None pc=628 frame=13(0xd6d8e00)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0xd6d8e00)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0xd6d8e00)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_279 : [#users=1] = placeholder[target=tensor_279]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_279, 1), kwargs = {})
    %tensor_280 : [#users=1] = placeholder[target=tensor_280]
    %tensor_281 : [#users=1] = placeholder[target=tensor_281]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_280, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_281, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0xd6d8e00)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=408 frame=11(0xfbee690)
tracing opcode IS_OP None pc=410 frame=11(0xfbee690)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=418 frame=11(0xfbee690)
tracing opcode BINARY_ADD None pc=420 frame=11(0xfbee690)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=426 frame=11(0xfbee690)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=468 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=470 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=472 frame=11(0xfbee690)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=476 frame=11(0xfbee690)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111bb80> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654854016
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111bb80> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23340396392912
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_291 : [#users=1] = placeholder[target=tensor_291]
    %to : [#users=1] = call_method[target=to](args = (%tensor_291, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_292 : [#users=1] = placeholder[target=tensor_292]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_292, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=482 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=484 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=486 frame=11(0xfbee690)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415671520
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23340396212448
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_293 : [#users=0] = placeholder[target=tensor_293]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0045, 0.0045, 0.0050,  ..., 0.0045, 0.0055, 0.0033],
          [0.0039, 0.0035, 0.0050,  ..., 0.0035, 0.0034, 0.0040],
          [0.0033, 0.0044, 0.0046,  ..., 0.0043, 0.0025, 0.0034],
          ...,
          [0.0038, 0.0033, 0.0056,  ..., 0.0035, 0.0039, 0.0045],
          [0.0043, 0.0042, 0.0035,  ..., 0.0033, 0.0036, 0.0040],
          [0.0040, 0.0041, 0.0043,  ..., 0.0036, 0.0040, 0.0034]],

         [[0.0047, 0.0032, 0.0043,  ..., 0.0031, 0.0040, 0.0030],
          [0.0030, 0.0033, 0.0029,  ..., 0.0028, 0.0032, 0.0034],
          [0.0034, 0.0029, 0.0032,  ..., 0.0033, 0.0038, 0.0038],
          ...,
          [0.0036, 0.0035, 0.0037,  ..., 0.0033, 0.0033, 0.0036],
          [0.0045, 0.0038, 0.0045,  ..., 0.0039, 0.0032, 0.0034],
          [0.0037, 0.0029, 0.0036,  ..., 0.0028, 0.0037, 0.0035]],

         [[0.0040, 0.0038, 0.0053,  ..., 0.0032, 0.0040, 0.0037],
          [0.0042, 0.0045, 0.0037,  ..., 0.0050, 0.0028, 0.0030],
          [0.0040, 0.0032, 0.0034,  ..., 0.0034, 0.0039, 0.0027],
          ...,
          [0.0042, 0.0050, 0.0034,  ..., 0.0036, 0.0039, 0.0036],
          [0.0047, 0.0039, 0.0033,  ..., 0.0028, 0.0024, 0.0031],
          [0.0037, 0.0037, 0.0040,  ..., 0.0045, 0.0036, 0.0044]],

         ...,

         [[0.0033, 0.0038, 0.0040,  ..., 0.0044, 0.0038, 0.0035],
          [0.0033, 0.0039, 0.0040,  ..., 0.0034, 0.0031, 0.0043],
          [0.0033, 0.0049, 0.0030,  ..., 0.0034, 0.0041, 0.0043],
          ...,
          [0.0028, 0.0050, 0.0036,  ..., 0.0045, 0.0039, 0.0030],
          [0.0031, 0.0045, 0.0029,  ..., 0.0032, 0.0048, 0.0031],
          [0.0029, 0.0036, 0.0038,  ..., 0.0045, 0.0036, 0.0033]],

         [[0.0039, 0.0037, 0.0038,  ..., 0.0052, 0.0050, 0.0029],
          [0.0035, 0.0038, 0.0035,  ..., 0.0038, 0.0026, 0.0056],
          [0.0032, 0.0044, 0.0047,  ..., 0.0042, 0.0038, 0.0038],
          ...,
          [0.0033, 0.0041, 0.0039,  ..., 0.0035, 0.0037, 0.0039],
          [0.0043, 0.0033, 0.0038,  ..., 0.0058, 0.0039, 0.0041],
          [0.0040, 0.0041, 0.0037,  ..., 0.0038, 0.0027, 0.0042]],

         [[0.0035, 0.0032, 0.0032,  ..., 0.0041, 0.0049, 0.0032],
          [0.0037, 0.0029, 0.0034,  ..., 0.0037, 0.0025, 0.0027],
          [0.0037, 0.0035, 0.0034,  ..., 0.0036, 0.0054, 0.0032],
          ...,
          [0.0040, 0.0025, 0.0039,  ..., 0.0025, 0.0029, 0.0036],
          [0.0042, 0.0042, 0.0037,  ..., 0.0058, 0.0039, 0.0045],
          [0.0045, 0.0037, 0.0045,  ..., 0.0044, 0.0033, 0.0034]]]]), modified_attrs={}, prev=None) 23342879206320 23340396212448
obj: tensor([[[[0.0045, 0.0045, 0.0050,  ..., 0.0045, 0.0055, 0.0033],
          [0.0039, 0.0035, 0.0050,  ..., 0.0035, 0.0034, 0.0040],
          [0.0033, 0.0044, 0.0046,  ..., 0.0043, 0.0025, 0.0034],
          ...,
          [0.0038, 0.0033, 0.0056,  ..., 0.0035, 0.0039, 0.0045],
          [0.0043, 0.0042, 0.0035,  ..., 0.0033, 0.0036, 0.0040],
          [0.0040, 0.0041, 0.0043,  ..., 0.0036, 0.0040, 0.0034]],

         [[0.0047, 0.0032, 0.0043,  ..., 0.0031, 0.0040, 0.0030],
          [0.0030, 0.0033, 0.0029,  ..., 0.0028, 0.0032, 0.0034],
          [0.0034, 0.0029, 0.0032,  ..., 0.0033, 0.0038, 0.0038],
          ...,
          [0.0036, 0.0035, 0.0037,  ..., 0.0033, 0.0033, 0.0036],
          [0.0045, 0.0038, 0.0045,  ..., 0.0039, 0.0032, 0.0034],
          [0.0037, 0.0029, 0.0036,  ..., 0.0028, 0.0037, 0.0035]],

         [[0.0040, 0.0038, 0.0053,  ..., 0.0032, 0.0040, 0.0037],
          [0.0042, 0.0045, 0.0037,  ..., 0.0050, 0.0028, 0.0030],
          [0.0040, 0.0032, 0.0034,  ..., 0.0034, 0.0039, 0.0027],
          ...,
          [0.0042, 0.0050, 0.0034,  ..., 0.0036, 0.0039, 0.0036],
          [0.0047, 0.0039, 0.0033,  ..., 0.0028, 0.0024, 0.0031],
          [0.0037, 0.0037, 0.0040,  ..., 0.0045, 0.0036, 0.0044]],

         ...,

         [[0.0033, 0.0038, 0.0040,  ..., 0.0044, 0.0038, 0.0035],
          [0.0033, 0.0039, 0.0040,  ..., 0.0034, 0.0031, 0.0043],
          [0.0033, 0.0049, 0.0030,  ..., 0.0034, 0.0041, 0.0043],
          ...,
          [0.0028, 0.0050, 0.0036,  ..., 0.0045, 0.0039, 0.0030],
          [0.0031, 0.0045, 0.0029,  ..., 0.0032, 0.0048, 0.0031],
          [0.0029, 0.0036, 0.0038,  ..., 0.0045, 0.0036, 0.0033]],

         [[0.0039, 0.0037, 0.0038,  ..., 0.0052, 0.0050, 0.0029],
          [0.0035, 0.0038, 0.0035,  ..., 0.0038, 0.0026, 0.0056],
          [0.0032, 0.0044, 0.0047,  ..., 0.0042, 0.0038, 0.0038],
          ...,
          [0.0033, 0.0041, 0.0039,  ..., 0.0035, 0.0037, 0.0039],
          [0.0043, 0.0033, 0.0038,  ..., 0.0058, 0.0039, 0.0041],
          [0.0040, 0.0041, 0.0037,  ..., 0.0038, 0.0027, 0.0042]],

         [[0.0035, 0.0032, 0.0032,  ..., 0.0041, 0.0049, 0.0032],
          [0.0037, 0.0029, 0.0034,  ..., 0.0037, 0.0025, 0.0027],
          [0.0037, 0.0035, 0.0034,  ..., 0.0036, 0.0054, 0.0032],
          ...,
          [0.0040, 0.0025, 0.0039,  ..., 0.0025, 0.0029, 0.0036],
          [0.0042, 0.0042, 0.0037,  ..., 0.0058, 0.0039, 0.0045],
          [0.0045, 0.0037, 0.0045,  ..., 0.0044, 0.0033, 0.0034]]]]) 23340396212448
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0045, 0.0045, 0.0050,  ..., 0.0045, 0.0055, 0.0033],
          [0.0039, 0.0035, 0.0050,  ..., 0.0035, 0.0034, 0.0040],
          [0.0033, 0.0044, 0.0046,  ..., 0.0043, 0.0025, 0.0034],
          ...,
          [0.0038, 0.0033, 0.0056,  ..., 0.0035, 0.0039, 0.0045],
          [0.0043, 0.0042, 0.0035,  ..., 0.0033, 0.0036, 0.0040],
          [0.0040, 0.0041, 0.0043,  ..., 0.0036, 0.0040, 0.0034]],

         [[0.0047, 0.0032, 0.0043,  ..., 0.0031, 0.0040, 0.0030],
          [0.0030, 0.0033, 0.0029,  ..., 0.0028, 0.0032, 0.0034],
          [0.0034, 0.0029, 0.0032,  ..., 0.0033, 0.0038, 0.0038],
          ...,
          [0.0036, 0.0035, 0.0037,  ..., 0.0033, 0.0033, 0.0036],
          [0.0045, 0.0038, 0.0045,  ..., 0.0039, 0.0032, 0.0034],
          [0.0037, 0.0029, 0.0036,  ..., 0.0028, 0.0037, 0.0035]],

         [[0.0040, 0.0038, 0.0053,  ..., 0.0032, 0.0040, 0.0037],
          [0.0042, 0.0045, 0.0037,  ..., 0.0050, 0.0028, 0.0030],
          [0.0040, 0.0032, 0.0034,  ..., 0.0034, 0.0039, 0.0027],
          ...,
          [0.0042, 0.0050, 0.0034,  ..., 0.0036, 0.0039, 0.0036],
          [0.0047, 0.0039, 0.0033,  ..., 0.0028, 0.0024, 0.0031],
          [0.0037, 0.0037, 0.0040,  ..., 0.0045, 0.0036, 0.0044]],

         ...,

         [[0.0033, 0.0038, 0.0040,  ..., 0.0044, 0.0038, 0.0035],
          [0.0033, 0.0039, 0.0040,  ..., 0.0034, 0.0031, 0.0043],
          [0.0033, 0.0049, 0.0030,  ..., 0.0034, 0.0041, 0.0043],
          ...,
          [0.0028, 0.0050, 0.0036,  ..., 0.0045, 0.0039, 0.0030],
          [0.0031, 0.0045, 0.0029,  ..., 0.0032, 0.0048, 0.0031],
          [0.0029, 0.0036, 0.0038,  ..., 0.0045, 0.0036, 0.0033]],

         [[0.0039, 0.0037, 0.0038,  ..., 0.0052, 0.0050, 0.0029],
          [0.0035, 0.0038, 0.0035,  ..., 0.0038, 0.0026, 0.0056],
          [0.0032, 0.0044, 0.0047,  ..., 0.0042, 0.0038, 0.0038],
          ...,
          [0.0033, 0.0041, 0.0039,  ..., 0.0035, 0.0037, 0.0039],
          [0.0043, 0.0033, 0.0038,  ..., 0.0058, 0.0039, 0.0041],
          [0.0040, 0.0041, 0.0037,  ..., 0.0038, 0.0027, 0.0042]],

         [[0.0035, 0.0032, 0.0032,  ..., 0.0041, 0.0049, 0.0032],
          [0.0037, 0.0029, 0.0034,  ..., 0.0037, 0.0025, 0.0027],
          [0.0037, 0.0035, 0.0034,  ..., 0.0036, 0.0054, 0.0032],
          ...,
          [0.0040, 0.0025, 0.0039,  ..., 0.0025, 0.0029, 0.0036],
          [0.0042, 0.0042, 0.0037,  ..., 0.0058, 0.0039, 0.0045],
          [0.0045, 0.0037, 0.0045,  ..., 0.0044, 0.0033, 0.0034]]]]), modified_attrs={}, prev=None) 23340395971968
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0xfbee690)
tracing opcode LOAD_ATTR None pc=492 frame=11(0xfbee690)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=534 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=536 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=538 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=540 frame=11(0xfbee690)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=546 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=548 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=550 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=552 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=554 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=556 frame=11(0xfbee690)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=560 frame=11(0xfbee690)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=566 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=568 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=570 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=572 frame=11(0xfbee690)
tracing opcode BUILD_SLICE None pc=574 frame=11(0xfbee690)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0xfbee690)
tracing opcode LOAD_CONST None pc=578 frame=11(0xfbee690)
tracing opcode BINARY_ADD None pc=580 frame=11(0xfbee690)
tracing opcode STORE_FAST None pc=582 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0xfbee690)
tracing opcode LOAD_METHOD None pc=586 frame=11(0xfbee690)
tracing opcode LOAD_FAST None pc=588 frame=11(0xfbee690)
tracing opcode CALL_METHOD None pc=590 frame=11(0xfbee690)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0xfbee690)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0xfbee690)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0xfbee690)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0xfbee690)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_274 : [#users=1] = placeholder[target=tensor_274]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_274,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_278 : [#users=1] = placeholder[target=tensor_278]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_278, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_279 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_279, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_290 : [#users=1] = placeholder[target=tensor_290]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_290, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_291 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_291), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0xfbee690)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0x9ca60e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0x9ca60e0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0x9ca60e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0x9ca60e0)
tracing opcode LOAD_CONST None pc=46 frame=10(0x9ca60e0)
tracing opcode IS_OP None pc=48 frame=10(0x9ca60e0)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0x9ca60e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0x9ca60e0)
tracing opcode STORE_FAST None pc=54 frame=10(0x9ca60e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0x9ca60e0)
tracing opcode LOAD_METHOD None pc=58 frame=10(0x9ca60e0)
tracing opcode LOAD_FAST None pc=60 frame=10(0x9ca60e0)
tracing opcode LOAD_FAST None pc=62 frame=10(0x9ca60e0)
tracing opcode CALL_METHOD None pc=64 frame=10(0x9ca60e0)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bad76e640)
push tracker due to record
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bad76e640)
load fast: 23346415671568
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bad76e640)
load fast: 23340396215168
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bad76e640)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bad76e640)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bad76e640)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xc451c40)
push tracker due to record
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0xc451c40 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xc451c40)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xc451c40)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xc451c40)
load fast: 23346415671712
tracing opcode LOAD_ATTR None pc=12 frame=3(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xc451c40)
load fast: 23340396126832
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xc451c40)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_295 : [#users=0] = placeholder[target=tensor_295]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0218,  0.1072,  0.1626,  ..., -0.0409,  0.0220,  0.0722],
         [ 0.0207,  0.1046,  0.1583,  ..., -0.0413,  0.0193,  0.0690],
         [ 0.0227,  0.1065,  0.1589,  ..., -0.0347,  0.0193,  0.0653],
         ...,
         [ 0.0207,  0.1053,  0.1572,  ..., -0.0330,  0.0240,  0.0771],
         [ 0.0275,  0.1064,  0.1589,  ..., -0.0437,  0.0209,  0.0701],
         [ 0.0225,  0.1109,  0.1511,  ..., -0.0438,  0.0245,  0.0672]]]), modified_attrs={}, prev=None) 23340395986656 23340396126832
obj: tensor([[[ 0.0218,  0.1072,  0.1626,  ..., -0.0409,  0.0220,  0.0722],
         [ 0.0207,  0.1046,  0.1583,  ..., -0.0413,  0.0193,  0.0690],
         [ 0.0227,  0.1065,  0.1589,  ..., -0.0347,  0.0193,  0.0653],
         ...,
         [ 0.0207,  0.1053,  0.1572,  ..., -0.0330,  0.0240,  0.0771],
         [ 0.0275,  0.1064,  0.1589,  ..., -0.0437,  0.0209,  0.0701],
         [ 0.0225,  0.1109,  0.1511,  ..., -0.0438,  0.0245,  0.0672]]]) 23340396126832
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0218,  0.1072,  0.1626,  ..., -0.0409,  0.0220,  0.0722],
         [ 0.0207,  0.1046,  0.1583,  ..., -0.0413,  0.0193,  0.0690],
         [ 0.0227,  0.1065,  0.1589,  ..., -0.0347,  0.0193,  0.0653],
         ...,
         [ 0.0207,  0.1053,  0.1572,  ..., -0.0330,  0.0240,  0.0771],
         [ 0.0275,  0.1064,  0.1589,  ..., -0.0437,  0.0209,  0.0701],
         [ 0.0225,  0.1109,  0.1511,  ..., -0.0438,  0.0245,  0.0672]]]), modified_attrs={}, prev=None) 23340396005456
tracing opcode RETURN_VALUE None pc=74 frame=3(0xc451c40)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bad76e640)
load fast: 23340396553056
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bad76e640)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bad76e640)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x8c7a7c0)
push tracker due to record
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0x8c7a7c0 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x8c7a7c0)
load fast: 23340396127952
tracing opcode LOAD_ATTR None pc=12 frame=2(0x8c7a7c0)
tracing opcode STORE_FAST None pc=14 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=20 frame=2(0x8c7a7c0)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=28 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=30 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=32 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153a5c0526d0>
tracing opcode STORE_FAST None pc=36 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=40 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=46 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=48 frame=2(0x8c7a7c0)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=52 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=54 frame=2(0x8c7a7c0)
tracing opcode LOAD_CONST None pc=56 frame=2(0x8c7a7c0)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x8c7a7c0)
record function in graph <built-in method mean of Tensor object at 0x153a4c0c08b0>
tracing opcode STORE_FAST None pc=60 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=64 frame=2(0x8c7a7c0)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x8c7a7c0)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=72 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=74 frame=2(0x8c7a7c0)
load fast: 23346415671664
tracing opcode LOAD_ATTR None pc=76 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=78 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x8c7a7c0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x8c7a7c0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x8c7a7c0)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=90 frame=2(0x8c7a7c0)
tracing opcode CALL_METHOD None pc=92 frame=2(0x8c7a7c0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x8c7a7c0)
tracing opcode LOAD_FAST None pc=100 frame=2(0x8c7a7c0)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x8c7a7c0)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x8c7a7c0)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x8c7a7c0)
tracing opcode BINARY_ADD None pc=108 frame=2(0x8c7a7c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x8c7a7c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x8c7a7c0)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_297 : [#users=4] = placeholder[target=tensor_297]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_297,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_297, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_297, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_297, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a5c0526d0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x8c7a7c0)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bad76e640)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_294 : [#users=1] = placeholder[target=tensor_294]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_294,), kwargs = {})
    %tensor_296 : [#users=1] = placeholder[target=tensor_296]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_296), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0x9ca60e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0x9ca60e0)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0x9ca60e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0x9ca60e0)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0x9ca60e0)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_271 : [#users=2] = placeholder[target=tensor_271]
    %tensor_272 : [#users=1] = placeholder[target=tensor_272]
    %tensor_273 : [#users=1] = placeholder[target=tensor_273]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_271,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_273, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_279 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_279, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_272, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_291 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_291), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_271), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0x9ca60e0)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0xe963990)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0xe963990)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0xe963990)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0xe963990)
tracing opcode LOAD_METHOD None pc=46 frame=9(0xe963990)
tracing opcode LOAD_FAST None pc=48 frame=9(0xe963990)
tracing opcode CALL_METHOD None pc=50 frame=9(0xe963990)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x8c78680)
push tracker due to record
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x8c78680)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x8c78680)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x8c78680)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x8c78680)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x8c78680)
load fast: 23346415671760
tracing opcode LOAD_METHOD None pc=12 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=14 frame=18(0x8c78680)
load fast: 23340396128352
tracing opcode CALL_METHOD None pc=16 frame=18(0x8c78680)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x8c78680)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=24 frame=18(0x8c78680)
tracing opcode CALL_METHOD None pc=26 frame=18(0x8c78680)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0xb1e2090)
push tracker due to record
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0xb1e2090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0xb1e2090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0xb1e2090)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0xb1e2090)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0xb1e2090)
load fast: 23346415671856
tracing opcode LOAD_METHOD None pc=12 frame=19(0xb1e2090)
tracing opcode LOAD_FAST None pc=14 frame=19(0xb1e2090)
load fast: 23340128309712
tracing opcode CALL_METHOD None pc=16 frame=19(0xb1e2090)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0xb1e2090)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_299 : [#users=1] = placeholder[target=tensor_299]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_299,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0xb1e2090)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x8c78680)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x8c78680)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_298 : [#users=1] = placeholder[target=tensor_298]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_298,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x8c78680)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0xe963990)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0xe963990)
tracing opcode LOAD_METHOD None pc=56 frame=9(0xe963990)
tracing opcode LOAD_FAST None pc=58 frame=9(0xe963990)
tracing opcode LOAD_FAST None pc=60 frame=9(0xe963990)
tracing opcode CALL_METHOD None pc=62 frame=9(0xe963990)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x951af10)
push tracker due to record
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x951af10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x951af10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x951af10)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x951af10)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x951af10)
load fast: 23346415671904
tracing opcode LOAD_METHOD None pc=12 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=14 frame=20(0x951af10)
load fast: 23340128310832
tracing opcode CALL_METHOD None pc=16 frame=20(0x951af10)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=24 frame=20(0x951af10)
tracing opcode CALL_METHOD None pc=26 frame=20(0x951af10)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xe47df20)
push tracker due to record
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xe47df20)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xe47df20)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xe47df20)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xe47df20)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xe47df20)
load fast: 23346415672048
tracing opcode LOAD_ATTR None pc=12 frame=3(0xe47df20)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xe47df20)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xe47df20)
load fast: 23340127822928
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xe47df20)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_301 : [#users=0] = placeholder[target=tensor_301]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.1731, -0.4771,  0.8698,  ...,  0.2533, -0.5651, -0.5314],
         [ 0.4561,  0.4161, -0.3344,  ..., -0.0068,  0.0320,  0.6391],
         [-0.5579,  0.7392,  0.1019,  ..., -0.2708, -0.3629,  0.1395],
         ...,
         [-0.3133, -0.0354,  0.0484,  ..., -0.3872,  0.0243,  0.2592],
         [ 0.6225,  0.0465,  0.0170,  ..., -0.0920, -0.2824,  0.2579],
         [ 0.0757, -0.2166, -0.1256,  ...,  0.5613, -0.4119,  0.1630]]]), modified_attrs={}, prev=None) 23340127871376 23340127822928
obj: tensor([[[ 0.1731, -0.4771,  0.8698,  ...,  0.2533, -0.5651, -0.5314],
         [ 0.4561,  0.4161, -0.3344,  ..., -0.0068,  0.0320,  0.6391],
         [-0.5579,  0.7392,  0.1019,  ..., -0.2708, -0.3629,  0.1395],
         ...,
         [-0.3133, -0.0354,  0.0484,  ..., -0.3872,  0.0243,  0.2592],
         [ 0.6225,  0.0465,  0.0170,  ..., -0.0920, -0.2824,  0.2579],
         [ 0.0757, -0.2166, -0.1256,  ...,  0.5613, -0.4119,  0.1630]]]) 23340127822928
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.1731, -0.4771,  0.8698,  ...,  0.2533, -0.5651, -0.5314],
         [ 0.4561,  0.4161, -0.3344,  ..., -0.0068,  0.0320,  0.6391],
         [-0.5579,  0.7392,  0.1019,  ..., -0.2708, -0.3629,  0.1395],
         ...,
         [-0.3133, -0.0354,  0.0484,  ..., -0.3872,  0.0243,  0.2592],
         [ 0.6225,  0.0465,  0.0170,  ..., -0.0920, -0.2824,  0.2579],
         [ 0.0757, -0.2166, -0.1256,  ...,  0.5613, -0.4119,  0.1630]]]), modified_attrs={}, prev=None) 23340127816480
tracing opcode RETURN_VALUE None pc=74 frame=3(0xe47df20)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=34 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=36 frame=20(0x951af10)
load fast: 23340396128352
tracing opcode BINARY_ADD None pc=38 frame=20(0x951af10)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x951af10)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23340127852560
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a4c079810>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a4c079900>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415672000
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_303 : [#users=4] = placeholder[target=tensor_303]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_303,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_303, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_303, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_303, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a4c079810>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x951af10)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x951af10)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_300 : [#users=1] = placeholder[target=tensor_300]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_300,), kwargs = {})
    %tensor_302 : [#users=1] = placeholder[target=tensor_302]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_302), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x951af10)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0xe963990)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0xe963990)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0xe963990)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0xe963990)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0xe963990)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_268 : [#users=2] = placeholder[target=tensor_268]
    %tensor_269 : [#users=1] = placeholder[target=tensor_269]
    %tensor_270 : [#users=1] = placeholder[target=tensor_270]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_268,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_270, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_279 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_279, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_269, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_291 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_291), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_268), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0xe963990)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0xd6eefa0)
push tracker due to record
push tracker 9 frame 0xd6eefa0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0xd6eefa0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0xd6eefa0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0xd6eefa0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0xd6eefa0)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0xd6eefa0)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0xd6eefa0)
load fast: 23346415672096
tracing opcode LOAD_ATTR None pc=12 frame=9(0xd6eefa0)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0xd6eefa0)
load fast: 23340128259184
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0xd6eefa0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0xd6eefa0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0xd6eefa0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0xd6eefa0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0xd6eefa0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0xd6eefa0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0xd6eefa0)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0xfbedbc0)
push tracker due to record
push tracker 10 frame 0xfbedbc0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0xfbedbc0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0xfbedbc0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0xfbedbc0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0xfbedbc0)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0xfbedbc0)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0xfbedbc0)
load fast: 23346415672144
tracing opcode LOAD_ATTR None pc=12 frame=10(0xfbedbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0xfbedbc0)
load fast: 23340128259184
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0xfbedbc0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0xfbedbc0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0xfbedbc0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0xfbedbc0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0xfbedbc0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0xfbedbc0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0xfbedbc0)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0xacf0520)
push tracker due to record
push tracker 11 frame 0xacf0520 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0xacf0520)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0xacf0520)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0xacf0520 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0xacf0520)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0xacf0520)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0xacf0520)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0xacf0520)
tracing opcode IS_OP None pc=16 frame=11(0xacf0520)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0xacf0520)
load fast: 23346415672192
tracing opcode LOAD_METHOD None pc=22 frame=11(0xacf0520)
tracing opcode LOAD_DEREF None pc=24 frame=11(0xacf0520)
load fast: 23340128259184
tracing opcode CALL_METHOD None pc=26 frame=11(0xacf0520)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=32 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=34 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=36 frame=11(0xacf0520)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340396129312
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415672192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_311 : [#users=1] = placeholder[target=tensor_311]
    %view : [#users=1] = call_method[target=view](args = (%tensor_311, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=40 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=42 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=44 frame=11(0xacf0520)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0xacf0520)
record function in graph <built-in method chunk of Tensor object at 0x153a4c072400>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0xacf0520)
tracing opcode STORE_FAST None pc=50 frame=11(0xacf0520)
tracing opcode STORE_FAST None pc=52 frame=11(0xacf0520)
tracing opcode STORE_FAST None pc=54 frame=11(0xacf0520)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0xacf0520)
tracing opcode LOAD_DEREF None pc=224 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=226 frame=11(0xacf0520)
tracing opcode LOAD_DEREF None pc=228 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=230 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=232 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=234 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=236 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=238 frame=11(0xacf0520)
tracing opcode BUILD_SLICE None pc=240 frame=11(0xacf0520)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0xacf0520)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0xacf0520)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0xacf0520)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340127659328
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415672192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_312 : [#users=1] = placeholder[target=tensor_312]
    %view : [#users=1] = call_method[target=view](args = (%tensor_312, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0xacf0520)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0xacf0520)
tracing opcode LOAD_DEREF None pc=254 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=256 frame=11(0xacf0520)
tracing opcode LOAD_DEREF None pc=258 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=260 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=262 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=264 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=266 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=268 frame=11(0xacf0520)
tracing opcode BUILD_SLICE None pc=270 frame=11(0xacf0520)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0xacf0520)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0xacf0520)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0xacf0520)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340127636672
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415672192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_313 : [#users=1] = placeholder[target=tensor_313]
    %view : [#users=1] = call_method[target=view](args = (%tensor_313, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0xacf0520)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0xacf0520)
tracing opcode STORE_FAST None pc=284 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0xacf0520)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0xacf0520)
tracing opcode LOAD_DEREF None pc=290 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=292 frame=11(0xacf0520)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0xacf0520)
tracing opcode BINARY_ADD None pc=296 frame=11(0xacf0520)
tracing opcode STORE_FAST None pc=298 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=302 frame=11(0xacf0520)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=306 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=308 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=310 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=312 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=314 frame=11(0xacf0520)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=318 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=320 frame=11(0xacf0520)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0xacf0520)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0xacf0520)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0xacf0520)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0xacf0520)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=334 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=336 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=338 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=340 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=342 frame=11(0xacf0520)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0xacf0520)
record function in graph <built-in method to of Tensor object at 0x153a4c04fb80>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0xacf0520)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=352 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=354 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=356 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=358 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=360 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=362 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=364 frame=11(0xacf0520)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0xacf0520)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=372 frame=11(0xacf0520)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=380 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=382 frame=11(0xacf0520)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0xacf0520)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xe47df20)
push tracker due to record
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xe47df20)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xe47df20)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xe47df20)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xe47df20)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xe47df20)
load fast: 23346415672288
tracing opcode LOAD_ATTR None pc=12 frame=3(0xe47df20)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xe47df20)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xe47df20)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xe47df20)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0xe47df20)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=390 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=392 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=394 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=396 frame=11(0xacf0520)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=400 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=402 frame=11(0xacf0520)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0xc451c40)
push tracker due to record
push tracker 13 frame 0xc451c40 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0xc451c40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0xc451c40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0xc451c40 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0xc451c40)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0xc451c40)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0xc451c40)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0xc451c40)
tracing opcode IS_OP None pc=16 frame=13(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=52 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=54 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=56 frame=13(0xc451c40)
tracing opcode COMPARE_OP None pc=58 frame=13(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=82 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=84 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=86 frame=13(0xc451c40)
tracing opcode COMPARE_OP None pc=88 frame=13(0xc451c40)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=94 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=96 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=98 frame=13(0xc451c40)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0xc451c40)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0xc451c40)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=138 frame=13(0xc451c40)
load fast: 23340128142256
tracing opcode LOAD_METHOD None pc=140 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=142 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=144 frame=13(0xc451c40)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0xc451c40)
load fast: 23340127695072
tracing opcode LOAD_METHOD None pc=148 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=150 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=152 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=156 frame=13(0xc451c40)
load fast: 23346415672192
tracing opcode LOAD_ATTR None pc=158 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0xc451c40)
tracing opcode STORE_FAST None pc=162 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=166 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=168 frame=13(0xc451c40)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=172 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=174 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=176 frame=13(0xc451c40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0xc451c40)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=184 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=186 frame=13(0xc451c40)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=190 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=192 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=194 frame=13(0xc451c40)
tracing opcode BINARY_ADD None pc=196 frame=13(0xc451c40)
tracing opcode BUILD_SLICE None pc=198 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=200 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=202 frame=13(0xc451c40)
tracing opcode BUILD_SLICE None pc=204 frame=13(0xc451c40)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0xc451c40)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0xc451c40)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0xc451c40)
tracing opcode STORE_FAST None pc=220 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=224 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=226 frame=13(0xc451c40)
tracing opcode CONTAINS_OP None pc=228 frame=13(0xc451c40)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=236 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=238 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=240 frame=13(0xc451c40)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=246 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=248 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=250 frame=13(0xc451c40)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340127687360
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415672192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_318 : [#users=1] = placeholder[target=tensor_318]
    %view : [#users=1] = call_method[target=view](args = (%tensor_318, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=256 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=258 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=260 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=262 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=264 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=266 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=268 frame=13(0xc451c40)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0xc451c40)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=276 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=278 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=280 frame=13(0xc451c40)
tracing opcode BINARY_ADD None pc=282 frame=13(0xc451c40)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=286 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=288 frame=13(0xc451c40)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=292 frame=13(0xc451c40)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=296 frame=13(0xc451c40)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=302 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=304 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=306 frame=13(0xc451c40)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=310 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=312 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=314 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0xc451c40)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23340127762048
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23340128142256
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23340127672016
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_319 : [#users=1] = placeholder[target=tensor_319]
    %tensor_320 : [#users=0] = placeholder[target=tensor_320]
    %tensor_321 : [#users=0] = placeholder[target=tensor_321]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_319, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0xc451c40)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=326 frame=13(0xc451c40)
tracing opcode INPLACE_ADD None pc=328 frame=13(0xc451c40)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=334 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=336 frame=13(0xc451c40)
tracing opcode CONTAINS_OP None pc=338 frame=13(0xc451c40)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=346 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=348 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=350 frame=13(0xc451c40)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=356 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=358 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=360 frame=13(0xc451c40)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23340015125664
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415672192
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_322 : [#users=1] = placeholder[target=tensor_322]
    %view : [#users=1] = call_method[target=view](args = (%tensor_322, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0xc451c40)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=368 frame=13(0xc451c40)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=372 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=374 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=376 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=378 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=380 frame=13(0xc451c40)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=384 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=386 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0xc451c40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0xc451c40)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0xc451c40)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0xc451c40)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0xc451c40)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=402 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=404 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=406 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=408 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=410 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=412 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=414 frame=13(0xc451c40)
tracing opcode COMPARE_OP None pc=416 frame=13(0xc451c40)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0xc451c40)
tracing opcode STORE_FAST None pc=452 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=456 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=458 frame=13(0xc451c40)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0xc451c40)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0xc451c40)
tracing opcode BINARY_ADD None pc=464 frame=13(0xc451c40)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=468 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=470 frame=13(0xc451c40)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=474 frame=13(0xc451c40)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=478 frame=13(0xc451c40)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=484 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=486 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=488 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=490 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=492 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=494 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=496 frame=13(0xc451c40)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=500 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=502 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=504 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0xc451c40)
record function in graph <built-in method to of Tensor object at 0x153a454f85e0>
tracing opcode CALL_METHOD None pc=508 frame=13(0xc451c40)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0xc451c40)
tracing opcode LOAD_ATTR None pc=514 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=518 frame=13(0xc451c40)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=522 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=524 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=526 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0xc451c40)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23340127688800
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23340128142256
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23340127695072
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_323 : [#users=1] = placeholder[target=tensor_323]
    %tensor_324 : [#users=0] = placeholder[target=tensor_324]
    %tensor_325 : [#users=0] = placeholder[target=tensor_325]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_323, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0xc451c40)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0xc451c40)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=538 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0xc451c40)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=546 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=548 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=550 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=552 frame=13(0xc451c40)
tracing opcode LOAD_METHOD None pc=554 frame=13(0xc451c40)
tracing opcode LOAD_CONST None pc=556 frame=13(0xc451c40)
tracing opcode CALL_METHOD None pc=558 frame=13(0xc451c40)
tracing opcode COMPARE_OP None pc=560 frame=13(0xc451c40)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0xc451c40)
tracing opcode LOAD_FAST None pc=626 frame=13(0xc451c40)
tracing opcode INPLACE_ADD None pc=628 frame=13(0xc451c40)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0xc451c40)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0xc451c40)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0xc451c40)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_315 : [#users=1] = placeholder[target=tensor_315]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_315, 1), kwargs = {})
    %tensor_316 : [#users=1] = placeholder[target=tensor_316]
    %tensor_317 : [#users=1] = placeholder[target=tensor_317]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_316, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_317, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0xc451c40)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=408 frame=11(0xacf0520)
tracing opcode IS_OP None pc=410 frame=11(0xacf0520)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=418 frame=11(0xacf0520)
tracing opcode BINARY_ADD None pc=420 frame=11(0xacf0520)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=426 frame=11(0xacf0520)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=468 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=470 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=472 frame=11(0xacf0520)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=476 frame=11(0xacf0520)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111bc70> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654854256
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111bc70> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23340015125264
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_327 : [#users=1] = placeholder[target=tensor_327]
    %to : [#users=1] = call_method[target=to](args = (%tensor_327, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_328 : [#users=1] = placeholder[target=tensor_328]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_328, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=482 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=484 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=486 frame=11(0xacf0520)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xe47df20)
push tracker due to record
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xe47df20)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xe47df20)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xe47df20)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xe47df20)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xe47df20)
load fast: 23346415672432
tracing opcode LOAD_ATTR None pc=12 frame=3(0xe47df20)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xe47df20)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xe47df20)
load fast: 23340015338416
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xe47df20)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_329 : [#users=0] = placeholder[target=tensor_329]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0032, 0.0040, 0.0051,  ..., 0.0037, 0.0042, 0.0042],
          [0.0047, 0.0035, 0.0036,  ..., 0.0050, 0.0039, 0.0038],
          [0.0032, 0.0037, 0.0038,  ..., 0.0051, 0.0049, 0.0061],
          ...,
          [0.0035, 0.0040, 0.0051,  ..., 0.0046, 0.0054, 0.0042],
          [0.0034, 0.0040, 0.0040,  ..., 0.0044, 0.0041, 0.0039],
          [0.0031, 0.0042, 0.0038,  ..., 0.0058, 0.0038, 0.0044]],

         [[0.0039, 0.0038, 0.0048,  ..., 0.0038, 0.0035, 0.0036],
          [0.0039, 0.0037, 0.0033,  ..., 0.0063, 0.0043, 0.0032],
          [0.0031, 0.0037, 0.0047,  ..., 0.0040, 0.0042, 0.0035],
          ...,
          [0.0033, 0.0037, 0.0033,  ..., 0.0034, 0.0038, 0.0031],
          [0.0033, 0.0044, 0.0040,  ..., 0.0028, 0.0037, 0.0043],
          [0.0054, 0.0035, 0.0042,  ..., 0.0039, 0.0032, 0.0046]],

         [[0.0035, 0.0038, 0.0025,  ..., 0.0041, 0.0040, 0.0040],
          [0.0035, 0.0030, 0.0033,  ..., 0.0041, 0.0040, 0.0047],
          [0.0038, 0.0038, 0.0030,  ..., 0.0033, 0.0040, 0.0039],
          ...,
          [0.0037, 0.0029, 0.0034,  ..., 0.0034, 0.0032, 0.0044],
          [0.0047, 0.0041, 0.0034,  ..., 0.0026, 0.0037, 0.0040],
          [0.0040, 0.0036, 0.0026,  ..., 0.0036, 0.0039, 0.0036]],

         ...,

         [[0.0035, 0.0049, 0.0036,  ..., 0.0035, 0.0036, 0.0041],
          [0.0046, 0.0046, 0.0027,  ..., 0.0040, 0.0034, 0.0044],
          [0.0036, 0.0045, 0.0036,  ..., 0.0043, 0.0043, 0.0031],
          ...,
          [0.0041, 0.0041, 0.0038,  ..., 0.0042, 0.0048, 0.0042],
          [0.0042, 0.0037, 0.0038,  ..., 0.0032, 0.0044, 0.0039],
          [0.0038, 0.0031, 0.0040,  ..., 0.0043, 0.0033, 0.0044]],

         [[0.0037, 0.0040, 0.0034,  ..., 0.0054, 0.0032, 0.0042],
          [0.0036, 0.0047, 0.0040,  ..., 0.0039, 0.0041, 0.0033],
          [0.0040, 0.0047, 0.0035,  ..., 0.0036, 0.0034, 0.0037],
          ...,
          [0.0032, 0.0035, 0.0039,  ..., 0.0035, 0.0045, 0.0053],
          [0.0040, 0.0036, 0.0041,  ..., 0.0034, 0.0047, 0.0024],
          [0.0041, 0.0041, 0.0040,  ..., 0.0037, 0.0044, 0.0051]],

         [[0.0038, 0.0038, 0.0035,  ..., 0.0047, 0.0031, 0.0034],
          [0.0037, 0.0036, 0.0040,  ..., 0.0047, 0.0056, 0.0030],
          [0.0037, 0.0046, 0.0039,  ..., 0.0039, 0.0037, 0.0044],
          ...,
          [0.0036, 0.0049, 0.0047,  ..., 0.0039, 0.0037, 0.0041],
          [0.0031, 0.0034, 0.0038,  ..., 0.0037, 0.0040, 0.0031],
          [0.0041, 0.0032, 0.0045,  ..., 0.0037, 0.0035, 0.0024]]]]), modified_attrs={}, prev=None) 23340015234064 23340015338416
obj: tensor([[[[0.0032, 0.0040, 0.0051,  ..., 0.0037, 0.0042, 0.0042],
          [0.0047, 0.0035, 0.0036,  ..., 0.0050, 0.0039, 0.0038],
          [0.0032, 0.0037, 0.0038,  ..., 0.0051, 0.0049, 0.0061],
          ...,
          [0.0035, 0.0040, 0.0051,  ..., 0.0046, 0.0054, 0.0042],
          [0.0034, 0.0040, 0.0040,  ..., 0.0044, 0.0041, 0.0039],
          [0.0031, 0.0042, 0.0038,  ..., 0.0058, 0.0038, 0.0044]],

         [[0.0039, 0.0038, 0.0048,  ..., 0.0038, 0.0035, 0.0036],
          [0.0039, 0.0037, 0.0033,  ..., 0.0063, 0.0043, 0.0032],
          [0.0031, 0.0037, 0.0047,  ..., 0.0040, 0.0042, 0.0035],
          ...,
          [0.0033, 0.0037, 0.0033,  ..., 0.0034, 0.0038, 0.0031],
          [0.0033, 0.0044, 0.0040,  ..., 0.0028, 0.0037, 0.0043],
          [0.0054, 0.0035, 0.0042,  ..., 0.0039, 0.0032, 0.0046]],

         [[0.0035, 0.0038, 0.0025,  ..., 0.0041, 0.0040, 0.0040],
          [0.0035, 0.0030, 0.0033,  ..., 0.0041, 0.0040, 0.0047],
          [0.0038, 0.0038, 0.0030,  ..., 0.0033, 0.0040, 0.0039],
          ...,
          [0.0037, 0.0029, 0.0034,  ..., 0.0034, 0.0032, 0.0044],
          [0.0047, 0.0041, 0.0034,  ..., 0.0026, 0.0037, 0.0040],
          [0.0040, 0.0036, 0.0026,  ..., 0.0036, 0.0039, 0.0036]],

         ...,

         [[0.0035, 0.0049, 0.0036,  ..., 0.0035, 0.0036, 0.0041],
          [0.0046, 0.0046, 0.0027,  ..., 0.0040, 0.0034, 0.0044],
          [0.0036, 0.0045, 0.0036,  ..., 0.0043, 0.0043, 0.0031],
          ...,
          [0.0041, 0.0041, 0.0038,  ..., 0.0042, 0.0048, 0.0042],
          [0.0042, 0.0037, 0.0038,  ..., 0.0032, 0.0044, 0.0039],
          [0.0038, 0.0031, 0.0040,  ..., 0.0043, 0.0033, 0.0044]],

         [[0.0037, 0.0040, 0.0034,  ..., 0.0054, 0.0032, 0.0042],
          [0.0036, 0.0047, 0.0040,  ..., 0.0039, 0.0041, 0.0033],
          [0.0040, 0.0047, 0.0035,  ..., 0.0036, 0.0034, 0.0037],
          ...,
          [0.0032, 0.0035, 0.0039,  ..., 0.0035, 0.0045, 0.0053],
          [0.0040, 0.0036, 0.0041,  ..., 0.0034, 0.0047, 0.0024],
          [0.0041, 0.0041, 0.0040,  ..., 0.0037, 0.0044, 0.0051]],

         [[0.0038, 0.0038, 0.0035,  ..., 0.0047, 0.0031, 0.0034],
          [0.0037, 0.0036, 0.0040,  ..., 0.0047, 0.0056, 0.0030],
          [0.0037, 0.0046, 0.0039,  ..., 0.0039, 0.0037, 0.0044],
          ...,
          [0.0036, 0.0049, 0.0047,  ..., 0.0039, 0.0037, 0.0041],
          [0.0031, 0.0034, 0.0038,  ..., 0.0037, 0.0040, 0.0031],
          [0.0041, 0.0032, 0.0045,  ..., 0.0037, 0.0035, 0.0024]]]]) 23340015338416
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0032, 0.0040, 0.0051,  ..., 0.0037, 0.0042, 0.0042],
          [0.0047, 0.0035, 0.0036,  ..., 0.0050, 0.0039, 0.0038],
          [0.0032, 0.0037, 0.0038,  ..., 0.0051, 0.0049, 0.0061],
          ...,
          [0.0035, 0.0040, 0.0051,  ..., 0.0046, 0.0054, 0.0042],
          [0.0034, 0.0040, 0.0040,  ..., 0.0044, 0.0041, 0.0039],
          [0.0031, 0.0042, 0.0038,  ..., 0.0058, 0.0038, 0.0044]],

         [[0.0039, 0.0038, 0.0048,  ..., 0.0038, 0.0035, 0.0036],
          [0.0039, 0.0037, 0.0033,  ..., 0.0063, 0.0043, 0.0032],
          [0.0031, 0.0037, 0.0047,  ..., 0.0040, 0.0042, 0.0035],
          ...,
          [0.0033, 0.0037, 0.0033,  ..., 0.0034, 0.0038, 0.0031],
          [0.0033, 0.0044, 0.0040,  ..., 0.0028, 0.0037, 0.0043],
          [0.0054, 0.0035, 0.0042,  ..., 0.0039, 0.0032, 0.0046]],

         [[0.0035, 0.0038, 0.0025,  ..., 0.0041, 0.0040, 0.0040],
          [0.0035, 0.0030, 0.0033,  ..., 0.0041, 0.0040, 0.0047],
          [0.0038, 0.0038, 0.0030,  ..., 0.0033, 0.0040, 0.0039],
          ...,
          [0.0037, 0.0029, 0.0034,  ..., 0.0034, 0.0032, 0.0044],
          [0.0047, 0.0041, 0.0034,  ..., 0.0026, 0.0037, 0.0040],
          [0.0040, 0.0036, 0.0026,  ..., 0.0036, 0.0039, 0.0036]],

         ...,

         [[0.0035, 0.0049, 0.0036,  ..., 0.0035, 0.0036, 0.0041],
          [0.0046, 0.0046, 0.0027,  ..., 0.0040, 0.0034, 0.0044],
          [0.0036, 0.0045, 0.0036,  ..., 0.0043, 0.0043, 0.0031],
          ...,
          [0.0041, 0.0041, 0.0038,  ..., 0.0042, 0.0048, 0.0042],
          [0.0042, 0.0037, 0.0038,  ..., 0.0032, 0.0044, 0.0039],
          [0.0038, 0.0031, 0.0040,  ..., 0.0043, 0.0033, 0.0044]],

         [[0.0037, 0.0040, 0.0034,  ..., 0.0054, 0.0032, 0.0042],
          [0.0036, 0.0047, 0.0040,  ..., 0.0039, 0.0041, 0.0033],
          [0.0040, 0.0047, 0.0035,  ..., 0.0036, 0.0034, 0.0037],
          ...,
          [0.0032, 0.0035, 0.0039,  ..., 0.0035, 0.0045, 0.0053],
          [0.0040, 0.0036, 0.0041,  ..., 0.0034, 0.0047, 0.0024],
          [0.0041, 0.0041, 0.0040,  ..., 0.0037, 0.0044, 0.0051]],

         [[0.0038, 0.0038, 0.0035,  ..., 0.0047, 0.0031, 0.0034],
          [0.0037, 0.0036, 0.0040,  ..., 0.0047, 0.0056, 0.0030],
          [0.0037, 0.0046, 0.0039,  ..., 0.0039, 0.0037, 0.0044],
          ...,
          [0.0036, 0.0049, 0.0047,  ..., 0.0039, 0.0037, 0.0041],
          [0.0031, 0.0034, 0.0038,  ..., 0.0037, 0.0040, 0.0031],
          [0.0041, 0.0032, 0.0045,  ..., 0.0037, 0.0035, 0.0024]]]]), modified_attrs={}, prev=None) 23340015213488
tracing opcode RETURN_VALUE None pc=74 frame=3(0xe47df20)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0xacf0520)
tracing opcode LOAD_ATTR None pc=492 frame=11(0xacf0520)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=534 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=536 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=538 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=540 frame=11(0xacf0520)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=546 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=548 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=550 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=552 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=554 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=556 frame=11(0xacf0520)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=560 frame=11(0xacf0520)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=566 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=568 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=570 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=572 frame=11(0xacf0520)
tracing opcode BUILD_SLICE None pc=574 frame=11(0xacf0520)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0xacf0520)
tracing opcode LOAD_CONST None pc=578 frame=11(0xacf0520)
tracing opcode BINARY_ADD None pc=580 frame=11(0xacf0520)
tracing opcode STORE_FAST None pc=582 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0xacf0520)
tracing opcode LOAD_METHOD None pc=586 frame=11(0xacf0520)
tracing opcode LOAD_FAST None pc=588 frame=11(0xacf0520)
tracing opcode CALL_METHOD None pc=590 frame=11(0xacf0520)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0xacf0520)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0xacf0520)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0xacf0520)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0xacf0520)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_310 : [#users=1] = placeholder[target=tensor_310]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_310,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_314 : [#users=1] = placeholder[target=tensor_314]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_314, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_315 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_315, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_326 : [#users=1] = placeholder[target=tensor_326]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_326, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_327 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_327), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0xacf0520)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0xfbedbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0xfbedbc0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0xfbedbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0xfbedbc0)
tracing opcode LOAD_CONST None pc=46 frame=10(0xfbedbc0)
tracing opcode IS_OP None pc=48 frame=10(0xfbedbc0)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0xfbedbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0xfbedbc0)
tracing opcode STORE_FAST None pc=54 frame=10(0xfbedbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0xfbedbc0)
tracing opcode LOAD_METHOD None pc=58 frame=10(0xfbedbc0)
tracing opcode LOAD_FAST None pc=60 frame=10(0xfbedbc0)
tracing opcode LOAD_FAST None pc=62 frame=10(0xfbedbc0)
tracing opcode CALL_METHOD None pc=64 frame=10(0xfbedbc0)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bad76e640)
push tracker due to record
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bad76e640)
load fast: 23346415672480
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bad76e640)
load fast: 23340015312960
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bad76e640)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bad76e640)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bad76e640)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xe47df20)
push tracker due to record
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xe47df20)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xe47df20)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0xe47df20 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xe47df20)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xe47df20)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xe47df20)
load fast: 23346415672624
tracing opcode LOAD_ATTR None pc=12 frame=3(0xe47df20)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xe47df20)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xe47df20)
load fast: 23339996004736
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xe47df20)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_331 : [#users=0] = placeholder[target=tensor_331]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[-0.0187,  0.0040,  0.0137,  ...,  0.0516, -0.1485, -0.0939],
         [-0.0136,  0.0059,  0.0063,  ...,  0.0599, -0.1508, -0.0945],
         [-0.0152, -0.0041,  0.0076,  ...,  0.0559, -0.1467, -0.0943],
         ...,
         [-0.0203, -0.0030,  0.0068,  ...,  0.0512, -0.1515, -0.0924],
         [-0.0149,  0.0021,  0.0085,  ...,  0.0555, -0.1449, -0.0948],
         [-0.0155, -0.0042,  0.0114,  ...,  0.0567, -0.1501, -0.0890]]]), modified_attrs={}, prev=None) 23339996087968 23339996004736
obj: tensor([[[-0.0187,  0.0040,  0.0137,  ...,  0.0516, -0.1485, -0.0939],
         [-0.0136,  0.0059,  0.0063,  ...,  0.0599, -0.1508, -0.0945],
         [-0.0152, -0.0041,  0.0076,  ...,  0.0559, -0.1467, -0.0943],
         ...,
         [-0.0203, -0.0030,  0.0068,  ...,  0.0512, -0.1515, -0.0924],
         [-0.0149,  0.0021,  0.0085,  ...,  0.0555, -0.1449, -0.0948],
         [-0.0155, -0.0042,  0.0114,  ...,  0.0567, -0.1501, -0.0890]]]) 23339996004736
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.0187,  0.0040,  0.0137,  ...,  0.0516, -0.1485, -0.0939],
         [-0.0136,  0.0059,  0.0063,  ...,  0.0599, -0.1508, -0.0945],
         [-0.0152, -0.0041,  0.0076,  ...,  0.0559, -0.1467, -0.0943],
         ...,
         [-0.0203, -0.0030,  0.0068,  ...,  0.0512, -0.1515, -0.0924],
         [-0.0149,  0.0021,  0.0085,  ...,  0.0555, -0.1449, -0.0948],
         [-0.0155, -0.0042,  0.0114,  ...,  0.0567, -0.1501, -0.0890]]]), modified_attrs={}, prev=None) 23339995983488
tracing opcode RETURN_VALUE None pc=74 frame=3(0xe47df20)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bad76e640)
load fast: 23340128259184
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bad76e640)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bad76e640)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23339995986736
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a442b7b30>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a442ccd60>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415672576
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_333 : [#users=4] = placeholder[target=tensor_333]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_333,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_333, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_333, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_333, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a442b7b30>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bad76e640)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_330 : [#users=1] = placeholder[target=tensor_330]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_330,), kwargs = {})
    %tensor_332 : [#users=1] = placeholder[target=tensor_332]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_332), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0xfbedbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0xfbedbc0)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0xfbedbc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0xfbedbc0)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0xfbedbc0)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_307 : [#users=2] = placeholder[target=tensor_307]
    %tensor_308 : [#users=1] = placeholder[target=tensor_308]
    %tensor_309 : [#users=1] = placeholder[target=tensor_309]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_307,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_309, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_315 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_315, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_308, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_327 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_327), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_307), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0xfbedbc0)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0xd6eefa0)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0xd6eefa0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0xd6eefa0)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0xd6eefa0)
tracing opcode LOAD_METHOD None pc=46 frame=9(0xd6eefa0)
tracing opcode LOAD_FAST None pc=48 frame=9(0xd6eefa0)
tracing opcode CALL_METHOD None pc=50 frame=9(0xd6eefa0)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x8c78680)
push tracker due to record
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x8c78680)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x8c78680)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x8c78680)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x8c78680)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x8c78680)
load fast: 23346415672672
tracing opcode LOAD_METHOD None pc=12 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=14 frame=18(0x8c78680)
load fast: 23339996054688
tracing opcode CALL_METHOD None pc=16 frame=18(0x8c78680)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x8c78680)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=24 frame=18(0x8c78680)
tracing opcode CALL_METHOD None pc=26 frame=18(0x8c78680)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0xb1e2090)
push tracker due to record
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0xb1e2090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0xb1e2090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0xb1e2090)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0xb1e2090)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0xb1e2090)
load fast: 23346415672768
tracing opcode LOAD_METHOD None pc=12 frame=19(0xb1e2090)
tracing opcode LOAD_FAST None pc=14 frame=19(0xb1e2090)
load fast: 23339995739776
tracing opcode CALL_METHOD None pc=16 frame=19(0xb1e2090)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0xb1e2090)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_335 : [#users=1] = placeholder[target=tensor_335]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_335,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0xb1e2090)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x8c78680)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x8c78680)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_334 : [#users=1] = placeholder[target=tensor_334]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_334,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x8c78680)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0xd6eefa0)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0xd6eefa0)
tracing opcode LOAD_METHOD None pc=56 frame=9(0xd6eefa0)
tracing opcode LOAD_FAST None pc=58 frame=9(0xd6eefa0)
tracing opcode LOAD_FAST None pc=60 frame=9(0xd6eefa0)
tracing opcode CALL_METHOD None pc=62 frame=9(0xd6eefa0)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x951af10)
push tracker due to record
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x951af10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x951af10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x951af10 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x951af10)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x951af10)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x951af10)
load fast: 23346415672816
tracing opcode LOAD_METHOD None pc=12 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=14 frame=20(0x951af10)
load fast: 23339995740816
tracing opcode CALL_METHOD None pc=16 frame=20(0x951af10)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=24 frame=20(0x951af10)
tracing opcode CALL_METHOD None pc=26 frame=20(0x951af10)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415672960
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339995781376
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_337 : [#users=0] = placeholder[target=tensor_337]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.1064, -0.0399, -0.3560,  ..., -0.0952,  0.1306, -0.4324],
         [ 0.4621, -0.4158,  0.0857,  ..., -0.3905,  0.2806,  0.3713],
         [ 0.0737, -0.1849, -0.1822,  ...,  0.1415,  0.4000, -0.4168],
         ...,
         [ 0.0601, -0.1028,  0.2246,  ...,  0.0606,  0.3579,  0.4539],
         [ 0.2441, -0.4157,  0.5904,  ...,  0.1513,  0.1179, -0.0293],
         [-0.1915, -0.1477, -0.1845,  ..., -0.1961,  0.1949,  0.0405]]]), modified_attrs={}, prev=None) 23339995817920 23339995781376
obj: tensor([[[ 0.1064, -0.0399, -0.3560,  ..., -0.0952,  0.1306, -0.4324],
         [ 0.4621, -0.4158,  0.0857,  ..., -0.3905,  0.2806,  0.3713],
         [ 0.0737, -0.1849, -0.1822,  ...,  0.1415,  0.4000, -0.4168],
         ...,
         [ 0.0601, -0.1028,  0.2246,  ...,  0.0606,  0.3579,  0.4539],
         [ 0.2441, -0.4157,  0.5904,  ...,  0.1513,  0.1179, -0.0293],
         [-0.1915, -0.1477, -0.1845,  ..., -0.1961,  0.1949,  0.0405]]]) 23339995781376
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.1064, -0.0399, -0.3560,  ..., -0.0952,  0.1306, -0.4324],
         [ 0.4621, -0.4158,  0.0857,  ..., -0.3905,  0.2806,  0.3713],
         [ 0.0737, -0.1849, -0.1822,  ...,  0.1415,  0.4000, -0.4168],
         ...,
         [ 0.0601, -0.1028,  0.2246,  ...,  0.0606,  0.3579,  0.4539],
         [ 0.2441, -0.4157,  0.5904,  ...,  0.1513,  0.1179, -0.0293],
         [-0.1915, -0.1477, -0.1845,  ..., -0.1961,  0.1949,  0.0405]]]), modified_attrs={}, prev=None) 23339995792384
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x951af10)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=34 frame=20(0x951af10)
tracing opcode LOAD_FAST None pc=36 frame=20(0x951af10)
load fast: 23339996054688
tracing opcode BINARY_ADD None pc=38 frame=20(0x951af10)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x951af10)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0x153b539a3840)
push tracker due to record
push tracker 2 frame 0x153b539a3840 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0x153b539a3840)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0x153b539a3840)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0x153b539a3840 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0x153b539a3840)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0x153b539a3840)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0x153b539a3840)
load fast: 23339995839680
tracing opcode LOAD_ATTR None pc=12 frame=2(0x153b539a3840)
tracing opcode STORE_FAST None pc=14 frame=2(0x153b539a3840)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0x153b539a3840)
tracing opcode LOAD_METHOD None pc=18 frame=2(0x153b539a3840)
tracing opcode CALL_METHOD None pc=20 frame=2(0x153b539a3840)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0x153b539a3840)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0x153b539a3840)
tracing opcode LOAD_ATTR None pc=26 frame=2(0x153b539a3840)
tracing opcode LOAD_CONST None pc=28 frame=2(0x153b539a3840)
tracing opcode LOAD_CONST None pc=30 frame=2(0x153b539a3840)
tracing opcode LOAD_CONST None pc=32 frame=2(0x153b539a3840)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0x153b539a3840)
record function in graph <built-in method mean of Tensor object at 0x153a44293cc0>
tracing opcode STORE_FAST None pc=36 frame=2(0x153b539a3840)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0x153b539a3840)
tracing opcode LOAD_FAST None pc=40 frame=2(0x153b539a3840)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0x153b539a3840)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0x153b539a3840)
tracing opcode LOAD_CONST None pc=46 frame=2(0x153b539a3840)
tracing opcode CALL_METHOD None pc=48 frame=2(0x153b539a3840)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0x153b539a3840)
tracing opcode LOAD_CONST None pc=52 frame=2(0x153b539a3840)
tracing opcode LOAD_CONST None pc=54 frame=2(0x153b539a3840)
tracing opcode LOAD_CONST None pc=56 frame=2(0x153b539a3840)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0x153b539a3840)
record function in graph <built-in method mean of Tensor object at 0x153a44293db0>
tracing opcode STORE_FAST None pc=60 frame=2(0x153b539a3840)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0x153b539a3840)
tracing opcode LOAD_FAST None pc=64 frame=2(0x153b539a3840)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0x153b539a3840)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0x153b539a3840)
tracing opcode LOAD_METHOD None pc=70 frame=2(0x153b539a3840)
tracing opcode LOAD_FAST None pc=72 frame=2(0x153b539a3840)
tracing opcode LOAD_FAST None pc=74 frame=2(0x153b539a3840)
load fast: 23346415672912
tracing opcode LOAD_ATTR None pc=76 frame=2(0x153b539a3840)
tracing opcode BINARY_ADD None pc=78 frame=2(0x153b539a3840)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0x153b539a3840)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0x153b539a3840)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0x153b539a3840)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0x153b539a3840)
tracing opcode LOAD_METHOD None pc=88 frame=2(0x153b539a3840)
tracing opcode LOAD_FAST None pc=90 frame=2(0x153b539a3840)
tracing opcode CALL_METHOD None pc=92 frame=2(0x153b539a3840)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0x153b539a3840)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0x153b539a3840)
tracing opcode LOAD_ATTR None pc=98 frame=2(0x153b539a3840)
tracing opcode LOAD_FAST None pc=100 frame=2(0x153b539a3840)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0x153b539a3840)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0x153b539a3840)
tracing opcode LOAD_ATTR None pc=106 frame=2(0x153b539a3840)
tracing opcode BINARY_ADD None pc=108 frame=2(0x153b539a3840)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0x153b539a3840)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0x153b539a3840)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0x153b539a3840)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_339 : [#users=4] = placeholder[target=tensor_339]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_339,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_339, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_339, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_339, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a44293cc0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0x153b539a3840)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x951af10)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x951af10)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x951af10)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_336 : [#users=1] = placeholder[target=tensor_336]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_336,), kwargs = {})
    %tensor_338 : [#users=1] = placeholder[target=tensor_338]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_338), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x951af10)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0xd6eefa0)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0xd6eefa0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0xd6eefa0)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0xd6eefa0)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0xd6eefa0)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_304 : [#users=2] = placeholder[target=tensor_304]
    %tensor_305 : [#users=1] = placeholder[target=tensor_305]
    %tensor_306 : [#users=1] = placeholder[target=tensor_306]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_304,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_306, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_315 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_315, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_305, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_327 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_327), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_304), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0xd6eefa0)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0xf706820)
push tracker due to record
push tracker 9 frame 0xf706820 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0xf706820)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0xf706820)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0xf706820 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0xf706820)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0xf706820)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0xf706820)
load fast: 23346415673008
tracing opcode LOAD_ATTR None pc=12 frame=9(0xf706820)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0xf706820)
load fast: 23339995882656
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0xf706820)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0xf706820)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0xf706820)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0xf706820)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0xf706820)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0xf706820)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0xf706820)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0xbf70940)
push tracker due to record
push tracker 10 frame 0xbf70940 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0xbf70940)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0xbf70940)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0xbf70940 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0xbf70940)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0xbf70940)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0xbf70940)
load fast: 23346415673056
tracing opcode LOAD_ATTR None pc=12 frame=10(0xbf70940)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0xbf70940)
load fast: 23339995882656
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0xbf70940)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0xbf70940)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0xbf70940)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0xbf70940)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0xbf70940)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0xbf70940)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0xbf70940)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0xd6f1bc0)
push tracker due to record
push tracker 11 frame 0xd6f1bc0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0xd6f1bc0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0xd6f1bc0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0xd6f1bc0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0xd6f1bc0)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0xd6f1bc0)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0xd6f1bc0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0xd6f1bc0)
tracing opcode IS_OP None pc=16 frame=11(0xd6f1bc0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0xd6f1bc0)
load fast: 23346415673104
tracing opcode LOAD_METHOD None pc=22 frame=11(0xd6f1bc0)
tracing opcode LOAD_DEREF None pc=24 frame=11(0xd6f1bc0)
load fast: 23339995882656
tracing opcode CALL_METHOD None pc=26 frame=11(0xd6f1bc0)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=32 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=34 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=36 frame=11(0xd6f1bc0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339995589104
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415673104
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_347 : [#users=1] = placeholder[target=tensor_347]
    %view : [#users=1] = call_method[target=view](args = (%tensor_347, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=40 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=42 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=44 frame=11(0xd6f1bc0)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0xd6f1bc0)
record function in graph <built-in method chunk of Tensor object at 0x153a44245720>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0xd6f1bc0)
tracing opcode STORE_FAST None pc=50 frame=11(0xd6f1bc0)
tracing opcode STORE_FAST None pc=52 frame=11(0xd6f1bc0)
tracing opcode STORE_FAST None pc=54 frame=11(0xd6f1bc0)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0xd6f1bc0)
tracing opcode LOAD_DEREF None pc=224 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=226 frame=11(0xd6f1bc0)
tracing opcode LOAD_DEREF None pc=228 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=230 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=232 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=234 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=236 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=238 frame=11(0xd6f1bc0)
tracing opcode BUILD_SLICE None pc=240 frame=11(0xd6f1bc0)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0xd6f1bc0)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0xd6f1bc0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0xd6f1bc0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339995488064
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415673104
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_348 : [#users=1] = placeholder[target=tensor_348]
    %view : [#users=1] = call_method[target=view](args = (%tensor_348, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0xd6f1bc0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0xd6f1bc0)
tracing opcode LOAD_DEREF None pc=254 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=256 frame=11(0xd6f1bc0)
tracing opcode LOAD_DEREF None pc=258 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=260 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=262 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=264 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=266 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=268 frame=11(0xd6f1bc0)
tracing opcode BUILD_SLICE None pc=270 frame=11(0xd6f1bc0)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0xd6f1bc0)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0xd6f1bc0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0xd6f1bc0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339995654640
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415673104
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_349 : [#users=1] = placeholder[target=tensor_349]
    %view : [#users=1] = call_method[target=view](args = (%tensor_349, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0xd6f1bc0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0xd6f1bc0)
tracing opcode STORE_FAST None pc=284 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0xd6f1bc0)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0xd6f1bc0)
tracing opcode LOAD_DEREF None pc=290 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=292 frame=11(0xd6f1bc0)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0xd6f1bc0)
tracing opcode BINARY_ADD None pc=296 frame=11(0xd6f1bc0)
tracing opcode STORE_FAST None pc=298 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=302 frame=11(0xd6f1bc0)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=306 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=308 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=310 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=312 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=314 frame=11(0xd6f1bc0)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=318 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=320 frame=11(0xd6f1bc0)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0xd6f1bc0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0xd6f1bc0)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0xd6f1bc0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0xd6f1bc0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=334 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=336 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=338 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=340 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=342 frame=11(0xd6f1bc0)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0xd6f1bc0)
record function in graph <built-in method to of Tensor object at 0x153a4424a900>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0xd6f1bc0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=352 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=354 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=356 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=358 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=360 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=362 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=364 frame=11(0xd6f1bc0)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0xd6f1bc0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=372 frame=11(0xd6f1bc0)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=380 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=382 frame=11(0xd6f1bc0)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0xd6f1bc0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415673200
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=390 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=392 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=394 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=396 frame=11(0xd6f1bc0)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=400 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=402 frame=11(0xd6f1bc0)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0x10e75ec0)
push tracker due to record
push tracker 13 frame 0x10e75ec0 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0x10e75ec0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0x10e75ec0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0x10e75ec0 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0x10e75ec0)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0x10e75ec0)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0x10e75ec0)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0x10e75ec0)
tracing opcode IS_OP None pc=16 frame=13(0x10e75ec0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=52 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=54 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=56 frame=13(0x10e75ec0)
tracing opcode COMPARE_OP None pc=58 frame=13(0x10e75ec0)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=82 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=84 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=86 frame=13(0x10e75ec0)
tracing opcode COMPARE_OP None pc=88 frame=13(0x10e75ec0)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=94 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=96 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=98 frame=13(0x10e75ec0)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0x10e75ec0)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0x10e75ec0)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=138 frame=13(0x10e75ec0)
load fast: 23339995520672
tracing opcode LOAD_METHOD None pc=140 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=142 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=144 frame=13(0x10e75ec0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0x10e75ec0)
load fast: 23339995519552
tracing opcode LOAD_METHOD None pc=148 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=150 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=152 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=156 frame=13(0x10e75ec0)
load fast: 23346415673104
tracing opcode LOAD_ATTR None pc=158 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0x10e75ec0)
tracing opcode STORE_FAST None pc=162 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=166 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=168 frame=13(0x10e75ec0)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=172 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=174 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=176 frame=13(0x10e75ec0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0x10e75ec0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=184 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=186 frame=13(0x10e75ec0)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=190 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=192 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=194 frame=13(0x10e75ec0)
tracing opcode BINARY_ADD None pc=196 frame=13(0x10e75ec0)
tracing opcode BUILD_SLICE None pc=198 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=200 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=202 frame=13(0x10e75ec0)
tracing opcode BUILD_SLICE None pc=204 frame=13(0x10e75ec0)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0x10e75ec0)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0x10e75ec0)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0x10e75ec0)
tracing opcode STORE_FAST None pc=220 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=224 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=226 frame=13(0x10e75ec0)
tracing opcode CONTAINS_OP None pc=228 frame=13(0x10e75ec0)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=236 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=238 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=240 frame=13(0x10e75ec0)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=246 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=248 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=250 frame=13(0x10e75ec0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339995177504
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415673104
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_354 : [#users=1] = placeholder[target=tensor_354]
    %view : [#users=1] = call_method[target=view](args = (%tensor_354, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=256 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=258 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=260 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=262 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=264 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=266 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=268 frame=13(0x10e75ec0)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0x10e75ec0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=276 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=278 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=280 frame=13(0x10e75ec0)
tracing opcode BINARY_ADD None pc=282 frame=13(0x10e75ec0)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=286 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=288 frame=13(0x10e75ec0)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=292 frame=13(0x10e75ec0)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=296 frame=13(0x10e75ec0)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=302 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=304 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=306 frame=13(0x10e75ec0)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=310 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=312 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=314 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0x10e75ec0)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23339995354112
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23339995520672
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23339995247616
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_355 : [#users=1] = placeholder[target=tensor_355]
    %tensor_356 : [#users=0] = placeholder[target=tensor_356]
    %tensor_357 : [#users=0] = placeholder[target=tensor_357]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_355, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0x10e75ec0)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=326 frame=13(0x10e75ec0)
tracing opcode INPLACE_ADD None pc=328 frame=13(0x10e75ec0)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=334 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=336 frame=13(0x10e75ec0)
tracing opcode CONTAINS_OP None pc=338 frame=13(0x10e75ec0)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=346 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=348 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=350 frame=13(0x10e75ec0)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=356 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=358 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=360 frame=13(0x10e75ec0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339995267616
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415673104
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_358 : [#users=1] = placeholder[target=tensor_358]
    %view : [#users=1] = call_method[target=view](args = (%tensor_358, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0x10e75ec0)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=368 frame=13(0x10e75ec0)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=372 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=374 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=376 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=378 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=380 frame=13(0x10e75ec0)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=384 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=386 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0x10e75ec0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0x10e75ec0)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0x10e75ec0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0x10e75ec0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0x10e75ec0)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=402 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=404 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=406 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=408 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=410 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=412 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=414 frame=13(0x10e75ec0)
tracing opcode COMPARE_OP None pc=416 frame=13(0x10e75ec0)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0x10e75ec0)
tracing opcode STORE_FAST None pc=452 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=456 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=458 frame=13(0x10e75ec0)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0x10e75ec0)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0x10e75ec0)
tracing opcode BINARY_ADD None pc=464 frame=13(0x10e75ec0)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=468 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=470 frame=13(0x10e75ec0)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=474 frame=13(0x10e75ec0)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=478 frame=13(0x10e75ec0)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=484 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=486 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=488 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=490 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=492 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=494 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=496 frame=13(0x10e75ec0)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=500 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=502 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=504 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0x10e75ec0)
record function in graph <built-in method to of Tensor object at 0x153a441f23b0>
tracing opcode CALL_METHOD None pc=508 frame=13(0x10e75ec0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0x10e75ec0)
tracing opcode LOAD_ATTR None pc=514 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=518 frame=13(0x10e75ec0)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=522 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=524 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=526 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0x10e75ec0)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23339995588224
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23339995520672
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23339995519552
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_359 : [#users=1] = placeholder[target=tensor_359]
    %tensor_360 : [#users=0] = placeholder[target=tensor_360]
    %tensor_361 : [#users=0] = placeholder[target=tensor_361]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_359, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0x10e75ec0)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0x10e75ec0)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=538 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0x10e75ec0)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=546 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=548 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=550 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=552 frame=13(0x10e75ec0)
tracing opcode LOAD_METHOD None pc=554 frame=13(0x10e75ec0)
tracing opcode LOAD_CONST None pc=556 frame=13(0x10e75ec0)
tracing opcode CALL_METHOD None pc=558 frame=13(0x10e75ec0)
tracing opcode COMPARE_OP None pc=560 frame=13(0x10e75ec0)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0x10e75ec0)
tracing opcode LOAD_FAST None pc=626 frame=13(0x10e75ec0)
tracing opcode INPLACE_ADD None pc=628 frame=13(0x10e75ec0)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0x10e75ec0)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0x10e75ec0)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0x10e75ec0)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_351 : [#users=1] = placeholder[target=tensor_351]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_351, 1), kwargs = {})
    %tensor_352 : [#users=1] = placeholder[target=tensor_352]
    %tensor_353 : [#users=1] = placeholder[target=tensor_353]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_352, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_353, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0x10e75ec0)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=408 frame=11(0xd6f1bc0)
tracing opcode IS_OP None pc=410 frame=11(0xd6f1bc0)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=418 frame=11(0xd6f1bc0)
tracing opcode BINARY_ADD None pc=420 frame=11(0xd6f1bc0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=426 frame=11(0xd6f1bc0)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=468 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=470 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=472 frame=11(0xd6f1bc0)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=476 frame=11(0xd6f1bc0)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111bd60> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654854496
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111bd60> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23339995655760
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_363 : [#users=1] = placeholder[target=tensor_363]
    %to : [#users=1] = call_method[target=to](args = (%tensor_363, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_364 : [#users=1] = placeholder[target=tensor_364]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_364, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=482 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=484 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=486 frame=11(0xd6f1bc0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415550528
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339995319168
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_365 : [#users=0] = placeholder[target=tensor_365]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0042, 0.0031, 0.0051,  ..., 0.0049, 0.0040, 0.0053],
          [0.0046, 0.0052, 0.0034,  ..., 0.0045, 0.0042, 0.0038],
          [0.0040, 0.0039, 0.0040,  ..., 0.0043, 0.0033, 0.0033],
          ...,
          [0.0047, 0.0039, 0.0040,  ..., 0.0036, 0.0035, 0.0039],
          [0.0048, 0.0058, 0.0030,  ..., 0.0043, 0.0045, 0.0044],
          [0.0043, 0.0034, 0.0055,  ..., 0.0045, 0.0037, 0.0038]],

         [[0.0040, 0.0052, 0.0050,  ..., 0.0043, 0.0032, 0.0035],
          [0.0037, 0.0045, 0.0035,  ..., 0.0038, 0.0035, 0.0040],
          [0.0046, 0.0042, 0.0039,  ..., 0.0048, 0.0044, 0.0038],
          ...,
          [0.0042, 0.0035, 0.0037,  ..., 0.0037, 0.0042, 0.0051],
          [0.0046, 0.0037, 0.0041,  ..., 0.0034, 0.0044, 0.0039],
          [0.0038, 0.0044, 0.0039,  ..., 0.0040, 0.0035, 0.0033]],

         [[0.0037, 0.0032, 0.0047,  ..., 0.0034, 0.0043, 0.0034],
          [0.0044, 0.0035, 0.0054,  ..., 0.0039, 0.0042, 0.0042],
          [0.0037, 0.0037, 0.0043,  ..., 0.0035, 0.0033, 0.0038],
          ...,
          [0.0042, 0.0040, 0.0033,  ..., 0.0040, 0.0036, 0.0037],
          [0.0043, 0.0038, 0.0035,  ..., 0.0046, 0.0033, 0.0041],
          [0.0031, 0.0042, 0.0040,  ..., 0.0057, 0.0033, 0.0048]],

         ...,

         [[0.0033, 0.0036, 0.0035,  ..., 0.0047, 0.0035, 0.0032],
          [0.0042, 0.0037, 0.0029,  ..., 0.0035, 0.0039, 0.0050],
          [0.0037, 0.0030, 0.0037,  ..., 0.0035, 0.0050, 0.0033],
          ...,
          [0.0048, 0.0051, 0.0035,  ..., 0.0048, 0.0045, 0.0028],
          [0.0036, 0.0043, 0.0039,  ..., 0.0039, 0.0047, 0.0027],
          [0.0029, 0.0045, 0.0032,  ..., 0.0038, 0.0042, 0.0042]],

         [[0.0033, 0.0047, 0.0036,  ..., 0.0042, 0.0031, 0.0056],
          [0.0026, 0.0040, 0.0038,  ..., 0.0044, 0.0035, 0.0044],
          [0.0034, 0.0051, 0.0037,  ..., 0.0047, 0.0044, 0.0045],
          ...,
          [0.0035, 0.0037, 0.0043,  ..., 0.0042, 0.0039, 0.0032],
          [0.0032, 0.0044, 0.0043,  ..., 0.0042, 0.0040, 0.0048],
          [0.0035, 0.0040, 0.0035,  ..., 0.0048, 0.0033, 0.0046]],

         [[0.0042, 0.0044, 0.0041,  ..., 0.0045, 0.0040, 0.0046],
          [0.0036, 0.0031, 0.0035,  ..., 0.0034, 0.0042, 0.0042],
          [0.0042, 0.0030, 0.0039,  ..., 0.0036, 0.0033, 0.0044],
          ...,
          [0.0038, 0.0042, 0.0042,  ..., 0.0045, 0.0031, 0.0039],
          [0.0036, 0.0046, 0.0047,  ..., 0.0037, 0.0043, 0.0035],
          [0.0037, 0.0038, 0.0045,  ..., 0.0038, 0.0033, 0.0045]]]]), modified_attrs={}, prev=None) 23339995974672 23339995319168
obj: tensor([[[[0.0042, 0.0031, 0.0051,  ..., 0.0049, 0.0040, 0.0053],
          [0.0046, 0.0052, 0.0034,  ..., 0.0045, 0.0042, 0.0038],
          [0.0040, 0.0039, 0.0040,  ..., 0.0043, 0.0033, 0.0033],
          ...,
          [0.0047, 0.0039, 0.0040,  ..., 0.0036, 0.0035, 0.0039],
          [0.0048, 0.0058, 0.0030,  ..., 0.0043, 0.0045, 0.0044],
          [0.0043, 0.0034, 0.0055,  ..., 0.0045, 0.0037, 0.0038]],

         [[0.0040, 0.0052, 0.0050,  ..., 0.0043, 0.0032, 0.0035],
          [0.0037, 0.0045, 0.0035,  ..., 0.0038, 0.0035, 0.0040],
          [0.0046, 0.0042, 0.0039,  ..., 0.0048, 0.0044, 0.0038],
          ...,
          [0.0042, 0.0035, 0.0037,  ..., 0.0037, 0.0042, 0.0051],
          [0.0046, 0.0037, 0.0041,  ..., 0.0034, 0.0044, 0.0039],
          [0.0038, 0.0044, 0.0039,  ..., 0.0040, 0.0035, 0.0033]],

         [[0.0037, 0.0032, 0.0047,  ..., 0.0034, 0.0043, 0.0034],
          [0.0044, 0.0035, 0.0054,  ..., 0.0039, 0.0042, 0.0042],
          [0.0037, 0.0037, 0.0043,  ..., 0.0035, 0.0033, 0.0038],
          ...,
          [0.0042, 0.0040, 0.0033,  ..., 0.0040, 0.0036, 0.0037],
          [0.0043, 0.0038, 0.0035,  ..., 0.0046, 0.0033, 0.0041],
          [0.0031, 0.0042, 0.0040,  ..., 0.0057, 0.0033, 0.0048]],

         ...,

         [[0.0033, 0.0036, 0.0035,  ..., 0.0047, 0.0035, 0.0032],
          [0.0042, 0.0037, 0.0029,  ..., 0.0035, 0.0039, 0.0050],
          [0.0037, 0.0030, 0.0037,  ..., 0.0035, 0.0050, 0.0033],
          ...,
          [0.0048, 0.0051, 0.0035,  ..., 0.0048, 0.0045, 0.0028],
          [0.0036, 0.0043, 0.0039,  ..., 0.0039, 0.0047, 0.0027],
          [0.0029, 0.0045, 0.0032,  ..., 0.0038, 0.0042, 0.0042]],

         [[0.0033, 0.0047, 0.0036,  ..., 0.0042, 0.0031, 0.0056],
          [0.0026, 0.0040, 0.0038,  ..., 0.0044, 0.0035, 0.0044],
          [0.0034, 0.0051, 0.0037,  ..., 0.0047, 0.0044, 0.0045],
          ...,
          [0.0035, 0.0037, 0.0043,  ..., 0.0042, 0.0039, 0.0032],
          [0.0032, 0.0044, 0.0043,  ..., 0.0042, 0.0040, 0.0048],
          [0.0035, 0.0040, 0.0035,  ..., 0.0048, 0.0033, 0.0046]],

         [[0.0042, 0.0044, 0.0041,  ..., 0.0045, 0.0040, 0.0046],
          [0.0036, 0.0031, 0.0035,  ..., 0.0034, 0.0042, 0.0042],
          [0.0042, 0.0030, 0.0039,  ..., 0.0036, 0.0033, 0.0044],
          ...,
          [0.0038, 0.0042, 0.0042,  ..., 0.0045, 0.0031, 0.0039],
          [0.0036, 0.0046, 0.0047,  ..., 0.0037, 0.0043, 0.0035],
          [0.0037, 0.0038, 0.0045,  ..., 0.0038, 0.0033, 0.0045]]]]) 23339995319168
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0042, 0.0031, 0.0051,  ..., 0.0049, 0.0040, 0.0053],
          [0.0046, 0.0052, 0.0034,  ..., 0.0045, 0.0042, 0.0038],
          [0.0040, 0.0039, 0.0040,  ..., 0.0043, 0.0033, 0.0033],
          ...,
          [0.0047, 0.0039, 0.0040,  ..., 0.0036, 0.0035, 0.0039],
          [0.0048, 0.0058, 0.0030,  ..., 0.0043, 0.0045, 0.0044],
          [0.0043, 0.0034, 0.0055,  ..., 0.0045, 0.0037, 0.0038]],

         [[0.0040, 0.0052, 0.0050,  ..., 0.0043, 0.0032, 0.0035],
          [0.0037, 0.0045, 0.0035,  ..., 0.0038, 0.0035, 0.0040],
          [0.0046, 0.0042, 0.0039,  ..., 0.0048, 0.0044, 0.0038],
          ...,
          [0.0042, 0.0035, 0.0037,  ..., 0.0037, 0.0042, 0.0051],
          [0.0046, 0.0037, 0.0041,  ..., 0.0034, 0.0044, 0.0039],
          [0.0038, 0.0044, 0.0039,  ..., 0.0040, 0.0035, 0.0033]],

         [[0.0037, 0.0032, 0.0047,  ..., 0.0034, 0.0043, 0.0034],
          [0.0044, 0.0035, 0.0054,  ..., 0.0039, 0.0042, 0.0042],
          [0.0037, 0.0037, 0.0043,  ..., 0.0035, 0.0033, 0.0038],
          ...,
          [0.0042, 0.0040, 0.0033,  ..., 0.0040, 0.0036, 0.0037],
          [0.0043, 0.0038, 0.0035,  ..., 0.0046, 0.0033, 0.0041],
          [0.0031, 0.0042, 0.0040,  ..., 0.0057, 0.0033, 0.0048]],

         ...,

         [[0.0033, 0.0036, 0.0035,  ..., 0.0047, 0.0035, 0.0032],
          [0.0042, 0.0037, 0.0029,  ..., 0.0035, 0.0039, 0.0050],
          [0.0037, 0.0030, 0.0037,  ..., 0.0035, 0.0050, 0.0033],
          ...,
          [0.0048, 0.0051, 0.0035,  ..., 0.0048, 0.0045, 0.0028],
          [0.0036, 0.0043, 0.0039,  ..., 0.0039, 0.0047, 0.0027],
          [0.0029, 0.0045, 0.0032,  ..., 0.0038, 0.0042, 0.0042]],

         [[0.0033, 0.0047, 0.0036,  ..., 0.0042, 0.0031, 0.0056],
          [0.0026, 0.0040, 0.0038,  ..., 0.0044, 0.0035, 0.0044],
          [0.0034, 0.0051, 0.0037,  ..., 0.0047, 0.0044, 0.0045],
          ...,
          [0.0035, 0.0037, 0.0043,  ..., 0.0042, 0.0039, 0.0032],
          [0.0032, 0.0044, 0.0043,  ..., 0.0042, 0.0040, 0.0048],
          [0.0035, 0.0040, 0.0035,  ..., 0.0048, 0.0033, 0.0046]],

         [[0.0042, 0.0044, 0.0041,  ..., 0.0045, 0.0040, 0.0046],
          [0.0036, 0.0031, 0.0035,  ..., 0.0034, 0.0042, 0.0042],
          [0.0042, 0.0030, 0.0039,  ..., 0.0036, 0.0033, 0.0044],
          ...,
          [0.0038, 0.0042, 0.0042,  ..., 0.0045, 0.0031, 0.0039],
          [0.0036, 0.0046, 0.0047,  ..., 0.0037, 0.0043, 0.0035],
          [0.0037, 0.0038, 0.0045,  ..., 0.0038, 0.0033, 0.0045]]]]), modified_attrs={}, prev=None) 23339993356752
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0xd6f1bc0)
tracing opcode LOAD_ATTR None pc=492 frame=11(0xd6f1bc0)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=534 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=536 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=538 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=540 frame=11(0xd6f1bc0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=546 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=548 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=550 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=552 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=554 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=556 frame=11(0xd6f1bc0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=560 frame=11(0xd6f1bc0)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=566 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=568 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=570 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=572 frame=11(0xd6f1bc0)
tracing opcode BUILD_SLICE None pc=574 frame=11(0xd6f1bc0)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0xd6f1bc0)
tracing opcode LOAD_CONST None pc=578 frame=11(0xd6f1bc0)
tracing opcode BINARY_ADD None pc=580 frame=11(0xd6f1bc0)
tracing opcode STORE_FAST None pc=582 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0xd6f1bc0)
tracing opcode LOAD_METHOD None pc=586 frame=11(0xd6f1bc0)
tracing opcode LOAD_FAST None pc=588 frame=11(0xd6f1bc0)
tracing opcode CALL_METHOD None pc=590 frame=11(0xd6f1bc0)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0xd6f1bc0)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0xd6f1bc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0xd6f1bc0)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0xd6f1bc0)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_346 : [#users=1] = placeholder[target=tensor_346]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_346,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_350 : [#users=1] = placeholder[target=tensor_350]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_350, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_351 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_351, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_362 : [#users=1] = placeholder[target=tensor_362]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_362, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_363 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_363), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0xd6f1bc0)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0xbf70940)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0xbf70940)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0xbf70940)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0xbf70940)
tracing opcode LOAD_CONST None pc=46 frame=10(0xbf70940)
tracing opcode IS_OP None pc=48 frame=10(0xbf70940)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0xbf70940)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0xbf70940)
tracing opcode STORE_FAST None pc=54 frame=10(0xbf70940)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0xbf70940)
tracing opcode LOAD_METHOD None pc=58 frame=10(0xbf70940)
tracing opcode LOAD_FAST None pc=60 frame=10(0xbf70940)
tracing opcode LOAD_FAST None pc=62 frame=10(0xbf70940)
tracing opcode CALL_METHOD None pc=64 frame=10(0xbf70940)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bad76e640)
push tracker due to record
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bad76e640)
load fast: 23346415550576
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bad76e640)
load fast: 23339993475248
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bad76e640)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bad76e640)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bad76e640)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415550720
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339993399360
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_367 : [#users=0] = placeholder[target=tensor_367]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.1535,  0.0808,  0.0628,  ...,  0.0938, -0.0903, -0.0973],
         [ 0.1486,  0.0747,  0.0638,  ...,  0.0868, -0.0976, -0.0952],
         [ 0.1471,  0.0710,  0.0594,  ...,  0.0846, -0.0926, -0.0906],
         ...,
         [ 0.1507,  0.0723,  0.0653,  ...,  0.0901, -0.0943, -0.0942],
         [ 0.1508,  0.0751,  0.0624,  ...,  0.0927, -0.0977, -0.0906],
         [ 0.1511,  0.0719,  0.0673,  ...,  0.0896, -0.0950, -0.0965]]]), modified_attrs={}, prev=None) 23339993443104 23339993399360
obj: tensor([[[ 0.1535,  0.0808,  0.0628,  ...,  0.0938, -0.0903, -0.0973],
         [ 0.1486,  0.0747,  0.0638,  ...,  0.0868, -0.0976, -0.0952],
         [ 0.1471,  0.0710,  0.0594,  ...,  0.0846, -0.0926, -0.0906],
         ...,
         [ 0.1507,  0.0723,  0.0653,  ...,  0.0901, -0.0943, -0.0942],
         [ 0.1508,  0.0751,  0.0624,  ...,  0.0927, -0.0977, -0.0906],
         [ 0.1511,  0.0719,  0.0673,  ...,  0.0896, -0.0950, -0.0965]]]) 23339993399360
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.1535,  0.0808,  0.0628,  ...,  0.0938, -0.0903, -0.0973],
         [ 0.1486,  0.0747,  0.0638,  ...,  0.0868, -0.0976, -0.0952],
         [ 0.1471,  0.0710,  0.0594,  ...,  0.0846, -0.0926, -0.0906],
         ...,
         [ 0.1507,  0.0723,  0.0653,  ...,  0.0901, -0.0943, -0.0942],
         [ 0.1508,  0.0751,  0.0624,  ...,  0.0927, -0.0977, -0.0906],
         [ 0.1511,  0.0719,  0.0673,  ...,  0.0896, -0.0950, -0.0965]]]), modified_attrs={}, prev=None) 23339993394384
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bad76e640)
load fast: 23339995882656
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bad76e640)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bad76e640)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23339993400720
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a44040590>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a44054590>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415550672
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_369 : [#users=4] = placeholder[target=tensor_369]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_369,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_369, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_369, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_369, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a44040590>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bad76e640)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_366 : [#users=1] = placeholder[target=tensor_366]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_366,), kwargs = {})
    %tensor_368 : [#users=1] = placeholder[target=tensor_368]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_368), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0xbf70940)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0xbf70940)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0xbf70940)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0xbf70940)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0xbf70940)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_343 : [#users=2] = placeholder[target=tensor_343]
    %tensor_344 : [#users=1] = placeholder[target=tensor_344]
    %tensor_345 : [#users=1] = placeholder[target=tensor_345]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_343,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_345, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_351 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_351, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_344, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_363 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_363), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_343), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0xbf70940)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0xf706820)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0xf706820)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0xf706820)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0xf706820)
tracing opcode LOAD_METHOD None pc=46 frame=9(0xf706820)
tracing opcode LOAD_FAST None pc=48 frame=9(0xf706820)
tracing opcode CALL_METHOD None pc=50 frame=9(0xf706820)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x8c78680)
push tracker due to record
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x8c78680)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x8c78680)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x8c78680)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x8c78680)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x8c78680)
load fast: 23346415550768
tracing opcode LOAD_METHOD None pc=12 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=14 frame=18(0x8c78680)
load fast: 23339993484400
tracing opcode CALL_METHOD None pc=16 frame=18(0x8c78680)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x8c78680)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=24 frame=18(0x8c78680)
tracing opcode CALL_METHOD None pc=26 frame=18(0x8c78680)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0xb1e2090)
push tracker due to record
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0xb1e2090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0xb1e2090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0xb1e2090)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0xb1e2090)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0xb1e2090)
load fast: 23346415550864
tracing opcode LOAD_METHOD None pc=12 frame=19(0xb1e2090)
tracing opcode LOAD_FAST None pc=14 frame=19(0xb1e2090)
load fast: 23339862159664
tracing opcode CALL_METHOD None pc=16 frame=19(0xb1e2090)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0xb1e2090)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_371 : [#users=1] = placeholder[target=tensor_371]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_371,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0xb1e2090)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x8c78680)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x8c78680)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_370 : [#users=1] = placeholder[target=tensor_370]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_370,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x8c78680)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0xf706820)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0xf706820)
tracing opcode LOAD_METHOD None pc=56 frame=9(0xf706820)
tracing opcode LOAD_FAST None pc=58 frame=9(0xf706820)
tracing opcode LOAD_FAST None pc=60 frame=9(0xf706820)
tracing opcode CALL_METHOD None pc=62 frame=9(0xf706820)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x120fe0f0)
push tracker due to record
push tracker 20 frame 0x120fe0f0 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x120fe0f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x120fe0f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x120fe0f0 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x120fe0f0)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x120fe0f0)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x120fe0f0)
load fast: 23346415550912
tracing opcode LOAD_METHOD None pc=12 frame=20(0x120fe0f0)
tracing opcode LOAD_FAST None pc=14 frame=20(0x120fe0f0)
load fast: 23339862128176
tracing opcode CALL_METHOD None pc=16 frame=20(0x120fe0f0)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x120fe0f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x120fe0f0)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x120fe0f0)
tracing opcode LOAD_FAST None pc=24 frame=20(0x120fe0f0)
tracing opcode CALL_METHOD None pc=26 frame=20(0x120fe0f0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0xe4785d0)
push tracker due to record
push tracker 3 frame 0xe4785d0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0xe4785d0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0xe4785d0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0xe4785d0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0xe4785d0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0xe4785d0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0xe4785d0)
load fast: 23346415551056
tracing opcode LOAD_ATTR None pc=12 frame=3(0xe4785d0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0xe4785d0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0xe4785d0)
load fast: 23339862233392
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0xe4785d0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_373 : [#users=0] = placeholder[target=tensor_373]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0781, -0.2434, -0.1189,  ..., -0.8450, -0.2808, -0.0109],
         [-0.0899, -0.5152, -0.3281,  ..., -0.4669,  0.0569,  0.4142],
         [-0.2130, -0.1539, -0.3899,  ..., -0.2372, -0.4141,  0.1425],
         ...,
         [ 0.5498,  0.0324, -0.6919,  ...,  0.3614,  0.1702,  0.6216],
         [ 0.0035,  0.1785, -0.1831,  ...,  0.2300, -0.1539,  0.5556],
         [ 0.1823,  0.3648,  0.5302,  ..., -0.0062, -0.0617,  0.3507]]]), modified_attrs={}, prev=None) 23339862238784 23339862233392
obj: tensor([[[ 0.0781, -0.2434, -0.1189,  ..., -0.8450, -0.2808, -0.0109],
         [-0.0899, -0.5152, -0.3281,  ..., -0.4669,  0.0569,  0.4142],
         [-0.2130, -0.1539, -0.3899,  ..., -0.2372, -0.4141,  0.1425],
         ...,
         [ 0.5498,  0.0324, -0.6919,  ...,  0.3614,  0.1702,  0.6216],
         [ 0.0035,  0.1785, -0.1831,  ...,  0.2300, -0.1539,  0.5556],
         [ 0.1823,  0.3648,  0.5302,  ..., -0.0062, -0.0617,  0.3507]]]) 23339862233392
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0781, -0.2434, -0.1189,  ..., -0.8450, -0.2808, -0.0109],
         [-0.0899, -0.5152, -0.3281,  ..., -0.4669,  0.0569,  0.4142],
         [-0.2130, -0.1539, -0.3899,  ..., -0.2372, -0.4141,  0.1425],
         ...,
         [ 0.5498,  0.0324, -0.6919,  ...,  0.3614,  0.1702,  0.6216],
         [ 0.0035,  0.1785, -0.1831,  ...,  0.2300, -0.1539,  0.5556],
         [ 0.1823,  0.3648,  0.5302,  ..., -0.0062, -0.0617,  0.3507]]]), modified_attrs={}, prev=None) 23339862229296
tracing opcode RETURN_VALUE None pc=74 frame=3(0xe4785d0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x120fe0f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x120fe0f0)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x120fe0f0)
tracing opcode LOAD_FAST None pc=34 frame=20(0x120fe0f0)
tracing opcode LOAD_FAST None pc=36 frame=20(0x120fe0f0)
load fast: 23339993484400
tracing opcode BINARY_ADD None pc=38 frame=20(0x120fe0f0)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x120fe0f0)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23339861742832
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a3c2b14f0>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a44054400>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415551008
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_375 : [#users=4] = placeholder[target=tensor_375]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_375,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_375, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_375, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_375, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a3c2b14f0>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x120fe0f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x120fe0f0)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x120fe0f0)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_372 : [#users=1] = placeholder[target=tensor_372]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_372,), kwargs = {})
    %tensor_374 : [#users=1] = placeholder[target=tensor_374]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_374), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x120fe0f0)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0xf706820)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0xf706820)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0xf706820)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0xf706820)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0xf706820)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_340 : [#users=2] = placeholder[target=tensor_340]
    %tensor_341 : [#users=1] = placeholder[target=tensor_341]
    %tensor_342 : [#users=1] = placeholder[target=tensor_342]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_340,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_342, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_351 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_351, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_341, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_363 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_363), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_340), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0xf706820)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0x120fc8b0)
push tracker due to record
push tracker 9 frame 0x120fc8b0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0x120fc8b0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0x120fc8b0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0x120fc8b0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0x120fc8b0)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0x120fc8b0)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0x120fc8b0)
load fast: 23346415551104
tracing opcode LOAD_ATTR None pc=12 frame=9(0x120fc8b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0x120fc8b0)
load fast: 23339993400960
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0x120fc8b0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0x120fc8b0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0x120fc8b0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0x120fc8b0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0x120fc8b0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0x120fc8b0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0x120fc8b0)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0xd1f5b20)
push tracker due to record
push tracker 10 frame 0xd1f5b20 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0xd1f5b20)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0xd1f5b20)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0xd1f5b20 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0xd1f5b20)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0xd1f5b20)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0xd1f5b20)
load fast: 23346415551152
tracing opcode LOAD_ATTR None pc=12 frame=10(0xd1f5b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0xd1f5b20)
load fast: 23339993400960
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0xd1f5b20)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0xd1f5b20)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0xd1f5b20)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0xd1f5b20)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0xd1f5b20)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0xd1f5b20)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0xd1f5b20)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0x121045c0)
push tracker due to record
push tracker 11 frame 0x121045c0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0x121045c0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0x121045c0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0x121045c0 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0x121045c0)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0x121045c0)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0x121045c0)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0x121045c0)
tracing opcode IS_OP None pc=16 frame=11(0x121045c0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0x121045c0)
load fast: 23346415551200
tracing opcode LOAD_METHOD None pc=22 frame=11(0x121045c0)
tracing opcode LOAD_DEREF None pc=24 frame=11(0x121045c0)
load fast: 23339993400960
tracing opcode CALL_METHOD None pc=26 frame=11(0x121045c0)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=32 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=34 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=36 frame=11(0x121045c0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339861936944
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415551200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_383 : [#users=1] = placeholder[target=tensor_383]
    %view : [#users=1] = call_method[target=view](args = (%tensor_383, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=40 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=42 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=44 frame=11(0x121045c0)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0x121045c0)
record function in graph <built-in method chunk of Tensor object at 0x153a3c2e99a0>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0x121045c0)
tracing opcode STORE_FAST None pc=50 frame=11(0x121045c0)
tracing opcode STORE_FAST None pc=52 frame=11(0x121045c0)
tracing opcode STORE_FAST None pc=54 frame=11(0x121045c0)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0x121045c0)
tracing opcode LOAD_DEREF None pc=224 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=226 frame=11(0x121045c0)
tracing opcode LOAD_DEREF None pc=228 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=230 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=232 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=234 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=236 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=238 frame=11(0x121045c0)
tracing opcode BUILD_SLICE None pc=240 frame=11(0x121045c0)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0x121045c0)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0x121045c0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0x121045c0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339861936464
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415551200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_384 : [#users=1] = placeholder[target=tensor_384]
    %view : [#users=1] = call_method[target=view](args = (%tensor_384, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0x121045c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0x121045c0)
tracing opcode LOAD_DEREF None pc=254 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=256 frame=11(0x121045c0)
tracing opcode LOAD_DEREF None pc=258 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=260 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=262 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=264 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=266 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=268 frame=11(0x121045c0)
tracing opcode BUILD_SLICE None pc=270 frame=11(0x121045c0)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0x121045c0)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0x121045c0)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0x121045c0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339861494896
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415551200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_385 : [#users=1] = placeholder[target=tensor_385]
    %view : [#users=1] = call_method[target=view](args = (%tensor_385, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0x121045c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0x121045c0)
tracing opcode STORE_FAST None pc=284 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0x121045c0)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0x121045c0)
tracing opcode LOAD_DEREF None pc=290 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=292 frame=11(0x121045c0)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0x121045c0)
tracing opcode BINARY_ADD None pc=296 frame=11(0x121045c0)
tracing opcode STORE_FAST None pc=298 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=302 frame=11(0x121045c0)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=306 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=308 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=310 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=312 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=314 frame=11(0x121045c0)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=318 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=320 frame=11(0x121045c0)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0x121045c0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0x121045c0)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0x121045c0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0x121045c0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=334 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=336 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=338 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=340 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=342 frame=11(0x121045c0)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0x121045c0)
record function in graph <built-in method to of Tensor object at 0x153a3c290b80>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0x121045c0)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=352 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=354 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=356 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=358 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=360 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=362 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=364 frame=11(0x121045c0)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0x121045c0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=372 frame=11(0x121045c0)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=380 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=382 frame=11(0x121045c0)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0x121045c0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415551296
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=390 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=392 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=394 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=396 frame=11(0x121045c0)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=400 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=402 frame=11(0x121045c0)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0x11c07fd0)
push tracker due to record
push tracker 13 frame 0x11c07fd0 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0x11c07fd0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0x11c07fd0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0x11c07fd0 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0x11c07fd0)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0x11c07fd0)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0x11c07fd0)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0x11c07fd0)
tracing opcode IS_OP None pc=16 frame=13(0x11c07fd0)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=52 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=54 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=56 frame=13(0x11c07fd0)
tracing opcode COMPARE_OP None pc=58 frame=13(0x11c07fd0)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=82 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=84 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=86 frame=13(0x11c07fd0)
tracing opcode COMPARE_OP None pc=88 frame=13(0x11c07fd0)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=94 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=96 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=98 frame=13(0x11c07fd0)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0x11c07fd0)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0x11c07fd0)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=138 frame=13(0x11c07fd0)
load fast: 23339861806432
tracing opcode LOAD_METHOD None pc=140 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=142 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=144 frame=13(0x11c07fd0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0x11c07fd0)
load fast: 23339861974208
tracing opcode LOAD_METHOD None pc=148 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=150 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=152 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=156 frame=13(0x11c07fd0)
load fast: 23346415551200
tracing opcode LOAD_ATTR None pc=158 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0x11c07fd0)
tracing opcode STORE_FAST None pc=162 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=166 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=168 frame=13(0x11c07fd0)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=172 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=174 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=176 frame=13(0x11c07fd0)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0x11c07fd0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=184 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=186 frame=13(0x11c07fd0)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=190 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=192 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=194 frame=13(0x11c07fd0)
tracing opcode BINARY_ADD None pc=196 frame=13(0x11c07fd0)
tracing opcode BUILD_SLICE None pc=198 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=200 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=202 frame=13(0x11c07fd0)
tracing opcode BUILD_SLICE None pc=204 frame=13(0x11c07fd0)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0x11c07fd0)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0x11c07fd0)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0x11c07fd0)
tracing opcode STORE_FAST None pc=220 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=224 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=226 frame=13(0x11c07fd0)
tracing opcode CONTAINS_OP None pc=228 frame=13(0x11c07fd0)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=236 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=238 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=240 frame=13(0x11c07fd0)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=246 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=248 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=250 frame=13(0x11c07fd0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339861709504
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415551200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_390 : [#users=1] = placeholder[target=tensor_390]
    %view : [#users=1] = call_method[target=view](args = (%tensor_390, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=256 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=258 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=260 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=262 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=264 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=266 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=268 frame=13(0x11c07fd0)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0x11c07fd0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=276 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=278 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=280 frame=13(0x11c07fd0)
tracing opcode BINARY_ADD None pc=282 frame=13(0x11c07fd0)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=286 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=288 frame=13(0x11c07fd0)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=292 frame=13(0x11c07fd0)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=296 frame=13(0x11c07fd0)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=302 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=304 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=306 frame=13(0x11c07fd0)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=310 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=312 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=314 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0x11c07fd0)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23339861497472
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23339861806432
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23339861718736
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_391 : [#users=1] = placeholder[target=tensor_391]
    %tensor_392 : [#users=0] = placeholder[target=tensor_392]
    %tensor_393 : [#users=0] = placeholder[target=tensor_393]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_391, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0x11c07fd0)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=326 frame=13(0x11c07fd0)
tracing opcode INPLACE_ADD None pc=328 frame=13(0x11c07fd0)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=334 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=336 frame=13(0x11c07fd0)
tracing opcode CONTAINS_OP None pc=338 frame=13(0x11c07fd0)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=346 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=348 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=350 frame=13(0x11c07fd0)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=356 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=358 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=360 frame=13(0x11c07fd0)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339861673120
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415551200
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_394 : [#users=1] = placeholder[target=tensor_394]
    %view : [#users=1] = call_method[target=view](args = (%tensor_394, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0x11c07fd0)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=368 frame=13(0x11c07fd0)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=372 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=374 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=376 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=378 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=380 frame=13(0x11c07fd0)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=384 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=386 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0x11c07fd0)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0x11c07fd0)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0x11c07fd0)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0x11c07fd0)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0x11c07fd0)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=402 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=404 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=406 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=408 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=410 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=412 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=414 frame=13(0x11c07fd0)
tracing opcode COMPARE_OP None pc=416 frame=13(0x11c07fd0)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0x11c07fd0)
tracing opcode STORE_FAST None pc=452 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=456 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=458 frame=13(0x11c07fd0)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0x11c07fd0)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0x11c07fd0)
tracing opcode BINARY_ADD None pc=464 frame=13(0x11c07fd0)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=468 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=470 frame=13(0x11c07fd0)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=474 frame=13(0x11c07fd0)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=478 frame=13(0x11c07fd0)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=484 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=486 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=488 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=490 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=492 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=494 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=496 frame=13(0x11c07fd0)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=500 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=502 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=504 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0x11c07fd0)
record function in graph <built-in method to of Tensor object at 0x153a3c2a05e0>
tracing opcode CALL_METHOD None pc=508 frame=13(0x11c07fd0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0x11c07fd0)
tracing opcode LOAD_ATTR None pc=514 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=518 frame=13(0x11c07fd0)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=522 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=524 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=526 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0x11c07fd0)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23339861710944
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23339861806432
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23339861974208
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_395 : [#users=1] = placeholder[target=tensor_395]
    %tensor_396 : [#users=0] = placeholder[target=tensor_396]
    %tensor_397 : [#users=0] = placeholder[target=tensor_397]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_395, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0x11c07fd0)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0x11c07fd0)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=538 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0x11c07fd0)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=546 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=548 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=550 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=552 frame=13(0x11c07fd0)
tracing opcode LOAD_METHOD None pc=554 frame=13(0x11c07fd0)
tracing opcode LOAD_CONST None pc=556 frame=13(0x11c07fd0)
tracing opcode CALL_METHOD None pc=558 frame=13(0x11c07fd0)
tracing opcode COMPARE_OP None pc=560 frame=13(0x11c07fd0)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0x11c07fd0)
tracing opcode LOAD_FAST None pc=626 frame=13(0x11c07fd0)
tracing opcode INPLACE_ADD None pc=628 frame=13(0x11c07fd0)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0x11c07fd0)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0x11c07fd0)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0x11c07fd0)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_387 : [#users=1] = placeholder[target=tensor_387]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_387, 1), kwargs = {})
    %tensor_388 : [#users=1] = placeholder[target=tensor_388]
    %tensor_389 : [#users=1] = placeholder[target=tensor_389]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_388, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_389, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0x11c07fd0)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=408 frame=11(0x121045c0)
tracing opcode IS_OP None pc=410 frame=11(0x121045c0)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=418 frame=11(0x121045c0)
tracing opcode BINARY_ADD None pc=420 frame=11(0x121045c0)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=426 frame=11(0x121045c0)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=468 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=470 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=472 frame=11(0x121045c0)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=476 frame=11(0x121045c0)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111be50> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23346654854736
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153bd111be50> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23339861672720
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_399 : [#users=1] = placeholder[target=tensor_399]
    %to : [#users=1] = call_method[target=to](args = (%tensor_399, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_400 : [#users=1] = placeholder[target=tensor_400]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_400, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=482 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=484 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=486 frame=11(0x121045c0)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415551440
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339785442384
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_401 : [#users=0] = placeholder[target=tensor_401]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0040, 0.0033, 0.0041,  ..., 0.0036, 0.0034, 0.0034],
          [0.0036, 0.0053, 0.0033,  ..., 0.0035, 0.0036, 0.0046],
          [0.0033, 0.0028, 0.0048,  ..., 0.0049, 0.0044, 0.0039],
          ...,
          [0.0027, 0.0031, 0.0053,  ..., 0.0039, 0.0032, 0.0042],
          [0.0040, 0.0039, 0.0037,  ..., 0.0038, 0.0056, 0.0038],
          [0.0031, 0.0059, 0.0033,  ..., 0.0039, 0.0044, 0.0051]],

         [[0.0034, 0.0036, 0.0039,  ..., 0.0041, 0.0030, 0.0049],
          [0.0044, 0.0036, 0.0042,  ..., 0.0044, 0.0041, 0.0040],
          [0.0045, 0.0041, 0.0039,  ..., 0.0052, 0.0045, 0.0033],
          ...,
          [0.0044, 0.0046, 0.0029,  ..., 0.0039, 0.0041, 0.0041],
          [0.0034, 0.0045, 0.0044,  ..., 0.0043, 0.0045, 0.0044],
          [0.0040, 0.0042, 0.0033,  ..., 0.0051, 0.0039, 0.0042]],

         [[0.0041, 0.0041, 0.0042,  ..., 0.0033, 0.0031, 0.0049],
          [0.0038, 0.0031, 0.0041,  ..., 0.0032, 0.0036, 0.0035],
          [0.0044, 0.0035, 0.0036,  ..., 0.0037, 0.0033, 0.0030],
          ...,
          [0.0034, 0.0034, 0.0048,  ..., 0.0039, 0.0035, 0.0034],
          [0.0032, 0.0031, 0.0041,  ..., 0.0035, 0.0044, 0.0038],
          [0.0034, 0.0044, 0.0038,  ..., 0.0038, 0.0044, 0.0034]],

         ...,

         [[0.0036, 0.0034, 0.0040,  ..., 0.0027, 0.0051, 0.0031],
          [0.0033, 0.0040, 0.0034,  ..., 0.0037, 0.0037, 0.0041],
          [0.0034, 0.0035, 0.0034,  ..., 0.0027, 0.0059, 0.0037],
          ...,
          [0.0039, 0.0044, 0.0041,  ..., 0.0029, 0.0039, 0.0037],
          [0.0042, 0.0038, 0.0038,  ..., 0.0036, 0.0055, 0.0054],
          [0.0043, 0.0031, 0.0045,  ..., 0.0033, 0.0033, 0.0059]],

         [[0.0054, 0.0045, 0.0038,  ..., 0.0047, 0.0048, 0.0032],
          [0.0043, 0.0049, 0.0034,  ..., 0.0043, 0.0036, 0.0042],
          [0.0053, 0.0041, 0.0039,  ..., 0.0042, 0.0037, 0.0033],
          ...,
          [0.0046, 0.0041, 0.0036,  ..., 0.0056, 0.0042, 0.0044],
          [0.0052, 0.0041, 0.0038,  ..., 0.0050, 0.0041, 0.0037],
          [0.0042, 0.0041, 0.0038,  ..., 0.0040, 0.0038, 0.0053]],

         [[0.0041, 0.0043, 0.0033,  ..., 0.0034, 0.0035, 0.0032],
          [0.0037, 0.0038, 0.0047,  ..., 0.0036, 0.0039, 0.0044],
          [0.0046, 0.0042, 0.0042,  ..., 0.0044, 0.0035, 0.0042],
          ...,
          [0.0038, 0.0045, 0.0039,  ..., 0.0037, 0.0038, 0.0032],
          [0.0045, 0.0041, 0.0036,  ..., 0.0032, 0.0038, 0.0044],
          [0.0040, 0.0034, 0.0040,  ..., 0.0038, 0.0032, 0.0043]]]]), modified_attrs={}, prev=None) 23339861697584 23339785442384
obj: tensor([[[[0.0040, 0.0033, 0.0041,  ..., 0.0036, 0.0034, 0.0034],
          [0.0036, 0.0053, 0.0033,  ..., 0.0035, 0.0036, 0.0046],
          [0.0033, 0.0028, 0.0048,  ..., 0.0049, 0.0044, 0.0039],
          ...,
          [0.0027, 0.0031, 0.0053,  ..., 0.0039, 0.0032, 0.0042],
          [0.0040, 0.0039, 0.0037,  ..., 0.0038, 0.0056, 0.0038],
          [0.0031, 0.0059, 0.0033,  ..., 0.0039, 0.0044, 0.0051]],

         [[0.0034, 0.0036, 0.0039,  ..., 0.0041, 0.0030, 0.0049],
          [0.0044, 0.0036, 0.0042,  ..., 0.0044, 0.0041, 0.0040],
          [0.0045, 0.0041, 0.0039,  ..., 0.0052, 0.0045, 0.0033],
          ...,
          [0.0044, 0.0046, 0.0029,  ..., 0.0039, 0.0041, 0.0041],
          [0.0034, 0.0045, 0.0044,  ..., 0.0043, 0.0045, 0.0044],
          [0.0040, 0.0042, 0.0033,  ..., 0.0051, 0.0039, 0.0042]],

         [[0.0041, 0.0041, 0.0042,  ..., 0.0033, 0.0031, 0.0049],
          [0.0038, 0.0031, 0.0041,  ..., 0.0032, 0.0036, 0.0035],
          [0.0044, 0.0035, 0.0036,  ..., 0.0037, 0.0033, 0.0030],
          ...,
          [0.0034, 0.0034, 0.0048,  ..., 0.0039, 0.0035, 0.0034],
          [0.0032, 0.0031, 0.0041,  ..., 0.0035, 0.0044, 0.0038],
          [0.0034, 0.0044, 0.0038,  ..., 0.0038, 0.0044, 0.0034]],

         ...,

         [[0.0036, 0.0034, 0.0040,  ..., 0.0027, 0.0051, 0.0031],
          [0.0033, 0.0040, 0.0034,  ..., 0.0037, 0.0037, 0.0041],
          [0.0034, 0.0035, 0.0034,  ..., 0.0027, 0.0059, 0.0037],
          ...,
          [0.0039, 0.0044, 0.0041,  ..., 0.0029, 0.0039, 0.0037],
          [0.0042, 0.0038, 0.0038,  ..., 0.0036, 0.0055, 0.0054],
          [0.0043, 0.0031, 0.0045,  ..., 0.0033, 0.0033, 0.0059]],

         [[0.0054, 0.0045, 0.0038,  ..., 0.0047, 0.0048, 0.0032],
          [0.0043, 0.0049, 0.0034,  ..., 0.0043, 0.0036, 0.0042],
          [0.0053, 0.0041, 0.0039,  ..., 0.0042, 0.0037, 0.0033],
          ...,
          [0.0046, 0.0041, 0.0036,  ..., 0.0056, 0.0042, 0.0044],
          [0.0052, 0.0041, 0.0038,  ..., 0.0050, 0.0041, 0.0037],
          [0.0042, 0.0041, 0.0038,  ..., 0.0040, 0.0038, 0.0053]],

         [[0.0041, 0.0043, 0.0033,  ..., 0.0034, 0.0035, 0.0032],
          [0.0037, 0.0038, 0.0047,  ..., 0.0036, 0.0039, 0.0044],
          [0.0046, 0.0042, 0.0042,  ..., 0.0044, 0.0035, 0.0042],
          ...,
          [0.0038, 0.0045, 0.0039,  ..., 0.0037, 0.0038, 0.0032],
          [0.0045, 0.0041, 0.0036,  ..., 0.0032, 0.0038, 0.0044],
          [0.0040, 0.0034, 0.0040,  ..., 0.0038, 0.0032, 0.0043]]]]) 23339785442384
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0040, 0.0033, 0.0041,  ..., 0.0036, 0.0034, 0.0034],
          [0.0036, 0.0053, 0.0033,  ..., 0.0035, 0.0036, 0.0046],
          [0.0033, 0.0028, 0.0048,  ..., 0.0049, 0.0044, 0.0039],
          ...,
          [0.0027, 0.0031, 0.0053,  ..., 0.0039, 0.0032, 0.0042],
          [0.0040, 0.0039, 0.0037,  ..., 0.0038, 0.0056, 0.0038],
          [0.0031, 0.0059, 0.0033,  ..., 0.0039, 0.0044, 0.0051]],

         [[0.0034, 0.0036, 0.0039,  ..., 0.0041, 0.0030, 0.0049],
          [0.0044, 0.0036, 0.0042,  ..., 0.0044, 0.0041, 0.0040],
          [0.0045, 0.0041, 0.0039,  ..., 0.0052, 0.0045, 0.0033],
          ...,
          [0.0044, 0.0046, 0.0029,  ..., 0.0039, 0.0041, 0.0041],
          [0.0034, 0.0045, 0.0044,  ..., 0.0043, 0.0045, 0.0044],
          [0.0040, 0.0042, 0.0033,  ..., 0.0051, 0.0039, 0.0042]],

         [[0.0041, 0.0041, 0.0042,  ..., 0.0033, 0.0031, 0.0049],
          [0.0038, 0.0031, 0.0041,  ..., 0.0032, 0.0036, 0.0035],
          [0.0044, 0.0035, 0.0036,  ..., 0.0037, 0.0033, 0.0030],
          ...,
          [0.0034, 0.0034, 0.0048,  ..., 0.0039, 0.0035, 0.0034],
          [0.0032, 0.0031, 0.0041,  ..., 0.0035, 0.0044, 0.0038],
          [0.0034, 0.0044, 0.0038,  ..., 0.0038, 0.0044, 0.0034]],

         ...,

         [[0.0036, 0.0034, 0.0040,  ..., 0.0027, 0.0051, 0.0031],
          [0.0033, 0.0040, 0.0034,  ..., 0.0037, 0.0037, 0.0041],
          [0.0034, 0.0035, 0.0034,  ..., 0.0027, 0.0059, 0.0037],
          ...,
          [0.0039, 0.0044, 0.0041,  ..., 0.0029, 0.0039, 0.0037],
          [0.0042, 0.0038, 0.0038,  ..., 0.0036, 0.0055, 0.0054],
          [0.0043, 0.0031, 0.0045,  ..., 0.0033, 0.0033, 0.0059]],

         [[0.0054, 0.0045, 0.0038,  ..., 0.0047, 0.0048, 0.0032],
          [0.0043, 0.0049, 0.0034,  ..., 0.0043, 0.0036, 0.0042],
          [0.0053, 0.0041, 0.0039,  ..., 0.0042, 0.0037, 0.0033],
          ...,
          [0.0046, 0.0041, 0.0036,  ..., 0.0056, 0.0042, 0.0044],
          [0.0052, 0.0041, 0.0038,  ..., 0.0050, 0.0041, 0.0037],
          [0.0042, 0.0041, 0.0038,  ..., 0.0040, 0.0038, 0.0053]],

         [[0.0041, 0.0043, 0.0033,  ..., 0.0034, 0.0035, 0.0032],
          [0.0037, 0.0038, 0.0047,  ..., 0.0036, 0.0039, 0.0044],
          [0.0046, 0.0042, 0.0042,  ..., 0.0044, 0.0035, 0.0042],
          ...,
          [0.0038, 0.0045, 0.0039,  ..., 0.0037, 0.0038, 0.0032],
          [0.0045, 0.0041, 0.0036,  ..., 0.0032, 0.0038, 0.0044],
          [0.0040, 0.0034, 0.0040,  ..., 0.0038, 0.0032, 0.0043]]]]), modified_attrs={}, prev=None) 23339785410592
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0x121045c0)
tracing opcode LOAD_ATTR None pc=492 frame=11(0x121045c0)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=534 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=536 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=538 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=540 frame=11(0x121045c0)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=546 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=548 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=550 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=552 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=554 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=556 frame=11(0x121045c0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=560 frame=11(0x121045c0)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=566 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=568 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=570 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=572 frame=11(0x121045c0)
tracing opcode BUILD_SLICE None pc=574 frame=11(0x121045c0)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0x121045c0)
tracing opcode LOAD_CONST None pc=578 frame=11(0x121045c0)
tracing opcode BINARY_ADD None pc=580 frame=11(0x121045c0)
tracing opcode STORE_FAST None pc=582 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0x121045c0)
tracing opcode LOAD_METHOD None pc=586 frame=11(0x121045c0)
tracing opcode LOAD_FAST None pc=588 frame=11(0x121045c0)
tracing opcode CALL_METHOD None pc=590 frame=11(0x121045c0)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0x121045c0)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0x121045c0)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0x121045c0)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0x121045c0)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_382 : [#users=1] = placeholder[target=tensor_382]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_382,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_386 : [#users=1] = placeholder[target=tensor_386]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_386, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_387 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_387, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_398 : [#users=1] = placeholder[target=tensor_398]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_398, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_399 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_399), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0x121045c0)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0xd1f5b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0xd1f5b20)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0xd1f5b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0xd1f5b20)
tracing opcode LOAD_CONST None pc=46 frame=10(0xd1f5b20)
tracing opcode IS_OP None pc=48 frame=10(0xd1f5b20)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0xd1f5b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0xd1f5b20)
tracing opcode STORE_FAST None pc=54 frame=10(0xd1f5b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0xd1f5b20)
tracing opcode LOAD_METHOD None pc=58 frame=10(0xd1f5b20)
tracing opcode LOAD_FAST None pc=60 frame=10(0xd1f5b20)
tracing opcode LOAD_FAST None pc=62 frame=10(0xd1f5b20)
tracing opcode CALL_METHOD None pc=64 frame=10(0xd1f5b20)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bad76e640)
push tracker due to record
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bad76e640)
load fast: 23346415551488
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bad76e640)
load fast: 23339785474432
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bad76e640)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bad76e640)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bad76e640)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415551632
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339759837728
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_403 : [#users=0] = placeholder[target=tensor_403]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.1799,  0.0465,  0.0034,  ..., -0.1247, -0.0187, -0.1497],
         [ 0.1758,  0.0494,  0.0069,  ..., -0.1308, -0.0205, -0.1523],
         [ 0.1824,  0.0509, -0.0056,  ..., -0.1291, -0.0176, -0.1628],
         ...,
         [ 0.1773,  0.0460,  0.0022,  ..., -0.1291, -0.0195, -0.1523],
         [ 0.1759,  0.0470, -0.0018,  ..., -0.1319, -0.0148, -0.1555],
         [ 0.1816,  0.0509,  0.0053,  ..., -0.1238, -0.0188, -0.1575]]]), modified_attrs={}, prev=None) 23339785276816 23339759837728
obj: tensor([[[ 0.1799,  0.0465,  0.0034,  ..., -0.1247, -0.0187, -0.1497],
         [ 0.1758,  0.0494,  0.0069,  ..., -0.1308, -0.0205, -0.1523],
         [ 0.1824,  0.0509, -0.0056,  ..., -0.1291, -0.0176, -0.1628],
         ...,
         [ 0.1773,  0.0460,  0.0022,  ..., -0.1291, -0.0195, -0.1523],
         [ 0.1759,  0.0470, -0.0018,  ..., -0.1319, -0.0148, -0.1555],
         [ 0.1816,  0.0509,  0.0053,  ..., -0.1238, -0.0188, -0.1575]]]) 23339759837728
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.1799,  0.0465,  0.0034,  ..., -0.1247, -0.0187, -0.1497],
         [ 0.1758,  0.0494,  0.0069,  ..., -0.1308, -0.0205, -0.1523],
         [ 0.1824,  0.0509, -0.0056,  ..., -0.1291, -0.0176, -0.1628],
         ...,
         [ 0.1773,  0.0460,  0.0022,  ..., -0.1291, -0.0195, -0.1523],
         [ 0.1759,  0.0470, -0.0018,  ..., -0.1319, -0.0148, -0.1555],
         [ 0.1816,  0.0509,  0.0053,  ..., -0.1238, -0.0188, -0.1575]]]), modified_attrs={}, prev=None) 23339785276144
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bad76e640)
load fast: 23339993400960
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bad76e640)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bad76e640)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23339785464624
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a379f2b30>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a36191e50>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415551584
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_405 : [#users=4] = placeholder[target=tensor_405]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_405,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_405, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_405, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_405, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a379f2b30>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bad76e640)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_402 : [#users=1] = placeholder[target=tensor_402]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_402,), kwargs = {})
    %tensor_404 : [#users=1] = placeholder[target=tensor_404]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_404), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0xd1f5b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0xd1f5b20)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0xd1f5b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0xd1f5b20)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0xd1f5b20)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_379 : [#users=2] = placeholder[target=tensor_379]
    %tensor_380 : [#users=1] = placeholder[target=tensor_380]
    %tensor_381 : [#users=1] = placeholder[target=tensor_381]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_379,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_381, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_387 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_387, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_380, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_399 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_399), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_379), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0xd1f5b20)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0x120fc8b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0x120fc8b0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0x120fc8b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0x120fc8b0)
tracing opcode LOAD_METHOD None pc=46 frame=9(0x120fc8b0)
tracing opcode LOAD_FAST None pc=48 frame=9(0x120fc8b0)
tracing opcode CALL_METHOD None pc=50 frame=9(0x120fc8b0)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x8c78680)
push tracker due to record
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x8c78680)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x8c78680)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x8c78680 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x8c78680)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x8c78680)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x8c78680)
load fast: 23346415551680
tracing opcode LOAD_METHOD None pc=12 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=14 frame=18(0x8c78680)
load fast: 23339759793552
tracing opcode CALL_METHOD None pc=16 frame=18(0x8c78680)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x8c78680)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x8c78680)
tracing opcode LOAD_FAST None pc=24 frame=18(0x8c78680)
tracing opcode CALL_METHOD None pc=26 frame=18(0x8c78680)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0xb1e2090)
push tracker due to record
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0xb1e2090)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0xb1e2090)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0xb1e2090 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0xb1e2090)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0xb1e2090)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0xb1e2090)
load fast: 23346415551776
tracing opcode LOAD_METHOD None pc=12 frame=19(0xb1e2090)
tracing opcode LOAD_FAST None pc=14 frame=19(0xb1e2090)
load fast: 23339746944960
tracing opcode CALL_METHOD None pc=16 frame=19(0xb1e2090)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0xb1e2090)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_407 : [#users=1] = placeholder[target=tensor_407]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_407,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0xb1e2090)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x8c78680)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x8c78680)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x8c78680)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_406 : [#users=1] = placeholder[target=tensor_406]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_406,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x8c78680)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0x120fc8b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0x120fc8b0)
tracing opcode LOAD_METHOD None pc=56 frame=9(0x120fc8b0)
tracing opcode LOAD_FAST None pc=58 frame=9(0x120fc8b0)
tracing opcode LOAD_FAST None pc=60 frame=9(0x120fc8b0)
tracing opcode CALL_METHOD None pc=62 frame=9(0x120fc8b0)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x10e79b20)
push tracker due to record
push tracker 20 frame 0x10e79b20 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x10e79b20)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x10e79b20)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x10e79b20 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x10e79b20)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x10e79b20)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x10e79b20)
load fast: 23346415551824
tracing opcode LOAD_METHOD None pc=12 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=14 frame=20(0x10e79b20)
load fast: 23339746946880
tracing opcode CALL_METHOD None pc=16 frame=20(0x10e79b20)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x10e79b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x10e79b20)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=24 frame=20(0x10e79b20)
tracing opcode CALL_METHOD None pc=26 frame=20(0x10e79b20)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415551968
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339759837488
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_409 : [#users=0] = placeholder[target=tensor_409]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.0842, -0.0388,  0.3474,  ...,  0.2286,  0.1974,  0.6051],
         [-0.5019,  0.3863,  0.1100,  ..., -0.4449,  0.0716,  0.3865],
         [ 0.0409,  0.0636,  0.3113,  ..., -0.0802, -0.8617, -0.3964],
         ...,
         [-0.0687,  0.2782,  0.2519,  ..., -0.0044,  0.2943,  0.2008],
         [ 0.3036, -0.9629, -0.1988,  ...,  0.1426, -0.0542,  0.1786],
         [-0.5982,  0.0071, -0.0413,  ..., -0.1605,  0.5412,  0.2092]]]), modified_attrs={}, prev=None) 23339759910864 23339759837488
obj: tensor([[[ 0.0842, -0.0388,  0.3474,  ...,  0.2286,  0.1974,  0.6051],
         [-0.5019,  0.3863,  0.1100,  ..., -0.4449,  0.0716,  0.3865],
         [ 0.0409,  0.0636,  0.3113,  ..., -0.0802, -0.8617, -0.3964],
         ...,
         [-0.0687,  0.2782,  0.2519,  ..., -0.0044,  0.2943,  0.2008],
         [ 0.3036, -0.9629, -0.1988,  ...,  0.1426, -0.0542,  0.1786],
         [-0.5982,  0.0071, -0.0413,  ..., -0.1605,  0.5412,  0.2092]]]) 23339759837488
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.0842, -0.0388,  0.3474,  ...,  0.2286,  0.1974,  0.6051],
         [-0.5019,  0.3863,  0.1100,  ..., -0.4449,  0.0716,  0.3865],
         [ 0.0409,  0.0636,  0.3113,  ..., -0.0802, -0.8617, -0.3964],
         ...,
         [-0.0687,  0.2782,  0.2519,  ..., -0.0044,  0.2943,  0.2008],
         [ 0.3036, -0.9629, -0.1988,  ...,  0.1426, -0.0542,  0.1786],
         [-0.5982,  0.0071, -0.0413,  ..., -0.1605,  0.5412,  0.2092]]]), modified_attrs={}, prev=None) 23339759885328
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x10e79b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x10e79b20)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=34 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=36 frame=20(0x10e79b20)
load fast: 23339759793552
tracing opcode BINARY_ADD None pc=38 frame=20(0x10e79b20)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x10e79b20)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23339747005200
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a35545310>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a35545540>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415551920
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_411 : [#users=4] = placeholder[target=tensor_411]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_411,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_411, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_411, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_411, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a35545310>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x10e79b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x10e79b20)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x10e79b20)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_408 : [#users=1] = placeholder[target=tensor_408]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_408,), kwargs = {})
    %tensor_410 : [#users=1] = placeholder[target=tensor_410]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_410), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x10e79b20)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0x120fc8b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0x120fc8b0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0x120fc8b0)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0x120fc8b0)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0x120fc8b0)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_376 : [#users=2] = placeholder[target=tensor_376]
    %tensor_377 : [#users=1] = placeholder[target=tensor_377]
    %tensor_378 : [#users=1] = placeholder[target=tensor_378]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_376,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_378, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_387 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_387, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_377, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_399 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_399), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_376), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0x120fc8b0)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing opcode UNPACK_SEQUENCE None pc=104 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=106 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=108 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:455
tracing opcode LOAD_FAST None pc=110 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=112 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:456
tracing opcode LOAD_FAST None pc=114 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=116 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=118 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=120 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=122 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:458
tracing opcode LOAD_FAST None pc=124 frame=4(0x7de0fc0)
tracing opcode LOAD_ATTR None pc=126 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=128 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_FAST None pc=178 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:476
tracing opcode LOAD_FAST None pc=180 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:477
tracing opcode LOAD_FAST None pc=182 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:478
tracing opcode LOAD_FAST None pc=184 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:479
tracing opcode LOAD_FAST None pc=186 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:480
tracing opcode LOAD_FAST None pc=188 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:481
tracing opcode LOAD_DEREF None pc=190 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:475
tracing opcode LOAD_CONST None pc=192 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION_KW None pc=194 frame=4(0x7de0fc0)
run into user defined function DebertaLayer(
  (attention): DebertaAttention(
    (self): DisentangledSelfAttention(
      (in_proj): Linear(in_features=768, out_features=2304, bias=False)
      (pos_dropout): StableDropout()
      (pos_proj): Linear(in_features=768, out_features=768, bias=False)
      (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
      (dropout): StableDropout()
    )
    (output): DebertaSelfOutput(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (LayerNorm): DebertaLayerNorm()
      (dropout): StableDropout()
    )
  )
  (intermediate): DebertaIntermediate(
    (dense): Linear(in_features=768, out_features=3072, bias=True)
    (intermediate_act_fn): GELUActivation()
  )
  (output): DebertaOutput(
    (dense): Linear(in_features=3072, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 9 0x7de1420 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(2, 9) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(86, 86)  -> inst 43
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, attention) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(3, query_states) 
11: [33mLOAD_FAST[0m(4, relative_pos) 
12: [33mLOAD_FAST[0m(5, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, attention_output) 
16: [33mLOAD_FAST[0m(6, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, attention_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, attention_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(0, self) 
23: [33mLOAD_METHOD[0m(1, intermediate) 
24: [33mLOAD_FAST[0m(7, attention_output) 
25: [33mCALL_METHOD[0m(1, 1) 
26: [33mSTORE_FAST[0m(9, intermediate_output) 
27: [33mLOAD_FAST[0m(0, self) 
28: [33mLOAD_METHOD[0m(2, output) 
29: [33mLOAD_FAST[0m(9, intermediate_output) 
30: [33mLOAD_FAST[0m(7, attention_output) 
31: [33mCALL_METHOD[0m(2, 2) 
32: [33mSTORE_FAST[0m(10, layer_output) 
33: [33mLOAD_FAST[0m(6, output_attentions) 
34: [33mPOP_JUMP_IF_FALSE[0m(78, 78)  -> inst 39
35: [33mLOAD_FAST[0m(10, layer_output) 
36: [33mLOAD_FAST[0m(8, att_matrix) 
37: [33mBUILD_TUPLE[0m(2, 2) 
38: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
39: [33mLOAD_FAST[0m(10, layer_output) 
40: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
41: [33mLOAD_CONST[0m(1, None) 
42: [32mJUMP_ABSOLUTE[0m(114, 114)  -> inst 57
43: [32mLOAD_GLOBAL[0m(6, guard_match) 
44: [32mLOAD_CONST[0m(2, 9) 
45: [32mLOAD_CONST[0m(3, 0) 
46: [32mLOAD_GLOBAL[0m(7, locals) 
47: [32mCALL_FUNCTION[0m(0, 0) 
48: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
49: [32mUNPACK_SEQUENCE[0m(2, 2) 
50: [32mSTORE_FAST[0m(12, __case_idx) 
51: [32mSTORE_FAST[0m(11, __graph_fn) 
52: [32mLOAD_GLOBAL[0m(4, enable_trace) 
53: [32mLOAD_CONST[0m(2, 9) 
54: [32mCALL_FUNCTION[0m(1, 1) 
55: [32mPOP_TOP[0m(None, None) 
56: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
57: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:372
tracing opcode LOAD_GLOBAL None pc=0 frame=9(0x11c078f0)
push tracker due to record
push tracker 9 frame 0x11c078f0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=9(0x11c078f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=9(0x11c078f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9] frame_id 9
enable_trace
push tracker 9 frame 0x11c078f0 frame_id 9 read_stack False cf_info <class 'NoneType'> all [0, 4, 9]
tracing opcode POP_TOP None pc=110 frame=9(0x11c078f0)
restart: running injected code (f_lasti=110)
tracing opcode JUMP_ABSOLUTE None pc=112 frame=9(0x11c078f0)
restart: running injected code (f_lasti=112)
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_FAST None pc=10 frame=9(0x11c078f0)
load fast: 23346415552016
tracing opcode LOAD_ATTR None pc=12 frame=9(0x11c078f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:382
tracing opcode LOAD_FAST None pc=14 frame=9(0x11c078f0)
load fast: 23339747007120
tracing line /home/drc/frontend/test/test_model_deberta.py:383
tracing opcode LOAD_FAST None pc=16 frame=9(0x11c078f0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:384
tracing opcode LOAD_FAST None pc=18 frame=9(0x11c078f0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:385
tracing opcode LOAD_FAST None pc=20 frame=9(0x11c078f0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:386
tracing opcode LOAD_FAST None pc=22 frame=9(0x11c078f0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:387
tracing opcode LOAD_FAST None pc=24 frame=9(0x11c078f0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:381
tracing opcode LOAD_CONST None pc=26 frame=9(0x11c078f0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=9(0x11c078f0)
run into user defined function DebertaAttention(
  (self): DisentangledSelfAttention(
    (in_proj): Linear(in_features=768, out_features=2304, bias=False)
    (pos_dropout): StableDropout()
    (pos_proj): Linear(in_features=768, out_features=768, bias=False)
    (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
    (dropout): StableDropout()
  )
  (output): DebertaSelfOutput(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (LayerNorm): DebertaLayerNorm()
    (dropout): StableDropout()
  )
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 10 0x84cda10 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(2, 10) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(88, 88)  -> inst 44
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, self) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mLOAD_FAST[0m(2, attention_mask) 
9: [33mLOAD_FAST[0m(3, output_attentions) 
10: [33mLOAD_FAST[0m(4, query_states) 
11: [33mLOAD_FAST[0m(5, relative_pos) 
12: [33mLOAD_FAST[0m(6, rel_embeddings) 
13: [33mLOAD_CONST[0m(0, ('query_states', 'relative_pos', 'rel_embeddings')) 
14: [33mCALL_FUNCTION_KW[0m(6, 6) 
15: [33mSTORE_FAST[0m(7, self_output) 
16: [33mLOAD_FAST[0m(3, output_attentions) 
17: [33mPOP_JUMP_IF_FALSE[0m(44, 44)  -> inst 22
18: [33mLOAD_FAST[0m(7, self_output) 
19: [33mUNPACK_SEQUENCE[0m(2, 2) 
20: [33mSTORE_FAST[0m(7, self_output) 
21: [33mSTORE_FAST[0m(8, att_matrix) 
22: [33mLOAD_FAST[0m(4, query_states) 
23: [33mLOAD_CONST[0m(1, None) 
24: [33mIS_OP[0m(0, 0) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(1, hidden_states) 
27: [33mSTORE_FAST[0m(4, query_states) 
28: [33mLOAD_FAST[0m(0, self) 
29: [33mLOAD_METHOD[0m(1, output) 
30: [33mLOAD_FAST[0m(7, self_output) 
31: [33mLOAD_FAST[0m(4, query_states) 
32: [33mCALL_METHOD[0m(2, 2) 
33: [33mSTORE_FAST[0m(9, attention_output) 
34: [33mLOAD_FAST[0m(3, output_attentions) 
35: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
36: [33mLOAD_FAST[0m(9, attention_output) 
37: [33mLOAD_FAST[0m(8, att_matrix) 
38: [33mBUILD_TUPLE[0m(2, 2) 
39: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
40: [33mLOAD_FAST[0m(9, attention_output) 
41: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
42: [33mLOAD_CONST[0m(1, None) 
43: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
44: [32mLOAD_GLOBAL[0m(5, guard_match) 
45: [32mLOAD_CONST[0m(2, 10) 
46: [32mLOAD_CONST[0m(3, 0) 
47: [32mLOAD_GLOBAL[0m(6, locals) 
48: [32mCALL_FUNCTION[0m(0, 0) 
49: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
50: [32mUNPACK_SEQUENCE[0m(2, 2) 
51: [32mSTORE_FAST[0m(11, __case_idx) 
52: [32mSTORE_FAST[0m(10, __graph_fn) 
53: [32mLOAD_GLOBAL[0m(3, enable_trace) 
54: [32mLOAD_CONST[0m(2, 10) 
55: [32mCALL_FUNCTION[0m(1, 1) 
56: [32mPOP_TOP[0m(None, None) 
57: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
58: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:305
tracing opcode LOAD_GLOBAL None pc=0 frame=10(0x8c422e0)
push tracker due to record
push tracker 10 frame 0x8c422e0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=10(0x8c422e0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=10(0x8c422e0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10] frame_id 10
enable_trace
push tracker 10 frame 0x8c422e0 frame_id 10 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10]
tracing opcode POP_TOP None pc=112 frame=10(0x8c422e0)
restart: running injected code (f_lasti=112)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=10(0x8c422e0)
restart: running injected code (f_lasti=114)
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_FAST None pc=10 frame=10(0x8c422e0)
load fast: 23346415552064
tracing opcode LOAD_ATTR None pc=12 frame=10(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:315
tracing opcode LOAD_FAST None pc=14 frame=10(0x8c422e0)
load fast: 23339747007120
tracing line /home/drc/frontend/test/test_model_deberta.py:316
tracing opcode LOAD_FAST None pc=16 frame=10(0x8c422e0)
load fast: 23346380226624
tracing line /home/drc/frontend/test/test_model_deberta.py:317
tracing opcode LOAD_FAST None pc=18 frame=10(0x8c422e0)
load fast: 23349571903936
tracing line /home/drc/frontend/test/test_model_deberta.py:318
tracing opcode LOAD_FAST None pc=20 frame=10(0x8c422e0)
load fast: 23349571986432
tracing line /home/drc/frontend/test/test_model_deberta.py:319
tracing opcode LOAD_FAST None pc=22 frame=10(0x8c422e0)
load fast: 23346380646096
tracing line /home/drc/frontend/test/test_model_deberta.py:320
tracing opcode LOAD_FAST None pc=24 frame=10(0x8c422e0)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:314
tracing opcode LOAD_CONST None pc=26 frame=10(0x8c422e0)
tracing opcode CALL_FUNCTION_KW None pc=28 frame=10(0x8c422e0)
run into user defined function DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 11 0x84fecc0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(31, disable_trace) 
1: [32mLOAD_CONST[0m(17, 11) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(622, 622)  -> inst 311
6: [33mLOAD_FAST[0m(4, query_states) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(58, 58)  -> inst 29
10: [33mLOAD_DEREF[0m(4, self) 
11: [33mLOAD_METHOD[0m(0, in_proj) 
12: [33mLOAD_DEREF[0m(0, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(7, qp) 
15: [33mLOAD_DEREF[0m(4, self) 
16: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
17: [33mLOAD_FAST[0m(7, qp) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_ATTR[0m(2, chunk) 
20: [33mLOAD_CONST[0m(6, 3) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mLOAD_CONST[0m(7, ('dim',)) 
23: [33mCALL_FUNCTION_KW[0m(2, 2) 
24: [33mUNPACK_SEQUENCE[0m(3, 3) 
25: [33mSTORE_FAST[0m(8, query_layer) 
26: [33mSTORE_FAST[0m(9, key_layer) 
27: [33mSTORE_FAST[0m(10, value_layer) 
28: [33mJUMP_FORWARD[0m(164, 222)  -> inst 111
29: [33mLOAD_CONST[0m(12, <code object linear at 0x153c7df4fc90, file "/home/drc/frontend/test/test_model_deberta.py", line 641>) 
30: [33mLOAD_CONST[0m(9, DisentangledSelfAttention.forward.<locals>.linear) 
31: [33mMAKE_FUNCTION[0m(0, 0) 
32: [33mSTORE_DEREF[0m(1, linear) 
33: [33mLOAD_DEREF[0m(4, self) 
34: [33mLOAD_ATTR[0m(0, in_proj) 
35: [33mLOAD_ATTR[0m(3, weight) 
36: [33mLOAD_ATTR[0m(2, chunk) 
37: [33mLOAD_DEREF[0m(4, self) 
38: [33mLOAD_ATTR[0m(4, num_attention_heads) 
39: [33mLOAD_CONST[0m(6, 3) 
40: [33mBINARY_MULTIPLY[0m(None, None) 
41: [33mLOAD_CONST[0m(10, 0) 
42: [33mLOAD_CONST[0m(7, ('dim',)) 
43: [33mCALL_FUNCTION_KW[0m(2, 2) 
44: [33mSTORE_DEREF[0m(5, ws) 
45: [33mLOAD_CLOSURE[0m(4, self) 
46: [33mLOAD_CLOSURE[0m(5, ws) 
47: [33mBUILD_TUPLE[0m(2, 2) 
48: [33mLOAD_CONST[0m(4, <code object <listcomp> at 0x153c7df4fdf0, file "/home/drc/frontend/test/test_model_deberta.py", line 648>) 
49: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
50: [33mMAKE_FUNCTION[0m(8, 8) 
51: [33mLOAD_GLOBAL[0m(5, range) 
52: [33mLOAD_CONST[0m(6, 3) 
53: [33mCALL_FUNCTION[0m(1, 1) 
54: [33mGET_ITER[0m(None, None) 
55: [33mCALL_FUNCTION[0m(1, 1) 
56: [33mSTORE_DEREF[0m(3, qkvw) 
57: [33mLOAD_CONST[0m(8, None) 
58: [33mBUILD_LIST[0m(1, 1) 
59: [33mLOAD_CONST[0m(6, 3) 
60: [33mBINARY_MULTIPLY[0m(None, None) 
61: [33mSTORE_DEREF[0m(2, qkvb) 
62: [33mLOAD_DEREF[0m(1, linear) 
63: [33mLOAD_DEREF[0m(3, qkvw) 
64: [33mLOAD_CONST[0m(10, 0) 
65: [33mBINARY_SUBSCR[0m(None, None) 
66: [33mLOAD_DEREF[0m(2, qkvb) 
67: [33mLOAD_CONST[0m(10, 0) 
68: [33mBINARY_SUBSCR[0m(None, None) 
69: [33mLOAD_FAST[0m(4, query_states) 
70: [33mLOAD_ATTR[0m(6, to) 
71: [33mLOAD_DEREF[0m(3, qkvw) 
72: [33mLOAD_CONST[0m(10, 0) 
73: [33mBINARY_SUBSCR[0m(None, None) 
74: [33mLOAD_ATTR[0m(7, dtype) 
75: [33mLOAD_CONST[0m(3, ('dtype',)) 
76: [33mCALL_FUNCTION_KW[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(3, 3) 
78: [33mSTORE_FAST[0m(11, q) 
79: [33mLOAD_CLOSURE[0m(0, hidden_states) 
80: [33mLOAD_CLOSURE[0m(1, linear) 
81: [33mLOAD_CLOSURE[0m(2, qkvb) 
82: [33mLOAD_CLOSURE[0m(3, qkvw) 
83: [33mBUILD_TUPLE[0m(4, 4) 
84: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4fea0, file "/home/drc/frontend/test/test_model_deberta.py", line 652>) 
85: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
86: [33mMAKE_FUNCTION[0m(8, 8) 
87: [33mLOAD_GLOBAL[0m(5, range) 
88: [33mLOAD_CONST[0m(0, 1) 
89: [33mLOAD_CONST[0m(6, 3) 
90: [33mCALL_FUNCTION[0m(2, 2) 
91: [33mGET_ITER[0m(None, None) 
92: [33mCALL_FUNCTION[0m(1, 1) 
93: [33mUNPACK_SEQUENCE[0m(2, 2) 
94: [33mSTORE_FAST[0m(12, k) 
95: [33mSTORE_FAST[0m(13, v) 
96: [33mLOAD_CLOSURE[0m(4, self) 
97: [33mBUILD_TUPLE[0m(1, 1) 
98: [33mLOAD_CONST[0m(13, <code object <listcomp> at 0x153c7df4ff50, file "/home/drc/frontend/test/test_model_deberta.py", line 653>) 
99: [33mLOAD_CONST[0m(15, DisentangledSelfAttention.forward.<locals>.<listcomp>) 
100: [33mMAKE_FUNCTION[0m(8, 8) 
101: [33mLOAD_FAST[0m(11, q) 
102: [33mLOAD_FAST[0m(12, k) 
103: [33mLOAD_FAST[0m(13, v) 
104: [33mBUILD_TUPLE[0m(3, 3) 
105: [33mGET_ITER[0m(None, None) 
106: [33mCALL_FUNCTION[0m(1, 1) 
107: [33mUNPACK_SEQUENCE[0m(3, 3) 
108: [33mSTORE_FAST[0m(8, query_layer) 
109: [33mSTORE_FAST[0m(9, key_layer) 
110: [33mSTORE_FAST[0m(10, value_layer) 
111: [33mLOAD_FAST[0m(8, query_layer) 
112: [33mLOAD_DEREF[0m(4, self) 
113: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
114: [33mLOAD_DEREF[0m(4, self) 
115: [33mLOAD_ATTR[0m(8, q_bias) 
116: [33mLOAD_CONST[0m(8, None) 
117: [33mLOAD_CONST[0m(8, None) 
118: [33mLOAD_CONST[0m(8, None) 
119: [33mLOAD_CONST[0m(8, None) 
120: [33mBUILD_SLICE[0m(2, 2) 
121: [33mBUILD_TUPLE[0m(3, 3) 
122: [33mBINARY_SUBSCR[0m(None, None) 
123: [33mCALL_METHOD[0m(1, 1) 
124: [33mBINARY_ADD[0m(None, None) 
125: [33mSTORE_FAST[0m(8, query_layer) 
126: [33mLOAD_FAST[0m(10, value_layer) 
127: [33mLOAD_DEREF[0m(4, self) 
128: [33mLOAD_METHOD[0m(1, transpose_for_scores) 
129: [33mLOAD_DEREF[0m(4, self) 
130: [33mLOAD_ATTR[0m(9, v_bias) 
131: [33mLOAD_CONST[0m(8, None) 
132: [33mLOAD_CONST[0m(8, None) 
133: [33mLOAD_CONST[0m(8, None) 
134: [33mLOAD_CONST[0m(8, None) 
135: [33mBUILD_SLICE[0m(2, 2) 
136: [33mBUILD_TUPLE[0m(3, 3) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mCALL_METHOD[0m(1, 1) 
139: [33mBINARY_ADD[0m(None, None) 
140: [33mSTORE_FAST[0m(10, value_layer) 
141: [33mLOAD_CONST[0m(8, None) 
142: [33mSTORE_FAST[0m(14, rel_att) 
143: [33mLOAD_CONST[0m(0, 1) 
144: [33mLOAD_GLOBAL[0m(10, len) 
145: [33mLOAD_DEREF[0m(4, self) 
146: [33mLOAD_ATTR[0m(11, pos_att_type) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mBINARY_ADD[0m(None, None) 
149: [33mSTORE_FAST[0m(15, scale_factor) 
150: [33mLOAD_GLOBAL[0m(12, torch) 
151: [33mLOAD_METHOD[0m(13, sqrt) 
152: [33mLOAD_GLOBAL[0m(12, torch) 
153: [33mLOAD_ATTR[0m(14, tensor) 
154: [33mLOAD_FAST[0m(8, query_layer) 
155: [33mLOAD_METHOD[0m(15, size) 
156: [33mLOAD_CONST[0m(1, -1) 
157: [33mCALL_METHOD[0m(1, 1) 
158: [33mLOAD_GLOBAL[0m(12, torch) 
159: [33mLOAD_ATTR[0m(16, float) 
160: [33mLOAD_CONST[0m(3, ('dtype',)) 
161: [33mCALL_FUNCTION_KW[0m(2, 2) 
162: [33mLOAD_FAST[0m(15, scale_factor) 
163: [33mBINARY_MULTIPLY[0m(None, None) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(16, scale) 
166: [33mLOAD_FAST[0m(8, query_layer) 
167: [33mLOAD_FAST[0m(16, scale) 
168: [33mLOAD_ATTR[0m(6, to) 
169: [33mLOAD_FAST[0m(8, query_layer) 
170: [33mLOAD_ATTR[0m(7, dtype) 
171: [33mLOAD_CONST[0m(3, ('dtype',)) 
172: [33mCALL_FUNCTION_KW[0m(1, 1) 
173: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
174: [33mSTORE_FAST[0m(8, query_layer) 
175: [33mLOAD_GLOBAL[0m(12, torch) 
176: [33mLOAD_METHOD[0m(17, matmul) 
177: [33mLOAD_FAST[0m(8, query_layer) 
178: [33mLOAD_FAST[0m(9, key_layer) 
179: [33mLOAD_METHOD[0m(18, transpose) 
180: [33mLOAD_CONST[0m(1, -1) 
181: [33mLOAD_CONST[0m(5, -2) 
182: [33mCALL_METHOD[0m(2, 2) 
183: [33mCALL_METHOD[0m(2, 2) 
184: [33mSTORE_FAST[0m(17, attention_scores) 
185: [33mLOAD_DEREF[0m(4, self) 
186: [33mLOAD_ATTR[0m(19, relative_attention) 
187: [32mEXTENDED_ARG[0m(1, 1) 
188: [33mPOP_JUMP_IF_FALSE[0m(406, 406)  -> inst 203
189: [33mLOAD_DEREF[0m(4, self) 
190: [33mLOAD_METHOD[0m(20, pos_dropout) 
191: [33mLOAD_FAST[0m(6, rel_embeddings) 
192: [33mCALL_METHOD[0m(1, 1) 
193: [33mSTORE_FAST[0m(6, rel_embeddings) 
194: [33mLOAD_DEREF[0m(4, self) 
195: [33mLOAD_METHOD[0m(21, disentangled_att_bias) 
196: [33mLOAD_FAST[0m(8, query_layer) 
197: [33mLOAD_FAST[0m(9, key_layer) 
198: [33mLOAD_FAST[0m(5, relative_pos) 
199: [33mLOAD_FAST[0m(6, rel_embeddings) 
200: [33mLOAD_FAST[0m(15, scale_factor) 
201: [33mCALL_METHOD[0m(5, 5) 
202: [33mSTORE_FAST[0m(14, rel_att) 
203: [33mLOAD_FAST[0m(14, rel_att) 
204: [33mLOAD_CONST[0m(8, None) 
205: [33mIS_OP[0m(1, 1) 
206: [32mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
208: [33mLOAD_FAST[0m(17, attention_scores) 
209: [33mLOAD_FAST[0m(14, rel_att) 
210: [33mBINARY_ADD[0m(None, None) 
211: [33mSTORE_FAST[0m(17, attention_scores) 
212: [33mLOAD_DEREF[0m(4, self) 
213: [33mLOAD_ATTR[0m(22, talking_head) 
214: [32mEXTENDED_ARG[0m(1, 1) 
215: [33mPOP_JUMP_IF_FALSE[0m(466, 466)  -> inst 233
216: [33mLOAD_DEREF[0m(4, self) 
217: [33mLOAD_METHOD[0m(23, head_logits_proj) 
218: [33mLOAD_FAST[0m(17, attention_scores) 
219: [33mLOAD_METHOD[0m(24, permute) 
220: [33mLOAD_CONST[0m(10, 0) 
221: [33mLOAD_CONST[0m(14, 2) 
222: [33mLOAD_CONST[0m(6, 3) 
223: [33mLOAD_CONST[0m(0, 1) 
224: [33mCALL_METHOD[0m(4, 4) 
225: [33mCALL_METHOD[0m(1, 1) 
226: [33mLOAD_METHOD[0m(24, permute) 
227: [33mLOAD_CONST[0m(10, 0) 
228: [33mLOAD_CONST[0m(6, 3) 
229: [33mLOAD_CONST[0m(0, 1) 
230: [33mLOAD_CONST[0m(14, 2) 
231: [33mCALL_METHOD[0m(4, 4) 
232: [33mSTORE_FAST[0m(17, attention_scores) 
233: [33mLOAD_GLOBAL[0m(25, XSoftmax) 
234: [33mLOAD_METHOD[0m(26, apply) 
235: [33mLOAD_FAST[0m(17, attention_scores) 
236: [33mLOAD_FAST[0m(2, attention_mask) 
237: [33mLOAD_CONST[0m(1, -1) 
238: [33mCALL_METHOD[0m(3, 3) 
239: [33mSTORE_FAST[0m(18, attention_probs) 
240: [33mLOAD_DEREF[0m(4, self) 
241: [33mLOAD_METHOD[0m(27, dropout) 
242: [33mLOAD_FAST[0m(18, attention_probs) 
243: [33mCALL_METHOD[0m(1, 1) 
244: [33mSTORE_FAST[0m(18, attention_probs) 
245: [33mLOAD_DEREF[0m(4, self) 
246: [33mLOAD_ATTR[0m(22, talking_head) 
247: [32mEXTENDED_ARG[0m(2, 2) 
248: [33mPOP_JUMP_IF_FALSE[0m(532, 532)  -> inst 266
249: [33mLOAD_DEREF[0m(4, self) 
250: [33mLOAD_METHOD[0m(28, head_weights_proj) 
251: [33mLOAD_FAST[0m(18, attention_probs) 
252: [33mLOAD_METHOD[0m(24, permute) 
253: [33mLOAD_CONST[0m(10, 0) 
254: [33mLOAD_CONST[0m(14, 2) 
255: [33mLOAD_CONST[0m(6, 3) 
256: [33mLOAD_CONST[0m(0, 1) 
257: [33mCALL_METHOD[0m(4, 4) 
258: [33mCALL_METHOD[0m(1, 1) 
259: [33mLOAD_METHOD[0m(24, permute) 
260: [33mLOAD_CONST[0m(10, 0) 
261: [33mLOAD_CONST[0m(6, 3) 
262: [33mLOAD_CONST[0m(0, 1) 
263: [33mLOAD_CONST[0m(14, 2) 
264: [33mCALL_METHOD[0m(4, 4) 
265: [33mSTORE_FAST[0m(18, attention_probs) 
266: [33mLOAD_GLOBAL[0m(12, torch) 
267: [33mLOAD_METHOD[0m(17, matmul) 
268: [33mLOAD_FAST[0m(18, attention_probs) 
269: [33mLOAD_FAST[0m(10, value_layer) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(19, context_layer) 
272: [33mLOAD_FAST[0m(19, context_layer) 
273: [33mLOAD_METHOD[0m(24, permute) 
274: [33mLOAD_CONST[0m(10, 0) 
275: [33mLOAD_CONST[0m(14, 2) 
276: [33mLOAD_CONST[0m(0, 1) 
277: [33mLOAD_CONST[0m(6, 3) 
278: [33mCALL_METHOD[0m(4, 4) 
279: [33mLOAD_METHOD[0m(29, contiguous) 
280: [33mCALL_METHOD[0m(0, 0) 
281: [33mSTORE_FAST[0m(19, context_layer) 
282: [33mLOAD_FAST[0m(19, context_layer) 
283: [33mLOAD_METHOD[0m(15, size) 
284: [33mCALL_METHOD[0m(0, 0) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mLOAD_CONST[0m(5, -2) 
287: [33mBUILD_SLICE[0m(2, 2) 
288: [33mBINARY_SUBSCR[0m(None, None) 
289: [33mLOAD_CONST[0m(11, (-1,)) 
290: [33mBINARY_ADD[0m(None, None) 
291: [33mSTORE_FAST[0m(20, new_context_layer_shape) 
292: [33mLOAD_FAST[0m(19, context_layer) 
293: [33mLOAD_METHOD[0m(30, view) 
294: [33mLOAD_FAST[0m(20, new_context_layer_shape) 
295: [33mCALL_METHOD[0m(1, 1) 
296: [33mSTORE_FAST[0m(19, context_layer) 
297: [33mLOAD_FAST[0m(3, output_attentions) 
298: [32mEXTENDED_ARG[0m(2, 2) 
299: [33mPOP_JUMP_IF_FALSE[0m(610, 610)  -> inst 305
300: [33mLOAD_FAST[0m(19, context_layer) 
301: [33mLOAD_FAST[0m(18, attention_probs) 
302: [33mBUILD_TUPLE[0m(2, 2) 
303: [32mEXTENDED_ARG[0m(2, 2) 
304: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
305: [33mLOAD_FAST[0m(19, context_layer) 
306: [32mEXTENDED_ARG[0m(2, 2) 
307: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
308: [33mLOAD_CONST[0m(8, None) 
309: [32mEXTENDED_ARG[0m(2, 2) 
310: [32mJUMP_ABSOLUTE[0m(650, 650)  -> inst 325
311: [32mLOAD_GLOBAL[0m(34, guard_match) 
312: [32mLOAD_CONST[0m(17, 11) 
313: [32mLOAD_CONST[0m(10, 0) 
314: [32mLOAD_GLOBAL[0m(35, locals) 
315: [32mCALL_FUNCTION[0m(0, 0) 
316: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
317: [32mUNPACK_SEQUENCE[0m(2, 2) 
318: [32mSTORE_FAST[0m(22, __case_idx) 
319: [32mSTORE_FAST[0m(21, __graph_fn) 
320: [32mLOAD_GLOBAL[0m(32, enable_trace) 
321: [32mLOAD_CONST[0m(17, 11) 
322: [32mCALL_FUNCTION[0m(1, 1) 
323: [32mPOP_TOP[0m(None, None) 
324: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
325: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:598
tracing opcode LOAD_GLOBAL None pc=0 frame=11(0x11c0ac70)
push tracker due to record
push tracker 11 frame 0x11c0ac70 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=11(0x11c0ac70)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=11(0x11c0ac70)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
enable_trace
push tracker 11 frame 0x11c0ac70 frame_id 11 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11]
tracing opcode POP_TOP None pc=646 frame=11(0x11c0ac70)
restart: running injected code (f_lasti=646)
tracing opcode JUMP_ABSOLUTE None pc=648 frame=11(0x11c0ac70)
restart: running injected code (f_lasti=648)
tracing line /home/drc/frontend/test/test_model_deberta.py:636
tracing opcode LOAD_FAST None pc=12 frame=11(0x11c0ac70)
load fast: 23349571986432
tracing opcode LOAD_CONST None pc=14 frame=11(0x11c0ac70)
tracing opcode IS_OP None pc=16 frame=11(0x11c0ac70)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:637
tracing opcode LOAD_DEREF None pc=20 frame=11(0x11c0ac70)
load fast: 23346415552112
tracing opcode LOAD_METHOD None pc=22 frame=11(0x11c0ac70)
tracing opcode LOAD_DEREF None pc=24 frame=11(0x11c0ac70)
load fast: 23339747007120
tracing opcode CALL_METHOD None pc=26 frame=11(0x11c0ac70)
record function in graph Linear(in_features=768, out_features=2304, bias=False)
tracing opcode STORE_FAST None pc=28 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:638
tracing opcode LOAD_DEREF None pc=30 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=32 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=34 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=36 frame=11(0x11c0ac70)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339747168144
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415552112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 256, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_419 : [#users=1] = placeholder[target=tensor_419]
    %view : [#users=1] = call_method[target=view](args = (%tensor_419, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_ATTR None pc=38 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=40 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=42 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=44 frame=11(0x11c0ac70)
tracing opcode CALL_FUNCTION_KW None pc=46 frame=11(0x11c0ac70)
record function in graph <built-in method chunk of Tensor object at 0x153a34f0aef0>
tracing opcode UNPACK_SEQUENCE None pc=48 frame=11(0x11c0ac70)
tracing opcode STORE_FAST None pc=50 frame=11(0x11c0ac70)
tracing opcode STORE_FAST None pc=52 frame=11(0x11c0ac70)
tracing opcode STORE_FAST None pc=54 frame=11(0x11c0ac70)
tracing opcode JUMP_FORWARD None pc=56 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:655
tracing opcode LOAD_FAST None pc=222 frame=11(0x11c0ac70)
tracing opcode LOAD_DEREF None pc=224 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=226 frame=11(0x11c0ac70)
tracing opcode LOAD_DEREF None pc=228 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=230 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=232 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=234 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=236 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=238 frame=11(0x11c0ac70)
tracing opcode BUILD_SLICE None pc=240 frame=11(0x11c0ac70)
tracing opcode BUILD_TUPLE None pc=242 frame=11(0x11c0ac70)
tracing opcode BINARY_SUBSCR None pc=244 frame=11(0x11c0ac70)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=246 frame=11(0x11c0ac70)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339740477856
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415552112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_420 : [#users=1] = placeholder[target=tensor_420]
    %view : [#users=1] = call_method[target=view](args = (%tensor_420, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=248 frame=11(0x11c0ac70)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=250 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:656
tracing opcode LOAD_FAST None pc=252 frame=11(0x11c0ac70)
tracing opcode LOAD_DEREF None pc=254 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=256 frame=11(0x11c0ac70)
tracing opcode LOAD_DEREF None pc=258 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=260 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=262 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=264 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=266 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=268 frame=11(0x11c0ac70)
tracing opcode BUILD_SLICE None pc=270 frame=11(0x11c0ac70)
tracing opcode BUILD_TUPLE None pc=272 frame=11(0x11c0ac70)
tracing opcode BINARY_SUBSCR None pc=274 frame=11(0x11c0ac70)
record function in graph <built-in function getitem>
tracing opcode CALL_METHOD None pc=276 frame=11(0x11c0ac70)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339740585792
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415552112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 1, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_421 : [#users=1] = placeholder[target=tensor_421]
    %view : [#users=1] = call_method[target=view](args = (%tensor_421, [1, 1, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 11
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode BINARY_ADD None pc=278 frame=11(0x11c0ac70)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=280 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:658
tracing opcode LOAD_CONST None pc=282 frame=11(0x11c0ac70)
tracing opcode STORE_FAST None pc=284 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:660
tracing opcode LOAD_CONST None pc=286 frame=11(0x11c0ac70)
tracing opcode LOAD_GLOBAL None pc=288 frame=11(0x11c0ac70)
tracing opcode LOAD_DEREF None pc=290 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=292 frame=11(0x11c0ac70)
tracing opcode CALL_FUNCTION None pc=294 frame=11(0x11c0ac70)
tracing opcode BINARY_ADD None pc=296 frame=11(0x11c0ac70)
tracing opcode STORE_FAST None pc=298 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:661
tracing opcode LOAD_GLOBAL None pc=300 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=302 frame=11(0x11c0ac70)
tracing opcode LOAD_GLOBAL None pc=304 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=306 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=308 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=310 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=312 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=314 frame=11(0x11c0ac70)
fetch:  -1 <class 'int'>
tracing opcode LOAD_GLOBAL None pc=316 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=318 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=320 frame=11(0x11c0ac70)
tracing opcode CALL_FUNCTION_KW None pc=322 frame=11(0x11c0ac70)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=324 frame=11(0x11c0ac70)
tracing opcode BINARY_MULTIPLY None pc=326 frame=11(0x11c0ac70)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=328 frame=11(0x11c0ac70)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=330 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:662
tracing opcode LOAD_FAST None pc=332 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=334 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=336 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=338 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=340 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=342 frame=11(0x11c0ac70)
tracing opcode CALL_FUNCTION_KW None pc=344 frame=11(0x11c0ac70)
record function in graph <built-in method to of Tensor object at 0x153a34f041d0>
tracing opcode BINARY_TRUE_DIVIDE None pc=346 frame=11(0x11c0ac70)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=348 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:663
tracing opcode LOAD_GLOBAL None pc=350 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=352 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=354 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=356 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=358 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=360 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=362 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=364 frame=11(0x11c0ac70)
fetch:  -2 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=366 frame=11(0x11c0ac70)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=368 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:664
tracing opcode LOAD_DEREF None pc=370 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=372 frame=11(0x11c0ac70)
tracing opcode EXTENDED_ARG None pc=374 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:665
tracing opcode LOAD_DEREF None pc=378 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=380 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=382 frame=11(0x11c0ac70)
load fast: 23346415211440
tracing opcode CALL_METHOD None pc=384 frame=11(0x11c0ac70)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415552208
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23346415211440
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
to merge frameid 3 11
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=386 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:666
tracing opcode LOAD_DEREF None pc=388 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=390 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=392 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=394 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=396 frame=11(0x11c0ac70)
load fast: 23346380646096
tracing opcode LOAD_FAST None pc=398 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=400 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=402 frame=11(0x11c0ac70)
fetch:  3 <class 'int'>
run into user defined function <bound method DisentangledSelfAttention.disentangled_att_bias of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 13 0x84d8040 disentangled_att_bias
old bytecode: 

0: [32mLOAD_GLOBAL[0m(27, disable_trace) 
1: [32mLOAD_CONST[0m(13, 13) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mEXTENDED_ARG[0m(2, 2) 
5: [32mJUMP_ABSOLUTE[0m(638, 638)  -> inst 319
6: [33mLOAD_FAST[0m(3, relative_pos) 
7: [33mLOAD_CONST[0m(8, None) 
8: [33mIS_OP[0m(0, 0) 
9: [33mPOP_JUMP_IF_FALSE[0m(50, 50)  -> inst 25
10: [33mLOAD_FAST[0m(1, query_layer) 
11: [33mLOAD_METHOD[0m(0, size) 
12: [33mLOAD_CONST[0m(1, -2) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(6, q) 
15: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
16: [33mLOAD_FAST[0m(6, q) 
17: [33mLOAD_FAST[0m(2, key_layer) 
18: [33mLOAD_METHOD[0m(0, size) 
19: [33mLOAD_CONST[0m(1, -2) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mLOAD_FAST[0m(1, query_layer) 
22: [33mLOAD_ATTR[0m(2, device) 
23: [33mCALL_FUNCTION[0m(3, 3) 
24: [33mSTORE_FAST[0m(3, relative_pos) 
25: [33mLOAD_FAST[0m(3, relative_pos) 
26: [33mLOAD_METHOD[0m(3, dim) 
27: [33mCALL_METHOD[0m(0, 0) 
28: [33mLOAD_CONST[0m(10, 2) 
29: [33mCOMPARE_OP[0m(2, ==) 
30: [33mPOP_JUMP_IF_FALSE[0m(80, 80)  -> inst 40
31: [33mLOAD_FAST[0m(3, relative_pos) 
32: [33mLOAD_METHOD[0m(4, unsqueeze) 
33: [33mLOAD_CONST[0m(7, 0) 
34: [33mCALL_METHOD[0m(1, 1) 
35: [33mLOAD_METHOD[0m(4, unsqueeze) 
36: [33mLOAD_CONST[0m(7, 0) 
37: [33mCALL_METHOD[0m(1, 1) 
38: [33mSTORE_FAST[0m(3, relative_pos) 
39: [33mJUMP_FORWARD[0m(54, 134)  -> inst 67
40: [33mLOAD_FAST[0m(3, relative_pos) 
41: [33mLOAD_METHOD[0m(3, dim) 
42: [33mCALL_METHOD[0m(0, 0) 
43: [33mLOAD_CONST[0m(5, 3) 
44: [33mCOMPARE_OP[0m(2, ==) 
45: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
46: [33mLOAD_FAST[0m(3, relative_pos) 
47: [33mLOAD_METHOD[0m(4, unsqueeze) 
48: [33mLOAD_CONST[0m(0, 1) 
49: [33mCALL_METHOD[0m(1, 1) 
50: [33mSTORE_FAST[0m(3, relative_pos) 
51: [33mJUMP_FORWARD[0m(30, 134)  -> inst 67
52: [33mLOAD_FAST[0m(3, relative_pos) 
53: [33mLOAD_METHOD[0m(3, dim) 
54: [33mCALL_METHOD[0m(0, 0) 
55: [33mLOAD_CONST[0m(2, 4) 
56: [33mCOMPARE_OP[0m(3, !=) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_GLOBAL[0m(5, ValueError) 
59: [33mLOAD_CONST[0m(12, Relative position ids must be of dim 2 or 3 or 4. ) 
60: [33mLOAD_FAST[0m(3, relative_pos) 
61: [33mLOAD_METHOD[0m(3, dim) 
62: [33mCALL_METHOD[0m(0, 0) 
63: [33mFORMAT_VALUE[0m(0, (None, False)) 
64: [33mBUILD_STRING[0m(2, 2) 
65: [33mCALL_FUNCTION[0m(1, 1) 
66: [33mRAISE_VARARGS[0m(1, 1) 
67: [33mLOAD_GLOBAL[0m(6, min) 
68: [33mLOAD_GLOBAL[0m(7, max) 
69: [33mLOAD_FAST[0m(1, query_layer) 
70: [33mLOAD_METHOD[0m(0, size) 
71: [33mLOAD_CONST[0m(1, -2) 
72: [33mCALL_METHOD[0m(1, 1) 
73: [33mLOAD_FAST[0m(2, key_layer) 
74: [33mLOAD_METHOD[0m(0, size) 
75: [33mLOAD_CONST[0m(1, -2) 
76: [33mCALL_METHOD[0m(1, 1) 
77: [33mCALL_FUNCTION[0m(2, 2) 
78: [33mLOAD_FAST[0m(0, self) 
79: [33mLOAD_ATTR[0m(8, max_relative_positions) 
80: [33mCALL_FUNCTION[0m(2, 2) 
81: [33mSTORE_FAST[0m(7, att_span) 
82: [33mLOAD_FAST[0m(3, relative_pos) 
83: [33mLOAD_METHOD[0m(9, long) 
84: [33mCALL_METHOD[0m(0, 0) 
85: [33mLOAD_METHOD[0m(10, to) 
86: [33mLOAD_FAST[0m(1, query_layer) 
87: [33mLOAD_ATTR[0m(2, device) 
88: [33mCALL_METHOD[0m(1, 1) 
89: [33mSTORE_FAST[0m(3, relative_pos) 
90: [33mLOAD_FAST[0m(4, rel_embeddings) 
91: [33mLOAD_FAST[0m(0, self) 
92: [33mLOAD_ATTR[0m(8, max_relative_positions) 
93: [33mLOAD_FAST[0m(7, att_span) 
94: [33mBINARY_SUBTRACT[0m(None, None) 
95: [33mLOAD_FAST[0m(0, self) 
96: [33mLOAD_ATTR[0m(8, max_relative_positions) 
97: [33mLOAD_FAST[0m(7, att_span) 
98: [33mBINARY_ADD[0m(None, None) 
99: [33mBUILD_SLICE[0m(2, 2) 
100: [33mLOAD_CONST[0m(8, None) 
101: [33mLOAD_CONST[0m(8, None) 
102: [33mBUILD_SLICE[0m(2, 2) 
103: [33mBUILD_TUPLE[0m(2, 2) 
104: [33mBINARY_SUBSCR[0m(None, None) 
105: [33mLOAD_METHOD[0m(4, unsqueeze) 
106: [33mLOAD_CONST[0m(7, 0) 
107: [33mCALL_METHOD[0m(1, 1) 
108: [33mSTORE_FAST[0m(4, rel_embeddings) 
109: [33mLOAD_CONST[0m(7, 0) 
110: [33mSTORE_FAST[0m(8, score) 
111: [33mLOAD_CONST[0m(9, c2p) 
112: [33mLOAD_FAST[0m(0, self) 
113: [33mLOAD_ATTR[0m(11, pos_att_type) 
114: [33mCONTAINS_OP[0m(0, 0) 
115: [32mEXTENDED_ARG[0m(1, 1) 
116: [33mPOP_JUMP_IF_FALSE[0m(332, 332)  -> inst 166
117: [33mLOAD_FAST[0m(0, self) 
118: [33mLOAD_METHOD[0m(12, pos_proj) 
119: [33mLOAD_FAST[0m(4, rel_embeddings) 
120: [33mCALL_METHOD[0m(1, 1) 
121: [33mSTORE_FAST[0m(9, pos_key_layer) 
122: [33mLOAD_FAST[0m(0, self) 
123: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
124: [33mLOAD_FAST[0m(9, pos_key_layer) 
125: [33mCALL_METHOD[0m(1, 1) 
126: [33mSTORE_FAST[0m(9, pos_key_layer) 
127: [33mLOAD_GLOBAL[0m(14, torch) 
128: [33mLOAD_METHOD[0m(15, matmul) 
129: [33mLOAD_FAST[0m(1, query_layer) 
130: [33mLOAD_FAST[0m(9, pos_key_layer) 
131: [33mLOAD_METHOD[0m(16, transpose) 
132: [33mLOAD_CONST[0m(3, -1) 
133: [33mLOAD_CONST[0m(1, -2) 
134: [33mCALL_METHOD[0m(2, 2) 
135: [33mCALL_METHOD[0m(2, 2) 
136: [33mSTORE_FAST[0m(10, c2p_att) 
137: [33mLOAD_GLOBAL[0m(14, torch) 
138: [33mLOAD_METHOD[0m(17, clamp) 
139: [33mLOAD_FAST[0m(3, relative_pos) 
140: [33mLOAD_FAST[0m(7, att_span) 
141: [33mBINARY_ADD[0m(None, None) 
142: [33mLOAD_CONST[0m(7, 0) 
143: [33mLOAD_FAST[0m(7, att_span) 
144: [33mLOAD_CONST[0m(10, 2) 
145: [33mBINARY_MULTIPLY[0m(None, None) 
146: [33mLOAD_CONST[0m(0, 1) 
147: [33mBINARY_SUBTRACT[0m(None, None) 
148: [33mCALL_METHOD[0m(3, 3) 
149: [33mSTORE_FAST[0m(11, c2p_pos) 
150: [33mLOAD_GLOBAL[0m(14, torch) 
151: [33mLOAD_ATTR[0m(18, gather) 
152: [33mLOAD_FAST[0m(10, c2p_att) 
153: [33mLOAD_CONST[0m(3, -1) 
154: [33mLOAD_GLOBAL[0m(19, c2p_dynamic_expand) 
155: [33mLOAD_FAST[0m(11, c2p_pos) 
156: [33mLOAD_FAST[0m(1, query_layer) 
157: [33mLOAD_FAST[0m(3, relative_pos) 
158: [33mCALL_FUNCTION[0m(3, 3) 
159: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
160: [33mCALL_FUNCTION_KW[0m(3, 3) 
161: [33mSTORE_FAST[0m(10, c2p_att) 
162: [33mLOAD_FAST[0m(8, score) 
163: [33mLOAD_FAST[0m(10, c2p_att) 
164: [33mINPLACE_ADD[0m(None, None) 
165: [33mSTORE_FAST[0m(8, score) 
166: [33mLOAD_CONST[0m(11, p2c) 
167: [33mLOAD_FAST[0m(0, self) 
168: [33mLOAD_ATTR[0m(11, pos_att_type) 
169: [33mCONTAINS_OP[0m(0, 0) 
170: [32mEXTENDED_ARG[0m(2, 2) 
171: [33mPOP_JUMP_IF_FALSE[0m(632, 632)  -> inst 316
172: [33mLOAD_FAST[0m(0, self) 
173: [33mLOAD_METHOD[0m(20, pos_q_proj) 
174: [33mLOAD_FAST[0m(4, rel_embeddings) 
175: [33mCALL_METHOD[0m(1, 1) 
176: [33mSTORE_FAST[0m(12, pos_query_layer) 
177: [33mLOAD_FAST[0m(0, self) 
178: [33mLOAD_METHOD[0m(13, transpose_for_scores) 
179: [33mLOAD_FAST[0m(12, pos_query_layer) 
180: [33mCALL_METHOD[0m(1, 1) 
181: [33mSTORE_FAST[0m(12, pos_query_layer) 
182: [33mLOAD_FAST[0m(12, pos_query_layer) 
183: [33mLOAD_GLOBAL[0m(14, torch) 
184: [33mLOAD_METHOD[0m(21, sqrt) 
185: [33mLOAD_GLOBAL[0m(14, torch) 
186: [33mLOAD_ATTR[0m(22, tensor) 
187: [33mLOAD_FAST[0m(12, pos_query_layer) 
188: [33mLOAD_METHOD[0m(0, size) 
189: [33mLOAD_CONST[0m(3, -1) 
190: [33mCALL_METHOD[0m(1, 1) 
191: [33mLOAD_GLOBAL[0m(14, torch) 
192: [33mLOAD_ATTR[0m(23, float) 
193: [33mLOAD_CONST[0m(4, ('dtype',)) 
194: [33mCALL_FUNCTION_KW[0m(2, 2) 
195: [33mLOAD_FAST[0m(5, scale_factor) 
196: [33mBINARY_MULTIPLY[0m(None, None) 
197: [33mCALL_METHOD[0m(1, 1) 
198: [33mINPLACE_TRUE_DIVIDE[0m(None, None) 
199: [33mSTORE_FAST[0m(12, pos_query_layer) 
200: [33mLOAD_FAST[0m(1, query_layer) 
201: [33mLOAD_METHOD[0m(0, size) 
202: [33mLOAD_CONST[0m(1, -2) 
203: [33mCALL_METHOD[0m(1, 1) 
204: [33mLOAD_FAST[0m(2, key_layer) 
205: [33mLOAD_METHOD[0m(0, size) 
206: [33mLOAD_CONST[0m(1, -2) 
207: [33mCALL_METHOD[0m(1, 1) 
208: [33mCOMPARE_OP[0m(3, !=) 
209: [32mEXTENDED_ARG[0m(1, 1) 
210: [33mPOP_JUMP_IF_FALSE[0m(450, 450)  -> inst 225
211: [33mLOAD_GLOBAL[0m(1, build_relative_position) 
212: [33mLOAD_FAST[0m(2, key_layer) 
213: [33mLOAD_METHOD[0m(0, size) 
214: [33mLOAD_CONST[0m(1, -2) 
215: [33mCALL_METHOD[0m(1, 1) 
216: [33mLOAD_FAST[0m(2, key_layer) 
217: [33mLOAD_METHOD[0m(0, size) 
218: [33mLOAD_CONST[0m(1, -2) 
219: [33mCALL_METHOD[0m(1, 1) 
220: [33mLOAD_FAST[0m(1, query_layer) 
221: [33mLOAD_ATTR[0m(2, device) 
222: [33mCALL_FUNCTION[0m(3, 3) 
223: [33mSTORE_FAST[0m(13, r_pos) 
224: [33mJUMP_FORWARD[0m(4, 454)  -> inst 227
225: [33mLOAD_FAST[0m(3, relative_pos) 
226: [33mSTORE_FAST[0m(13, r_pos) 
227: [33mLOAD_GLOBAL[0m(14, torch) 
228: [33mLOAD_METHOD[0m(17, clamp) 
229: [33mLOAD_FAST[0m(13, r_pos) 
230: [33mUNARY_NEGATIVE[0m(None, None) 
231: [33mLOAD_FAST[0m(7, att_span) 
232: [33mBINARY_ADD[0m(None, None) 
233: [33mLOAD_CONST[0m(7, 0) 
234: [33mLOAD_FAST[0m(7, att_span) 
235: [33mLOAD_CONST[0m(10, 2) 
236: [33mBINARY_MULTIPLY[0m(None, None) 
237: [33mLOAD_CONST[0m(0, 1) 
238: [33mBINARY_SUBTRACT[0m(None, None) 
239: [33mCALL_METHOD[0m(3, 3) 
240: [33mSTORE_FAST[0m(14, p2c_pos) 
241: [33mLOAD_GLOBAL[0m(14, torch) 
242: [33mLOAD_METHOD[0m(15, matmul) 
243: [33mLOAD_FAST[0m(2, key_layer) 
244: [33mLOAD_FAST[0m(12, pos_query_layer) 
245: [33mLOAD_METHOD[0m(16, transpose) 
246: [33mLOAD_CONST[0m(3, -1) 
247: [33mLOAD_CONST[0m(1, -2) 
248: [33mCALL_METHOD[0m(2, 2) 
249: [33mLOAD_ATTR[0m(10, to) 
250: [33mLOAD_FAST[0m(2, key_layer) 
251: [33mLOAD_ATTR[0m(24, dtype) 
252: [33mLOAD_CONST[0m(4, ('dtype',)) 
253: [33mCALL_FUNCTION_KW[0m(1, 1) 
254: [33mCALL_METHOD[0m(2, 2) 
255: [33mSTORE_FAST[0m(15, p2c_att) 
256: [33mLOAD_GLOBAL[0m(14, torch) 
257: [33mLOAD_ATTR[0m(18, gather) 
258: [33mLOAD_FAST[0m(15, p2c_att) 
259: [33mLOAD_CONST[0m(3, -1) 
260: [33mLOAD_GLOBAL[0m(25, p2c_dynamic_expand) 
261: [33mLOAD_FAST[0m(14, p2c_pos) 
262: [33mLOAD_FAST[0m(1, query_layer) 
263: [33mLOAD_FAST[0m(2, key_layer) 
264: [33mCALL_FUNCTION[0m(3, 3) 
265: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
266: [33mCALL_FUNCTION_KW[0m(3, 3) 
267: [33mLOAD_METHOD[0m(16, transpose) 
268: [33mLOAD_CONST[0m(3, -1) 
269: [33mLOAD_CONST[0m(1, -2) 
270: [33mCALL_METHOD[0m(2, 2) 
271: [33mSTORE_FAST[0m(15, p2c_att) 
272: [33mLOAD_FAST[0m(1, query_layer) 
273: [33mLOAD_METHOD[0m(0, size) 
274: [33mLOAD_CONST[0m(1, -2) 
275: [33mCALL_METHOD[0m(1, 1) 
276: [33mLOAD_FAST[0m(2, key_layer) 
277: [33mLOAD_METHOD[0m(0, size) 
278: [33mLOAD_CONST[0m(1, -2) 
279: [33mCALL_METHOD[0m(1, 1) 
280: [33mCOMPARE_OP[0m(3, !=) 
281: [32mEXTENDED_ARG[0m(2, 2) 
282: [33mPOP_JUMP_IF_FALSE[0m(624, 624)  -> inst 312
283: [33mLOAD_FAST[0m(3, relative_pos) 
284: [33mLOAD_CONST[0m(8, None) 
285: [33mLOAD_CONST[0m(8, None) 
286: [33mBUILD_SLICE[0m(2, 2) 
287: [33mLOAD_CONST[0m(8, None) 
288: [33mLOAD_CONST[0m(8, None) 
289: [33mBUILD_SLICE[0m(2, 2) 
290: [33mLOAD_CONST[0m(8, None) 
291: [33mLOAD_CONST[0m(8, None) 
292: [33mBUILD_SLICE[0m(2, 2) 
293: [33mLOAD_CONST[0m(7, 0) 
294: [33mBUILD_TUPLE[0m(4, 4) 
295: [33mBINARY_SUBSCR[0m(None, None) 
296: [33mLOAD_METHOD[0m(4, unsqueeze) 
297: [33mLOAD_CONST[0m(3, -1) 
298: [33mCALL_METHOD[0m(1, 1) 
299: [33mSTORE_FAST[0m(16, pos_index) 
300: [33mLOAD_GLOBAL[0m(14, torch) 
301: [33mLOAD_ATTR[0m(18, gather) 
302: [33mLOAD_FAST[0m(15, p2c_att) 
303: [33mLOAD_CONST[0m(1, -2) 
304: [33mLOAD_GLOBAL[0m(26, pos_dynamic_expand) 
305: [33mLOAD_FAST[0m(16, pos_index) 
306: [33mLOAD_FAST[0m(15, p2c_att) 
307: [33mLOAD_FAST[0m(2, key_layer) 
308: [33mCALL_FUNCTION[0m(3, 3) 
309: [33mLOAD_CONST[0m(6, ('dim', 'index')) 
310: [33mCALL_FUNCTION_KW[0m(3, 3) 
311: [33mSTORE_FAST[0m(15, p2c_att) 
312: [33mLOAD_FAST[0m(8, score) 
313: [33mLOAD_FAST[0m(15, p2c_att) 
314: [33mINPLACE_ADD[0m(None, None) 
315: [33mSTORE_FAST[0m(8, score) 
316: [33mLOAD_FAST[0m(8, score) 
317: [32mEXTENDED_ARG[0m(2, 2) 
318: [32mJUMP_ABSOLUTE[0m(666, 666)  -> inst 333
319: [32mLOAD_GLOBAL[0m(30, guard_match) 
320: [32mLOAD_CONST[0m(13, 13) 
321: [32mLOAD_CONST[0m(7, 0) 
322: [32mLOAD_GLOBAL[0m(31, locals) 
323: [32mCALL_FUNCTION[0m(0, 0) 
324: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
325: [32mUNPACK_SEQUENCE[0m(2, 2) 
326: [32mSTORE_FAST[0m(18, __case_idx) 
327: [32mSTORE_FAST[0m(17, __graph_fn) 
328: [32mLOAD_GLOBAL[0m(28, enable_trace) 
329: [32mLOAD_CONST[0m(13, 13) 
330: [32mCALL_FUNCTION[0m(1, 1) 
331: [32mPOP_TOP[0m(None, None) 
332: [32mJUMP_ABSOLUTE[0m(12, 12)  -> inst 6
333: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:690
tracing opcode LOAD_GLOBAL None pc=0 frame=13(0xd6d7f60)
push tracker due to record
push tracker 13 frame 0xd6d7f60 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=13(0xd6d7f60)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=13(0xd6d7f60)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
enable_trace
push tracker 13 frame 0xd6d7f60 frame_id 13 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13]
tracing opcode POP_TOP None pc=662 frame=13(0xd6d7f60)
restart: running injected code (f_lasti=662)
tracing opcode JUMP_ABSOLUTE None pc=664 frame=13(0xd6d7f60)
restart: running injected code (f_lasti=664)
tracing line /home/drc/frontend/test/test_model_deberta.py:691
tracing opcode LOAD_FAST None pc=12 frame=13(0xd6d7f60)
load fast: 23346380646096
tracing opcode LOAD_CONST None pc=14 frame=13(0xd6d7f60)
tracing opcode IS_OP None pc=16 frame=13(0xd6d7f60)
tracing opcode POP_JUMP_IF_FALSE None pc=18 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:694
tracing opcode LOAD_FAST None pc=50 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=52 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=54 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=56 frame=13(0xd6d7f60)
tracing opcode COMPARE_OP None pc=58 frame=13(0xd6d7f60)
tracing opcode POP_JUMP_IF_FALSE None pc=60 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:696
tracing opcode LOAD_FAST None pc=80 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=82 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=84 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=86 frame=13(0xd6d7f60)
tracing opcode COMPARE_OP None pc=88 frame=13(0xd6d7f60)
tracing opcode POP_JUMP_IF_FALSE None pc=90 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:697
tracing opcode LOAD_FAST None pc=92 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=94 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=96 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=98 frame=13(0xd6d7f60)
fetch:  1 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=100 frame=13(0xd6d7f60)
tracing opcode JUMP_FORWARD None pc=102 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:702
tracing opcode LOAD_GLOBAL None pc=134 frame=13(0xd6d7f60)
tracing opcode LOAD_GLOBAL None pc=136 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=138 frame=13(0xd6d7f60)
load fast: 23339740478176
tracing opcode LOAD_METHOD None pc=140 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=142 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=144 frame=13(0xd6d7f60)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=146 frame=13(0xd6d7f60)
load fast: 23339740582512
tracing opcode LOAD_METHOD None pc=148 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=150 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=152 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION None pc=154 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=156 frame=13(0xd6d7f60)
load fast: 23346415552112
tracing opcode LOAD_ATTR None pc=158 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION None pc=160 frame=13(0xd6d7f60)
tracing opcode STORE_FAST None pc=162 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:703
tracing opcode LOAD_FAST None pc=164 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=166 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=168 frame=13(0xd6d7f60)
record function in graph <method 'long' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=170 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=172 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=174 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=176 frame=13(0xd6d7f60)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=178 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode LOAD_FAST None pc=180 frame=13(0xd6d7f60)
load fast: 23346415211440
tracing line /home/drc/frontend/test/test_model_deberta.py:705
tracing opcode LOAD_FAST None pc=182 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=184 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=186 frame=13(0xd6d7f60)
tracing opcode BINARY_SUBTRACT None pc=188 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=190 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=192 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=194 frame=13(0xd6d7f60)
tracing opcode BINARY_ADD None pc=196 frame=13(0xd6d7f60)
tracing opcode BUILD_SLICE None pc=198 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=200 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=202 frame=13(0xd6d7f60)
tracing opcode BUILD_SLICE None pc=204 frame=13(0xd6d7f60)
tracing opcode BUILD_TUPLE None pc=206 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode BINARY_SUBSCR None pc=208 frame=13(0xd6d7f60)
record function in graph <built-in function getitem>
tracing opcode LOAD_METHOD None pc=210 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:706
tracing opcode LOAD_CONST None pc=212 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:704
tracing opcode CALL_METHOD None pc=214 frame=13(0xd6d7f60)
fetch:  0 <class 'int'>
record function in graph <method 'unsqueeze' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=216 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:708
tracing opcode LOAD_CONST None pc=218 frame=13(0xd6d7f60)
tracing opcode STORE_FAST None pc=220 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:711
tracing opcode LOAD_CONST None pc=222 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=224 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=226 frame=13(0xd6d7f60)
tracing opcode CONTAINS_OP None pc=228 frame=13(0xd6d7f60)
tracing opcode EXTENDED_ARG None pc=230 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:712
tracing opcode LOAD_FAST None pc=234 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=236 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=238 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=240 frame=13(0xd6d7f60)
record function in graph Linear(in_features=768, out_features=768, bias=False)
tracing opcode STORE_FAST None pc=242 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:713
tracing opcode LOAD_FAST None pc=244 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=246 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=248 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=250 frame=13(0xd6d7f60)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339737774096
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415552112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_426 : [#users=1] = placeholder[target=tensor_426]
    %view : [#users=1] = call_method[target=view](args = (%tensor_426, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=252 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:714
tracing opcode LOAD_GLOBAL None pc=254 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=256 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=258 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=260 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=262 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=264 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=266 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=268 frame=13(0xd6d7f60)
fetch:  -1 <class 'int'>
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode CALL_METHOD None pc=270 frame=13(0xd6d7f60)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=272 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:715
tracing opcode LOAD_GLOBAL None pc=274 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=276 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=278 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=280 frame=13(0xd6d7f60)
tracing opcode BINARY_ADD None pc=282 frame=13(0xd6d7f60)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=284 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=286 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=288 frame=13(0xd6d7f60)
tracing opcode BINARY_MULTIPLY None pc=290 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=292 frame=13(0xd6d7f60)
tracing opcode BINARY_SUBTRACT None pc=294 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=296 frame=13(0xd6d7f60)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=298 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:716
tracing opcode LOAD_GLOBAL None pc=300 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=302 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=304 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=306 frame=13(0xd6d7f60)
tracing opcode LOAD_GLOBAL None pc=308 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=310 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=312 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=314 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION None pc=316 frame=13(0xd6d7f60)
run into user defined function <function c2p_dynamic_expand at 0x153bd10d7ee0>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 14 0x8597e70 c2p_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(5, 14) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(1, query_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(4, 2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, relative_pos) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -1) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(5, 14) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(5, 14) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_GLOBAL None pc=0 frame=14(0x84f1e10)
push tracker due to record
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=14(0x84f1e10)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=14(0x84f1e10)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
enable_trace
push tracker 14 frame 0x84f1e10 frame_id 14 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 14]
tracing opcode POP_TOP None pc=76 frame=14(0x84f1e10)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=14(0x84f1e10)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:533
tracing opcode LOAD_FAST None pc=10 frame=14(0x84f1e10)
load fast: 23339737965568
tracing opcode LOAD_METHOD None pc=12 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=14 frame=14(0x84f1e10)
load fast: 23339740478176
tracing opcode LOAD_METHOD None pc=16 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=18 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=20 frame=14(0x84f1e10)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=24 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=26 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=28 frame=14(0x84f1e10)
tracing opcode LOAD_FAST None pc=30 frame=14(0x84f1e10)
tracing opcode LOAD_METHOD None pc=32 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=34 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=36 frame=14(0x84f1e10)
fetch:  2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=14(0x84f1e10)
load fast: 23339740449824
tracing opcode LOAD_METHOD None pc=40 frame=14(0x84f1e10)
tracing opcode LOAD_CONST None pc=42 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=44 frame=14(0x84f1e10)
fetch:  -1 <class 'int'>
tracing opcode BUILD_LIST None pc=46 frame=14(0x84f1e10)
tracing opcode CALL_METHOD None pc=48 frame=14(0x84f1e10)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=14(0x84f1e10)
restart: running injected code (f_lasti=50)
commiting 14 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_427 : [#users=1] = placeholder[target=tensor_427]
    %tensor_428 : [#users=0] = placeholder[target=tensor_428]
    %tensor_429 : [#users=0] = placeholder[target=tensor_429]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_427, [1, 12, 256, 256]), kwargs = {})
to merge frameid 14 13
tracing opcode RETURN_VALUE None pc=80 frame=14(0x84f1e10)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 14] frame_id 14
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode LOAD_CONST None pc=318 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION_KW None pc=320 frame=13(0xd6d7f60)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=322 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:717
tracing opcode LOAD_FAST None pc=324 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=326 frame=13(0xd6d7f60)
tracing opcode INPLACE_ADD None pc=328 frame=13(0xd6d7f60)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=330 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:720
tracing opcode LOAD_CONST None pc=332 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=334 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=336 frame=13(0xd6d7f60)
tracing opcode CONTAINS_OP None pc=338 frame=13(0xd6d7f60)
tracing opcode EXTENDED_ARG None pc=340 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:721
tracing opcode LOAD_FAST None pc=344 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=346 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=348 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=350 frame=13(0xd6d7f60)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=352 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:722
tracing opcode LOAD_FAST None pc=354 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=356 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=358 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=360 frame=13(0xd6d7f60)
run into user defined function <bound method DisentangledSelfAttention.transpose_for_scores of DisentangledSelfAttention(
  (in_proj): Linear(in_features=768, out_features=2304, bias=False)
  (pos_dropout): StableDropout()
  (pos_proj): Linear(in_features=768, out_features=768, bias=False)
  (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)
  (dropout): StableDropout()
)>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 12 0x84e3d40 transpose_for_scores
old bytecode: 

0: [32mLOAD_GLOBAL[0m(4, disable_trace) 
1: [32mLOAD_CONST[0m(6, 12) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
5: [33mLOAD_FAST[0m(1, x) 
6: [33mLOAD_METHOD[0m(0, size) 
7: [33mCALL_METHOD[0m(0, 0) 
8: [33mLOAD_CONST[0m(4, None) 
9: [33mLOAD_CONST[0m(1, -1) 
10: [33mBUILD_SLICE[0m(2, 2) 
11: [33mBINARY_SUBSCR[0m(None, None) 
12: [33mLOAD_FAST[0m(0, self) 
13: [33mLOAD_ATTR[0m(1, num_attention_heads) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mBUILD_TUPLE[0m(2, 2) 
16: [33mBINARY_ADD[0m(None, None) 
17: [33mSTORE_FAST[0m(2, new_x_shape) 
18: [33mLOAD_FAST[0m(1, x) 
19: [33mLOAD_METHOD[0m(2, view) 
20: [33mLOAD_FAST[0m(2, new_x_shape) 
21: [33mCALL_METHOD[0m(1, 1) 
22: [33mSTORE_FAST[0m(1, x) 
23: [33mLOAD_FAST[0m(1, x) 
24: [33mLOAD_METHOD[0m(3, permute) 
25: [33mLOAD_CONST[0m(3, 0) 
26: [33mLOAD_CONST[0m(5, 2) 
27: [33mLOAD_CONST[0m(0, 1) 
28: [33mLOAD_CONST[0m(2, 3) 
29: [33mCALL_METHOD[0m(4, 4) 
30: [32mJUMP_ABSOLUTE[0m(90, 90)  -> inst 45
31: [32mLOAD_GLOBAL[0m(7, guard_match) 
32: [32mLOAD_CONST[0m(6, 12) 
33: [32mLOAD_CONST[0m(3, 0) 
34: [32mLOAD_GLOBAL[0m(8, locals) 
35: [32mCALL_FUNCTION[0m(0, 0) 
36: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
37: [32mUNPACK_SEQUENCE[0m(2, 2) 
38: [32mSTORE_FAST[0m(4, __case_idx) 
39: [32mSTORE_FAST[0m(3, __graph_fn) 
40: [32mLOAD_GLOBAL[0m(5, enable_trace) 
41: [32mLOAD_CONST[0m(6, 12) 
42: [32mCALL_FUNCTION[0m(1, 1) 
43: [32mPOP_TOP[0m(None, None) 
44: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
45: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:593
tracing opcode LOAD_GLOBAL None pc=0 frame=12(0x86b93f0)
push tracker due to record
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=12(0x86b93f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=12(0x86b93f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
enable_trace
push tracker 12 frame 0x86b93f0 frame_id 12 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 12]
tracing opcode POP_TOP None pc=86 frame=12(0x86b93f0)
restart: running injected code (f_lasti=86)
tracing opcode JUMP_ABSOLUTE None pc=88 frame=12(0x86b93f0)
restart: running injected code (f_lasti=88)
tracing line /home/drc/frontend/test/test_model_deberta.py:594
tracing opcode LOAD_FAST None pc=10 frame=12(0x86b93f0)
load fast: 23339737784864
tracing opcode LOAD_METHOD None pc=12 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=14 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=16 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=18 frame=12(0x86b93f0)
tracing opcode BUILD_SLICE None pc=20 frame=12(0x86b93f0)
tracing opcode BINARY_SUBSCR None pc=22 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=24 frame=12(0x86b93f0)
load fast: 23346415552112
tracing opcode LOAD_ATTR None pc=26 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=28 frame=12(0x86b93f0)
tracing opcode BUILD_TUPLE None pc=30 frame=12(0x86b93f0)
tracing opcode BINARY_ADD None pc=32 frame=12(0x86b93f0)
tracing opcode STORE_FAST None pc=34 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:595
tracing opcode LOAD_FAST None pc=36 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=38 frame=12(0x86b93f0)
tracing opcode LOAD_FAST None pc=40 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=42 frame=12(0x86b93f0)
fetch:  torch.Size([1, 512, 12, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=44 frame=12(0x86b93f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:596
tracing opcode LOAD_FAST None pc=46 frame=12(0x86b93f0)
tracing opcode LOAD_METHOD None pc=48 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=50 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=52 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=54 frame=12(0x86b93f0)
tracing opcode LOAD_CONST None pc=56 frame=12(0x86b93f0)
tracing opcode CALL_METHOD None pc=58 frame=12(0x86b93f0)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  3 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=60 frame=12(0x86b93f0)
restart: running injected code (f_lasti=60)
commiting 12 0 25 [32mRETURN_VALUE[0m(None, None)  60
callee is full graph, merge to caller
to merge graph graph():
    %tensor_430 : [#users=1] = placeholder[target=tensor_430]
    %view : [#users=1] = call_method[target=view](args = (%tensor_430, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=0] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
to merge frameid 12 13
tracing opcode RETURN_VALUE None pc=90 frame=12(0x86b93f0)
restart: running injected code (f_lasti=90)
before pop_tracker [0, 4, 9, 10, 11, 13, 12] frame_id 12
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=362 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:723
tracing opcode LOAD_FAST None pc=364 frame=13(0xd6d7f60)
tracing opcode LOAD_GLOBAL None pc=366 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=368 frame=13(0xd6d7f60)
tracing opcode LOAD_GLOBAL None pc=370 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=372 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=374 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=376 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=378 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=380 frame=13(0xd6d7f60)
tracing opcode LOAD_GLOBAL None pc=382 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=384 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=386 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION_KW None pc=388 frame=13(0xd6d7f60)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode LOAD_FAST None pc=390 frame=13(0xd6d7f60)
tracing opcode BINARY_MULTIPLY None pc=392 frame=13(0xd6d7f60)
record function in graph <built-in function mul>
tracing opcode CALL_METHOD None pc=394 frame=13(0xd6d7f60)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode INPLACE_TRUE_DIVIDE None pc=396 frame=13(0xd6d7f60)
record function in graph <built-in function itruediv>
tracing opcode STORE_FAST None pc=398 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:724
tracing opcode LOAD_FAST None pc=400 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=402 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=404 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=406 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=408 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=410 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=412 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=414 frame=13(0xd6d7f60)
tracing opcode COMPARE_OP None pc=416 frame=13(0xd6d7f60)
tracing opcode EXTENDED_ARG None pc=418 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:727
tracing opcode LOAD_FAST None pc=450 frame=13(0xd6d7f60)
tracing opcode STORE_FAST None pc=452 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:728
tracing opcode LOAD_GLOBAL None pc=454 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=456 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=458 frame=13(0xd6d7f60)
tracing opcode UNARY_NEGATIVE None pc=460 frame=13(0xd6d7f60)
record function in graph <built-in function neg>
tracing opcode LOAD_FAST None pc=462 frame=13(0xd6d7f60)
tracing opcode BINARY_ADD None pc=464 frame=13(0xd6d7f60)
record function in graph <built-in function add>
tracing opcode LOAD_CONST None pc=466 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=468 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=470 frame=13(0xd6d7f60)
tracing opcode BINARY_MULTIPLY None pc=472 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=474 frame=13(0xd6d7f60)
tracing opcode BINARY_SUBTRACT None pc=476 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=478 frame=13(0xd6d7f60)
fetch:  511 <class 'int'>
record function in graph <built-in method clamp of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=480 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:729
tracing opcode LOAD_GLOBAL None pc=482 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=484 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=486 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=488 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=490 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=492 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=494 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=496 frame=13(0xd6d7f60)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=498 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=500 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=502 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=504 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION_KW None pc=506 frame=13(0xd6d7f60)
record function in graph <built-in method to of Tensor object at 0x153a34c7a360>
tracing opcode CALL_METHOD None pc=508 frame=13(0xd6d7f60)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=510 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_GLOBAL None pc=512 frame=13(0xd6d7f60)
tracing opcode LOAD_ATTR None pc=514 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:731
tracing opcode LOAD_FAST None pc=516 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=518 frame=13(0xd6d7f60)
tracing opcode LOAD_GLOBAL None pc=520 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=522 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=524 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=526 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION None pc=528 frame=13(0xd6d7f60)
run into user defined function <function p2c_dynamic_expand at 0x153bd10d7f70>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 15 0x153bc2c06840 p2c_dynamic_expand
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(4, 15) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(52, 52)  -> inst 26
5: [33mLOAD_FAST[0m(0, c2p_pos) 
6: [33mLOAD_METHOD[0m(0, expand) 
7: [33mLOAD_FAST[0m(1, query_layer) 
8: [33mLOAD_METHOD[0m(1, size) 
9: [33mLOAD_CONST[0m(2, 0) 
10: [33mCALL_METHOD[0m(1, 1) 
11: [33mLOAD_FAST[0m(1, query_layer) 
12: [33mLOAD_METHOD[0m(1, size) 
13: [33mLOAD_CONST[0m(0, 1) 
14: [33mCALL_METHOD[0m(1, 1) 
15: [33mLOAD_FAST[0m(2, key_layer) 
16: [33mLOAD_METHOD[0m(1, size) 
17: [33mLOAD_CONST[0m(1, -2) 
18: [33mCALL_METHOD[0m(1, 1) 
19: [33mLOAD_FAST[0m(2, key_layer) 
20: [33mLOAD_METHOD[0m(1, size) 
21: [33mLOAD_CONST[0m(1, -2) 
22: [33mCALL_METHOD[0m(1, 1) 
23: [33mBUILD_LIST[0m(4, 4) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [32mJUMP_ABSOLUTE[0m(80, 80)  -> inst 40
26: [32mLOAD_GLOBAL[0m(5, guard_match) 
27: [32mLOAD_CONST[0m(4, 15) 
28: [32mLOAD_CONST[0m(2, 0) 
29: [32mLOAD_GLOBAL[0m(6, locals) 
30: [32mCALL_FUNCTION[0m(0, 0) 
31: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
32: [32mUNPACK_SEQUENCE[0m(2, 2) 
33: [32mSTORE_FAST[0m(4, __case_idx) 
34: [32mSTORE_FAST[0m(3, __graph_fn) 
35: [32mLOAD_GLOBAL[0m(3, enable_trace) 
36: [32mLOAD_CONST[0m(4, 15) 
37: [32mCALL_FUNCTION[0m(1, 1) 
38: [32mPOP_TOP[0m(None, None) 
39: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
40: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_GLOBAL None pc=0 frame=15(0x86a69f0)
push tracker due to record
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=15(0x86a69f0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=15(0x86a69f0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
enable_trace
push tracker 15 frame 0x86a69f0 frame_id 15 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 13, 15]
tracing opcode POP_TOP None pc=76 frame=15(0x86a69f0)
restart: running injected code (f_lasti=76)
tracing opcode JUMP_ABSOLUTE None pc=78 frame=15(0x86a69f0)
restart: running injected code (f_lasti=78)
tracing line /home/drc/frontend/test/test_model_deberta.py:538
tracing opcode LOAD_FAST None pc=10 frame=15(0x86a69f0)
load fast: 23339737968208
tracing opcode LOAD_METHOD None pc=12 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=14 frame=15(0x86a69f0)
load fast: 23339740478176
tracing opcode LOAD_METHOD None pc=16 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=18 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=20 frame=15(0x86a69f0)
fetch:  0 <class 'int'>
tracing opcode LOAD_FAST None pc=22 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=24 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=26 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=28 frame=15(0x86a69f0)
tracing opcode LOAD_FAST None pc=30 frame=15(0x86a69f0)
load fast: 23339740582512
tracing opcode LOAD_METHOD None pc=32 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=34 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=36 frame=15(0x86a69f0)
fetch:  -2 <class 'int'>
tracing opcode LOAD_FAST None pc=38 frame=15(0x86a69f0)
tracing opcode LOAD_METHOD None pc=40 frame=15(0x86a69f0)
tracing opcode LOAD_CONST None pc=42 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=44 frame=15(0x86a69f0)
tracing opcode BUILD_LIST None pc=46 frame=15(0x86a69f0)
tracing opcode CALL_METHOD None pc=48 frame=15(0x86a69f0)
fetch:  [1, 12, 256, 256] <class 'list'>
record function in graph <method 'expand' of 'torch._C._TensorBase' objects>
tracing opcode JUMP_ABSOLUTE None pc=50 frame=15(0x86a69f0)
restart: running injected code (f_lasti=50)
commiting 15 0 20 [32mRETURN_VALUE[0m(None, None)  50
callee is full graph, merge to caller
to merge graph graph():
    %tensor_431 : [#users=1] = placeholder[target=tensor_431]
    %tensor_432 : [#users=0] = placeholder[target=tensor_432]
    %tensor_433 : [#users=0] = placeholder[target=tensor_433]
    %expand : [#users=0] = call_method[target=expand](args = (%tensor_431, [1, 12, 256, 256]), kwargs = {})
to merge frameid 15 13
tracing opcode RETURN_VALUE None pc=80 frame=15(0x86a69f0)
restart: running injected code (f_lasti=80)
before pop_tracker [0, 4, 9, 10, 11, 13, 15] frame_id 15
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode LOAD_CONST None pc=530 frame=13(0xd6d7f60)
tracing opcode CALL_FUNCTION_KW None pc=532 frame=13(0xd6d7f60)
record function in graph <built-in method gather of type object at 0x153c4f4a4880>
tracing opcode LOAD_METHOD None pc=534 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:732
tracing opcode LOAD_CONST None pc=536 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=538 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:730
tracing opcode CALL_METHOD None pc=540 frame=13(0xd6d7f60)
record function in graph <method 'transpose' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=542 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:734
tracing opcode LOAD_FAST None pc=544 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=546 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=548 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=550 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=552 frame=13(0xd6d7f60)
tracing opcode LOAD_METHOD None pc=554 frame=13(0xd6d7f60)
tracing opcode LOAD_CONST None pc=556 frame=13(0xd6d7f60)
tracing opcode CALL_METHOD None pc=558 frame=13(0xd6d7f60)
tracing opcode COMPARE_OP None pc=560 frame=13(0xd6d7f60)
tracing opcode EXTENDED_ARG None pc=562 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:737
tracing opcode LOAD_FAST None pc=624 frame=13(0xd6d7f60)
tracing opcode LOAD_FAST None pc=626 frame=13(0xd6d7f60)
tracing opcode INPLACE_ADD None pc=628 frame=13(0xd6d7f60)
record function in graph <built-in function iadd>
tracing opcode STORE_FAST None pc=630 frame=13(0xd6d7f60)
tracing line /home/drc/frontend/test/test_model_deberta.py:739
tracing opcode LOAD_FAST None pc=632 frame=13(0xd6d7f60)
tracing opcode EXTENDED_ARG None pc=634 frame=13(0xd6d7f60)
restart: running injected code (f_lasti=634)
commiting 13 0 311 [32mRETURN_VALUE[0m(None, None)  634
callee is full graph, merge to caller
to merge graph graph():
    %tensor_423 : [#users=1] = placeholder[target=tensor_423]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_423, 1), kwargs = {})
    %tensor_424 : [#users=1] = placeholder[target=tensor_424]
    %tensor_425 : [#users=1] = placeholder[target=tensor_425]
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%permute, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%tensor_424, %transpose), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_1, %sqrt), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_1, 0, 511), kwargs = {})
    %transpose_1 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%transpose_1,), kwargs = {dtype: torch.float32})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%tensor_425, %transpose_1), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand_1})
    %transpose_2 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=0] = call_function[target=operator.iadd](args = (%iadd, %transpose_2), kwargs = {})
to merge frameid 13 11
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDeviceVar(need_guard_check=True, extract_code_at_start=[locals['query_layer'].device], extract_code_hashs={6964955507098700893}, obj=device(type='cpu'), modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=666 frame=13(0xd6d7f60)
restart: running injected code (f_lasti=666)
before pop_tracker [0, 4, 9, 10, 11, 13] frame_id 13
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=404 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:668
tracing opcode LOAD_FAST None pc=406 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=408 frame=11(0x11c0ac70)
tracing opcode IS_OP None pc=410 frame=11(0x11c0ac70)
tracing opcode EXTENDED_ARG None pc=412 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:669
tracing opcode LOAD_FAST None pc=416 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=418 frame=11(0x11c0ac70)
tracing opcode BINARY_ADD None pc=420 frame=11(0x11c0ac70)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=422 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:672
tracing opcode LOAD_DEREF None pc=424 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=426 frame=11(0x11c0ac70)
tracing opcode EXTENDED_ARG None pc=428 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:675
tracing opcode LOAD_GLOBAL None pc=466 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=468 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=470 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=472 frame=11(0x11c0ac70)
load fast: 23346380226624
tracing opcode LOAD_CONST None pc=474 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=476 frame=11(0x11c0ac70)
run into user defined function <bound method Function.apply of <class '__main__.XSoftmax'>>
preprocess frame /home/drc/frontend/test/test_model_deberta.py 16 0x153bc0bea640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(12, disable_trace) 
1: [32mLOAD_CONST[0m(2, 16) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(98, 98)  -> inst 49
5: [33mLOAD_FAST[0m(3, dim) 
6: [33mLOAD_FAST[0m(0, self) 
7: [33mSTORE_ATTR[0m(0, dim) 
8: [33mLOAD_FAST[0m(2, mask) 
9: [33mLOAD_METHOD[0m(1, to) 
10: [33mLOAD_GLOBAL[0m(2, torch) 
11: [33mLOAD_ATTR[0m(3, bool) 
12: [33mCALL_METHOD[0m(1, 1) 
13: [33mUNARY_INVERT[0m(None, None) 
14: [33mSTORE_FAST[0m(4, rmask) 
15: [33mLOAD_FAST[0m(1, input) 
16: [33mLOAD_METHOD[0m(4, masked_fill) 
17: [33mLOAD_FAST[0m(4, rmask) 
18: [33mLOAD_GLOBAL[0m(2, torch) 
19: [33mLOAD_METHOD[0m(5, tensor) 
20: [33mLOAD_GLOBAL[0m(2, torch) 
21: [33mLOAD_METHOD[0m(6, finfo) 
22: [33mLOAD_FAST[0m(1, input) 
23: [33mLOAD_ATTR[0m(7, dtype) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(8, min) 
26: [33mCALL_METHOD[0m(1, 1) 
27: [33mCALL_METHOD[0m(2, 2) 
28: [33mSTORE_FAST[0m(5, output) 
29: [33mLOAD_GLOBAL[0m(2, torch) 
30: [33mLOAD_METHOD[0m(9, softmax) 
31: [33mLOAD_FAST[0m(5, output) 
32: [33mLOAD_FAST[0m(0, self) 
33: [33mLOAD_ATTR[0m(0, dim) 
34: [33mCALL_METHOD[0m(2, 2) 
35: [33mSTORE_FAST[0m(5, output) 
36: [33mLOAD_FAST[0m(5, output) 
37: [33mLOAD_METHOD[0m(10, masked_fill_) 
38: [33mLOAD_FAST[0m(4, rmask) 
39: [33mLOAD_CONST[0m(0, 0) 
40: [33mCALL_METHOD[0m(2, 2) 
41: [33mPOP_TOP[0m(None, None) 
42: [33mLOAD_FAST[0m(0, self) 
43: [33mLOAD_METHOD[0m(11, save_for_backward) 
44: [33mLOAD_FAST[0m(5, output) 
45: [33mCALL_METHOD[0m(1, 1) 
46: [33mPOP_TOP[0m(None, None) 
47: [33mLOAD_FAST[0m(5, output) 
48: [32mJUMP_ABSOLUTE[0m(126, 126)  -> inst 63
49: [32mLOAD_GLOBAL[0m(15, guard_match) 
50: [32mLOAD_CONST[0m(2, 16) 
51: [32mLOAD_CONST[0m(0, 0) 
52: [32mLOAD_GLOBAL[0m(16, locals) 
53: [32mCALL_FUNCTION[0m(0, 0) 
54: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
55: [32mUNPACK_SEQUENCE[0m(2, 2) 
56: [32mSTORE_FAST[0m(7, __case_idx) 
57: [32mSTORE_FAST[0m(6, __graph_fn) 
58: [32mLOAD_GLOBAL[0m(13, enable_trace) 
59: [32mLOAD_CONST[0m(2, 16) 
60: [32mCALL_FUNCTION[0m(1, 1) 
61: [32mPOP_TOP[0m(None, None) 
62: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
63: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:106
tracing opcode LOAD_GLOBAL None pc=0 frame=16(0x153bc0b3bc40)
push tracker due to record
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
enable_trace
push tracker 16 frame 0x153bc0b3bc40 frame_id 16 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 16]
tracing opcode POP_TOP None pc=122 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=122)
tracing opcode JUMP_ABSOLUTE None pc=124 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=124)
tracing line /home/drc/frontend/test/test_model_deberta.py:108
tracing opcode LOAD_FAST None pc=10 frame=16(0x153bc0b3bc40)
load fast: 23349563697392
tracing opcode LOAD_FAST None pc=12 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153a34c8b040> <class 'torch.autograd.function.XSoftmaxBackward'> [locals['self']]
load fast: 23339737854016
tracing opcode STORE_ATTR None pc=14 frame=16(0x153bc0b3bc40)
generate any for <torch.autograd.function.XSoftmaxBackward object at 0x153a34c8b040> <class 'torch.autograd.function.XSoftmaxBackward'> []
tracing line /home/drc/frontend/test/test_model_deberta.py:109
tracing opcode LOAD_FAST None pc=16 frame=16(0x153bc0b3bc40)
load fast: 23346380226624
tracing opcode LOAD_METHOD None pc=18 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=20 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=22 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=24 frame=16(0x153bc0b3bc40)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode UNARY_INVERT None pc=26 frame=16(0x153bc0b3bc40)
record function in graph <built-in function invert>
tracing opcode STORE_FAST None pc=28 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:111
tracing opcode LOAD_FAST None pc=30 frame=16(0x153bc0b3bc40)
load fast: 23339747004800
tracing opcode LOAD_METHOD None pc=32 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=34 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=36 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=38 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_GLOBAL None pc=40 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=42 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=44 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=46 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=48 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=50 frame=16(0x153bc0b3bc40)
generate any for finfo(resolution=1e-06, min=-3.40282e+38, max=3.40282e+38, eps=1.19209e-07, smallest_normal=1.17549e-38, tiny=1.17549e-38, dtype=float32) <class 'torch.finfo'> []
tracing opcode CALL_METHOD None pc=52 frame=16(0x153bc0b3bc40)
record function in graph <built-in method tensor of type object at 0x153c4f4a4880>
tracing opcode CALL_METHOD None pc=54 frame=16(0x153bc0b3bc40)
record function in graph <method 'masked_fill' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=56 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:112
tracing opcode LOAD_GLOBAL None pc=58 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=60 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=62 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=64 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_ATTR None pc=66 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=68 frame=16(0x153bc0b3bc40)
record function in graph <built-in method softmax of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=70 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:113
tracing opcode LOAD_FAST None pc=72 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=74 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=76 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_CONST None pc=78 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=80 frame=16(0x153bc0b3bc40)
fetch:  0 <class 'int'>
record function in graph <method 'masked_fill_' of 'torch._C._TensorBase' objects>
tracing opcode POP_TOP None pc=82 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:114
tracing opcode LOAD_FAST None pc=84 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_METHOD None pc=86 frame=16(0x153bc0b3bc40)
tracing opcode LOAD_FAST None pc=88 frame=16(0x153bc0b3bc40)
tracing opcode CALL_METHOD None pc=90 frame=16(0x153bc0b3bc40)
tracing opcode POP_TOP None pc=92 frame=16(0x153bc0b3bc40)
tracing line /home/drc/frontend/test/test_model_deberta.py:115
tracing opcode LOAD_FAST None pc=94 frame=16(0x153bc0b3bc40)
tracing opcode JUMP_ABSOLUTE None pc=96 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=96)
commiting 16 0 43 [32mRETURN_VALUE[0m(None, None)  96
callee is full graph, merge to caller
to merge graph graph():
    %tensor_435 : [#users=1] = placeholder[target=tensor_435]
    %to : [#users=1] = call_method[target=to](args = (%tensor_435, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to,), kwargs = {})
    %tensor_436 : [#users=1] = placeholder[target=tensor_436]
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%tensor_436, %invert, %tensor), kwargs = {})
    %softmax : [#users=1] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
to merge frameid 16 11
tracing opcode RETURN_VALUE None pc=126 frame=16(0x153bc0b3bc40)
restart: running injected code (f_lasti=126)
before pop_tracker [0, 4, 9, 10, 11, 16] frame_id 16
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=478 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:677
tracing opcode LOAD_DEREF None pc=480 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=482 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=484 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=486 frame=11(0x11c0ac70)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 11, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415552352
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339737793376
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_437 : [#users=0] = placeholder[target=tensor_437]
to merge frameid 3 11
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[[0.0041, 0.0032, 0.0040,  ..., 0.0036, 0.0032, 0.0041],
          [0.0037, 0.0040, 0.0034,  ..., 0.0038, 0.0038, 0.0042],
          [0.0030, 0.0033, 0.0040,  ..., 0.0034, 0.0036, 0.0032],
          ...,
          [0.0032, 0.0027, 0.0043,  ..., 0.0037, 0.0028, 0.0041],
          [0.0038, 0.0032, 0.0058,  ..., 0.0035, 0.0048, 0.0041],
          [0.0032, 0.0040, 0.0046,  ..., 0.0044, 0.0027, 0.0035]],

         [[0.0042, 0.0038, 0.0040,  ..., 0.0035, 0.0040, 0.0034],
          [0.0047, 0.0033, 0.0046,  ..., 0.0040, 0.0043, 0.0039],
          [0.0041, 0.0040, 0.0038,  ..., 0.0057, 0.0026, 0.0038],
          ...,
          [0.0041, 0.0033, 0.0046,  ..., 0.0049, 0.0038, 0.0048],
          [0.0037, 0.0036, 0.0031,  ..., 0.0043, 0.0029, 0.0036],
          [0.0044, 0.0053, 0.0032,  ..., 0.0058, 0.0050, 0.0038]],

         [[0.0053, 0.0029, 0.0041,  ..., 0.0034, 0.0037, 0.0044],
          [0.0049, 0.0037, 0.0035,  ..., 0.0042, 0.0033, 0.0034],
          [0.0044, 0.0039, 0.0037,  ..., 0.0041, 0.0043, 0.0045],
          ...,
          [0.0046, 0.0029, 0.0040,  ..., 0.0041, 0.0041, 0.0035],
          [0.0039, 0.0034, 0.0052,  ..., 0.0042, 0.0044, 0.0036],
          [0.0032, 0.0044, 0.0042,  ..., 0.0034, 0.0041, 0.0035]],

         ...,

         [[0.0040, 0.0038, 0.0045,  ..., 0.0037, 0.0048, 0.0035],
          [0.0033, 0.0036, 0.0038,  ..., 0.0041, 0.0043, 0.0033],
          [0.0045, 0.0042, 0.0035,  ..., 0.0042, 0.0039, 0.0040],
          ...,
          [0.0044, 0.0044, 0.0042,  ..., 0.0040, 0.0035, 0.0043],
          [0.0042, 0.0035, 0.0039,  ..., 0.0045, 0.0050, 0.0037],
          [0.0041, 0.0044, 0.0042,  ..., 0.0035, 0.0039, 0.0030]],

         [[0.0036, 0.0036, 0.0041,  ..., 0.0035, 0.0036, 0.0045],
          [0.0031, 0.0041, 0.0044,  ..., 0.0031, 0.0034, 0.0031],
          [0.0033, 0.0045, 0.0028,  ..., 0.0031, 0.0036, 0.0032],
          ...,
          [0.0035, 0.0040, 0.0049,  ..., 0.0036, 0.0036, 0.0027],
          [0.0040, 0.0041, 0.0035,  ..., 0.0041, 0.0048, 0.0036],
          [0.0033, 0.0046, 0.0051,  ..., 0.0044, 0.0042, 0.0042]],

         [[0.0037, 0.0040, 0.0046,  ..., 0.0046, 0.0028, 0.0042],
          [0.0041, 0.0046, 0.0049,  ..., 0.0038, 0.0032, 0.0028],
          [0.0038, 0.0034, 0.0042,  ..., 0.0036, 0.0039, 0.0037],
          ...,
          [0.0042, 0.0036, 0.0055,  ..., 0.0035, 0.0045, 0.0037],
          [0.0038, 0.0037, 0.0047,  ..., 0.0035, 0.0038, 0.0038],
          [0.0042, 0.0032, 0.0045,  ..., 0.0037, 0.0037, 0.0041]]]]), modified_attrs={}, prev=None) 23339993397232 23339737793376
obj: tensor([[[[0.0041, 0.0032, 0.0040,  ..., 0.0036, 0.0032, 0.0041],
          [0.0037, 0.0040, 0.0034,  ..., 0.0038, 0.0038, 0.0042],
          [0.0030, 0.0033, 0.0040,  ..., 0.0034, 0.0036, 0.0032],
          ...,
          [0.0032, 0.0027, 0.0043,  ..., 0.0037, 0.0028, 0.0041],
          [0.0038, 0.0032, 0.0058,  ..., 0.0035, 0.0048, 0.0041],
          [0.0032, 0.0040, 0.0046,  ..., 0.0044, 0.0027, 0.0035]],

         [[0.0042, 0.0038, 0.0040,  ..., 0.0035, 0.0040, 0.0034],
          [0.0047, 0.0033, 0.0046,  ..., 0.0040, 0.0043, 0.0039],
          [0.0041, 0.0040, 0.0038,  ..., 0.0057, 0.0026, 0.0038],
          ...,
          [0.0041, 0.0033, 0.0046,  ..., 0.0049, 0.0038, 0.0048],
          [0.0037, 0.0036, 0.0031,  ..., 0.0043, 0.0029, 0.0036],
          [0.0044, 0.0053, 0.0032,  ..., 0.0058, 0.0050, 0.0038]],

         [[0.0053, 0.0029, 0.0041,  ..., 0.0034, 0.0037, 0.0044],
          [0.0049, 0.0037, 0.0035,  ..., 0.0042, 0.0033, 0.0034],
          [0.0044, 0.0039, 0.0037,  ..., 0.0041, 0.0043, 0.0045],
          ...,
          [0.0046, 0.0029, 0.0040,  ..., 0.0041, 0.0041, 0.0035],
          [0.0039, 0.0034, 0.0052,  ..., 0.0042, 0.0044, 0.0036],
          [0.0032, 0.0044, 0.0042,  ..., 0.0034, 0.0041, 0.0035]],

         ...,

         [[0.0040, 0.0038, 0.0045,  ..., 0.0037, 0.0048, 0.0035],
          [0.0033, 0.0036, 0.0038,  ..., 0.0041, 0.0043, 0.0033],
          [0.0045, 0.0042, 0.0035,  ..., 0.0042, 0.0039, 0.0040],
          ...,
          [0.0044, 0.0044, 0.0042,  ..., 0.0040, 0.0035, 0.0043],
          [0.0042, 0.0035, 0.0039,  ..., 0.0045, 0.0050, 0.0037],
          [0.0041, 0.0044, 0.0042,  ..., 0.0035, 0.0039, 0.0030]],

         [[0.0036, 0.0036, 0.0041,  ..., 0.0035, 0.0036, 0.0045],
          [0.0031, 0.0041, 0.0044,  ..., 0.0031, 0.0034, 0.0031],
          [0.0033, 0.0045, 0.0028,  ..., 0.0031, 0.0036, 0.0032],
          ...,
          [0.0035, 0.0040, 0.0049,  ..., 0.0036, 0.0036, 0.0027],
          [0.0040, 0.0041, 0.0035,  ..., 0.0041, 0.0048, 0.0036],
          [0.0033, 0.0046, 0.0051,  ..., 0.0044, 0.0042, 0.0042]],

         [[0.0037, 0.0040, 0.0046,  ..., 0.0046, 0.0028, 0.0042],
          [0.0041, 0.0046, 0.0049,  ..., 0.0038, 0.0032, 0.0028],
          [0.0038, 0.0034, 0.0042,  ..., 0.0036, 0.0039, 0.0037],
          ...,
          [0.0042, 0.0036, 0.0055,  ..., 0.0035, 0.0045, 0.0037],
          [0.0038, 0.0037, 0.0047,  ..., 0.0035, 0.0038, 0.0038],
          [0.0042, 0.0032, 0.0045,  ..., 0.0037, 0.0037, 0.0041]]]]) 23339737793376
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[[0.0041, 0.0032, 0.0040,  ..., 0.0036, 0.0032, 0.0041],
          [0.0037, 0.0040, 0.0034,  ..., 0.0038, 0.0038, 0.0042],
          [0.0030, 0.0033, 0.0040,  ..., 0.0034, 0.0036, 0.0032],
          ...,
          [0.0032, 0.0027, 0.0043,  ..., 0.0037, 0.0028, 0.0041],
          [0.0038, 0.0032, 0.0058,  ..., 0.0035, 0.0048, 0.0041],
          [0.0032, 0.0040, 0.0046,  ..., 0.0044, 0.0027, 0.0035]],

         [[0.0042, 0.0038, 0.0040,  ..., 0.0035, 0.0040, 0.0034],
          [0.0047, 0.0033, 0.0046,  ..., 0.0040, 0.0043, 0.0039],
          [0.0041, 0.0040, 0.0038,  ..., 0.0057, 0.0026, 0.0038],
          ...,
          [0.0041, 0.0033, 0.0046,  ..., 0.0049, 0.0038, 0.0048],
          [0.0037, 0.0036, 0.0031,  ..., 0.0043, 0.0029, 0.0036],
          [0.0044, 0.0053, 0.0032,  ..., 0.0058, 0.0050, 0.0038]],

         [[0.0053, 0.0029, 0.0041,  ..., 0.0034, 0.0037, 0.0044],
          [0.0049, 0.0037, 0.0035,  ..., 0.0042, 0.0033, 0.0034],
          [0.0044, 0.0039, 0.0037,  ..., 0.0041, 0.0043, 0.0045],
          ...,
          [0.0046, 0.0029, 0.0040,  ..., 0.0041, 0.0041, 0.0035],
          [0.0039, 0.0034, 0.0052,  ..., 0.0042, 0.0044, 0.0036],
          [0.0032, 0.0044, 0.0042,  ..., 0.0034, 0.0041, 0.0035]],

         ...,

         [[0.0040, 0.0038, 0.0045,  ..., 0.0037, 0.0048, 0.0035],
          [0.0033, 0.0036, 0.0038,  ..., 0.0041, 0.0043, 0.0033],
          [0.0045, 0.0042, 0.0035,  ..., 0.0042, 0.0039, 0.0040],
          ...,
          [0.0044, 0.0044, 0.0042,  ..., 0.0040, 0.0035, 0.0043],
          [0.0042, 0.0035, 0.0039,  ..., 0.0045, 0.0050, 0.0037],
          [0.0041, 0.0044, 0.0042,  ..., 0.0035, 0.0039, 0.0030]],

         [[0.0036, 0.0036, 0.0041,  ..., 0.0035, 0.0036, 0.0045],
          [0.0031, 0.0041, 0.0044,  ..., 0.0031, 0.0034, 0.0031],
          [0.0033, 0.0045, 0.0028,  ..., 0.0031, 0.0036, 0.0032],
          ...,
          [0.0035, 0.0040, 0.0049,  ..., 0.0036, 0.0036, 0.0027],
          [0.0040, 0.0041, 0.0035,  ..., 0.0041, 0.0048, 0.0036],
          [0.0033, 0.0046, 0.0051,  ..., 0.0044, 0.0042, 0.0042]],

         [[0.0037, 0.0040, 0.0046,  ..., 0.0046, 0.0028, 0.0042],
          [0.0041, 0.0046, 0.0049,  ..., 0.0038, 0.0032, 0.0028],
          [0.0038, 0.0034, 0.0042,  ..., 0.0036, 0.0039, 0.0037],
          ...,
          [0.0042, 0.0036, 0.0055,  ..., 0.0035, 0.0045, 0.0037],
          [0.0038, 0.0037, 0.0047,  ..., 0.0035, 0.0038, 0.0038],
          [0.0042, 0.0032, 0.0045,  ..., 0.0037, 0.0037, 0.0041]]]]), modified_attrs={}, prev=None) 23339737992400
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 11, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=488 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:678
tracing opcode LOAD_DEREF None pc=490 frame=11(0x11c0ac70)
tracing opcode LOAD_ATTR None pc=492 frame=11(0x11c0ac70)
tracing opcode EXTENDED_ARG None pc=494 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:681
tracing opcode LOAD_GLOBAL None pc=532 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=534 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=536 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=538 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=540 frame=11(0x11c0ac70)
record function in graph <built-in method matmul of type object at 0x153c4f4a4880>
tracing opcode STORE_FAST None pc=542 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:682
tracing opcode LOAD_FAST None pc=544 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=546 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=548 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=550 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=552 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=554 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=556 frame=11(0x11c0ac70)
fetch:  0 <class 'int'>
fetch:  2 <class 'int'>
fetch:  1 <class 'int'>
record function in graph <method 'permute' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_METHOD None pc=558 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=560 frame=11(0x11c0ac70)
record function in graph <method 'contiguous' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=562 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:683
tracing opcode LOAD_FAST None pc=564 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=566 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=568 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=570 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=572 frame=11(0x11c0ac70)
tracing opcode BUILD_SLICE None pc=574 frame=11(0x11c0ac70)
tracing opcode BINARY_SUBSCR None pc=576 frame=11(0x11c0ac70)
tracing opcode LOAD_CONST None pc=578 frame=11(0x11c0ac70)
tracing opcode BINARY_ADD None pc=580 frame=11(0x11c0ac70)
tracing opcode STORE_FAST None pc=582 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:684
tracing opcode LOAD_FAST None pc=584 frame=11(0x11c0ac70)
tracing opcode LOAD_METHOD None pc=586 frame=11(0x11c0ac70)
tracing opcode LOAD_FAST None pc=588 frame=11(0x11c0ac70)
tracing opcode CALL_METHOD None pc=590 frame=11(0x11c0ac70)
fetch:  torch.Size([1, 256, -1]) <class 'torch.Size'>
record function in graph <method 'view' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=592 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:685
tracing opcode LOAD_FAST None pc=594 frame=11(0x11c0ac70)
tracing opcode EXTENDED_ARG None pc=596 frame=11(0x11c0ac70)
tracing line /home/drc/frontend/test/test_model_deberta.py:688
tracing opcode LOAD_FAST None pc=610 frame=11(0x11c0ac70)
tracing opcode EXTENDED_ARG None pc=612 frame=11(0x11c0ac70)
restart: running injected code (f_lasti=612)
commiting 11 0 299 [32mRETURN_VALUE[0m(None, None)  612
callee is full graph, merge to caller
to merge graph graph():
    %tensor_418 : [#users=1] = placeholder[target=tensor_418]
    %in_proj : [#users=1] = call_module[target=in_proj](args = (%tensor_418,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %tensor_422 : [#users=1] = placeholder[target=tensor_422]
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_422, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_423 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_423, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %tensor_434 : [#users=1] = placeholder[target=tensor_434]
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_434, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_435 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_435), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=0] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
to merge frameid 11 10
tracing opcode RETURN_VALUE None pc=650 frame=11(0x11c0ac70)
restart: running injected code (f_lasti=650)
before pop_tracker [0, 4, 9, 10, 11] frame_id 11
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=10(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:322
tracing opcode LOAD_FAST None pc=32 frame=10(0x8c422e0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=10(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:324
tracing opcode LOAD_FAST None pc=44 frame=10(0x8c422e0)
tracing opcode LOAD_CONST None pc=46 frame=10(0x8c422e0)
tracing opcode IS_OP None pc=48 frame=10(0x8c422e0)
tracing opcode POP_JUMP_IF_FALSE None pc=50 frame=10(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:325
tracing opcode LOAD_FAST None pc=52 frame=10(0x8c422e0)
tracing opcode STORE_FAST None pc=54 frame=10(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:326
tracing opcode LOAD_FAST None pc=56 frame=10(0x8c422e0)
tracing opcode LOAD_METHOD None pc=58 frame=10(0x8c422e0)
tracing opcode LOAD_FAST None pc=60 frame=10(0x8c422e0)
tracing opcode LOAD_FAST None pc=62 frame=10(0x8c422e0)
tracing opcode CALL_METHOD None pc=64 frame=10(0x8c422e0)
run into user defined function DebertaSelfOutput(
  (dense): Linear(in_features=768, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 17 0x153bc0bbb640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 17) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 17) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 17) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:291
tracing opcode LOAD_GLOBAL None pc=0 frame=17(0x153bad76e640)
push tracker due to record
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
enable_trace
push tracker 17 frame 0x153bad76e640 frame_id 17 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17]
tracing opcode POP_TOP None pc=72 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:292
tracing opcode LOAD_FAST None pc=10 frame=17(0x153bad76e640)
load fast: 23346415552400
tracing opcode LOAD_METHOD None pc=12 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=14 frame=17(0x153bad76e640)
load fast: 23339737796096
tracing opcode CALL_METHOD None pc=16 frame=17(0x153bad76e640)
record function in graph Linear(in_features=768, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:293
tracing opcode LOAD_FAST None pc=20 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=22 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=24 frame=17(0x153bad76e640)
tracing opcode CALL_METHOD None pc=26 frame=17(0x153bad76e640)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415552544
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23339732903152
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_439 : [#users=0] = placeholder[target=tensor_439]
to merge frameid 3 17
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.1120,  0.0025,  0.1414,  ..., -0.2795,  0.0260, -0.0609],
         [ 0.1202,  0.0012,  0.1504,  ..., -0.2804,  0.0283, -0.0582],
         [ 0.1160, -0.0027,  0.1499,  ..., -0.2825,  0.0195, -0.0632],
         ...,
         [ 0.1161,  0.0017,  0.1421,  ..., -0.2846,  0.0180, -0.0553],
         [ 0.1120, -0.0016,  0.1477,  ..., -0.2811,  0.0237, -0.0644],
         [ 0.1164, -0.0005,  0.1453,  ..., -0.2848,  0.0289, -0.0641]]]), modified_attrs={}, prev=None) 23339732883392 23339732903152
obj: tensor([[[ 0.1120,  0.0025,  0.1414,  ..., -0.2795,  0.0260, -0.0609],
         [ 0.1202,  0.0012,  0.1504,  ..., -0.2804,  0.0283, -0.0582],
         [ 0.1160, -0.0027,  0.1499,  ..., -0.2825,  0.0195, -0.0632],
         ...,
         [ 0.1161,  0.0017,  0.1421,  ..., -0.2846,  0.0180, -0.0553],
         [ 0.1120, -0.0016,  0.1477,  ..., -0.2811,  0.0237, -0.0644],
         [ 0.1164, -0.0005,  0.1453,  ..., -0.2848,  0.0289, -0.0641]]]) 23339732903152
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.1120,  0.0025,  0.1414,  ..., -0.2795,  0.0260, -0.0609],
         [ 0.1202,  0.0012,  0.1504,  ..., -0.2804,  0.0283, -0.0582],
         [ 0.1160, -0.0027,  0.1499,  ..., -0.2825,  0.0195, -0.0632],
         ...,
         [ 0.1161,  0.0017,  0.1421,  ..., -0.2846,  0.0180, -0.0553],
         [ 0.1120, -0.0016,  0.1477,  ..., -0.2811,  0.0237, -0.0644],
         [ 0.1164, -0.0005,  0.1453,  ..., -0.2848,  0.0289, -0.0641]]]), modified_attrs={}, prev=None) 23339732881856
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 10, 17, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:294
tracing opcode LOAD_FAST None pc=30 frame=17(0x153bad76e640)
tracing opcode LOAD_METHOD None pc=32 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=34 frame=17(0x153bad76e640)
tracing opcode LOAD_FAST None pc=36 frame=17(0x153bad76e640)
load fast: 23339747007120
tracing opcode BINARY_ADD None pc=38 frame=17(0x153bad76e640)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=17(0x153bad76e640)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 10, 17, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23339732904192
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a347d2900>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153a347c4b30>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415552496
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_441 : [#users=4] = placeholder[target=tensor_441]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_441,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_441, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_441, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_441, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 17
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153a347d2900>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 10, 17, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=17(0x153bad76e640)
tracing line /home/drc/frontend/test/test_model_deberta.py:295
tracing opcode LOAD_FAST None pc=44 frame=17(0x153bad76e640)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=46)
commiting 17 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_438 : [#users=1] = placeholder[target=tensor_438]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_438,), kwargs = {})
    %tensor_440 : [#users=1] = placeholder[target=tensor_440]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_440), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 17 10
tracing opcode RETURN_VALUE None pc=76 frame=17(0x153bad76e640)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 10, 17] frame_id 17
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=66 frame=10(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:328
tracing opcode LOAD_FAST None pc=68 frame=10(0x8c422e0)
tracing opcode POP_JUMP_IF_FALSE None pc=70 frame=10(0x8c422e0)
tracing line /home/drc/frontend/test/test_model_deberta.py:331
tracing opcode LOAD_FAST None pc=80 frame=10(0x8c422e0)
tracing opcode JUMP_ABSOLUTE None pc=82 frame=10(0x8c422e0)
restart: running injected code (f_lasti=82)
commiting 10 0 36 [32mRETURN_VALUE[0m(None, None)  82
callee is full graph, merge to caller
to merge graph graph():
    %tensor_415 : [#users=2] = placeholder[target=tensor_415]
    %tensor_416 : [#users=1] = placeholder[target=tensor_416]
    %tensor_417 : [#users=1] = placeholder[target=tensor_417]
    %in_proj : [#users=1] = call_module[target=self.in_proj](args = (%tensor_415,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_417, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_423 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_423, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_416, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_435 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_435), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_415), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_7 : [#users=0] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
to merge frameid 10 9
tracing opcode RETURN_VALUE None pc=116 frame=10(0x8c422e0)
restart: running injected code (f_lasti=116)
before pop_tracker [0, 4, 9, 10] frame_id 10
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=30 frame=9(0x11c078f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:389
tracing opcode LOAD_FAST None pc=32 frame=9(0x11c078f0)
tracing opcode POP_JUMP_IF_FALSE None pc=34 frame=9(0x11c078f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:391
tracing opcode LOAD_FAST None pc=44 frame=9(0x11c078f0)
tracing opcode LOAD_METHOD None pc=46 frame=9(0x11c078f0)
tracing opcode LOAD_FAST None pc=48 frame=9(0x11c078f0)
tracing opcode CALL_METHOD None pc=50 frame=9(0x11c078f0)
run into user defined function DebertaIntermediate(
  (dense): Linear(in_features=768, out_features=3072, bias=True)
  (intermediate_act_fn): GELUActivation()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 18 0x153bc0a4ca40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(2, disable_trace) 
1: [32mLOAD_CONST[0m(1, 18) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(34, 34)  -> inst 17
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, intermediate_act_fn) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(1, hidden_states) 
16: [32mJUMP_ABSOLUTE[0m(62, 62)  -> inst 31
17: [32mLOAD_GLOBAL[0m(5, guard_match) 
18: [32mLOAD_CONST[0m(1, 18) 
19: [32mLOAD_CONST[0m(2, 0) 
20: [32mLOAD_GLOBAL[0m(6, locals) 
21: [32mCALL_FUNCTION[0m(0, 0) 
22: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
23: [32mUNPACK_SEQUENCE[0m(2, 2) 
24: [32mSTORE_FAST[0m(3, __case_idx) 
25: [32mSTORE_FAST[0m(2, __graph_fn) 
26: [32mLOAD_GLOBAL[0m(3, enable_trace) 
27: [32mLOAD_CONST[0m(1, 18) 
28: [32mCALL_FUNCTION[0m(1, 1) 
29: [32mPOP_TOP[0m(None, None) 
30: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
31: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:344
tracing opcode LOAD_GLOBAL None pc=0 frame=18(0x153a3c2b2440)
push tracker due to record
push tracker 18 frame 0x153a3c2b2440 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=18(0x153a3c2b2440)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=18(0x153a3c2b2440)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18] frame_id 18
enable_trace
push tracker 18 frame 0x153a3c2b2440 frame_id 18 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18]
tracing opcode POP_TOP None pc=58 frame=18(0x153a3c2b2440)
restart: running injected code (f_lasti=58)
tracing opcode JUMP_ABSOLUTE None pc=60 frame=18(0x153a3c2b2440)
restart: running injected code (f_lasti=60)
tracing line /home/drc/frontend/test/test_model_deberta.py:345
tracing opcode LOAD_FAST None pc=10 frame=18(0x153a3c2b2440)
load fast: 23346415552592
tracing opcode LOAD_METHOD None pc=12 frame=18(0x153a3c2b2440)
tracing opcode LOAD_FAST None pc=14 frame=18(0x153a3c2b2440)
load fast: 23339732931184
tracing opcode CALL_METHOD None pc=16 frame=18(0x153a3c2b2440)
record function in graph Linear(in_features=768, out_features=3072, bias=True)
tracing opcode STORE_FAST None pc=18 frame=18(0x153a3c2b2440)
tracing line /home/drc/frontend/test/test_model_deberta.py:346
tracing opcode LOAD_FAST None pc=20 frame=18(0x153a3c2b2440)
tracing opcode LOAD_METHOD None pc=22 frame=18(0x153a3c2b2440)
tracing opcode LOAD_FAST None pc=24 frame=18(0x153a3c2b2440)
tracing opcode CALL_METHOD None pc=26 frame=18(0x153a3c2b2440)
run into user defined function GELUActivation()
preprocess frame /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py 19 0x153bc0ad7640 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(1, disable_trace) 
1: [32mLOAD_CONST[0m(1, 19) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(20, 20)  -> inst 10
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, act) 
7: [33mLOAD_FAST[0m(1, input) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
10: [32mLOAD_GLOBAL[0m(4, guard_match) 
11: [32mLOAD_CONST[0m(1, 19) 
12: [32mLOAD_CONST[0m(2, 0) 
13: [32mLOAD_GLOBAL[0m(5, locals) 
14: [32mCALL_FUNCTION[0m(0, 0) 
15: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
16: [32mUNPACK_SEQUENCE[0m(2, 2) 
17: [32mSTORE_FAST[0m(3, __case_idx) 
18: [32mSTORE_FAST[0m(2, __graph_fn) 
19: [32mLOAD_GLOBAL[0m(2, enable_trace) 
20: [32mLOAD_CONST[0m(1, 19) 
21: [32mCALL_FUNCTION[0m(1, 1) 
22: [32mPOP_TOP[0m(None, None) 
23: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
24: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_GLOBAL None pc=0 frame=19(0x14609310)
push tracker due to record
push tracker 19 frame 0x14609310 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=19(0x14609310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=19(0x14609310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
enable_trace
push tracker 19 frame 0x14609310 frame_id 19 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 18, 19]
tracing opcode POP_TOP None pc=44 frame=19(0x14609310)
restart: running injected code (f_lasti=44)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=19(0x14609310)
restart: running injected code (f_lasti=46)
tracing line /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py:77
tracing opcode LOAD_FAST None pc=10 frame=19(0x14609310)
load fast: 23346415552688
tracing opcode LOAD_METHOD None pc=12 frame=19(0x14609310)
tracing opcode LOAD_FAST None pc=14 frame=19(0x14609310)
load fast: 23339632208208
tracing opcode CALL_METHOD None pc=16 frame=19(0x14609310)
record function in graph <built-in function gelu>
tracing opcode JUMP_ABSOLUTE None pc=18 frame=19(0x14609310)
restart: running injected code (f_lasti=18)
commiting 19 0 4 [32mRETURN_VALUE[0m(None, None)  18
callee is full graph, merge to caller
to merge graph graph():
    %tensor_443 : [#users=1] = placeholder[target=tensor_443]
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%tensor_443,), kwargs = {})
to merge frameid 19 18
tracing opcode RETURN_VALUE None pc=48 frame=19(0x14609310)
restart: running injected code (f_lasti=48)
before pop_tracker [0, 4, 9, 18, 19] frame_id 19
tracing return in /home/drc/frontend-venv/lib/python3.9/site-packages/transformers/activations.py
tracing opcode STORE_FAST None pc=28 frame=18(0x153a3c2b2440)
tracing line /home/drc/frontend/test/test_model_deberta.py:347
tracing opcode LOAD_FAST None pc=30 frame=18(0x153a3c2b2440)
tracing opcode JUMP_ABSOLUTE None pc=32 frame=18(0x153a3c2b2440)
restart: running injected code (f_lasti=32)
commiting 18 0 11 [32mRETURN_VALUE[0m(None, None)  32
callee is full graph, merge to caller
to merge graph graph():
    %tensor_442 : [#users=1] = placeholder[target=tensor_442]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_442,), kwargs = {})
    %gelu : [#users=0] = call_function[target=torch._C._nn.gelu](args = (%dense,), kwargs = {})
to merge frameid 18 9
tracing opcode RETURN_VALUE None pc=62 frame=18(0x153a3c2b2440)
restart: running injected code (f_lasti=62)
before pop_tracker [0, 4, 9, 18] frame_id 18
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=52 frame=9(0x11c078f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:392
tracing opcode LOAD_FAST None pc=54 frame=9(0x11c078f0)
tracing opcode LOAD_METHOD None pc=56 frame=9(0x11c078f0)
tracing opcode LOAD_FAST None pc=58 frame=9(0x11c078f0)
tracing opcode LOAD_FAST None pc=60 frame=9(0x11c078f0)
tracing opcode CALL_METHOD None pc=62 frame=9(0x11c078f0)
run into user defined function DebertaOutput(
  (dense): Linear(in_features=3072, out_features=768, bias=True)
  (LayerNorm): DebertaLayerNorm()
  (dropout): StableDropout()
)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 20 0x153bc2c5c9f0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(3, disable_trace) 
1: [32mLOAD_CONST[0m(1, 20) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(48, 48)  -> inst 24
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_METHOD[0m(0, dense) 
7: [33mLOAD_FAST[0m(1, hidden_states) 
8: [33mCALL_METHOD[0m(1, 1) 
9: [33mSTORE_FAST[0m(1, hidden_states) 
10: [33mLOAD_FAST[0m(0, self) 
11: [33mLOAD_METHOD[0m(1, dropout) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mCALL_METHOD[0m(1, 1) 
14: [33mSTORE_FAST[0m(1, hidden_states) 
15: [33mLOAD_FAST[0m(0, self) 
16: [33mLOAD_METHOD[0m(2, LayerNorm) 
17: [33mLOAD_FAST[0m(1, hidden_states) 
18: [33mLOAD_FAST[0m(2, input_tensor) 
19: [33mBINARY_ADD[0m(None, None) 
20: [33mCALL_METHOD[0m(1, 1) 
21: [33mSTORE_FAST[0m(1, hidden_states) 
22: [33mLOAD_FAST[0m(1, hidden_states) 
23: [32mJUMP_ABSOLUTE[0m(76, 76)  -> inst 38
24: [32mLOAD_GLOBAL[0m(6, guard_match) 
25: [32mLOAD_CONST[0m(1, 20) 
26: [32mLOAD_CONST[0m(2, 0) 
27: [32mLOAD_GLOBAL[0m(7, locals) 
28: [32mCALL_FUNCTION[0m(0, 0) 
29: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
30: [32mUNPACK_SEQUENCE[0m(2, 2) 
31: [32mSTORE_FAST[0m(4, __case_idx) 
32: [32mSTORE_FAST[0m(3, __graph_fn) 
33: [32mLOAD_GLOBAL[0m(4, enable_trace) 
34: [32mLOAD_CONST[0m(1, 20) 
35: [32mCALL_FUNCTION[0m(1, 1) 
36: [32mPOP_TOP[0m(None, None) 
37: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
38: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:358
tracing opcode LOAD_GLOBAL None pc=0 frame=20(0x10e79b20)
push tracker due to record
push tracker 20 frame 0x10e79b20 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=20(0x10e79b20)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=20(0x10e79b20)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20] frame_id 20
enable_trace
push tracker 20 frame 0x10e79b20 frame_id 20 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20]
tracing opcode POP_TOP None pc=72 frame=20(0x10e79b20)
restart: running injected code (f_lasti=72)
tracing opcode JUMP_ABSOLUTE None pc=74 frame=20(0x10e79b20)
restart: running injected code (f_lasti=74)
tracing line /home/drc/frontend/test/test_model_deberta.py:359
tracing opcode LOAD_FAST None pc=10 frame=20(0x10e79b20)
load fast: 23346415552736
tracing opcode LOAD_METHOD None pc=12 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=14 frame=20(0x10e79b20)
load fast: 23339632253664
tracing opcode CALL_METHOD None pc=16 frame=20(0x10e79b20)
record function in graph Linear(in_features=3072, out_features=768, bias=True)
tracing opcode STORE_FAST None pc=18 frame=20(0x10e79b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:360
tracing opcode LOAD_FAST None pc=20 frame=20(0x10e79b20)
tracing opcode LOAD_METHOD None pc=22 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=24 frame=20(0x10e79b20)
tracing opcode CALL_METHOD None pc=26 frame=20(0x10e79b20)
run into user defined function StableDropout()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 3 0x153bc2c33e40 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(5, disable_trace) 
1: [32mLOAD_CONST[0m(2, 3) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(46, 46)  -> inst 23
5: [33mLOAD_FAST[0m(0, self) 
6: [33mLOAD_ATTR[0m(0, training) 
7: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
8: [33mLOAD_FAST[0m(0, self) 
9: [33mLOAD_ATTR[0m(1, drop_prob) 
10: [33mLOAD_CONST[0m(1, 0) 
11: [33mCOMPARE_OP[0m(4, >) 
12: [33mPOP_JUMP_IF_FALSE[0m(42, 42)  -> inst 21
13: [33mLOAD_GLOBAL[0m(2, XDropout) 
14: [33mLOAD_METHOD[0m(3, apply) 
15: [33mLOAD_FAST[0m(1, x) 
16: [33mLOAD_FAST[0m(0, self) 
17: [33mLOAD_METHOD[0m(4, get_context) 
18: [33mCALL_METHOD[0m(0, 0) 
19: [33mCALL_METHOD[0m(2, 2) 
20: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
21: [33mLOAD_FAST[0m(1, x) 
22: [32mJUMP_ABSOLUTE[0m(74, 74)  -> inst 37
23: [32mLOAD_GLOBAL[0m(8, guard_match) 
24: [32mLOAD_CONST[0m(2, 3) 
25: [32mLOAD_CONST[0m(1, 0) 
26: [32mLOAD_GLOBAL[0m(9, locals) 
27: [32mCALL_FUNCTION[0m(0, 0) 
28: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
29: [32mUNPACK_SEQUENCE[0m(2, 2) 
30: [32mSTORE_FAST[0m(3, __case_idx) 
31: [32mSTORE_FAST[0m(2, __graph_fn) 
32: [32mLOAD_GLOBAL[0m(6, enable_trace) 
33: [32mLOAD_CONST[0m(2, 3) 
34: [32mCALL_FUNCTION[0m(1, 1) 
35: [32mPOP_TOP[0m(None, None) 
36: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
37: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:229
tracing opcode LOAD_GLOBAL None pc=0 frame=3(0x8c65fb0)
push tracker due to record
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
enable_trace
push tracker 3 frame 0x8c65fb0 frame_id 3 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 3]
tracing opcode POP_TOP None pc=70 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=70)
tracing opcode JUMP_ABSOLUTE None pc=72 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=72)
tracing line /home/drc/frontend/test/test_model_deberta.py:236
tracing opcode LOAD_FAST None pc=10 frame=3(0x8c65fb0)
load fast: 23346415552880
tracing opcode LOAD_ATTR None pc=12 frame=3(0x8c65fb0)
tracing opcode POP_JUMP_IF_FALSE None pc=14 frame=3(0x8c65fb0)
tracing line /home/drc/frontend/test/test_model_deberta.py:238
tracing opcode LOAD_FAST None pc=42 frame=3(0x8c65fb0)
load fast: 23345521088928
tracing opcode JUMP_ABSOLUTE None pc=44 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=44)
commiting 3 0 17 [32mRETURN_VALUE[0m(None, None)  44
callee is full graph, merge to caller
to merge graph graph():
    %tensor_445 : [#users=0] = placeholder[target=tensor_445]
to merge frameid 3 20
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['x']], extract_code_hashs={8313641004175655704}, obj=tensor([[[ 0.1862,  0.3517, -0.2582,  ..., -1.1625, -0.4400,  0.1940],
         [ 0.3340,  0.2341, -0.2360,  ..., -0.2042, -0.4618,  0.2805],
         [ 0.1637, -0.1221, -0.1568,  ..., -0.5437, -0.0574,  0.0126],
         ...,
         [ 0.2298,  0.4089, -0.1897,  ...,  0.0523, -0.4161,  0.3333],
         [-0.1161,  0.2916, -0.3142,  ...,  0.1161, -0.2399,  0.1731],
         [-0.2731,  0.3644, -0.9105,  ..., -0.1894, -0.0750,  0.1660]]]), modified_attrs={}, prev=None) 23340396576672 23345521088928
obj: tensor([[[ 0.1862,  0.3517, -0.2582,  ..., -1.1625, -0.4400,  0.1940],
         [ 0.3340,  0.2341, -0.2360,  ..., -0.2042, -0.4618,  0.2805],
         [ 0.1637, -0.1221, -0.1568,  ..., -0.5437, -0.0574,  0.0126],
         ...,
         [ 0.2298,  0.4089, -0.1897,  ...,  0.0523, -0.4161,  0.3333],
         [-0.1161,  0.2916, -0.3142,  ...,  0.1161, -0.2399,  0.1731],
         [-0.2731,  0.3644, -0.9105,  ..., -0.1894, -0.0750,  0.1660]]]) 23345521088928
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[ 0.1862,  0.3517, -0.2582,  ..., -1.1625, -0.4400,  0.1940],
         [ 0.3340,  0.2341, -0.2360,  ..., -0.2042, -0.4618,  0.2805],
         [ 0.1637, -0.1221, -0.1568,  ..., -0.5437, -0.0574,  0.0126],
         ...,
         [ 0.2298,  0.4089, -0.1897,  ...,  0.0523, -0.4161,  0.3333],
         [-0.1161,  0.2916, -0.3142,  ...,  0.1161, -0.2399,  0.1731],
         [-0.2731,  0.3644, -0.9105,  ..., -0.1894, -0.0750,  0.1660]]]), modified_attrs={}, prev=None) 23344548699632
tracing opcode RETURN_VALUE None pc=74 frame=3(0x8c65fb0)
restart: running injected code (f_lasti=74)
before pop_tracker [0, 4, 9, 20, 3] frame_id 3
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=28 frame=20(0x10e79b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:361
tracing opcode LOAD_FAST None pc=30 frame=20(0x10e79b20)
tracing opcode LOAD_METHOD None pc=32 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=34 frame=20(0x10e79b20)
tracing opcode LOAD_FAST None pc=36 frame=20(0x10e79b20)
load fast: 23339732931184
tracing opcode BINARY_ADD None pc=38 frame=20(0x10e79b20)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=40 frame=20(0x10e79b20)
run into user defined function DebertaLayerNorm()
preprocess frame /home/drc/frontend/test/test_model_deberta.py 2 0x7de54c0 forward
old bytecode: 

0: [32mLOAD_GLOBAL[0m(10, disable_trace) 
1: [32mLOAD_CONST[0m(4, 2) 
2: [32mCALL_FUNCTION[0m(1, 1) 
3: [32mPOP_TOP[0m(None, None) 
4: [32mJUMP_ABSOLUTE[0m(116, 116)  -> inst 58
5: [33mLOAD_FAST[0m(1, hidden_states) 
6: [33mLOAD_ATTR[0m(0, dtype) 
7: [33mSTORE_FAST[0m(2, input_type) 
8: [33mLOAD_FAST[0m(1, hidden_states) 
9: [33mLOAD_METHOD[0m(1, float) 
10: [33mCALL_METHOD[0m(0, 0) 
11: [33mSTORE_FAST[0m(1, hidden_states) 
12: [33mLOAD_FAST[0m(1, hidden_states) 
13: [33mLOAD_ATTR[0m(2, mean) 
14: [33mLOAD_CONST[0m(1, -1) 
15: [33mLOAD_CONST[0m(3, True) 
16: [33mLOAD_CONST[0m(0, ('keepdim',)) 
17: [33mCALL_FUNCTION_KW[0m(2, 2) 
18: [33mSTORE_FAST[0m(3, mean) 
19: [33mLOAD_FAST[0m(1, hidden_states) 
20: [33mLOAD_FAST[0m(3, mean) 
21: [33mBINARY_SUBTRACT[0m(None, None) 
22: [33mLOAD_METHOD[0m(3, pow) 
23: [33mLOAD_CONST[0m(4, 2) 
24: [33mCALL_METHOD[0m(1, 1) 
25: [33mLOAD_ATTR[0m(2, mean) 
26: [33mLOAD_CONST[0m(1, -1) 
27: [33mLOAD_CONST[0m(3, True) 
28: [33mLOAD_CONST[0m(0, ('keepdim',)) 
29: [33mCALL_FUNCTION_KW[0m(2, 2) 
30: [33mSTORE_FAST[0m(4, variance) 
31: [33mLOAD_FAST[0m(1, hidden_states) 
32: [33mLOAD_FAST[0m(3, mean) 
33: [33mBINARY_SUBTRACT[0m(None, None) 
34: [33mLOAD_GLOBAL[0m(4, torch) 
35: [33mLOAD_METHOD[0m(5, sqrt) 
36: [33mLOAD_FAST[0m(4, variance) 
37: [33mLOAD_FAST[0m(0, self) 
38: [33mLOAD_ATTR[0m(6, variance_epsilon) 
39: [33mBINARY_ADD[0m(None, None) 
40: [33mCALL_METHOD[0m(1, 1) 
41: [33mBINARY_TRUE_DIVIDE[0m(None, None) 
42: [33mSTORE_FAST[0m(1, hidden_states) 
43: [33mLOAD_FAST[0m(1, hidden_states) 
44: [33mLOAD_METHOD[0m(7, to) 
45: [33mLOAD_FAST[0m(2, input_type) 
46: [33mCALL_METHOD[0m(1, 1) 
47: [33mSTORE_FAST[0m(1, hidden_states) 
48: [33mLOAD_FAST[0m(0, self) 
49: [33mLOAD_ATTR[0m(8, weight) 
50: [33mLOAD_FAST[0m(1, hidden_states) 
51: [33mBINARY_MULTIPLY[0m(None, None) 
52: [33mLOAD_FAST[0m(0, self) 
53: [33mLOAD_ATTR[0m(9, bias) 
54: [33mBINARY_ADD[0m(None, None) 
55: [33mSTORE_FAST[0m(5, y) 
56: [33mLOAD_FAST[0m(5, y) 
57: [32mJUMP_ABSOLUTE[0m(144, 144)  -> inst 72
58: [32mLOAD_GLOBAL[0m(13, guard_match) 
59: [32mLOAD_CONST[0m(4, 2) 
60: [32mLOAD_CONST[0m(5, 0) 
61: [32mLOAD_GLOBAL[0m(14, locals) 
62: [32mCALL_FUNCTION[0m(0, 0) 
63: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
64: [32mUNPACK_SEQUENCE[0m(2, 2) 
65: [32mSTORE_FAST[0m(7, __case_idx) 
66: [32mSTORE_FAST[0m(6, __graph_fn) 
67: [32mLOAD_GLOBAL[0m(11, enable_trace) 
68: [32mLOAD_CONST[0m(4, 2) 
69: [32mCALL_FUNCTION[0m(1, 1) 
70: [32mPOP_TOP[0m(None, None) 
71: [32mJUMP_ABSOLUTE[0m(10, 10)  -> inst 5
72: [32mRETURN_VALUE[0m(None, None) 

tracing line /home/drc/frontend/test/test_model_deberta.py:273
tracing opcode LOAD_GLOBAL None pc=0 frame=2(0xe971310)
push tracker due to record
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
restart: running injected code (f_lasti=0)
tracing opcode LOAD_CONST None pc=2 frame=2(0xe971310)
restart: running injected code (f_lasti=2)
tracing opcode CALL_FUNCTION None pc=4 frame=2(0xe971310)
restart: running injected code (f_lasti=4)
disable_trace
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
enable_trace
push tracker 2 frame 0xe971310 frame_id 2 read_stack False cf_info <class 'NoneType'> all [0, 4, 9, 20, 2]
tracing opcode POP_TOP None pc=140 frame=2(0xe971310)
restart: running injected code (f_lasti=140)
tracing opcode JUMP_ABSOLUTE None pc=142 frame=2(0xe971310)
restart: running injected code (f_lasti=142)
tracing line /home/drc/frontend/test/test_model_deberta.py:274
tracing opcode LOAD_FAST None pc=10 frame=2(0xe971310)
load fast: 23343818499392
tracing opcode LOAD_ATTR None pc=12 frame=2(0xe971310)
tracing opcode STORE_FAST None pc=14 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:275
tracing opcode LOAD_FAST None pc=16 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=18 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=20 frame=2(0xe971310)
record function in graph <method 'float' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=22 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:276
tracing opcode LOAD_FAST None pc=24 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=26 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=28 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=30 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=32 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=34 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153b28026540>
tracing opcode STORE_FAST None pc=36 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:277
tracing opcode LOAD_FAST None pc=38 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=40 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=42 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_METHOD None pc=44 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=46 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=48 frame=2(0xe971310)
fetch:  2 <class 'int'>
record function in graph <method 'pow' of 'torch._C._TensorBase' objects>
tracing opcode LOAD_ATTR None pc=50 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=52 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=54 frame=2(0xe971310)
tracing opcode LOAD_CONST None pc=56 frame=2(0xe971310)
tracing opcode CALL_FUNCTION_KW None pc=58 frame=2(0xe971310)
record function in graph <built-in method mean of Tensor object at 0x153bc0b9eb80>
tracing opcode STORE_FAST None pc=60 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:278
tracing opcode LOAD_FAST None pc=62 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=64 frame=2(0xe971310)
tracing opcode BINARY_SUBTRACT None pc=66 frame=2(0xe971310)
record function in graph <built-in function sub>
tracing opcode LOAD_GLOBAL None pc=68 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=70 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=72 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=74 frame=2(0xe971310)
load fast: 23346415552832
tracing opcode LOAD_ATTR None pc=76 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=78 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode CALL_METHOD None pc=80 frame=2(0xe971310)
record function in graph <built-in method sqrt of type object at 0x153c4f4a4880>
tracing opcode BINARY_TRUE_DIVIDE None pc=82 frame=2(0xe971310)
record function in graph <built-in function truediv>
tracing opcode STORE_FAST None pc=84 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:279
tracing opcode LOAD_FAST None pc=86 frame=2(0xe971310)
tracing opcode LOAD_METHOD None pc=88 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=90 frame=2(0xe971310)
tracing opcode CALL_METHOD None pc=92 frame=2(0xe971310)
record function in graph <method 'to' of 'torch._C._TensorBase' objects>
tracing opcode STORE_FAST None pc=94 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:280
tracing opcode LOAD_FAST None pc=96 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=98 frame=2(0xe971310)
tracing opcode LOAD_FAST None pc=100 frame=2(0xe971310)
tracing opcode BINARY_MULTIPLY None pc=102 frame=2(0xe971310)
record function in graph <built-in function mul>
tracing opcode LOAD_FAST None pc=104 frame=2(0xe971310)
tracing opcode LOAD_ATTR None pc=106 frame=2(0xe971310)
tracing opcode BINARY_ADD None pc=108 frame=2(0xe971310)
record function in graph <built-in function add>
tracing opcode STORE_FAST None pc=110 frame=2(0xe971310)
tracing line /home/drc/frontend/test/test_model_deberta.py:281
tracing opcode LOAD_FAST None pc=112 frame=2(0xe971310)
tracing opcode JUMP_ABSOLUTE None pc=114 frame=2(0xe971310)
restart: running injected code (f_lasti=114)
commiting 2 0 52 [32mRETURN_VALUE[0m(None, None)  114
callee is full graph, merge to caller
to merge graph graph():
    %tensor_447 : [#users=4] = placeholder[target=tensor_447]
    %float_1 : [#users=0] = call_method[target=float](args = (%tensor_447,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%tensor_447, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%tensor_447, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%tensor_447, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=bias]
    %add_1 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 2 20
[34m[warning] cannot find store pos in callee, skip guard check[0m TorchDtypeVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].dtype], extract_code_hashs={-1492364201629016260}, obj=torch.float32, modified_attrs={}, prev=None)
[34m[warning] cannot find store pos in callee, skip guard check[0m FunctionVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states'].mean], extract_code_hashs={8489489812351159108}, obj=<built-in method mean of Tensor object at 0x153b28026540>, modified_attrs={}, prev=None)
tracing opcode RETURN_VALUE None pc=144 frame=2(0xe971310)
restart: running injected code (f_lasti=144)
before pop_tracker [0, 4, 9, 20, 2] frame_id 2
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=42 frame=20(0x10e79b20)
tracing line /home/drc/frontend/test/test_model_deberta.py:362
tracing opcode LOAD_FAST None pc=44 frame=20(0x10e79b20)
tracing opcode JUMP_ABSOLUTE None pc=46 frame=20(0x10e79b20)
restart: running injected code (f_lasti=46)
commiting 20 0 18 [32mRETURN_VALUE[0m(None, None)  46
callee is full graph, merge to caller
to merge graph graph():
    %tensor_444 : [#users=1] = placeholder[target=tensor_444]
    %dense : [#users=1] = call_module[target=dense](args = (%tensor_444,), kwargs = {})
    %tensor_446 : [#users=1] = placeholder[target=tensor_446]
    %add : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_446), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add, %mean), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add_1,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=LayerNorm.bias]
    %add_2 : [#users=0] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
to merge frameid 20 9
tracing opcode RETURN_VALUE None pc=76 frame=20(0x10e79b20)
restart: running injected code (f_lasti=76)
before pop_tracker [0, 4, 9, 20] frame_id 20
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=64 frame=9(0x11c078f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:393
tracing opcode LOAD_FAST None pc=66 frame=9(0x11c078f0)
tracing opcode POP_JUMP_IF_FALSE None pc=68 frame=9(0x11c078f0)
tracing line /home/drc/frontend/test/test_model_deberta.py:396
tracing opcode LOAD_FAST None pc=78 frame=9(0x11c078f0)
tracing opcode JUMP_ABSOLUTE None pc=80 frame=9(0x11c078f0)
restart: running injected code (f_lasti=80)
commiting 9 0 35 [32mRETURN_VALUE[0m(None, None)  80
callee is full graph, merge to caller
to merge graph graph():
    %tensor_412 : [#users=2] = placeholder[target=tensor_412]
    %tensor_413 : [#users=1] = placeholder[target=tensor_413]
    %tensor_414 : [#users=1] = placeholder[target=tensor_414]
    %in_proj : [#users=1] = call_module[target=attention.self.in_proj](args = (%tensor_412,), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_1 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=attention.self.q_bias]
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%getitem_3, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=attention.self.v_bias]
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_4, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_1, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze : [#users=4] = call_method[target=unsqueeze](args = (%tensor_414, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=attention.self.__external_param__6]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_5, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=attention.self.pos_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=attention.self.pos_q_proj](args = (%unsqueeze_1,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %tensor_423 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor_423, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_1, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%tensor_413, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_435 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_435), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=attention.output.dense](args = (%view_5,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_412), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=attention.output.LayerNorm.weight]
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_2, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_2, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_3, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=output.LayerNorm.bias]
    %add_10 : [#users=0] = call_function[target=operator.add](args = (%mul_3, %bias_1), kwargs = {})
to merge frameid 9 4
tracing opcode RETURN_VALUE None pc=114 frame=9(0x11c078f0)
restart: running injected code (f_lasti=114)
before pop_tracker [0, 4, 9] frame_id 9
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=196 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:484
tracing opcode LOAD_DEREF None pc=198 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=200 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:487
tracing opcode LOAD_FAST None pc=210 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=212 frame=4(0x7de0fc0)
tracing opcode IS_OP None pc=214 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=216 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:492
tracing opcode LOAD_FAST None pc=274 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=276 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:494
tracing opcode LOAD_DEREF None pc=278 frame=4(0x7de0fc0)
tracing opcode POP_JUMP_IF_FALSE None pc=280 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:454
tracing opcode FOR_ITER None pc=102 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:497
tracing opcode LOAD_FAST None pc=294 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=296 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:498
tracing opcode LOAD_FAST None pc=300 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=302 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=304 frame=4(0x7de0fc0)
tracing opcode BINARY_ADD None pc=306 frame=4(0x7de0fc0)
tracing opcode STORE_FAST None pc=308 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:500
tracing opcode LOAD_FAST None pc=310 frame=4(0x7de0fc0)
tracing opcode EXTENDED_ARG None pc=312 frame=4(0x7de0fc0)
tracing line /home/drc/frontend/test/test_model_deberta.py:501
tracing opcode LOAD_GLOBAL None pc=316 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=318 frame=4(0x7de0fc0)
tracing opcode LOAD_CONST None pc=320 frame=4(0x7de0fc0)
tracing opcode MAKE_FUNCTION None pc=322 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=324 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=326 frame=4(0x7de0fc0)
tracing opcode LOAD_FAST None pc=328 frame=4(0x7de0fc0)
tracing opcode BUILD_TUPLE None pc=330 frame=4(0x7de0fc0)
tracing opcode GET_ITER None pc=332 frame=4(0x7de0fc0)
fetch:  (tensor([[[ 0.4186,  0.5426,  0.6940,  ..., -0.6678, -1.5092,  0.7814],
         [ 1.2343,  0.5733, -0.2966,  ..., -1.0547,  0.4952,  2.2875],
         [-1.3067,  0.6904,  0.3220,  ..., -1.7382, -1.2329,  1.3649],
         ...,
         [ 1.3000,  1.5730, -0.9127,  ..., -0.6530,  0.0760,  1.9931],
         [ 1.9489,  0.0645, -1.2444,  ...,  1.2270, -1.0421,  0.8862],
         [-1.1054,  0.5104, -0.5496,  ..., -1.8275,  0.1475,  0.6112]]]), (tensor([[[-0.4745,  0.4795, -0.6835,  ...,  0.7922, -0.1495,  1.2664],
         [-0.2552,  1.4093, -0.5182,  ..., -1.0163,  1.7162,  1.7644],
         [-0.3467,  1.4889,  0.7441,  ..., -0.3843,  1.3751,  1.3166],
         ...,
         [ 0.9130,  1.1131, -0.5668,  ...,  0.3879, -0.5664,  0.8270],
         [ 0.1326,  0.4045, -1.5836,  ...,  1.2737, -0.6294,  0.7159],
         [-1.8158,  1.1578, -0.8414,  ..., -1.4324, -0.1903, -0.1349]]]), tensor([[[-0.3477,  0.4350, -0.5275,  ...,  0.3209,  0.1533,  1.5576],
         [-0.8022,  1.2208, -0.6341,  ..., -0.8602,  2.0031,  1.5075],
         [-0.4762,  0.8144,  0.5852,  ..., -0.5906,  0.6893,  1.5314],
         ...,
         [ 0.3497,  1.0329, -1.0315,  ...,  0.3494, -0.4606,  0.9796],
         [-0.3540,  0.4487, -1.7219,  ...,  1.4860, -0.6553,  0.6034],
         [-2.2021,  0.4393, -0.7474,  ..., -1.5999,  0.1029,  0.2150]]]), tensor([[[-0.3007,  0.3556,  0.1881,  ..., -0.2287, -0.4247,  1.7482],
         [-0.0857,  1.0255, -0.1840,  ..., -0.9948,  1.8521,  1.2676],
         [-0.1877,  0.8684,  0.3900,  ..., -0.8821,  0.6245,  1.6574],
         ...,
         [ 0.3948,  0.6539, -0.4136,  ...,  0.3442, -0.7443,  0.9887],
         [ 0.2264,  0.4856, -1.8031,  ...,  1.0620,  0.1899,  0.6245],
         [-2.0228, -0.0978, -1.1979,  ..., -2.0539, -0.2117,  0.5869]]]), tensor([[[-0.9097,  0.3433, -0.5056,  ...,  0.2337, -0.8392,  1.5617],
         [-0.2995,  1.2405,  0.1374,  ..., -0.2874,  2.0664,  0.9240],
         [-0.6586,  1.2402,  0.6071,  ..., -1.1410,  0.1233,  2.3051],
         ...,
         [ 1.0162,  1.1572, -0.1314,  ...,  0.7285, -0.6907,  1.2920],
         [ 0.4174,  0.6652, -1.6930,  ...,  1.4341,  0.1021,  0.5276],
         [-2.0038, -0.5349, -0.7278,  ..., -2.3456, -0.0276,  0.8513]]]), tensor([[[-0.8642,  0.5875, -0.4100,  ...,  0.1832, -0.9126,  1.2483],
         [ 0.3765,  1.1238, -0.1378,  ...,  0.1778,  1.9348,  1.1948],
         [-0.7827,  0.8989,  0.3799,  ..., -0.9922,  0.2895,  2.5990],
         ...,
         [ 0.7973,  0.9659, -0.1809,  ...,  0.0463, -0.2524,  1.0688],
         [ 0.7964,  0.6999, -1.8202,  ...,  2.0060, -0.5084,  0.5040],
         [-2.1665, -0.6770, -0.3319,  ..., -1.3715, -0.0843, -0.1332]]]), tensor([[[-1.4317,  1.0938, -0.3720,  ...,  0.5998, -0.9889,  1.2866],
         [ 0.6154,  0.6695, -0.2853,  ...,  0.5307,  1.8412,  0.8177],
         [-0.9732,  0.5523,  0.5189,  ..., -1.3094,  0.4988,  2.4586],
         ...,
         [ 0.6792,  0.6787, -1.1377,  ...,  0.4751, -0.1282,  1.6220],
         [ 0.4495,  0.9642, -1.8222,  ...,  1.7091, -0.5122,  0.1811],
         [-1.9373, -0.2913, -0.4054,  ..., -1.7398,  0.1684, -0.6785]]]), tensor([[[-1.3803e+00,  6.3447e-01, -1.4614e-01,  ...,  8.4063e-01,
          -1.3117e+00,  1.0555e+00],
         [ 2.0161e-01,  6.2276e-01,  1.1840e-01,  ...,  4.2411e-01,
           1.6914e+00,  6.9350e-01],
         [-1.5477e+00,  3.0468e-01,  4.3323e-01,  ..., -1.0016e+00,
           9.3292e-02,  2.1731e+00],
         ...,
         [ 1.2643e-01,  1.0195e+00, -1.3830e+00,  ...,  2.9771e-01,
          -9.5135e-04,  1.4416e+00],
         [ 6.2623e-01,  5.9695e-01, -1.6826e+00,  ...,  1.3958e+00,
          -6.8355e-01,  1.1165e-01],
         [-9.0483e-01, -1.0727e-01, -8.5930e-01,  ..., -1.7972e+00,
          -2.4111e-01, -8.3651e-01]]]), tensor([[[-0.6774,  0.8710,  0.0525,  ...,  1.4621, -0.7548,  1.4757],
         [ 0.4874,  0.3889, -0.0082,  ...,  0.7529,  1.0325,  1.1570],
         [-1.8373,  0.4467,  0.4097,  ..., -0.7225,  0.1545,  2.9354],
         ...,
         [ 0.7691,  1.2878, -1.2643,  ..., -0.6486, -0.0118,  1.1598],
         [ 1.0106,  0.8437, -1.8721,  ...,  1.4272, -0.4432,  0.3202],
         [-1.1185, -0.1042, -0.2616,  ..., -2.0888,  0.1039,  0.1603]]]), tensor([[[-0.4622,  0.4695,  1.0245,  ...,  1.5830, -1.2363,  0.9581],
         [ 0.9198,  0.8677, -0.1785,  ...,  0.6709,  1.0328,  1.7800],
         [-2.2610,  1.2119,  0.6208,  ..., -0.9877, -0.1943,  2.9576],
         ...,
         [ 0.4409,  1.2695, -0.9984,  ..., -1.0099,  0.0296,  1.4008],
         [ 1.5637,  0.9317, -1.6244,  ...,  1.2113, -0.6841,  0.6017],
         [-0.9739, -0.2082, -0.2327,  ..., -1.4932, -0.2788,  0.3617]]]), tensor([[[-0.3437,  0.4146,  0.6466,  ...,  1.4529, -1.1697,  0.4109],
         [ 1.2823,  0.4221, -0.0882,  ...,  0.3116,  1.0880,  1.9300],
         [-2.0337,  0.9638,  0.4276,  ..., -0.7198,  0.0721,  2.2858],
         ...,
         [ 0.4270,  1.0589, -0.7282,  ..., -0.8506,  0.2019,  1.6166],
         [ 1.6538,  0.4731, -0.9414,  ...,  1.3076, -0.6555,  0.4390],
         [-1.0756, -0.3224, -0.3647,  ..., -1.4899, -0.2029,  0.2971]]]), tensor([[[-0.0943,  0.2427,  0.5594,  ...,  0.6573, -1.4302,  0.2919],
         [ 1.2665, -0.0036, -0.3148,  ..., -0.0501,  0.9928,  2.1155],
         [-1.9255,  0.8080,  0.0859,  ..., -0.8008, -0.4020,  2.1480],
         ...,
         [ 1.0634,  1.0941, -1.2459,  ..., -0.3536,  0.2731,  2.0066],
         [ 1.7142,  0.6971, -0.9888,  ...,  1.5479, -0.8428,  0.8658],
         [-0.6503,  0.1318,  0.2408,  ..., -1.2571, -0.3031,  0.5300]]]), tensor([[[ 0.1578,  0.2353,  0.8714,  ...,  0.7276, -1.2111,  0.7149],
         [ 0.8878,  0.3987, -0.2097,  ..., -0.6235,  0.9885,  2.2491],
         [-1.6427,  0.8487,  0.3459,  ..., -0.9864, -1.2476,  1.4788],
         ...,
         [ 1.0711,  1.2999, -0.9199,  ..., -0.4565,  0.4985,  1.8861],
         [ 2.0611, -0.2176, -1.1343,  ...,  1.4613, -0.8722,  0.8287],
         [-1.0081,  0.1777,  0.1918,  ..., -1.4550,  0.2061,  0.5474]]]), tensor([[[ 0.4186,  0.5426,  0.6940,  ..., -0.6678, -1.5092,  0.7814],
         [ 1.2343,  0.5733, -0.2966,  ..., -1.0547,  0.4952,  2.2875],
         [-1.3067,  0.6904,  0.3220,  ..., -1.7382, -1.2329,  1.3649],
         ...,
         [ 1.3000,  1.5730, -0.9127,  ..., -0.6530,  0.0760,  1.9931],
         [ 1.9489,  0.0645, -1.2444,  ...,  1.2270, -1.0421,  0.8862],
         [-1.1054,  0.5104, -0.5496,  ..., -1.8275,  0.1475,  0.6112]]])), None) <class 'tuple'>
tracing opcode CALL_FUNCTION None pc=334 frame=4(0x7de0fc0)
tracing opcode CALL_FUNCTION None pc=336 frame=4(0x7de0fc0)
fetch:  <generator object DebertaEncoder.forward.<locals>.<genexpr> at 0x153bd1122f90> <class 'generator'>
generate any for <generator object DebertaEncoder.forward.<locals>.<genexpr> at 0x153bd1122f90> <class 'generator'> []
tracing opcode EXTENDED_ARG None pc=338 frame=4(0x7de0fc0)
restart: running injected code (f_lasti=338)
commiting 4 0 162 [32mRETURN_VALUE[0m(None, None)  338
callee is full graph, merge to caller
to merge graph graph():
    %tensor_11 : [#users=1] = placeholder[target=tensor_11]
    %unsqueeze : [#users=1] = call_method[target=unsqueeze](args = (%tensor_11, 1), kwargs = {})
    %unsqueeze_1 : [#users=2] = call_method[target=unsqueeze](args = (%unsqueeze, 2), kwargs = {})
    %squeeze : [#users=1] = call_method[target=squeeze](args = (%unsqueeze_1, -2), kwargs = {})
    %unsqueeze_2 : [#users=1] = call_method[target=unsqueeze](args = (%squeeze, -1), kwargs = {})
    %mul : [#users=1] = call_function[target=operator.mul](args = (%unsqueeze_1, %unsqueeze_2), kwargs = {})
    %byte : [#users=12] = call_method[target=byte](args = (%mul,), kwargs = {})
    %tensor_13 : [#users=2] = placeholder[target=tensor_13]
    %arange : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %arange_1 : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %getitem : [#users=1] = call_function[target=operator.getitem](args = (%arange, [slice(None, None, None), None]), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%arange_1, 1, -1), kwargs = {})
    %repeat : [#users=1] = call_method[target=repeat](args = (%view, 256, 1), kwargs = {})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%getitem, %repeat), kwargs = {})
    %getitem_1 : [#users=1] = call_function[target=operator.getitem](args = (%sub, [slice(None, 256, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_3 : [#users=12] = call_method[target=unsqueeze](args = (%getitem_1, 0), kwargs = {})
    %in_proj : [#users=1] = call_module[target=layer.0.attention.self.in_proj](args = (%tensor_13,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_3 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_4 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=layer.0.attention.self.q_bias]
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_5, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%getitem_2, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=layer.0.attention.self.v_bias]
    %getitem_6 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%getitem_6, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%getitem_4, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_1 : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt : [#users=2] = call_function[target=torch.sqrt](args = (%mul_1,), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%sqrt,), kwargs = {dtype: torch.float32})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%add, %sqrt), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_3, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose), kwargs = {})
    %unsqueeze_4 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze_4,), kwargs = {})
    %to_1 : [#users=0] = call_method[target=to](args = (%unsqueeze_4, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_5 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_7, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=layer.0.attention.self.pos_proj](args = (%unsqueeze_5,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv, %transpose_1), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_4, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_2, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=layer.0.attention.self.pos_q_proj](args = (%unsqueeze_5,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_5, 0, 2, 1, 3), kwargs = {})
    %tensor_27 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%tensor_27, 3), kwargs = {})
    %sqrt_1 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_2,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_1), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_4,), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_3, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_3, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_3 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_3,), kwargs = {})
    %tensor_39 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_4, %invert, %tensor_39), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_1), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_6 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=layer.0.attention.output.dense](args = (%view_6,), kwargs = {})
    %add_5 : [#users=4] = call_function[target=operator.add](args = (%dense, %tensor_13), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%add_5,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%add_5, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub_1, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%add_5, %mean), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%add_6,), kwargs = {})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%sub_2, %sqrt_2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%truediv_1, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=layer.0.attention.output.LayerNorm.weight]
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv_1), kwargs = {})
    %bias : [#users=1] = get_attr[target=layer.0.attention.output.LayerNorm.bias]
    %add_7 : [#users=2] = call_function[target=operator.add](args = (%mul_3, %bias), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=layer.0.intermediate.dense](args = (%add_7,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=layer.0.output.dense](args = (%gelu,), kwargs = {})
    %add_8 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_7), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_8,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_8, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_3, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_4 : [#users=1] = call_function[target=operator.sub](args = (%add_8, %mean_2), kwargs = {})
    %add_9 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_9,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_4, %sqrt_3), kwargs = {})
    %to_5 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=layer.0.output.LayerNorm.weight]
    %mul_4 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=layer.0.output.LayerNorm.bias]
    %add_10 : [#users=2] = call_function[target=operator.add](args = (%mul_4, %bias_1), kwargs = {})
    %in_proj_1 : [#users=1] = call_module[target=layer.1.attention.self.in_proj](args = (%add_10,), kwargs = {})
    %view_7 : [#users=1] = call_method[target=view](args = (%in_proj_1, [1, 256, 12, -1]), kwargs = {})
    %permute_6 : [#users=1] = call_method[target=permute](args = (%view_7, 0, 2, 1, 3), kwargs = {})
    %chunk_1 : [#users=3] = call_method[target=chunk](args = (%permute_6, 3), kwargs = {dim: -1})
    %getitem_8 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_1, 0), kwargs = {})
    %getitem_9 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_1, 1), kwargs = {})
    %getitem_10 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_1, 2), kwargs = {})
    %q_bias_1 : [#users=1] = get_attr[target=layer.1.attention.self.q_bias]
    %getitem_11 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_1, [None, None, slice(None, None, None)]), kwargs = {})
    %view_8 : [#users=1] = call_method[target=view](args = (%getitem_11, [1, 1, 12, -1]), kwargs = {})
    %permute_7 : [#users=1] = call_method[target=permute](args = (%view_8, 0, 2, 1, 3), kwargs = {})
    %add_11 : [#users=1] = call_function[target=operator.add](args = (%getitem_8, %permute_7), kwargs = {})
    %v_bias_1 : [#users=1] = get_attr[target=layer.1.attention.self.v_bias]
    %getitem_12 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_1, [None, None, slice(None, None, None)]), kwargs = {})
    %view_9 : [#users=1] = call_method[target=view](args = (%getitem_12, [1, 1, 12, -1]), kwargs = {})
    %permute_8 : [#users=1] = call_method[target=permute](args = (%view_9, 0, 2, 1, 3), kwargs = {})
    %add_12 : [#users=1] = call_function[target=operator.add](args = (%getitem_10, %permute_8), kwargs = {})
    %tensor_40 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_5 : [#users=1] = call_function[target=operator.mul](args = (%tensor_40, 3), kwargs = {})
    %sqrt_4 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_5,), kwargs = {})
    %to_6 : [#users=0] = call_method[target=to](args = (%sqrt_4,), kwargs = {dtype: torch.float32})
    %truediv_3 : [#users=2] = call_function[target=operator.truediv](args = (%add_11, %sqrt_4), kwargs = {})
    %transpose_4 : [#users=1] = call_method[target=transpose](args = (%getitem_9, -1, -2), kwargs = {})
    %matmul_4 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_3, %transpose_4), kwargs = {})
    %unsqueeze_6 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_1 : [#users=0] = call_method[target=long](args = (%unsqueeze_6,), kwargs = {})
    %to_7 : [#users=0] = call_method[target=to](args = (%unsqueeze_6, cpu), kwargs = {})
    %__external_param__7 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_13 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__7, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_7 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_13, 0), kwargs = {})
    %pos_proj_1 : [#users=1] = call_module[target=layer.1.attention.self.pos_proj](args = (%unsqueeze_7,), kwargs = {})
    %view_10 : [#users=1] = call_method[target=view](args = (%pos_proj_1, [1, 512, 12, -1]), kwargs = {})
    %permute_9 : [#users=1] = call_method[target=permute](args = (%view_10, 0, 2, 1, 3), kwargs = {})
    %transpose_5 : [#users=1] = call_method[target=transpose](args = (%permute_9, -1, -2), kwargs = {})
    %matmul_5 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_3, %transpose_5), kwargs = {})
    %add_13 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_6, 256), kwargs = {})
    %clamp_2 : [#users=1] = call_function[target=torch.clamp](args = (%add_13, 0, 511), kwargs = {})
    %expand_2 : [#users=1] = call_method[target=expand](args = (%clamp_2, [1, 12, 256, 256]), kwargs = {})
    %gather_2 : [#users=2] = call_function[target=torch.gather](args = (%matmul_5,), kwargs = {dim: -1, index: %expand_2})
    %full_like_1 : [#users=1] = call_function[target=torch.full_like](args = (%gather_2, 0), kwargs = {})
    %iadd_2 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_1, %gather_2), kwargs = {})
    %pos_q_proj_1 : [#users=1] = call_module[target=layer.1.attention.self.pos_q_proj](args = (%unsqueeze_7,), kwargs = {})
    %view_11 : [#users=1] = call_method[target=view](args = (%pos_q_proj_1, [1, 512, 12, -1]), kwargs = {})
    %permute_10 : [#users=1] = call_method[target=permute](args = (%view_11, 0, 2, 1, 3), kwargs = {})
    %tensor_63 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_6 : [#users=1] = call_function[target=operator.mul](args = (%tensor_63, 3), kwargs = {})
    %sqrt_5 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_6,), kwargs = {})
    %itruediv_1 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_10, %sqrt_5), kwargs = {})
    %neg_1 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_6,), kwargs = {})
    %add_14 : [#users=1] = call_function[target=operator.add](args = (%neg_1, 256), kwargs = {})
    %clamp_3 : [#users=1] = call_function[target=torch.clamp](args = (%add_14, 0, 511), kwargs = {})
    %transpose_6 : [#users=2] = call_method[target=transpose](args = (%itruediv_1, -1, -2), kwargs = {})
    %to_8 : [#users=0] = call_method[target=to](args = (%transpose_6,), kwargs = {dtype: torch.float32})
    %matmul_6 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_9, %transpose_6), kwargs = {})
    %expand_3 : [#users=1] = call_method[target=expand](args = (%clamp_3, [1, 12, 256, 256]), kwargs = {})
    %gather_3 : [#users=1] = call_function[target=torch.gather](args = (%matmul_6,), kwargs = {dim: -1, index: %expand_3})
    %transpose_7 : [#users=1] = call_method[target=transpose](args = (%gather_3, -1, -2), kwargs = {})
    %iadd_3 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_2, %transpose_7), kwargs = {})
    %add_15 : [#users=1] = call_function[target=operator.add](args = (%matmul_4, %iadd_3), kwargs = {})
    %to_9 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_1 : [#users=2] = call_function[target=operator.invert](args = (%to_9,), kwargs = {})
    %tensor_75 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_1 : [#users=1] = call_method[target=masked_fill](args = (%add_15, %invert_1, %tensor_75), kwargs = {})
    %softmax_1 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_1, -1), kwargs = {})
    %masked_fill__1 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_1, %invert_1, 0), kwargs = {})
    %matmul_7 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_1, %add_12), kwargs = {})
    %permute_11 : [#users=1] = call_method[target=permute](args = (%matmul_7, 0, 2, 1, 3), kwargs = {})
    %contiguous_1 : [#users=1] = call_method[target=contiguous](args = (%permute_11,), kwargs = {})
    %view_12 : [#users=1] = call_method[target=view](args = (%contiguous_1, [1, 256, -1]), kwargs = {})
    %dense_3 : [#users=1] = call_module[target=layer.1.attention.output.dense](args = (%view_12,), kwargs = {})
    %add_16 : [#users=4] = call_function[target=operator.add](args = (%dense_3, %add_10), kwargs = {})
    %float_3 : [#users=0] = call_method[target=float](args = (%add_16,), kwargs = {})
    %mean_4 : [#users=2] = call_method[target=mean](args = (%add_16, -1), kwargs = {keepdim: True})
    %sub_5 : [#users=1] = call_function[target=operator.sub](args = (%add_16, %mean_4), kwargs = {})
    %pow_3 : [#users=1] = call_method[target=pow](args = (%sub_5, 2), kwargs = {})
    %mean_5 : [#users=1] = call_method[target=mean](args = (%pow_3, -1), kwargs = {keepdim: True})
    %sub_6 : [#users=1] = call_function[target=operator.sub](args = (%add_16, %mean_4), kwargs = {})
    %add_17 : [#users=1] = call_function[target=operator.add](args = (%mean_5, 1e-07), kwargs = {})
    %sqrt_6 : [#users=1] = call_function[target=torch.sqrt](args = (%add_17,), kwargs = {})
    %truediv_4 : [#users=2] = call_function[target=operator.truediv](args = (%sub_6, %sqrt_6), kwargs = {})
    %to_10 : [#users=0] = call_method[target=to](args = (%truediv_4, torch.float32), kwargs = {})
    %weight_2 : [#users=1] = get_attr[target=layer.1.attention.output.LayerNorm.weight]
    %mul_7 : [#users=1] = call_function[target=operator.mul](args = (%weight_2, %truediv_4), kwargs = {})
    %bias_2 : [#users=1] = get_attr[target=layer.1.attention.output.LayerNorm.bias]
    %add_18 : [#users=2] = call_function[target=operator.add](args = (%mul_7, %bias_2), kwargs = {})
    %dense_4 : [#users=1] = call_module[target=layer.1.intermediate.dense](args = (%add_18,), kwargs = {})
    %gelu_1 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_4,), kwargs = {})
    %dense_5 : [#users=1] = call_module[target=layer.1.output.dense](args = (%gelu_1,), kwargs = {})
    %add_19 : [#users=4] = call_function[target=operator.add](args = (%dense_5, %add_18), kwargs = {})
    %float_4 : [#users=0] = call_method[target=float](args = (%add_19,), kwargs = {})
    %mean_6 : [#users=2] = call_method[target=mean](args = (%add_19, -1), kwargs = {keepdim: True})
    %sub_7 : [#users=1] = call_function[target=operator.sub](args = (%add_19, %mean_6), kwargs = {})
    %pow_4 : [#users=1] = call_method[target=pow](args = (%sub_7, 2), kwargs = {})
    %mean_7 : [#users=1] = call_method[target=mean](args = (%pow_4, -1), kwargs = {keepdim: True})
    %sub_8 : [#users=1] = call_function[target=operator.sub](args = (%add_19, %mean_6), kwargs = {})
    %add_20 : [#users=1] = call_function[target=operator.add](args = (%mean_7, 1e-07), kwargs = {})
    %sqrt_7 : [#users=1] = call_function[target=torch.sqrt](args = (%add_20,), kwargs = {})
    %truediv_5 : [#users=2] = call_function[target=operator.truediv](args = (%sub_8, %sqrt_7), kwargs = {})
    %to_11 : [#users=0] = call_method[target=to](args = (%truediv_5, torch.float32), kwargs = {})
    %weight_3 : [#users=1] = get_attr[target=layer.1.output.LayerNorm.weight]
    %mul_8 : [#users=1] = call_function[target=operator.mul](args = (%weight_3, %truediv_5), kwargs = {})
    %bias_3 : [#users=1] = get_attr[target=layer.1.output.LayerNorm.bias]
    %add_21 : [#users=2] = call_function[target=operator.add](args = (%mul_8, %bias_3), kwargs = {})
    %in_proj_2 : [#users=1] = call_module[target=layer.2.attention.self.in_proj](args = (%add_21,), kwargs = {})
    %view_13 : [#users=1] = call_method[target=view](args = (%in_proj_2, [1, 256, 12, -1]), kwargs = {})
    %permute_12 : [#users=1] = call_method[target=permute](args = (%view_13, 0, 2, 1, 3), kwargs = {})
    %chunk_2 : [#users=3] = call_method[target=chunk](args = (%permute_12, 3), kwargs = {dim: -1})
    %getitem_14 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_2, 0), kwargs = {})
    %getitem_15 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_2, 1), kwargs = {})
    %getitem_16 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_2, 2), kwargs = {})
    %q_bias_2 : [#users=1] = get_attr[target=layer.2.attention.self.q_bias]
    %getitem_17 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_2, [None, None, slice(None, None, None)]), kwargs = {})
    %view_14 : [#users=1] = call_method[target=view](args = (%getitem_17, [1, 1, 12, -1]), kwargs = {})
    %permute_13 : [#users=1] = call_method[target=permute](args = (%view_14, 0, 2, 1, 3), kwargs = {})
    %add_22 : [#users=1] = call_function[target=operator.add](args = (%getitem_14, %permute_13), kwargs = {})
    %v_bias_2 : [#users=1] = get_attr[target=layer.2.attention.self.v_bias]
    %getitem_18 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_2, [None, None, slice(None, None, None)]), kwargs = {})
    %view_15 : [#users=1] = call_method[target=view](args = (%getitem_18, [1, 1, 12, -1]), kwargs = {})
    %permute_14 : [#users=1] = call_method[target=permute](args = (%view_15, 0, 2, 1, 3), kwargs = {})
    %add_23 : [#users=1] = call_function[target=operator.add](args = (%getitem_16, %permute_14), kwargs = {})
    %tensor_76 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_9 : [#users=1] = call_function[target=operator.mul](args = (%tensor_76, 3), kwargs = {})
    %sqrt_8 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_9,), kwargs = {})
    %to_12 : [#users=0] = call_method[target=to](args = (%sqrt_8,), kwargs = {dtype: torch.float32})
    %truediv_6 : [#users=2] = call_function[target=operator.truediv](args = (%add_22, %sqrt_8), kwargs = {})
    %transpose_8 : [#users=1] = call_method[target=transpose](args = (%getitem_15, -1, -2), kwargs = {})
    %matmul_8 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_6, %transpose_8), kwargs = {})
    %unsqueeze_8 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_2 : [#users=0] = call_method[target=long](args = (%unsqueeze_8,), kwargs = {})
    %to_13 : [#users=0] = call_method[target=to](args = (%unsqueeze_8, cpu), kwargs = {})
    %__external_param__8 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_19 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__8, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_9 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_19, 0), kwargs = {})
    %pos_proj_2 : [#users=1] = call_module[target=layer.2.attention.self.pos_proj](args = (%unsqueeze_9,), kwargs = {})
    %view_16 : [#users=1] = call_method[target=view](args = (%pos_proj_2, [1, 512, 12, -1]), kwargs = {})
    %permute_15 : [#users=1] = call_method[target=permute](args = (%view_16, 0, 2, 1, 3), kwargs = {})
    %transpose_9 : [#users=1] = call_method[target=transpose](args = (%permute_15, -1, -2), kwargs = {})
    %matmul_9 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_6, %transpose_9), kwargs = {})
    %add_24 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_8, 256), kwargs = {})
    %clamp_4 : [#users=1] = call_function[target=torch.clamp](args = (%add_24, 0, 511), kwargs = {})
    %expand_4 : [#users=1] = call_method[target=expand](args = (%clamp_4, [1, 12, 256, 256]), kwargs = {})
    %gather_4 : [#users=2] = call_function[target=torch.gather](args = (%matmul_9,), kwargs = {dim: -1, index: %expand_4})
    %full_like_2 : [#users=1] = call_function[target=torch.full_like](args = (%gather_4, 0), kwargs = {})
    %iadd_4 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_2, %gather_4), kwargs = {})
    %pos_q_proj_2 : [#users=1] = call_module[target=layer.2.attention.self.pos_q_proj](args = (%unsqueeze_9,), kwargs = {})
    %view_17 : [#users=1] = call_method[target=view](args = (%pos_q_proj_2, [1, 512, 12, -1]), kwargs = {})
    %permute_16 : [#users=1] = call_method[target=permute](args = (%view_17, 0, 2, 1, 3), kwargs = {})
    %tensor_99 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_10 : [#users=1] = call_function[target=operator.mul](args = (%tensor_99, 3), kwargs = {})
    %sqrt_9 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_10,), kwargs = {})
    %itruediv_2 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_16, %sqrt_9), kwargs = {})
    %neg_2 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_8,), kwargs = {})
    %add_25 : [#users=1] = call_function[target=operator.add](args = (%neg_2, 256), kwargs = {})
    %clamp_5 : [#users=1] = call_function[target=torch.clamp](args = (%add_25, 0, 511), kwargs = {})
    %transpose_10 : [#users=2] = call_method[target=transpose](args = (%itruediv_2, -1, -2), kwargs = {})
    %to_14 : [#users=0] = call_method[target=to](args = (%transpose_10,), kwargs = {dtype: torch.float32})
    %matmul_10 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_15, %transpose_10), kwargs = {})
    %expand_5 : [#users=1] = call_method[target=expand](args = (%clamp_5, [1, 12, 256, 256]), kwargs = {})
    %gather_5 : [#users=1] = call_function[target=torch.gather](args = (%matmul_10,), kwargs = {dim: -1, index: %expand_5})
    %transpose_11 : [#users=1] = call_method[target=transpose](args = (%gather_5, -1, -2), kwargs = {})
    %iadd_5 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_4, %transpose_11), kwargs = {})
    %add_26 : [#users=1] = call_function[target=operator.add](args = (%matmul_8, %iadd_5), kwargs = {})
    %to_15 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_2 : [#users=2] = call_function[target=operator.invert](args = (%to_15,), kwargs = {})
    %tensor_111 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_2 : [#users=1] = call_method[target=masked_fill](args = (%add_26, %invert_2, %tensor_111), kwargs = {})
    %softmax_2 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_2, -1), kwargs = {})
    %masked_fill__2 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_2, %invert_2, 0), kwargs = {})
    %matmul_11 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_2, %add_23), kwargs = {})
    %permute_17 : [#users=1] = call_method[target=permute](args = (%matmul_11, 0, 2, 1, 3), kwargs = {})
    %contiguous_2 : [#users=1] = call_method[target=contiguous](args = (%permute_17,), kwargs = {})
    %view_18 : [#users=1] = call_method[target=view](args = (%contiguous_2, [1, 256, -1]), kwargs = {})
    %dense_6 : [#users=1] = call_module[target=layer.2.attention.output.dense](args = (%view_18,), kwargs = {})
    %add_27 : [#users=4] = call_function[target=operator.add](args = (%dense_6, %add_21), kwargs = {})
    %float_5 : [#users=0] = call_method[target=float](args = (%add_27,), kwargs = {})
    %mean_8 : [#users=2] = call_method[target=mean](args = (%add_27, -1), kwargs = {keepdim: True})
    %sub_9 : [#users=1] = call_function[target=operator.sub](args = (%add_27, %mean_8), kwargs = {})
    %pow_5 : [#users=1] = call_method[target=pow](args = (%sub_9, 2), kwargs = {})
    %mean_9 : [#users=1] = call_method[target=mean](args = (%pow_5, -1), kwargs = {keepdim: True})
    %sub_10 : [#users=1] = call_function[target=operator.sub](args = (%add_27, %mean_8), kwargs = {})
    %add_28 : [#users=1] = call_function[target=operator.add](args = (%mean_9, 1e-07), kwargs = {})
    %sqrt_10 : [#users=1] = call_function[target=torch.sqrt](args = (%add_28,), kwargs = {})
    %truediv_7 : [#users=2] = call_function[target=operator.truediv](args = (%sub_10, %sqrt_10), kwargs = {})
    %to_16 : [#users=0] = call_method[target=to](args = (%truediv_7, torch.float32), kwargs = {})
    %weight_4 : [#users=1] = get_attr[target=layer.2.attention.output.LayerNorm.weight]
    %mul_11 : [#users=1] = call_function[target=operator.mul](args = (%weight_4, %truediv_7), kwargs = {})
    %bias_4 : [#users=1] = get_attr[target=layer.2.attention.output.LayerNorm.bias]
    %add_29 : [#users=2] = call_function[target=operator.add](args = (%mul_11, %bias_4), kwargs = {})
    %dense_7 : [#users=1] = call_module[target=layer.2.intermediate.dense](args = (%add_29,), kwargs = {})
    %gelu_2 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_7,), kwargs = {})
    %dense_8 : [#users=1] = call_module[target=layer.2.output.dense](args = (%gelu_2,), kwargs = {})
    %add_30 : [#users=4] = call_function[target=operator.add](args = (%dense_8, %add_29), kwargs = {})
    %float_6 : [#users=0] = call_method[target=float](args = (%add_30,), kwargs = {})
    %mean_10 : [#users=2] = call_method[target=mean](args = (%add_30, -1), kwargs = {keepdim: True})
    %sub_11 : [#users=1] = call_function[target=operator.sub](args = (%add_30, %mean_10), kwargs = {})
    %pow_6 : [#users=1] = call_method[target=pow](args = (%sub_11, 2), kwargs = {})
    %mean_11 : [#users=1] = call_method[target=mean](args = (%pow_6, -1), kwargs = {keepdim: True})
    %sub_12 : [#users=1] = call_function[target=operator.sub](args = (%add_30, %mean_10), kwargs = {})
    %add_31 : [#users=1] = call_function[target=operator.add](args = (%mean_11, 1e-07), kwargs = {})
    %sqrt_11 : [#users=1] = call_function[target=torch.sqrt](args = (%add_31,), kwargs = {})
    %truediv_8 : [#users=2] = call_function[target=operator.truediv](args = (%sub_12, %sqrt_11), kwargs = {})
    %to_17 : [#users=0] = call_method[target=to](args = (%truediv_8, torch.float32), kwargs = {})
    %weight_5 : [#users=1] = get_attr[target=layer.2.output.LayerNorm.weight]
    %mul_12 : [#users=1] = call_function[target=operator.mul](args = (%weight_5, %truediv_8), kwargs = {})
    %bias_5 : [#users=1] = get_attr[target=layer.2.output.LayerNorm.bias]
    %add_32 : [#users=2] = call_function[target=operator.add](args = (%mul_12, %bias_5), kwargs = {})
    %in_proj_3 : [#users=1] = call_module[target=layer.3.attention.self.in_proj](args = (%add_32,), kwargs = {})
    %view_19 : [#users=1] = call_method[target=view](args = (%in_proj_3, [1, 256, 12, -1]), kwargs = {})
    %permute_18 : [#users=1] = call_method[target=permute](args = (%view_19, 0, 2, 1, 3), kwargs = {})
    %chunk_3 : [#users=3] = call_method[target=chunk](args = (%permute_18, 3), kwargs = {dim: -1})
    %getitem_20 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_3, 0), kwargs = {})
    %getitem_21 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_3, 1), kwargs = {})
    %getitem_22 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_3, 2), kwargs = {})
    %q_bias_3 : [#users=1] = get_attr[target=layer.3.attention.self.q_bias]
    %getitem_23 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_3, [None, None, slice(None, None, None)]), kwargs = {})
    %view_20 : [#users=1] = call_method[target=view](args = (%getitem_23, [1, 1, 12, -1]), kwargs = {})
    %permute_19 : [#users=1] = call_method[target=permute](args = (%view_20, 0, 2, 1, 3), kwargs = {})
    %add_33 : [#users=1] = call_function[target=operator.add](args = (%getitem_20, %permute_19), kwargs = {})
    %v_bias_3 : [#users=1] = get_attr[target=layer.3.attention.self.v_bias]
    %getitem_24 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_3, [None, None, slice(None, None, None)]), kwargs = {})
    %view_21 : [#users=1] = call_method[target=view](args = (%getitem_24, [1, 1, 12, -1]), kwargs = {})
    %permute_20 : [#users=1] = call_method[target=permute](args = (%view_21, 0, 2, 1, 3), kwargs = {})
    %add_34 : [#users=1] = call_function[target=operator.add](args = (%getitem_22, %permute_20), kwargs = {})
    %tensor_112 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_13 : [#users=1] = call_function[target=operator.mul](args = (%tensor_112, 3), kwargs = {})
    %sqrt_12 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_13,), kwargs = {})
    %to_18 : [#users=0] = call_method[target=to](args = (%sqrt_12,), kwargs = {dtype: torch.float32})
    %truediv_9 : [#users=2] = call_function[target=operator.truediv](args = (%add_33, %sqrt_12), kwargs = {})
    %transpose_12 : [#users=1] = call_method[target=transpose](args = (%getitem_21, -1, -2), kwargs = {})
    %matmul_12 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_9, %transpose_12), kwargs = {})
    %unsqueeze_10 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_3 : [#users=0] = call_method[target=long](args = (%unsqueeze_10,), kwargs = {})
    %to_19 : [#users=0] = call_method[target=to](args = (%unsqueeze_10, cpu), kwargs = {})
    %__external_param__9 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_25 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__9, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_11 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_25, 0), kwargs = {})
    %pos_proj_3 : [#users=1] = call_module[target=layer.3.attention.self.pos_proj](args = (%unsqueeze_11,), kwargs = {})
    %view_22 : [#users=1] = call_method[target=view](args = (%pos_proj_3, [1, 512, 12, -1]), kwargs = {})
    %permute_21 : [#users=1] = call_method[target=permute](args = (%view_22, 0, 2, 1, 3), kwargs = {})
    %transpose_13 : [#users=1] = call_method[target=transpose](args = (%permute_21, -1, -2), kwargs = {})
    %matmul_13 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_9, %transpose_13), kwargs = {})
    %add_35 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_10, 256), kwargs = {})
    %clamp_6 : [#users=1] = call_function[target=torch.clamp](args = (%add_35, 0, 511), kwargs = {})
    %expand_6 : [#users=1] = call_method[target=expand](args = (%clamp_6, [1, 12, 256, 256]), kwargs = {})
    %gather_6 : [#users=2] = call_function[target=torch.gather](args = (%matmul_13,), kwargs = {dim: -1, index: %expand_6})
    %full_like_3 : [#users=1] = call_function[target=torch.full_like](args = (%gather_6, 0), kwargs = {})
    %iadd_6 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_3, %gather_6), kwargs = {})
    %pos_q_proj_3 : [#users=1] = call_module[target=layer.3.attention.self.pos_q_proj](args = (%unsqueeze_11,), kwargs = {})
    %view_23 : [#users=1] = call_method[target=view](args = (%pos_q_proj_3, [1, 512, 12, -1]), kwargs = {})
    %permute_22 : [#users=1] = call_method[target=permute](args = (%view_23, 0, 2, 1, 3), kwargs = {})
    %tensor_135 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_14 : [#users=1] = call_function[target=operator.mul](args = (%tensor_135, 3), kwargs = {})
    %sqrt_13 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_14,), kwargs = {})
    %itruediv_3 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_22, %sqrt_13), kwargs = {})
    %neg_3 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_10,), kwargs = {})
    %add_36 : [#users=1] = call_function[target=operator.add](args = (%neg_3, 256), kwargs = {})
    %clamp_7 : [#users=1] = call_function[target=torch.clamp](args = (%add_36, 0, 511), kwargs = {})
    %transpose_14 : [#users=2] = call_method[target=transpose](args = (%itruediv_3, -1, -2), kwargs = {})
    %to_20 : [#users=0] = call_method[target=to](args = (%transpose_14,), kwargs = {dtype: torch.float32})
    %matmul_14 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_21, %transpose_14), kwargs = {})
    %expand_7 : [#users=1] = call_method[target=expand](args = (%clamp_7, [1, 12, 256, 256]), kwargs = {})
    %gather_7 : [#users=1] = call_function[target=torch.gather](args = (%matmul_14,), kwargs = {dim: -1, index: %expand_7})
    %transpose_15 : [#users=1] = call_method[target=transpose](args = (%gather_7, -1, -2), kwargs = {})
    %iadd_7 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_6, %transpose_15), kwargs = {})
    %add_37 : [#users=1] = call_function[target=operator.add](args = (%matmul_12, %iadd_7), kwargs = {})
    %to_21 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_3 : [#users=2] = call_function[target=operator.invert](args = (%to_21,), kwargs = {})
    %tensor_147 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_3 : [#users=1] = call_method[target=masked_fill](args = (%add_37, %invert_3, %tensor_147), kwargs = {})
    %softmax_3 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_3, -1), kwargs = {})
    %masked_fill__3 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_3, %invert_3, 0), kwargs = {})
    %matmul_15 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_3, %add_34), kwargs = {})
    %permute_23 : [#users=1] = call_method[target=permute](args = (%matmul_15, 0, 2, 1, 3), kwargs = {})
    %contiguous_3 : [#users=1] = call_method[target=contiguous](args = (%permute_23,), kwargs = {})
    %view_24 : [#users=1] = call_method[target=view](args = (%contiguous_3, [1, 256, -1]), kwargs = {})
    %dense_9 : [#users=1] = call_module[target=layer.3.attention.output.dense](args = (%view_24,), kwargs = {})
    %add_38 : [#users=4] = call_function[target=operator.add](args = (%dense_9, %add_32), kwargs = {})
    %float_7 : [#users=0] = call_method[target=float](args = (%add_38,), kwargs = {})
    %mean_12 : [#users=2] = call_method[target=mean](args = (%add_38, -1), kwargs = {keepdim: True})
    %sub_13 : [#users=1] = call_function[target=operator.sub](args = (%add_38, %mean_12), kwargs = {})
    %pow_7 : [#users=1] = call_method[target=pow](args = (%sub_13, 2), kwargs = {})
    %mean_13 : [#users=1] = call_method[target=mean](args = (%pow_7, -1), kwargs = {keepdim: True})
    %sub_14 : [#users=1] = call_function[target=operator.sub](args = (%add_38, %mean_12), kwargs = {})
    %add_39 : [#users=1] = call_function[target=operator.add](args = (%mean_13, 1e-07), kwargs = {})
    %sqrt_14 : [#users=1] = call_function[target=torch.sqrt](args = (%add_39,), kwargs = {})
    %truediv_10 : [#users=2] = call_function[target=operator.truediv](args = (%sub_14, %sqrt_14), kwargs = {})
    %to_22 : [#users=0] = call_method[target=to](args = (%truediv_10, torch.float32), kwargs = {})
    %weight_6 : [#users=1] = get_attr[target=layer.3.attention.output.LayerNorm.weight]
    %mul_15 : [#users=1] = call_function[target=operator.mul](args = (%weight_6, %truediv_10), kwargs = {})
    %bias_6 : [#users=1] = get_attr[target=layer.3.attention.output.LayerNorm.bias]
    %add_40 : [#users=2] = call_function[target=operator.add](args = (%mul_15, %bias_6), kwargs = {})
    %dense_10 : [#users=1] = call_module[target=layer.3.intermediate.dense](args = (%add_40,), kwargs = {})
    %gelu_3 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_10,), kwargs = {})
    %dense_11 : [#users=1] = call_module[target=layer.3.output.dense](args = (%gelu_3,), kwargs = {})
    %add_41 : [#users=4] = call_function[target=operator.add](args = (%dense_11, %add_40), kwargs = {})
    %float_8 : [#users=0] = call_method[target=float](args = (%add_41,), kwargs = {})
    %mean_14 : [#users=2] = call_method[target=mean](args = (%add_41, -1), kwargs = {keepdim: True})
    %sub_15 : [#users=1] = call_function[target=operator.sub](args = (%add_41, %mean_14), kwargs = {})
    %pow_8 : [#users=1] = call_method[target=pow](args = (%sub_15, 2), kwargs = {})
    %mean_15 : [#users=1] = call_method[target=mean](args = (%pow_8, -1), kwargs = {keepdim: True})
    %sub_16 : [#users=1] = call_function[target=operator.sub](args = (%add_41, %mean_14), kwargs = {})
    %add_42 : [#users=1] = call_function[target=operator.add](args = (%mean_15, 1e-07), kwargs = {})
    %sqrt_15 : [#users=1] = call_function[target=torch.sqrt](args = (%add_42,), kwargs = {})
    %truediv_11 : [#users=2] = call_function[target=operator.truediv](args = (%sub_16, %sqrt_15), kwargs = {})
    %to_23 : [#users=0] = call_method[target=to](args = (%truediv_11, torch.float32), kwargs = {})
    %weight_7 : [#users=1] = get_attr[target=layer.3.output.LayerNorm.weight]
    %mul_16 : [#users=1] = call_function[target=operator.mul](args = (%weight_7, %truediv_11), kwargs = {})
    %bias_7 : [#users=1] = get_attr[target=layer.3.output.LayerNorm.bias]
    %add_43 : [#users=2] = call_function[target=operator.add](args = (%mul_16, %bias_7), kwargs = {})
    %in_proj_4 : [#users=1] = call_module[target=layer.4.attention.self.in_proj](args = (%add_43,), kwargs = {})
    %view_25 : [#users=1] = call_method[target=view](args = (%in_proj_4, [1, 256, 12, -1]), kwargs = {})
    %permute_24 : [#users=1] = call_method[target=permute](args = (%view_25, 0, 2, 1, 3), kwargs = {})
    %chunk_4 : [#users=3] = call_method[target=chunk](args = (%permute_24, 3), kwargs = {dim: -1})
    %getitem_26 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_4, 0), kwargs = {})
    %getitem_27 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_4, 1), kwargs = {})
    %getitem_28 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_4, 2), kwargs = {})
    %q_bias_4 : [#users=1] = get_attr[target=layer.4.attention.self.q_bias]
    %getitem_29 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_4, [None, None, slice(None, None, None)]), kwargs = {})
    %view_26 : [#users=1] = call_method[target=view](args = (%getitem_29, [1, 1, 12, -1]), kwargs = {})
    %permute_25 : [#users=1] = call_method[target=permute](args = (%view_26, 0, 2, 1, 3), kwargs = {})
    %add_44 : [#users=1] = call_function[target=operator.add](args = (%getitem_26, %permute_25), kwargs = {})
    %v_bias_4 : [#users=1] = get_attr[target=layer.4.attention.self.v_bias]
    %getitem_30 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_4, [None, None, slice(None, None, None)]), kwargs = {})
    %view_27 : [#users=1] = call_method[target=view](args = (%getitem_30, [1, 1, 12, -1]), kwargs = {})
    %permute_26 : [#users=1] = call_method[target=permute](args = (%view_27, 0, 2, 1, 3), kwargs = {})
    %add_45 : [#users=1] = call_function[target=operator.add](args = (%getitem_28, %permute_26), kwargs = {})
    %tensor_148 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_17 : [#users=1] = call_function[target=operator.mul](args = (%tensor_148, 3), kwargs = {})
    %sqrt_16 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_17,), kwargs = {})
    %to_24 : [#users=0] = call_method[target=to](args = (%sqrt_16,), kwargs = {dtype: torch.float32})
    %truediv_12 : [#users=2] = call_function[target=operator.truediv](args = (%add_44, %sqrt_16), kwargs = {})
    %transpose_16 : [#users=1] = call_method[target=transpose](args = (%getitem_27, -1, -2), kwargs = {})
    %matmul_16 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_12, %transpose_16), kwargs = {})
    %unsqueeze_12 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_4 : [#users=0] = call_method[target=long](args = (%unsqueeze_12,), kwargs = {})
    %to_25 : [#users=0] = call_method[target=to](args = (%unsqueeze_12, cpu), kwargs = {})
    %__external_param__10 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_31 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__10, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_13 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_31, 0), kwargs = {})
    %pos_proj_4 : [#users=1] = call_module[target=layer.4.attention.self.pos_proj](args = (%unsqueeze_13,), kwargs = {})
    %view_28 : [#users=1] = call_method[target=view](args = (%pos_proj_4, [1, 512, 12, -1]), kwargs = {})
    %permute_27 : [#users=1] = call_method[target=permute](args = (%view_28, 0, 2, 1, 3), kwargs = {})
    %transpose_17 : [#users=1] = call_method[target=transpose](args = (%permute_27, -1, -2), kwargs = {})
    %matmul_17 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_12, %transpose_17), kwargs = {})
    %add_46 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_12, 256), kwargs = {})
    %clamp_8 : [#users=1] = call_function[target=torch.clamp](args = (%add_46, 0, 511), kwargs = {})
    %expand_8 : [#users=1] = call_method[target=expand](args = (%clamp_8, [1, 12, 256, 256]), kwargs = {})
    %gather_8 : [#users=2] = call_function[target=torch.gather](args = (%matmul_17,), kwargs = {dim: -1, index: %expand_8})
    %full_like_4 : [#users=1] = call_function[target=torch.full_like](args = (%gather_8, 0), kwargs = {})
    %iadd_8 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_4, %gather_8), kwargs = {})
    %pos_q_proj_4 : [#users=1] = call_module[target=layer.4.attention.self.pos_q_proj](args = (%unsqueeze_13,), kwargs = {})
    %view_29 : [#users=1] = call_method[target=view](args = (%pos_q_proj_4, [1, 512, 12, -1]), kwargs = {})
    %permute_28 : [#users=1] = call_method[target=permute](args = (%view_29, 0, 2, 1, 3), kwargs = {})
    %tensor_171 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_18 : [#users=1] = call_function[target=operator.mul](args = (%tensor_171, 3), kwargs = {})
    %sqrt_17 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_18,), kwargs = {})
    %itruediv_4 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_28, %sqrt_17), kwargs = {})
    %neg_4 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_12,), kwargs = {})
    %add_47 : [#users=1] = call_function[target=operator.add](args = (%neg_4, 256), kwargs = {})
    %clamp_9 : [#users=1] = call_function[target=torch.clamp](args = (%add_47, 0, 511), kwargs = {})
    %transpose_18 : [#users=2] = call_method[target=transpose](args = (%itruediv_4, -1, -2), kwargs = {})
    %to_26 : [#users=0] = call_method[target=to](args = (%transpose_18,), kwargs = {dtype: torch.float32})
    %matmul_18 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_27, %transpose_18), kwargs = {})
    %expand_9 : [#users=1] = call_method[target=expand](args = (%clamp_9, [1, 12, 256, 256]), kwargs = {})
    %gather_9 : [#users=1] = call_function[target=torch.gather](args = (%matmul_18,), kwargs = {dim: -1, index: %expand_9})
    %transpose_19 : [#users=1] = call_method[target=transpose](args = (%gather_9, -1, -2), kwargs = {})
    %iadd_9 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_8, %transpose_19), kwargs = {})
    %add_48 : [#users=1] = call_function[target=operator.add](args = (%matmul_16, %iadd_9), kwargs = {})
    %to_27 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_4 : [#users=2] = call_function[target=operator.invert](args = (%to_27,), kwargs = {})
    %tensor_183 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_4 : [#users=1] = call_method[target=masked_fill](args = (%add_48, %invert_4, %tensor_183), kwargs = {})
    %softmax_4 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_4, -1), kwargs = {})
    %masked_fill__4 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_4, %invert_4, 0), kwargs = {})
    %matmul_19 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_4, %add_45), kwargs = {})
    %permute_29 : [#users=1] = call_method[target=permute](args = (%matmul_19, 0, 2, 1, 3), kwargs = {})
    %contiguous_4 : [#users=1] = call_method[target=contiguous](args = (%permute_29,), kwargs = {})
    %view_30 : [#users=1] = call_method[target=view](args = (%contiguous_4, [1, 256, -1]), kwargs = {})
    %dense_12 : [#users=1] = call_module[target=layer.4.attention.output.dense](args = (%view_30,), kwargs = {})
    %add_49 : [#users=4] = call_function[target=operator.add](args = (%dense_12, %add_43), kwargs = {})
    %float_9 : [#users=0] = call_method[target=float](args = (%add_49,), kwargs = {})
    %mean_16 : [#users=2] = call_method[target=mean](args = (%add_49, -1), kwargs = {keepdim: True})
    %sub_17 : [#users=1] = call_function[target=operator.sub](args = (%add_49, %mean_16), kwargs = {})
    %pow_9 : [#users=1] = call_method[target=pow](args = (%sub_17, 2), kwargs = {})
    %mean_17 : [#users=1] = call_method[target=mean](args = (%pow_9, -1), kwargs = {keepdim: True})
    %sub_18 : [#users=1] = call_function[target=operator.sub](args = (%add_49, %mean_16), kwargs = {})
    %add_50 : [#users=1] = call_function[target=operator.add](args = (%mean_17, 1e-07), kwargs = {})
    %sqrt_18 : [#users=1] = call_function[target=torch.sqrt](args = (%add_50,), kwargs = {})
    %truediv_13 : [#users=2] = call_function[target=operator.truediv](args = (%sub_18, %sqrt_18), kwargs = {})
    %to_28 : [#users=0] = call_method[target=to](args = (%truediv_13, torch.float32), kwargs = {})
    %weight_8 : [#users=1] = get_attr[target=layer.4.attention.output.LayerNorm.weight]
    %mul_19 : [#users=1] = call_function[target=operator.mul](args = (%weight_8, %truediv_13), kwargs = {})
    %bias_8 : [#users=1] = get_attr[target=layer.4.attention.output.LayerNorm.bias]
    %add_51 : [#users=2] = call_function[target=operator.add](args = (%mul_19, %bias_8), kwargs = {})
    %dense_13 : [#users=1] = call_module[target=layer.4.intermediate.dense](args = (%add_51,), kwargs = {})
    %gelu_4 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_13,), kwargs = {})
    %dense_14 : [#users=1] = call_module[target=layer.4.output.dense](args = (%gelu_4,), kwargs = {})
    %add_52 : [#users=4] = call_function[target=operator.add](args = (%dense_14, %add_51), kwargs = {})
    %float_10 : [#users=0] = call_method[target=float](args = (%add_52,), kwargs = {})
    %mean_18 : [#users=2] = call_method[target=mean](args = (%add_52, -1), kwargs = {keepdim: True})
    %sub_19 : [#users=1] = call_function[target=operator.sub](args = (%add_52, %mean_18), kwargs = {})
    %pow_10 : [#users=1] = call_method[target=pow](args = (%sub_19, 2), kwargs = {})
    %mean_19 : [#users=1] = call_method[target=mean](args = (%pow_10, -1), kwargs = {keepdim: True})
    %sub_20 : [#users=1] = call_function[target=operator.sub](args = (%add_52, %mean_18), kwargs = {})
    %add_53 : [#users=1] = call_function[target=operator.add](args = (%mean_19, 1e-07), kwargs = {})
    %sqrt_19 : [#users=1] = call_function[target=torch.sqrt](args = (%add_53,), kwargs = {})
    %truediv_14 : [#users=2] = call_function[target=operator.truediv](args = (%sub_20, %sqrt_19), kwargs = {})
    %to_29 : [#users=0] = call_method[target=to](args = (%truediv_14, torch.float32), kwargs = {})
    %weight_9 : [#users=1] = get_attr[target=layer.4.output.LayerNorm.weight]
    %mul_20 : [#users=1] = call_function[target=operator.mul](args = (%weight_9, %truediv_14), kwargs = {})
    %bias_9 : [#users=1] = get_attr[target=layer.4.output.LayerNorm.bias]
    %add_54 : [#users=2] = call_function[target=operator.add](args = (%mul_20, %bias_9), kwargs = {})
    %in_proj_5 : [#users=1] = call_module[target=layer.5.attention.self.in_proj](args = (%add_54,), kwargs = {})
    %view_31 : [#users=1] = call_method[target=view](args = (%in_proj_5, [1, 256, 12, -1]), kwargs = {})
    %permute_30 : [#users=1] = call_method[target=permute](args = (%view_31, 0, 2, 1, 3), kwargs = {})
    %chunk_5 : [#users=3] = call_method[target=chunk](args = (%permute_30, 3), kwargs = {dim: -1})
    %getitem_32 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_5, 0), kwargs = {})
    %getitem_33 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_5, 1), kwargs = {})
    %getitem_34 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_5, 2), kwargs = {})
    %q_bias_5 : [#users=1] = get_attr[target=layer.5.attention.self.q_bias]
    %getitem_35 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_5, [None, None, slice(None, None, None)]), kwargs = {})
    %view_32 : [#users=1] = call_method[target=view](args = (%getitem_35, [1, 1, 12, -1]), kwargs = {})
    %permute_31 : [#users=1] = call_method[target=permute](args = (%view_32, 0, 2, 1, 3), kwargs = {})
    %add_55 : [#users=1] = call_function[target=operator.add](args = (%getitem_32, %permute_31), kwargs = {})
    %v_bias_5 : [#users=1] = get_attr[target=layer.5.attention.self.v_bias]
    %getitem_36 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_5, [None, None, slice(None, None, None)]), kwargs = {})
    %view_33 : [#users=1] = call_method[target=view](args = (%getitem_36, [1, 1, 12, -1]), kwargs = {})
    %permute_32 : [#users=1] = call_method[target=permute](args = (%view_33, 0, 2, 1, 3), kwargs = {})
    %add_56 : [#users=1] = call_function[target=operator.add](args = (%getitem_34, %permute_32), kwargs = {})
    %tensor_184 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_21 : [#users=1] = call_function[target=operator.mul](args = (%tensor_184, 3), kwargs = {})
    %sqrt_20 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_21,), kwargs = {})
    %to_30 : [#users=0] = call_method[target=to](args = (%sqrt_20,), kwargs = {dtype: torch.float32})
    %truediv_15 : [#users=2] = call_function[target=operator.truediv](args = (%add_55, %sqrt_20), kwargs = {})
    %transpose_20 : [#users=1] = call_method[target=transpose](args = (%getitem_33, -1, -2), kwargs = {})
    %matmul_20 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_15, %transpose_20), kwargs = {})
    %unsqueeze_14 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_5 : [#users=0] = call_method[target=long](args = (%unsqueeze_14,), kwargs = {})
    %to_31 : [#users=0] = call_method[target=to](args = (%unsqueeze_14, cpu), kwargs = {})
    %__external_param__11 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_37 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__11, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_15 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_37, 0), kwargs = {})
    %pos_proj_5 : [#users=1] = call_module[target=layer.5.attention.self.pos_proj](args = (%unsqueeze_15,), kwargs = {})
    %view_34 : [#users=1] = call_method[target=view](args = (%pos_proj_5, [1, 512, 12, -1]), kwargs = {})
    %permute_33 : [#users=1] = call_method[target=permute](args = (%view_34, 0, 2, 1, 3), kwargs = {})
    %transpose_21 : [#users=1] = call_method[target=transpose](args = (%permute_33, -1, -2), kwargs = {})
    %matmul_21 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_15, %transpose_21), kwargs = {})
    %add_57 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_14, 256), kwargs = {})
    %clamp_10 : [#users=1] = call_function[target=torch.clamp](args = (%add_57, 0, 511), kwargs = {})
    %expand_10 : [#users=1] = call_method[target=expand](args = (%clamp_10, [1, 12, 256, 256]), kwargs = {})
    %gather_10 : [#users=2] = call_function[target=torch.gather](args = (%matmul_21,), kwargs = {dim: -1, index: %expand_10})
    %full_like_5 : [#users=1] = call_function[target=torch.full_like](args = (%gather_10, 0), kwargs = {})
    %iadd_10 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_5, %gather_10), kwargs = {})
    %pos_q_proj_5 : [#users=1] = call_module[target=layer.5.attention.self.pos_q_proj](args = (%unsqueeze_15,), kwargs = {})
    %view_35 : [#users=1] = call_method[target=view](args = (%pos_q_proj_5, [1, 512, 12, -1]), kwargs = {})
    %permute_34 : [#users=1] = call_method[target=permute](args = (%view_35, 0, 2, 1, 3), kwargs = {})
    %tensor_207 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_22 : [#users=1] = call_function[target=operator.mul](args = (%tensor_207, 3), kwargs = {})
    %sqrt_21 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_22,), kwargs = {})
    %itruediv_5 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_34, %sqrt_21), kwargs = {})
    %neg_5 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_14,), kwargs = {})
    %add_58 : [#users=1] = call_function[target=operator.add](args = (%neg_5, 256), kwargs = {})
    %clamp_11 : [#users=1] = call_function[target=torch.clamp](args = (%add_58, 0, 511), kwargs = {})
    %transpose_22 : [#users=2] = call_method[target=transpose](args = (%itruediv_5, -1, -2), kwargs = {})
    %to_32 : [#users=0] = call_method[target=to](args = (%transpose_22,), kwargs = {dtype: torch.float32})
    %matmul_22 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_33, %transpose_22), kwargs = {})
    %expand_11 : [#users=1] = call_method[target=expand](args = (%clamp_11, [1, 12, 256, 256]), kwargs = {})
    %gather_11 : [#users=1] = call_function[target=torch.gather](args = (%matmul_22,), kwargs = {dim: -1, index: %expand_11})
    %transpose_23 : [#users=1] = call_method[target=transpose](args = (%gather_11, -1, -2), kwargs = {})
    %iadd_11 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_10, %transpose_23), kwargs = {})
    %add_59 : [#users=1] = call_function[target=operator.add](args = (%matmul_20, %iadd_11), kwargs = {})
    %to_33 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_5 : [#users=2] = call_function[target=operator.invert](args = (%to_33,), kwargs = {})
    %tensor_219 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_5 : [#users=1] = call_method[target=masked_fill](args = (%add_59, %invert_5, %tensor_219), kwargs = {})
    %softmax_5 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_5, -1), kwargs = {})
    %masked_fill__5 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_5, %invert_5, 0), kwargs = {})
    %matmul_23 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_5, %add_56), kwargs = {})
    %permute_35 : [#users=1] = call_method[target=permute](args = (%matmul_23, 0, 2, 1, 3), kwargs = {})
    %contiguous_5 : [#users=1] = call_method[target=contiguous](args = (%permute_35,), kwargs = {})
    %view_36 : [#users=1] = call_method[target=view](args = (%contiguous_5, [1, 256, -1]), kwargs = {})
    %dense_15 : [#users=1] = call_module[target=layer.5.attention.output.dense](args = (%view_36,), kwargs = {})
    %add_60 : [#users=4] = call_function[target=operator.add](args = (%dense_15, %add_54), kwargs = {})
    %float_11 : [#users=0] = call_method[target=float](args = (%add_60,), kwargs = {})
    %mean_20 : [#users=2] = call_method[target=mean](args = (%add_60, -1), kwargs = {keepdim: True})
    %sub_21 : [#users=1] = call_function[target=operator.sub](args = (%add_60, %mean_20), kwargs = {})
    %pow_11 : [#users=1] = call_method[target=pow](args = (%sub_21, 2), kwargs = {})
    %mean_21 : [#users=1] = call_method[target=mean](args = (%pow_11, -1), kwargs = {keepdim: True})
    %sub_22 : [#users=1] = call_function[target=operator.sub](args = (%add_60, %mean_20), kwargs = {})
    %add_61 : [#users=1] = call_function[target=operator.add](args = (%mean_21, 1e-07), kwargs = {})
    %sqrt_22 : [#users=1] = call_function[target=torch.sqrt](args = (%add_61,), kwargs = {})
    %truediv_16 : [#users=2] = call_function[target=operator.truediv](args = (%sub_22, %sqrt_22), kwargs = {})
    %to_34 : [#users=0] = call_method[target=to](args = (%truediv_16, torch.float32), kwargs = {})
    %weight_10 : [#users=1] = get_attr[target=layer.5.attention.output.LayerNorm.weight]
    %mul_23 : [#users=1] = call_function[target=operator.mul](args = (%weight_10, %truediv_16), kwargs = {})
    %bias_10 : [#users=1] = get_attr[target=layer.5.attention.output.LayerNorm.bias]
    %add_62 : [#users=2] = call_function[target=operator.add](args = (%mul_23, %bias_10), kwargs = {})
    %dense_16 : [#users=1] = call_module[target=layer.5.intermediate.dense](args = (%add_62,), kwargs = {})
    %gelu_5 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_16,), kwargs = {})
    %dense_17 : [#users=1] = call_module[target=layer.5.output.dense](args = (%gelu_5,), kwargs = {})
    %add_63 : [#users=4] = call_function[target=operator.add](args = (%dense_17, %add_62), kwargs = {})
    %float_12 : [#users=0] = call_method[target=float](args = (%add_63,), kwargs = {})
    %mean_22 : [#users=2] = call_method[target=mean](args = (%add_63, -1), kwargs = {keepdim: True})
    %sub_23 : [#users=1] = call_function[target=operator.sub](args = (%add_63, %mean_22), kwargs = {})
    %pow_12 : [#users=1] = call_method[target=pow](args = (%sub_23, 2), kwargs = {})
    %mean_23 : [#users=1] = call_method[target=mean](args = (%pow_12, -1), kwargs = {keepdim: True})
    %sub_24 : [#users=1] = call_function[target=operator.sub](args = (%add_63, %mean_22), kwargs = {})
    %add_64 : [#users=1] = call_function[target=operator.add](args = (%mean_23, 1e-07), kwargs = {})
    %sqrt_23 : [#users=1] = call_function[target=torch.sqrt](args = (%add_64,), kwargs = {})
    %truediv_17 : [#users=2] = call_function[target=operator.truediv](args = (%sub_24, %sqrt_23), kwargs = {})
    %to_35 : [#users=0] = call_method[target=to](args = (%truediv_17, torch.float32), kwargs = {})
    %weight_11 : [#users=1] = get_attr[target=layer.5.output.LayerNorm.weight]
    %mul_24 : [#users=1] = call_function[target=operator.mul](args = (%weight_11, %truediv_17), kwargs = {})
    %bias_11 : [#users=1] = get_attr[target=layer.5.output.LayerNorm.bias]
    %add_65 : [#users=2] = call_function[target=operator.add](args = (%mul_24, %bias_11), kwargs = {})
    %in_proj_6 : [#users=1] = call_module[target=layer.6.attention.self.in_proj](args = (%add_65,), kwargs = {})
    %view_37 : [#users=1] = call_method[target=view](args = (%in_proj_6, [1, 256, 12, -1]), kwargs = {})
    %permute_36 : [#users=1] = call_method[target=permute](args = (%view_37, 0, 2, 1, 3), kwargs = {})
    %chunk_6 : [#users=3] = call_method[target=chunk](args = (%permute_36, 3), kwargs = {dim: -1})
    %getitem_38 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_6, 0), kwargs = {})
    %getitem_39 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_6, 1), kwargs = {})
    %getitem_40 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_6, 2), kwargs = {})
    %q_bias_6 : [#users=1] = get_attr[target=layer.6.attention.self.q_bias]
    %getitem_41 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_6, [None, None, slice(None, None, None)]), kwargs = {})
    %view_38 : [#users=1] = call_method[target=view](args = (%getitem_41, [1, 1, 12, -1]), kwargs = {})
    %permute_37 : [#users=1] = call_method[target=permute](args = (%view_38, 0, 2, 1, 3), kwargs = {})
    %add_66 : [#users=1] = call_function[target=operator.add](args = (%getitem_38, %permute_37), kwargs = {})
    %v_bias_6 : [#users=1] = get_attr[target=layer.6.attention.self.v_bias]
    %getitem_42 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_6, [None, None, slice(None, None, None)]), kwargs = {})
    %view_39 : [#users=1] = call_method[target=view](args = (%getitem_42, [1, 1, 12, -1]), kwargs = {})
    %permute_38 : [#users=1] = call_method[target=permute](args = (%view_39, 0, 2, 1, 3), kwargs = {})
    %add_67 : [#users=1] = call_function[target=operator.add](args = (%getitem_40, %permute_38), kwargs = {})
    %tensor_220 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_25 : [#users=1] = call_function[target=operator.mul](args = (%tensor_220, 3), kwargs = {})
    %sqrt_24 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_25,), kwargs = {})
    %to_36 : [#users=0] = call_method[target=to](args = (%sqrt_24,), kwargs = {dtype: torch.float32})
    %truediv_18 : [#users=2] = call_function[target=operator.truediv](args = (%add_66, %sqrt_24), kwargs = {})
    %transpose_24 : [#users=1] = call_method[target=transpose](args = (%getitem_39, -1, -2), kwargs = {})
    %matmul_24 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_18, %transpose_24), kwargs = {})
    %unsqueeze_16 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_6 : [#users=0] = call_method[target=long](args = (%unsqueeze_16,), kwargs = {})
    %to_37 : [#users=0] = call_method[target=to](args = (%unsqueeze_16, cpu), kwargs = {})
    %__external_param__12 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_43 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__12, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_17 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_43, 0), kwargs = {})
    %pos_proj_6 : [#users=1] = call_module[target=layer.6.attention.self.pos_proj](args = (%unsqueeze_17,), kwargs = {})
    %view_40 : [#users=1] = call_method[target=view](args = (%pos_proj_6, [1, 512, 12, -1]), kwargs = {})
    %permute_39 : [#users=1] = call_method[target=permute](args = (%view_40, 0, 2, 1, 3), kwargs = {})
    %transpose_25 : [#users=1] = call_method[target=transpose](args = (%permute_39, -1, -2), kwargs = {})
    %matmul_25 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_18, %transpose_25), kwargs = {})
    %add_68 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_16, 256), kwargs = {})
    %clamp_12 : [#users=1] = call_function[target=torch.clamp](args = (%add_68, 0, 511), kwargs = {})
    %expand_12 : [#users=1] = call_method[target=expand](args = (%clamp_12, [1, 12, 256, 256]), kwargs = {})
    %gather_12 : [#users=2] = call_function[target=torch.gather](args = (%matmul_25,), kwargs = {dim: -1, index: %expand_12})
    %full_like_6 : [#users=1] = call_function[target=torch.full_like](args = (%gather_12, 0), kwargs = {})
    %iadd_12 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_6, %gather_12), kwargs = {})
    %pos_q_proj_6 : [#users=1] = call_module[target=layer.6.attention.self.pos_q_proj](args = (%unsqueeze_17,), kwargs = {})
    %view_41 : [#users=1] = call_method[target=view](args = (%pos_q_proj_6, [1, 512, 12, -1]), kwargs = {})
    %permute_40 : [#users=1] = call_method[target=permute](args = (%view_41, 0, 2, 1, 3), kwargs = {})
    %tensor_243 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_26 : [#users=1] = call_function[target=operator.mul](args = (%tensor_243, 3), kwargs = {})
    %sqrt_25 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_26,), kwargs = {})
    %itruediv_6 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_40, %sqrt_25), kwargs = {})
    %neg_6 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_16,), kwargs = {})
    %add_69 : [#users=1] = call_function[target=operator.add](args = (%neg_6, 256), kwargs = {})
    %clamp_13 : [#users=1] = call_function[target=torch.clamp](args = (%add_69, 0, 511), kwargs = {})
    %transpose_26 : [#users=2] = call_method[target=transpose](args = (%itruediv_6, -1, -2), kwargs = {})
    %to_38 : [#users=0] = call_method[target=to](args = (%transpose_26,), kwargs = {dtype: torch.float32})
    %matmul_26 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_39, %transpose_26), kwargs = {})
    %expand_13 : [#users=1] = call_method[target=expand](args = (%clamp_13, [1, 12, 256, 256]), kwargs = {})
    %gather_13 : [#users=1] = call_function[target=torch.gather](args = (%matmul_26,), kwargs = {dim: -1, index: %expand_13})
    %transpose_27 : [#users=1] = call_method[target=transpose](args = (%gather_13, -1, -2), kwargs = {})
    %iadd_13 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_12, %transpose_27), kwargs = {})
    %add_70 : [#users=1] = call_function[target=operator.add](args = (%matmul_24, %iadd_13), kwargs = {})
    %to_39 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_6 : [#users=2] = call_function[target=operator.invert](args = (%to_39,), kwargs = {})
    %tensor_255 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_6 : [#users=1] = call_method[target=masked_fill](args = (%add_70, %invert_6, %tensor_255), kwargs = {})
    %softmax_6 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_6, -1), kwargs = {})
    %masked_fill__6 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_6, %invert_6, 0), kwargs = {})
    %matmul_27 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_6, %add_67), kwargs = {})
    %permute_41 : [#users=1] = call_method[target=permute](args = (%matmul_27, 0, 2, 1, 3), kwargs = {})
    %contiguous_6 : [#users=1] = call_method[target=contiguous](args = (%permute_41,), kwargs = {})
    %view_42 : [#users=1] = call_method[target=view](args = (%contiguous_6, [1, 256, -1]), kwargs = {})
    %dense_18 : [#users=1] = call_module[target=layer.6.attention.output.dense](args = (%view_42,), kwargs = {})
    %add_71 : [#users=4] = call_function[target=operator.add](args = (%dense_18, %add_65), kwargs = {})
    %float_13 : [#users=0] = call_method[target=float](args = (%add_71,), kwargs = {})
    %mean_24 : [#users=2] = call_method[target=mean](args = (%add_71, -1), kwargs = {keepdim: True})
    %sub_25 : [#users=1] = call_function[target=operator.sub](args = (%add_71, %mean_24), kwargs = {})
    %pow_13 : [#users=1] = call_method[target=pow](args = (%sub_25, 2), kwargs = {})
    %mean_25 : [#users=1] = call_method[target=mean](args = (%pow_13, -1), kwargs = {keepdim: True})
    %sub_26 : [#users=1] = call_function[target=operator.sub](args = (%add_71, %mean_24), kwargs = {})
    %add_72 : [#users=1] = call_function[target=operator.add](args = (%mean_25, 1e-07), kwargs = {})
    %sqrt_26 : [#users=1] = call_function[target=torch.sqrt](args = (%add_72,), kwargs = {})
    %truediv_19 : [#users=2] = call_function[target=operator.truediv](args = (%sub_26, %sqrt_26), kwargs = {})
    %to_40 : [#users=0] = call_method[target=to](args = (%truediv_19, torch.float32), kwargs = {})
    %weight_12 : [#users=1] = get_attr[target=layer.6.attention.output.LayerNorm.weight]
    %mul_27 : [#users=1] = call_function[target=operator.mul](args = (%weight_12, %truediv_19), kwargs = {})
    %bias_12 : [#users=1] = get_attr[target=layer.6.attention.output.LayerNorm.bias]
    %add_73 : [#users=2] = call_function[target=operator.add](args = (%mul_27, %bias_12), kwargs = {})
    %dense_19 : [#users=1] = call_module[target=layer.6.intermediate.dense](args = (%add_73,), kwargs = {})
    %gelu_6 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_19,), kwargs = {})
    %dense_20 : [#users=1] = call_module[target=layer.6.output.dense](args = (%gelu_6,), kwargs = {})
    %add_74 : [#users=4] = call_function[target=operator.add](args = (%dense_20, %add_73), kwargs = {})
    %float_14 : [#users=0] = call_method[target=float](args = (%add_74,), kwargs = {})
    %mean_26 : [#users=2] = call_method[target=mean](args = (%add_74, -1), kwargs = {keepdim: True})
    %sub_27 : [#users=1] = call_function[target=operator.sub](args = (%add_74, %mean_26), kwargs = {})
    %pow_14 : [#users=1] = call_method[target=pow](args = (%sub_27, 2), kwargs = {})
    %mean_27 : [#users=1] = call_method[target=mean](args = (%pow_14, -1), kwargs = {keepdim: True})
    %sub_28 : [#users=1] = call_function[target=operator.sub](args = (%add_74, %mean_26), kwargs = {})
    %add_75 : [#users=1] = call_function[target=operator.add](args = (%mean_27, 1e-07), kwargs = {})
    %sqrt_27 : [#users=1] = call_function[target=torch.sqrt](args = (%add_75,), kwargs = {})
    %truediv_20 : [#users=2] = call_function[target=operator.truediv](args = (%sub_28, %sqrt_27), kwargs = {})
    %to_41 : [#users=0] = call_method[target=to](args = (%truediv_20, torch.float32), kwargs = {})
    %weight_13 : [#users=1] = get_attr[target=layer.6.output.LayerNorm.weight]
    %mul_28 : [#users=1] = call_function[target=operator.mul](args = (%weight_13, %truediv_20), kwargs = {})
    %bias_13 : [#users=1] = get_attr[target=layer.6.output.LayerNorm.bias]
    %add_76 : [#users=2] = call_function[target=operator.add](args = (%mul_28, %bias_13), kwargs = {})
    %in_proj_7 : [#users=1] = call_module[target=layer.7.attention.self.in_proj](args = (%add_76,), kwargs = {})
    %view_43 : [#users=1] = call_method[target=view](args = (%in_proj_7, [1, 256, 12, -1]), kwargs = {})
    %permute_42 : [#users=1] = call_method[target=permute](args = (%view_43, 0, 2, 1, 3), kwargs = {})
    %chunk_7 : [#users=3] = call_method[target=chunk](args = (%permute_42, 3), kwargs = {dim: -1})
    %getitem_44 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_7, 0), kwargs = {})
    %getitem_45 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_7, 1), kwargs = {})
    %getitem_46 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_7, 2), kwargs = {})
    %q_bias_7 : [#users=1] = get_attr[target=layer.7.attention.self.q_bias]
    %getitem_47 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_7, [None, None, slice(None, None, None)]), kwargs = {})
    %view_44 : [#users=1] = call_method[target=view](args = (%getitem_47, [1, 1, 12, -1]), kwargs = {})
    %permute_43 : [#users=1] = call_method[target=permute](args = (%view_44, 0, 2, 1, 3), kwargs = {})
    %add_77 : [#users=1] = call_function[target=operator.add](args = (%getitem_44, %permute_43), kwargs = {})
    %v_bias_7 : [#users=1] = get_attr[target=layer.7.attention.self.v_bias]
    %getitem_48 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_7, [None, None, slice(None, None, None)]), kwargs = {})
    %view_45 : [#users=1] = call_method[target=view](args = (%getitem_48, [1, 1, 12, -1]), kwargs = {})
    %permute_44 : [#users=1] = call_method[target=permute](args = (%view_45, 0, 2, 1, 3), kwargs = {})
    %add_78 : [#users=1] = call_function[target=operator.add](args = (%getitem_46, %permute_44), kwargs = {})
    %tensor_256 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_29 : [#users=1] = call_function[target=operator.mul](args = (%tensor_256, 3), kwargs = {})
    %sqrt_28 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_29,), kwargs = {})
    %to_42 : [#users=0] = call_method[target=to](args = (%sqrt_28,), kwargs = {dtype: torch.float32})
    %truediv_21 : [#users=2] = call_function[target=operator.truediv](args = (%add_77, %sqrt_28), kwargs = {})
    %transpose_28 : [#users=1] = call_method[target=transpose](args = (%getitem_45, -1, -2), kwargs = {})
    %matmul_28 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_21, %transpose_28), kwargs = {})
    %unsqueeze_18 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_7 : [#users=0] = call_method[target=long](args = (%unsqueeze_18,), kwargs = {})
    %to_43 : [#users=0] = call_method[target=to](args = (%unsqueeze_18, cpu), kwargs = {})
    %__external_param__13 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_49 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__13, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_19 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_49, 0), kwargs = {})
    %pos_proj_7 : [#users=1] = call_module[target=layer.7.attention.self.pos_proj](args = (%unsqueeze_19,), kwargs = {})
    %view_46 : [#users=1] = call_method[target=view](args = (%pos_proj_7, [1, 512, 12, -1]), kwargs = {})
    %permute_45 : [#users=1] = call_method[target=permute](args = (%view_46, 0, 2, 1, 3), kwargs = {})
    %transpose_29 : [#users=1] = call_method[target=transpose](args = (%permute_45, -1, -2), kwargs = {})
    %matmul_29 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_21, %transpose_29), kwargs = {})
    %add_79 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_18, 256), kwargs = {})
    %clamp_14 : [#users=1] = call_function[target=torch.clamp](args = (%add_79, 0, 511), kwargs = {})
    %expand_14 : [#users=1] = call_method[target=expand](args = (%clamp_14, [1, 12, 256, 256]), kwargs = {})
    %gather_14 : [#users=2] = call_function[target=torch.gather](args = (%matmul_29,), kwargs = {dim: -1, index: %expand_14})
    %full_like_7 : [#users=1] = call_function[target=torch.full_like](args = (%gather_14, 0), kwargs = {})
    %iadd_14 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_7, %gather_14), kwargs = {})
    %pos_q_proj_7 : [#users=1] = call_module[target=layer.7.attention.self.pos_q_proj](args = (%unsqueeze_19,), kwargs = {})
    %view_47 : [#users=1] = call_method[target=view](args = (%pos_q_proj_7, [1, 512, 12, -1]), kwargs = {})
    %permute_46 : [#users=1] = call_method[target=permute](args = (%view_47, 0, 2, 1, 3), kwargs = {})
    %tensor_279 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_30 : [#users=1] = call_function[target=operator.mul](args = (%tensor_279, 3), kwargs = {})
    %sqrt_29 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_30,), kwargs = {})
    %itruediv_7 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_46, %sqrt_29), kwargs = {})
    %neg_7 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_18,), kwargs = {})
    %add_80 : [#users=1] = call_function[target=operator.add](args = (%neg_7, 256), kwargs = {})
    %clamp_15 : [#users=1] = call_function[target=torch.clamp](args = (%add_80, 0, 511), kwargs = {})
    %transpose_30 : [#users=2] = call_method[target=transpose](args = (%itruediv_7, -1, -2), kwargs = {})
    %to_44 : [#users=0] = call_method[target=to](args = (%transpose_30,), kwargs = {dtype: torch.float32})
    %matmul_30 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_45, %transpose_30), kwargs = {})
    %expand_15 : [#users=1] = call_method[target=expand](args = (%clamp_15, [1, 12, 256, 256]), kwargs = {})
    %gather_15 : [#users=1] = call_function[target=torch.gather](args = (%matmul_30,), kwargs = {dim: -1, index: %expand_15})
    %transpose_31 : [#users=1] = call_method[target=transpose](args = (%gather_15, -1, -2), kwargs = {})
    %iadd_15 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_14, %transpose_31), kwargs = {})
    %add_81 : [#users=1] = call_function[target=operator.add](args = (%matmul_28, %iadd_15), kwargs = {})
    %to_45 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_7 : [#users=2] = call_function[target=operator.invert](args = (%to_45,), kwargs = {})
    %tensor_291 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_7 : [#users=1] = call_method[target=masked_fill](args = (%add_81, %invert_7, %tensor_291), kwargs = {})
    %softmax_7 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_7, -1), kwargs = {})
    %masked_fill__7 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_7, %invert_7, 0), kwargs = {})
    %matmul_31 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_7, %add_78), kwargs = {})
    %permute_47 : [#users=1] = call_method[target=permute](args = (%matmul_31, 0, 2, 1, 3), kwargs = {})
    %contiguous_7 : [#users=1] = call_method[target=contiguous](args = (%permute_47,), kwargs = {})
    %view_48 : [#users=1] = call_method[target=view](args = (%contiguous_7, [1, 256, -1]), kwargs = {})
    %dense_21 : [#users=1] = call_module[target=layer.7.attention.output.dense](args = (%view_48,), kwargs = {})
    %add_82 : [#users=4] = call_function[target=operator.add](args = (%dense_21, %add_76), kwargs = {})
    %float_15 : [#users=0] = call_method[target=float](args = (%add_82,), kwargs = {})
    %mean_28 : [#users=2] = call_method[target=mean](args = (%add_82, -1), kwargs = {keepdim: True})
    %sub_29 : [#users=1] = call_function[target=operator.sub](args = (%add_82, %mean_28), kwargs = {})
    %pow_15 : [#users=1] = call_method[target=pow](args = (%sub_29, 2), kwargs = {})
    %mean_29 : [#users=1] = call_method[target=mean](args = (%pow_15, -1), kwargs = {keepdim: True})
    %sub_30 : [#users=1] = call_function[target=operator.sub](args = (%add_82, %mean_28), kwargs = {})
    %add_83 : [#users=1] = call_function[target=operator.add](args = (%mean_29, 1e-07), kwargs = {})
    %sqrt_30 : [#users=1] = call_function[target=torch.sqrt](args = (%add_83,), kwargs = {})
    %truediv_22 : [#users=2] = call_function[target=operator.truediv](args = (%sub_30, %sqrt_30), kwargs = {})
    %to_46 : [#users=0] = call_method[target=to](args = (%truediv_22, torch.float32), kwargs = {})
    %weight_14 : [#users=1] = get_attr[target=layer.7.attention.output.LayerNorm.weight]
    %mul_31 : [#users=1] = call_function[target=operator.mul](args = (%weight_14, %truediv_22), kwargs = {})
    %bias_14 : [#users=1] = get_attr[target=layer.7.attention.output.LayerNorm.bias]
    %add_84 : [#users=2] = call_function[target=operator.add](args = (%mul_31, %bias_14), kwargs = {})
    %dense_22 : [#users=1] = call_module[target=layer.7.intermediate.dense](args = (%add_84,), kwargs = {})
    %gelu_7 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_22,), kwargs = {})
    %dense_23 : [#users=1] = call_module[target=layer.7.output.dense](args = (%gelu_7,), kwargs = {})
    %add_85 : [#users=4] = call_function[target=operator.add](args = (%dense_23, %add_84), kwargs = {})
    %float_16 : [#users=0] = call_method[target=float](args = (%add_85,), kwargs = {})
    %mean_30 : [#users=2] = call_method[target=mean](args = (%add_85, -1), kwargs = {keepdim: True})
    %sub_31 : [#users=1] = call_function[target=operator.sub](args = (%add_85, %mean_30), kwargs = {})
    %pow_16 : [#users=1] = call_method[target=pow](args = (%sub_31, 2), kwargs = {})
    %mean_31 : [#users=1] = call_method[target=mean](args = (%pow_16, -1), kwargs = {keepdim: True})
    %sub_32 : [#users=1] = call_function[target=operator.sub](args = (%add_85, %mean_30), kwargs = {})
    %add_86 : [#users=1] = call_function[target=operator.add](args = (%mean_31, 1e-07), kwargs = {})
    %sqrt_31 : [#users=1] = call_function[target=torch.sqrt](args = (%add_86,), kwargs = {})
    %truediv_23 : [#users=2] = call_function[target=operator.truediv](args = (%sub_32, %sqrt_31), kwargs = {})
    %to_47 : [#users=0] = call_method[target=to](args = (%truediv_23, torch.float32), kwargs = {})
    %weight_15 : [#users=1] = get_attr[target=layer.7.output.LayerNorm.weight]
    %mul_32 : [#users=1] = call_function[target=operator.mul](args = (%weight_15, %truediv_23), kwargs = {})
    %bias_15 : [#users=1] = get_attr[target=layer.7.output.LayerNorm.bias]
    %add_87 : [#users=2] = call_function[target=operator.add](args = (%mul_32, %bias_15), kwargs = {})
    %in_proj_8 : [#users=1] = call_module[target=layer.8.attention.self.in_proj](args = (%add_87,), kwargs = {})
    %view_49 : [#users=1] = call_method[target=view](args = (%in_proj_8, [1, 256, 12, -1]), kwargs = {})
    %permute_48 : [#users=1] = call_method[target=permute](args = (%view_49, 0, 2, 1, 3), kwargs = {})
    %chunk_8 : [#users=3] = call_method[target=chunk](args = (%permute_48, 3), kwargs = {dim: -1})
    %getitem_50 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_8, 0), kwargs = {})
    %getitem_51 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_8, 1), kwargs = {})
    %getitem_52 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_8, 2), kwargs = {})
    %q_bias_8 : [#users=1] = get_attr[target=layer.8.attention.self.q_bias]
    %getitem_53 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_8, [None, None, slice(None, None, None)]), kwargs = {})
    %view_50 : [#users=1] = call_method[target=view](args = (%getitem_53, [1, 1, 12, -1]), kwargs = {})
    %permute_49 : [#users=1] = call_method[target=permute](args = (%view_50, 0, 2, 1, 3), kwargs = {})
    %add_88 : [#users=1] = call_function[target=operator.add](args = (%getitem_50, %permute_49), kwargs = {})
    %v_bias_8 : [#users=1] = get_attr[target=layer.8.attention.self.v_bias]
    %getitem_54 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_8, [None, None, slice(None, None, None)]), kwargs = {})
    %view_51 : [#users=1] = call_method[target=view](args = (%getitem_54, [1, 1, 12, -1]), kwargs = {})
    %permute_50 : [#users=1] = call_method[target=permute](args = (%view_51, 0, 2, 1, 3), kwargs = {})
    %add_89 : [#users=1] = call_function[target=operator.add](args = (%getitem_52, %permute_50), kwargs = {})
    %tensor_292 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_33 : [#users=1] = call_function[target=operator.mul](args = (%tensor_292, 3), kwargs = {})
    %sqrt_32 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_33,), kwargs = {})
    %to_48 : [#users=0] = call_method[target=to](args = (%sqrt_32,), kwargs = {dtype: torch.float32})
    %truediv_24 : [#users=2] = call_function[target=operator.truediv](args = (%add_88, %sqrt_32), kwargs = {})
    %transpose_32 : [#users=1] = call_method[target=transpose](args = (%getitem_51, -1, -2), kwargs = {})
    %matmul_32 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_24, %transpose_32), kwargs = {})
    %unsqueeze_20 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_8 : [#users=0] = call_method[target=long](args = (%unsqueeze_20,), kwargs = {})
    %to_49 : [#users=0] = call_method[target=to](args = (%unsqueeze_20, cpu), kwargs = {})
    %__external_param__14 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_55 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__14, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_21 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_55, 0), kwargs = {})
    %pos_proj_8 : [#users=1] = call_module[target=layer.8.attention.self.pos_proj](args = (%unsqueeze_21,), kwargs = {})
    %view_52 : [#users=1] = call_method[target=view](args = (%pos_proj_8, [1, 512, 12, -1]), kwargs = {})
    %permute_51 : [#users=1] = call_method[target=permute](args = (%view_52, 0, 2, 1, 3), kwargs = {})
    %transpose_33 : [#users=1] = call_method[target=transpose](args = (%permute_51, -1, -2), kwargs = {})
    %matmul_33 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_24, %transpose_33), kwargs = {})
    %add_90 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_20, 256), kwargs = {})
    %clamp_16 : [#users=1] = call_function[target=torch.clamp](args = (%add_90, 0, 511), kwargs = {})
    %expand_16 : [#users=1] = call_method[target=expand](args = (%clamp_16, [1, 12, 256, 256]), kwargs = {})
    %gather_16 : [#users=2] = call_function[target=torch.gather](args = (%matmul_33,), kwargs = {dim: -1, index: %expand_16})
    %full_like_8 : [#users=1] = call_function[target=torch.full_like](args = (%gather_16, 0), kwargs = {})
    %iadd_16 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_8, %gather_16), kwargs = {})
    %pos_q_proj_8 : [#users=1] = call_module[target=layer.8.attention.self.pos_q_proj](args = (%unsqueeze_21,), kwargs = {})
    %view_53 : [#users=1] = call_method[target=view](args = (%pos_q_proj_8, [1, 512, 12, -1]), kwargs = {})
    %permute_52 : [#users=1] = call_method[target=permute](args = (%view_53, 0, 2, 1, 3), kwargs = {})
    %tensor_315 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_34 : [#users=1] = call_function[target=operator.mul](args = (%tensor_315, 3), kwargs = {})
    %sqrt_33 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_34,), kwargs = {})
    %itruediv_8 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_52, %sqrt_33), kwargs = {})
    %neg_8 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_20,), kwargs = {})
    %add_91 : [#users=1] = call_function[target=operator.add](args = (%neg_8, 256), kwargs = {})
    %clamp_17 : [#users=1] = call_function[target=torch.clamp](args = (%add_91, 0, 511), kwargs = {})
    %transpose_34 : [#users=2] = call_method[target=transpose](args = (%itruediv_8, -1, -2), kwargs = {})
    %to_50 : [#users=0] = call_method[target=to](args = (%transpose_34,), kwargs = {dtype: torch.float32})
    %matmul_34 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_51, %transpose_34), kwargs = {})
    %expand_17 : [#users=1] = call_method[target=expand](args = (%clamp_17, [1, 12, 256, 256]), kwargs = {})
    %gather_17 : [#users=1] = call_function[target=torch.gather](args = (%matmul_34,), kwargs = {dim: -1, index: %expand_17})
    %transpose_35 : [#users=1] = call_method[target=transpose](args = (%gather_17, -1, -2), kwargs = {})
    %iadd_17 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_16, %transpose_35), kwargs = {})
    %add_92 : [#users=1] = call_function[target=operator.add](args = (%matmul_32, %iadd_17), kwargs = {})
    %to_51 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_8 : [#users=2] = call_function[target=operator.invert](args = (%to_51,), kwargs = {})
    %tensor_327 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_8 : [#users=1] = call_method[target=masked_fill](args = (%add_92, %invert_8, %tensor_327), kwargs = {})
    %softmax_8 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_8, -1), kwargs = {})
    %masked_fill__8 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_8, %invert_8, 0), kwargs = {})
    %matmul_35 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_8, %add_89), kwargs = {})
    %permute_53 : [#users=1] = call_method[target=permute](args = (%matmul_35, 0, 2, 1, 3), kwargs = {})
    %contiguous_8 : [#users=1] = call_method[target=contiguous](args = (%permute_53,), kwargs = {})
    %view_54 : [#users=1] = call_method[target=view](args = (%contiguous_8, [1, 256, -1]), kwargs = {})
    %dense_24 : [#users=1] = call_module[target=layer.8.attention.output.dense](args = (%view_54,), kwargs = {})
    %add_93 : [#users=4] = call_function[target=operator.add](args = (%dense_24, %add_87), kwargs = {})
    %float_17 : [#users=0] = call_method[target=float](args = (%add_93,), kwargs = {})
    %mean_32 : [#users=2] = call_method[target=mean](args = (%add_93, -1), kwargs = {keepdim: True})
    %sub_33 : [#users=1] = call_function[target=operator.sub](args = (%add_93, %mean_32), kwargs = {})
    %pow_17 : [#users=1] = call_method[target=pow](args = (%sub_33, 2), kwargs = {})
    %mean_33 : [#users=1] = call_method[target=mean](args = (%pow_17, -1), kwargs = {keepdim: True})
    %sub_34 : [#users=1] = call_function[target=operator.sub](args = (%add_93, %mean_32), kwargs = {})
    %add_94 : [#users=1] = call_function[target=operator.add](args = (%mean_33, 1e-07), kwargs = {})
    %sqrt_34 : [#users=1] = call_function[target=torch.sqrt](args = (%add_94,), kwargs = {})
    %truediv_25 : [#users=2] = call_function[target=operator.truediv](args = (%sub_34, %sqrt_34), kwargs = {})
    %to_52 : [#users=0] = call_method[target=to](args = (%truediv_25, torch.float32), kwargs = {})
    %weight_16 : [#users=1] = get_attr[target=layer.8.attention.output.LayerNorm.weight]
    %mul_35 : [#users=1] = call_function[target=operator.mul](args = (%weight_16, %truediv_25), kwargs = {})
    %bias_16 : [#users=1] = get_attr[target=layer.8.attention.output.LayerNorm.bias]
    %add_95 : [#users=2] = call_function[target=operator.add](args = (%mul_35, %bias_16), kwargs = {})
    %dense_25 : [#users=1] = call_module[target=layer.8.intermediate.dense](args = (%add_95,), kwargs = {})
    %gelu_8 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_25,), kwargs = {})
    %dense_26 : [#users=1] = call_module[target=layer.8.output.dense](args = (%gelu_8,), kwargs = {})
    %add_96 : [#users=4] = call_function[target=operator.add](args = (%dense_26, %add_95), kwargs = {})
    %float_18 : [#users=0] = call_method[target=float](args = (%add_96,), kwargs = {})
    %mean_34 : [#users=2] = call_method[target=mean](args = (%add_96, -1), kwargs = {keepdim: True})
    %sub_35 : [#users=1] = call_function[target=operator.sub](args = (%add_96, %mean_34), kwargs = {})
    %pow_18 : [#users=1] = call_method[target=pow](args = (%sub_35, 2), kwargs = {})
    %mean_35 : [#users=1] = call_method[target=mean](args = (%pow_18, -1), kwargs = {keepdim: True})
    %sub_36 : [#users=1] = call_function[target=operator.sub](args = (%add_96, %mean_34), kwargs = {})
    %add_97 : [#users=1] = call_function[target=operator.add](args = (%mean_35, 1e-07), kwargs = {})
    %sqrt_35 : [#users=1] = call_function[target=torch.sqrt](args = (%add_97,), kwargs = {})
    %truediv_26 : [#users=2] = call_function[target=operator.truediv](args = (%sub_36, %sqrt_35), kwargs = {})
    %to_53 : [#users=0] = call_method[target=to](args = (%truediv_26, torch.float32), kwargs = {})
    %weight_17 : [#users=1] = get_attr[target=layer.8.output.LayerNorm.weight]
    %mul_36 : [#users=1] = call_function[target=operator.mul](args = (%weight_17, %truediv_26), kwargs = {})
    %bias_17 : [#users=1] = get_attr[target=layer.8.output.LayerNorm.bias]
    %add_98 : [#users=2] = call_function[target=operator.add](args = (%mul_36, %bias_17), kwargs = {})
    %in_proj_9 : [#users=1] = call_module[target=layer.9.attention.self.in_proj](args = (%add_98,), kwargs = {})
    %view_55 : [#users=1] = call_method[target=view](args = (%in_proj_9, [1, 256, 12, -1]), kwargs = {})
    %permute_54 : [#users=1] = call_method[target=permute](args = (%view_55, 0, 2, 1, 3), kwargs = {})
    %chunk_9 : [#users=3] = call_method[target=chunk](args = (%permute_54, 3), kwargs = {dim: -1})
    %getitem_56 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_9, 0), kwargs = {})
    %getitem_57 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_9, 1), kwargs = {})
    %getitem_58 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_9, 2), kwargs = {})
    %q_bias_9 : [#users=1] = get_attr[target=layer.9.attention.self.q_bias]
    %getitem_59 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_9, [None, None, slice(None, None, None)]), kwargs = {})
    %view_56 : [#users=1] = call_method[target=view](args = (%getitem_59, [1, 1, 12, -1]), kwargs = {})
    %permute_55 : [#users=1] = call_method[target=permute](args = (%view_56, 0, 2, 1, 3), kwargs = {})
    %add_99 : [#users=1] = call_function[target=operator.add](args = (%getitem_56, %permute_55), kwargs = {})
    %v_bias_9 : [#users=1] = get_attr[target=layer.9.attention.self.v_bias]
    %getitem_60 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_9, [None, None, slice(None, None, None)]), kwargs = {})
    %view_57 : [#users=1] = call_method[target=view](args = (%getitem_60, [1, 1, 12, -1]), kwargs = {})
    %permute_56 : [#users=1] = call_method[target=permute](args = (%view_57, 0, 2, 1, 3), kwargs = {})
    %add_100 : [#users=1] = call_function[target=operator.add](args = (%getitem_58, %permute_56), kwargs = {})
    %tensor_328 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_37 : [#users=1] = call_function[target=operator.mul](args = (%tensor_328, 3), kwargs = {})
    %sqrt_36 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_37,), kwargs = {})
    %to_54 : [#users=0] = call_method[target=to](args = (%sqrt_36,), kwargs = {dtype: torch.float32})
    %truediv_27 : [#users=2] = call_function[target=operator.truediv](args = (%add_99, %sqrt_36), kwargs = {})
    %transpose_36 : [#users=1] = call_method[target=transpose](args = (%getitem_57, -1, -2), kwargs = {})
    %matmul_36 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_27, %transpose_36), kwargs = {})
    %unsqueeze_22 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_9 : [#users=0] = call_method[target=long](args = (%unsqueeze_22,), kwargs = {})
    %to_55 : [#users=0] = call_method[target=to](args = (%unsqueeze_22, cpu), kwargs = {})
    %__external_param__15 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_61 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__15, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_23 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_61, 0), kwargs = {})
    %pos_proj_9 : [#users=1] = call_module[target=layer.9.attention.self.pos_proj](args = (%unsqueeze_23,), kwargs = {})
    %view_58 : [#users=1] = call_method[target=view](args = (%pos_proj_9, [1, 512, 12, -1]), kwargs = {})
    %permute_57 : [#users=1] = call_method[target=permute](args = (%view_58, 0, 2, 1, 3), kwargs = {})
    %transpose_37 : [#users=1] = call_method[target=transpose](args = (%permute_57, -1, -2), kwargs = {})
    %matmul_37 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_27, %transpose_37), kwargs = {})
    %add_101 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_22, 256), kwargs = {})
    %clamp_18 : [#users=1] = call_function[target=torch.clamp](args = (%add_101, 0, 511), kwargs = {})
    %expand_18 : [#users=1] = call_method[target=expand](args = (%clamp_18, [1, 12, 256, 256]), kwargs = {})
    %gather_18 : [#users=2] = call_function[target=torch.gather](args = (%matmul_37,), kwargs = {dim: -1, index: %expand_18})
    %full_like_9 : [#users=1] = call_function[target=torch.full_like](args = (%gather_18, 0), kwargs = {})
    %iadd_18 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_9, %gather_18), kwargs = {})
    %pos_q_proj_9 : [#users=1] = call_module[target=layer.9.attention.self.pos_q_proj](args = (%unsqueeze_23,), kwargs = {})
    %view_59 : [#users=1] = call_method[target=view](args = (%pos_q_proj_9, [1, 512, 12, -1]), kwargs = {})
    %permute_58 : [#users=1] = call_method[target=permute](args = (%view_59, 0, 2, 1, 3), kwargs = {})
    %tensor_351 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_38 : [#users=1] = call_function[target=operator.mul](args = (%tensor_351, 3), kwargs = {})
    %sqrt_37 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_38,), kwargs = {})
    %itruediv_9 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_58, %sqrt_37), kwargs = {})
    %neg_9 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_22,), kwargs = {})
    %add_102 : [#users=1] = call_function[target=operator.add](args = (%neg_9, 256), kwargs = {})
    %clamp_19 : [#users=1] = call_function[target=torch.clamp](args = (%add_102, 0, 511), kwargs = {})
    %transpose_38 : [#users=2] = call_method[target=transpose](args = (%itruediv_9, -1, -2), kwargs = {})
    %to_56 : [#users=0] = call_method[target=to](args = (%transpose_38,), kwargs = {dtype: torch.float32})
    %matmul_38 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_57, %transpose_38), kwargs = {})
    %expand_19 : [#users=1] = call_method[target=expand](args = (%clamp_19, [1, 12, 256, 256]), kwargs = {})
    %gather_19 : [#users=1] = call_function[target=torch.gather](args = (%matmul_38,), kwargs = {dim: -1, index: %expand_19})
    %transpose_39 : [#users=1] = call_method[target=transpose](args = (%gather_19, -1, -2), kwargs = {})
    %iadd_19 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_18, %transpose_39), kwargs = {})
    %add_103 : [#users=1] = call_function[target=operator.add](args = (%matmul_36, %iadd_19), kwargs = {})
    %to_57 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_9 : [#users=2] = call_function[target=operator.invert](args = (%to_57,), kwargs = {})
    %tensor_363 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_9 : [#users=1] = call_method[target=masked_fill](args = (%add_103, %invert_9, %tensor_363), kwargs = {})
    %softmax_9 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_9, -1), kwargs = {})
    %masked_fill__9 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_9, %invert_9, 0), kwargs = {})
    %matmul_39 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_9, %add_100), kwargs = {})
    %permute_59 : [#users=1] = call_method[target=permute](args = (%matmul_39, 0, 2, 1, 3), kwargs = {})
    %contiguous_9 : [#users=1] = call_method[target=contiguous](args = (%permute_59,), kwargs = {})
    %view_60 : [#users=1] = call_method[target=view](args = (%contiguous_9, [1, 256, -1]), kwargs = {})
    %dense_27 : [#users=1] = call_module[target=layer.9.attention.output.dense](args = (%view_60,), kwargs = {})
    %add_104 : [#users=4] = call_function[target=operator.add](args = (%dense_27, %add_98), kwargs = {})
    %float_19 : [#users=0] = call_method[target=float](args = (%add_104,), kwargs = {})
    %mean_36 : [#users=2] = call_method[target=mean](args = (%add_104, -1), kwargs = {keepdim: True})
    %sub_37 : [#users=1] = call_function[target=operator.sub](args = (%add_104, %mean_36), kwargs = {})
    %pow_19 : [#users=1] = call_method[target=pow](args = (%sub_37, 2), kwargs = {})
    %mean_37 : [#users=1] = call_method[target=mean](args = (%pow_19, -1), kwargs = {keepdim: True})
    %sub_38 : [#users=1] = call_function[target=operator.sub](args = (%add_104, %mean_36), kwargs = {})
    %add_105 : [#users=1] = call_function[target=operator.add](args = (%mean_37, 1e-07), kwargs = {})
    %sqrt_38 : [#users=1] = call_function[target=torch.sqrt](args = (%add_105,), kwargs = {})
    %truediv_28 : [#users=2] = call_function[target=operator.truediv](args = (%sub_38, %sqrt_38), kwargs = {})
    %to_58 : [#users=0] = call_method[target=to](args = (%truediv_28, torch.float32), kwargs = {})
    %weight_18 : [#users=1] = get_attr[target=layer.9.attention.output.LayerNorm.weight]
    %mul_39 : [#users=1] = call_function[target=operator.mul](args = (%weight_18, %truediv_28), kwargs = {})
    %bias_18 : [#users=1] = get_attr[target=layer.9.attention.output.LayerNorm.bias]
    %add_106 : [#users=2] = call_function[target=operator.add](args = (%mul_39, %bias_18), kwargs = {})
    %dense_28 : [#users=1] = call_module[target=layer.9.intermediate.dense](args = (%add_106,), kwargs = {})
    %gelu_9 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_28,), kwargs = {})
    %dense_29 : [#users=1] = call_module[target=layer.9.output.dense](args = (%gelu_9,), kwargs = {})
    %add_107 : [#users=4] = call_function[target=operator.add](args = (%dense_29, %add_106), kwargs = {})
    %float_20 : [#users=0] = call_method[target=float](args = (%add_107,), kwargs = {})
    %mean_38 : [#users=2] = call_method[target=mean](args = (%add_107, -1), kwargs = {keepdim: True})
    %sub_39 : [#users=1] = call_function[target=operator.sub](args = (%add_107, %mean_38), kwargs = {})
    %pow_20 : [#users=1] = call_method[target=pow](args = (%sub_39, 2), kwargs = {})
    %mean_39 : [#users=1] = call_method[target=mean](args = (%pow_20, -1), kwargs = {keepdim: True})
    %sub_40 : [#users=1] = call_function[target=operator.sub](args = (%add_107, %mean_38), kwargs = {})
    %add_108 : [#users=1] = call_function[target=operator.add](args = (%mean_39, 1e-07), kwargs = {})
    %sqrt_39 : [#users=1] = call_function[target=torch.sqrt](args = (%add_108,), kwargs = {})
    %truediv_29 : [#users=2] = call_function[target=operator.truediv](args = (%sub_40, %sqrt_39), kwargs = {})
    %to_59 : [#users=0] = call_method[target=to](args = (%truediv_29, torch.float32), kwargs = {})
    %weight_19 : [#users=1] = get_attr[target=layer.9.output.LayerNorm.weight]
    %mul_40 : [#users=1] = call_function[target=operator.mul](args = (%weight_19, %truediv_29), kwargs = {})
    %bias_19 : [#users=1] = get_attr[target=layer.9.output.LayerNorm.bias]
    %add_109 : [#users=2] = call_function[target=operator.add](args = (%mul_40, %bias_19), kwargs = {})
    %in_proj_10 : [#users=1] = call_module[target=layer.10.attention.self.in_proj](args = (%add_109,), kwargs = {})
    %view_61 : [#users=1] = call_method[target=view](args = (%in_proj_10, [1, 256, 12, -1]), kwargs = {})
    %permute_60 : [#users=1] = call_method[target=permute](args = (%view_61, 0, 2, 1, 3), kwargs = {})
    %chunk_10 : [#users=3] = call_method[target=chunk](args = (%permute_60, 3), kwargs = {dim: -1})
    %getitem_62 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_10, 0), kwargs = {})
    %getitem_63 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_10, 1), kwargs = {})
    %getitem_64 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_10, 2), kwargs = {})
    %q_bias_10 : [#users=1] = get_attr[target=layer.10.attention.self.q_bias]
    %getitem_65 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_10, [None, None, slice(None, None, None)]), kwargs = {})
    %view_62 : [#users=1] = call_method[target=view](args = (%getitem_65, [1, 1, 12, -1]), kwargs = {})
    %permute_61 : [#users=1] = call_method[target=permute](args = (%view_62, 0, 2, 1, 3), kwargs = {})
    %add_110 : [#users=1] = call_function[target=operator.add](args = (%getitem_62, %permute_61), kwargs = {})
    %v_bias_10 : [#users=1] = get_attr[target=layer.10.attention.self.v_bias]
    %getitem_66 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_10, [None, None, slice(None, None, None)]), kwargs = {})
    %view_63 : [#users=1] = call_method[target=view](args = (%getitem_66, [1, 1, 12, -1]), kwargs = {})
    %permute_62 : [#users=1] = call_method[target=permute](args = (%view_63, 0, 2, 1, 3), kwargs = {})
    %add_111 : [#users=1] = call_function[target=operator.add](args = (%getitem_64, %permute_62), kwargs = {})
    %tensor_364 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_41 : [#users=1] = call_function[target=operator.mul](args = (%tensor_364, 3), kwargs = {})
    %sqrt_40 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_41,), kwargs = {})
    %to_60 : [#users=0] = call_method[target=to](args = (%sqrt_40,), kwargs = {dtype: torch.float32})
    %truediv_30 : [#users=2] = call_function[target=operator.truediv](args = (%add_110, %sqrt_40), kwargs = {})
    %transpose_40 : [#users=1] = call_method[target=transpose](args = (%getitem_63, -1, -2), kwargs = {})
    %matmul_40 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_30, %transpose_40), kwargs = {})
    %unsqueeze_24 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_10 : [#users=0] = call_method[target=long](args = (%unsqueeze_24,), kwargs = {})
    %to_61 : [#users=0] = call_method[target=to](args = (%unsqueeze_24, cpu), kwargs = {})
    %__external_param__16 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_67 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__16, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_25 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_67, 0), kwargs = {})
    %pos_proj_10 : [#users=1] = call_module[target=layer.10.attention.self.pos_proj](args = (%unsqueeze_25,), kwargs = {})
    %view_64 : [#users=1] = call_method[target=view](args = (%pos_proj_10, [1, 512, 12, -1]), kwargs = {})
    %permute_63 : [#users=1] = call_method[target=permute](args = (%view_64, 0, 2, 1, 3), kwargs = {})
    %transpose_41 : [#users=1] = call_method[target=transpose](args = (%permute_63, -1, -2), kwargs = {})
    %matmul_41 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_30, %transpose_41), kwargs = {})
    %add_112 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_24, 256), kwargs = {})
    %clamp_20 : [#users=1] = call_function[target=torch.clamp](args = (%add_112, 0, 511), kwargs = {})
    %expand_20 : [#users=1] = call_method[target=expand](args = (%clamp_20, [1, 12, 256, 256]), kwargs = {})
    %gather_20 : [#users=2] = call_function[target=torch.gather](args = (%matmul_41,), kwargs = {dim: -1, index: %expand_20})
    %full_like_10 : [#users=1] = call_function[target=torch.full_like](args = (%gather_20, 0), kwargs = {})
    %iadd_20 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_10, %gather_20), kwargs = {})
    %pos_q_proj_10 : [#users=1] = call_module[target=layer.10.attention.self.pos_q_proj](args = (%unsqueeze_25,), kwargs = {})
    %view_65 : [#users=1] = call_method[target=view](args = (%pos_q_proj_10, [1, 512, 12, -1]), kwargs = {})
    %permute_64 : [#users=1] = call_method[target=permute](args = (%view_65, 0, 2, 1, 3), kwargs = {})
    %tensor_387 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_42 : [#users=1] = call_function[target=operator.mul](args = (%tensor_387, 3), kwargs = {})
    %sqrt_41 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_42,), kwargs = {})
    %itruediv_10 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_64, %sqrt_41), kwargs = {})
    %neg_10 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_24,), kwargs = {})
    %add_113 : [#users=1] = call_function[target=operator.add](args = (%neg_10, 256), kwargs = {})
    %clamp_21 : [#users=1] = call_function[target=torch.clamp](args = (%add_113, 0, 511), kwargs = {})
    %transpose_42 : [#users=2] = call_method[target=transpose](args = (%itruediv_10, -1, -2), kwargs = {})
    %to_62 : [#users=0] = call_method[target=to](args = (%transpose_42,), kwargs = {dtype: torch.float32})
    %matmul_42 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_63, %transpose_42), kwargs = {})
    %expand_21 : [#users=1] = call_method[target=expand](args = (%clamp_21, [1, 12, 256, 256]), kwargs = {})
    %gather_21 : [#users=1] = call_function[target=torch.gather](args = (%matmul_42,), kwargs = {dim: -1, index: %expand_21})
    %transpose_43 : [#users=1] = call_method[target=transpose](args = (%gather_21, -1, -2), kwargs = {})
    %iadd_21 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_20, %transpose_43), kwargs = {})
    %add_114 : [#users=1] = call_function[target=operator.add](args = (%matmul_40, %iadd_21), kwargs = {})
    %to_63 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_10 : [#users=2] = call_function[target=operator.invert](args = (%to_63,), kwargs = {})
    %tensor_399 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_10 : [#users=1] = call_method[target=masked_fill](args = (%add_114, %invert_10, %tensor_399), kwargs = {})
    %softmax_10 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_10, -1), kwargs = {})
    %masked_fill__10 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_10, %invert_10, 0), kwargs = {})
    %matmul_43 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_10, %add_111), kwargs = {})
    %permute_65 : [#users=1] = call_method[target=permute](args = (%matmul_43, 0, 2, 1, 3), kwargs = {})
    %contiguous_10 : [#users=1] = call_method[target=contiguous](args = (%permute_65,), kwargs = {})
    %view_66 : [#users=1] = call_method[target=view](args = (%contiguous_10, [1, 256, -1]), kwargs = {})
    %dense_30 : [#users=1] = call_module[target=layer.10.attention.output.dense](args = (%view_66,), kwargs = {})
    %add_115 : [#users=4] = call_function[target=operator.add](args = (%dense_30, %add_109), kwargs = {})
    %float_21 : [#users=0] = call_method[target=float](args = (%add_115,), kwargs = {})
    %mean_40 : [#users=2] = call_method[target=mean](args = (%add_115, -1), kwargs = {keepdim: True})
    %sub_41 : [#users=1] = call_function[target=operator.sub](args = (%add_115, %mean_40), kwargs = {})
    %pow_21 : [#users=1] = call_method[target=pow](args = (%sub_41, 2), kwargs = {})
    %mean_41 : [#users=1] = call_method[target=mean](args = (%pow_21, -1), kwargs = {keepdim: True})
    %sub_42 : [#users=1] = call_function[target=operator.sub](args = (%add_115, %mean_40), kwargs = {})
    %add_116 : [#users=1] = call_function[target=operator.add](args = (%mean_41, 1e-07), kwargs = {})
    %sqrt_42 : [#users=1] = call_function[target=torch.sqrt](args = (%add_116,), kwargs = {})
    %truediv_31 : [#users=2] = call_function[target=operator.truediv](args = (%sub_42, %sqrt_42), kwargs = {})
    %to_64 : [#users=0] = call_method[target=to](args = (%truediv_31, torch.float32), kwargs = {})
    %weight_20 : [#users=1] = get_attr[target=layer.10.attention.output.LayerNorm.weight]
    %mul_43 : [#users=1] = call_function[target=operator.mul](args = (%weight_20, %truediv_31), kwargs = {})
    %bias_20 : [#users=1] = get_attr[target=layer.10.attention.output.LayerNorm.bias]
    %add_117 : [#users=2] = call_function[target=operator.add](args = (%mul_43, %bias_20), kwargs = {})
    %dense_31 : [#users=1] = call_module[target=layer.10.intermediate.dense](args = (%add_117,), kwargs = {})
    %gelu_10 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_31,), kwargs = {})
    %dense_32 : [#users=1] = call_module[target=layer.10.output.dense](args = (%gelu_10,), kwargs = {})
    %add_118 : [#users=4] = call_function[target=operator.add](args = (%dense_32, %add_117), kwargs = {})
    %float_22 : [#users=0] = call_method[target=float](args = (%add_118,), kwargs = {})
    %mean_42 : [#users=2] = call_method[target=mean](args = (%add_118, -1), kwargs = {keepdim: True})
    %sub_43 : [#users=1] = call_function[target=operator.sub](args = (%add_118, %mean_42), kwargs = {})
    %pow_22 : [#users=1] = call_method[target=pow](args = (%sub_43, 2), kwargs = {})
    %mean_43 : [#users=1] = call_method[target=mean](args = (%pow_22, -1), kwargs = {keepdim: True})
    %sub_44 : [#users=1] = call_function[target=operator.sub](args = (%add_118, %mean_42), kwargs = {})
    %add_119 : [#users=1] = call_function[target=operator.add](args = (%mean_43, 1e-07), kwargs = {})
    %sqrt_43 : [#users=1] = call_function[target=torch.sqrt](args = (%add_119,), kwargs = {})
    %truediv_32 : [#users=2] = call_function[target=operator.truediv](args = (%sub_44, %sqrt_43), kwargs = {})
    %to_65 : [#users=0] = call_method[target=to](args = (%truediv_32, torch.float32), kwargs = {})
    %weight_21 : [#users=1] = get_attr[target=layer.10.output.LayerNorm.weight]
    %mul_44 : [#users=1] = call_function[target=operator.mul](args = (%weight_21, %truediv_32), kwargs = {})
    %bias_21 : [#users=1] = get_attr[target=layer.10.output.LayerNorm.bias]
    %add_120 : [#users=2] = call_function[target=operator.add](args = (%mul_44, %bias_21), kwargs = {})
    %in_proj_11 : [#users=1] = call_module[target=layer.11.attention.self.in_proj](args = (%add_120,), kwargs = {})
    %view_67 : [#users=1] = call_method[target=view](args = (%in_proj_11, [1, 256, 12, -1]), kwargs = {})
    %permute_66 : [#users=1] = call_method[target=permute](args = (%view_67, 0, 2, 1, 3), kwargs = {})
    %chunk_11 : [#users=3] = call_method[target=chunk](args = (%permute_66, 3), kwargs = {dim: -1})
    %getitem_68 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_11, 0), kwargs = {})
    %getitem_69 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_11, 1), kwargs = {})
    %getitem_70 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_11, 2), kwargs = {})
    %q_bias_11 : [#users=1] = get_attr[target=layer.11.attention.self.q_bias]
    %getitem_71 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_11, [None, None, slice(None, None, None)]), kwargs = {})
    %view_68 : [#users=1] = call_method[target=view](args = (%getitem_71, [1, 1, 12, -1]), kwargs = {})
    %permute_67 : [#users=1] = call_method[target=permute](args = (%view_68, 0, 2, 1, 3), kwargs = {})
    %add_121 : [#users=1] = call_function[target=operator.add](args = (%getitem_68, %permute_67), kwargs = {})
    %v_bias_11 : [#users=1] = get_attr[target=layer.11.attention.self.v_bias]
    %getitem_72 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_11, [None, None, slice(None, None, None)]), kwargs = {})
    %view_69 : [#users=1] = call_method[target=view](args = (%getitem_72, [1, 1, 12, -1]), kwargs = {})
    %permute_68 : [#users=1] = call_method[target=permute](args = (%view_69, 0, 2, 1, 3), kwargs = {})
    %add_122 : [#users=1] = call_function[target=operator.add](args = (%getitem_70, %permute_68), kwargs = {})
    %tensor_400 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_45 : [#users=1] = call_function[target=operator.mul](args = (%tensor_400, 3), kwargs = {})
    %sqrt_44 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_45,), kwargs = {})
    %to_66 : [#users=0] = call_method[target=to](args = (%sqrt_44,), kwargs = {dtype: torch.float32})
    %truediv_33 : [#users=2] = call_function[target=operator.truediv](args = (%add_121, %sqrt_44), kwargs = {})
    %transpose_44 : [#users=1] = call_method[target=transpose](args = (%getitem_69, -1, -2), kwargs = {})
    %matmul_44 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_33, %transpose_44), kwargs = {})
    %unsqueeze_26 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_3, 1), kwargs = {})
    %long_11 : [#users=0] = call_method[target=long](args = (%unsqueeze_26,), kwargs = {})
    %to_67 : [#users=0] = call_method[target=to](args = (%unsqueeze_26, cpu), kwargs = {})
    %__external_param__17 : [#users=1] = get_attr[target=layer.0.attention.self.__external_param__6]
    %getitem_73 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__17, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_27 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_73, 0), kwargs = {})
    %pos_proj_11 : [#users=1] = call_module[target=layer.11.attention.self.pos_proj](args = (%unsqueeze_27,), kwargs = {})
    %view_70 : [#users=1] = call_method[target=view](args = (%pos_proj_11, [1, 512, 12, -1]), kwargs = {})
    %permute_69 : [#users=1] = call_method[target=permute](args = (%view_70, 0, 2, 1, 3), kwargs = {})
    %transpose_45 : [#users=1] = call_method[target=transpose](args = (%permute_69, -1, -2), kwargs = {})
    %matmul_45 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_33, %transpose_45), kwargs = {})
    %add_123 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_26, 256), kwargs = {})
    %clamp_22 : [#users=1] = call_function[target=torch.clamp](args = (%add_123, 0, 511), kwargs = {})
    %expand_22 : [#users=1] = call_method[target=expand](args = (%clamp_22, [1, 12, 256, 256]), kwargs = {})
    %gather_22 : [#users=2] = call_function[target=torch.gather](args = (%matmul_45,), kwargs = {dim: -1, index: %expand_22})
    %full_like_11 : [#users=1] = call_function[target=torch.full_like](args = (%gather_22, 0), kwargs = {})
    %iadd_22 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_11, %gather_22), kwargs = {})
    %pos_q_proj_11 : [#users=1] = call_module[target=layer.11.attention.self.pos_q_proj](args = (%unsqueeze_27,), kwargs = {})
    %view_71 : [#users=1] = call_method[target=view](args = (%pos_q_proj_11, [1, 512, 12, -1]), kwargs = {})
    %permute_70 : [#users=1] = call_method[target=permute](args = (%view_71, 0, 2, 1, 3), kwargs = {})
    %tensor_423 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_46 : [#users=1] = call_function[target=operator.mul](args = (%tensor_423, 3), kwargs = {})
    %sqrt_45 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_46,), kwargs = {})
    %itruediv_11 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_70, %sqrt_45), kwargs = {})
    %neg_11 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_26,), kwargs = {})
    %add_124 : [#users=1] = call_function[target=operator.add](args = (%neg_11, 256), kwargs = {})
    %clamp_23 : [#users=1] = call_function[target=torch.clamp](args = (%add_124, 0, 511), kwargs = {})
    %transpose_46 : [#users=2] = call_method[target=transpose](args = (%itruediv_11, -1, -2), kwargs = {})
    %to_68 : [#users=0] = call_method[target=to](args = (%transpose_46,), kwargs = {dtype: torch.float32})
    %matmul_46 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_69, %transpose_46), kwargs = {})
    %expand_23 : [#users=1] = call_method[target=expand](args = (%clamp_23, [1, 12, 256, 256]), kwargs = {})
    %gather_23 : [#users=1] = call_function[target=torch.gather](args = (%matmul_46,), kwargs = {dim: -1, index: %expand_23})
    %transpose_47 : [#users=1] = call_method[target=transpose](args = (%gather_23, -1, -2), kwargs = {})
    %iadd_23 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_22, %transpose_47), kwargs = {})
    %add_125 : [#users=1] = call_function[target=operator.add](args = (%matmul_44, %iadd_23), kwargs = {})
    %to_69 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_11 : [#users=2] = call_function[target=operator.invert](args = (%to_69,), kwargs = {})
    %tensor_435 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_11 : [#users=1] = call_method[target=masked_fill](args = (%add_125, %invert_11, %tensor_435), kwargs = {})
    %softmax_11 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_11, -1), kwargs = {})
    %masked_fill__11 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_11, %invert_11, 0), kwargs = {})
    %matmul_47 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_11, %add_122), kwargs = {})
    %permute_71 : [#users=1] = call_method[target=permute](args = (%matmul_47, 0, 2, 1, 3), kwargs = {})
    %contiguous_11 : [#users=1] = call_method[target=contiguous](args = (%permute_71,), kwargs = {})
    %view_72 : [#users=1] = call_method[target=view](args = (%contiguous_11, [1, 256, -1]), kwargs = {})
    %dense_33 : [#users=1] = call_module[target=layer.11.attention.output.dense](args = (%view_72,), kwargs = {})
    %add_126 : [#users=4] = call_function[target=operator.add](args = (%dense_33, %add_120), kwargs = {})
    %float_23 : [#users=0] = call_method[target=float](args = (%add_126,), kwargs = {})
    %mean_44 : [#users=2] = call_method[target=mean](args = (%add_126, -1), kwargs = {keepdim: True})
    %sub_45 : [#users=1] = call_function[target=operator.sub](args = (%add_126, %mean_44), kwargs = {})
    %pow_23 : [#users=1] = call_method[target=pow](args = (%sub_45, 2), kwargs = {})
    %mean_45 : [#users=1] = call_method[target=mean](args = (%pow_23, -1), kwargs = {keepdim: True})
    %sub_46 : [#users=1] = call_function[target=operator.sub](args = (%add_126, %mean_44), kwargs = {})
    %add_127 : [#users=1] = call_function[target=operator.add](args = (%mean_45, 1e-07), kwargs = {})
    %sqrt_46 : [#users=1] = call_function[target=torch.sqrt](args = (%add_127,), kwargs = {})
    %truediv_34 : [#users=2] = call_function[target=operator.truediv](args = (%sub_46, %sqrt_46), kwargs = {})
    %to_70 : [#users=0] = call_method[target=to](args = (%truediv_34, torch.float32), kwargs = {})
    %weight_22 : [#users=1] = get_attr[target=layer.11.attention.output.LayerNorm.weight]
    %mul_47 : [#users=1] = call_function[target=operator.mul](args = (%weight_22, %truediv_34), kwargs = {})
    %bias_22 : [#users=1] = get_attr[target=layer.11.attention.output.LayerNorm.bias]
    %add_128 : [#users=2] = call_function[target=operator.add](args = (%mul_47, %bias_22), kwargs = {})
    %dense_34 : [#users=1] = call_module[target=layer.11.intermediate.dense](args = (%add_128,), kwargs = {})
    %gelu_11 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_34,), kwargs = {})
    %dense_35 : [#users=1] = call_module[target=layer.11.output.dense](args = (%gelu_11,), kwargs = {})
    %add_129 : [#users=4] = call_function[target=operator.add](args = (%dense_35, %add_128), kwargs = {})
    %float_24 : [#users=0] = call_method[target=float](args = (%add_129,), kwargs = {})
    %mean_46 : [#users=2] = call_method[target=mean](args = (%add_129, -1), kwargs = {keepdim: True})
    %sub_47 : [#users=1] = call_function[target=operator.sub](args = (%add_129, %mean_46), kwargs = {})
    %pow_24 : [#users=1] = call_method[target=pow](args = (%sub_47, 2), kwargs = {})
    %mean_47 : [#users=1] = call_method[target=mean](args = (%pow_24, -1), kwargs = {keepdim: True})
    %sub_48 : [#users=1] = call_function[target=operator.sub](args = (%add_129, %mean_46), kwargs = {})
    %add_130 : [#users=1] = call_function[target=operator.add](args = (%mean_47, 1e-07), kwargs = {})
    %sqrt_47 : [#users=1] = call_function[target=torch.sqrt](args = (%add_130,), kwargs = {})
    %truediv_35 : [#users=2] = call_function[target=operator.truediv](args = (%sub_48, %sqrt_47), kwargs = {})
    %to_71 : [#users=0] = call_method[target=to](args = (%truediv_35, torch.float32), kwargs = {})
    %weight_23 : [#users=1] = get_attr[target=layer.11.output.LayerNorm.weight]
    %mul_48 : [#users=1] = call_function[target=operator.mul](args = (%weight_23, %truediv_35), kwargs = {})
    %bias_23 : [#users=1] = get_attr[target=layer.11.output.LayerNorm.bias]
    %add_131 : [#users=0] = call_function[target=operator.add](args = (%mul_48, %bias_23), kwargs = {})
to merge frameid 4 0
generate any for <enumerate object at 0x153bc0b05e00> <class 'enumerate'> [enumerate(locals['self'].encoder.layer).__iter__(), enumerate(locals['self'].encoder.layer)]
old obj TensorVar(need_guard_check=True, extract_code_at_start=[locals['hidden_states']], extract_code_hashs={-8381734214552088898}, obj=tensor([[[-0.4745,  0.4795, -0.6835,  ...,  0.7922, -0.1495,  1.2664],
         [-0.2552,  1.4093, -0.5182,  ..., -1.0163,  1.7162,  1.7644],
         [-0.3467,  1.4889,  0.7441,  ..., -0.3843,  1.3751,  1.3166],
         ...,
         [ 0.9130,  1.1131, -0.5668,  ...,  0.3879, -0.5664,  0.8270],
         [ 0.1326,  0.4045, -1.5836,  ...,  1.2737, -0.6294,  0.7159],
         [-1.8158,  1.1578, -0.8414,  ..., -1.4324, -0.1903, -0.1349]]]), modified_attrs={}, prev=None) 23346380250848 23346380865104
obj: tensor([[[-0.4745,  0.4795, -0.6835,  ...,  0.7922, -0.1495,  1.2664],
         [-0.2552,  1.4093, -0.5182,  ..., -1.0163,  1.7162,  1.7644],
         [-0.3467,  1.4889,  0.7441,  ..., -0.3843,  1.3751,  1.3166],
         ...,
         [ 0.9130,  1.1131, -0.5668,  ...,  0.3879, -0.5664,  0.8270],
         [ 0.1326,  0.4045, -1.5836,  ...,  1.2737, -0.6294,  0.7159],
         [-1.8158,  1.1578, -0.8414,  ..., -1.4324, -0.1903, -0.1349]]]) 23346380865104
self obj var: TensorVar(need_guard_check=False, extract_code_at_start=[], extract_code_hashs=set(), obj=tensor([[[-0.4745,  0.4795, -0.6835,  ...,  0.7922, -0.1495,  1.2664],
         [-0.2552,  1.4093, -0.5182,  ..., -1.0163,  1.7162,  1.7644],
         [-0.3467,  1.4889,  0.7441,  ..., -0.3843,  1.3751,  1.3166],
         ...,
         [ 0.9130,  1.1131, -0.5668,  ...,  0.3879, -0.5664,  0.8270],
         [ 0.1326,  0.4045, -1.5836,  ...,  1.2737, -0.6294,  0.7159],
         [-1.8158,  1.1578, -0.8414,  ..., -1.4324, -0.1903, -0.1349]]]), modified_attrs={}, prev=None) 23346380932192
tracing opcode RETURN_VALUE None pc=386 frame=4(0x7de0fc0)
restart: running injected code (f_lasti=386)
before pop_tracker [0, 4] frame_id 4
tracing return in /home/drc/frontend/test/test_model_deberta.py
tracing opcode STORE_FAST None pc=248 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:989
tracing opcode LOAD_FAST None pc=250 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=252 frame=0(0x7dd9b30)
tracing opcode BINARY_SUBSCR None pc=254 frame=0(0x7dd9b30)
tracing opcode STORE_FAST None pc=256 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:991
tracing opcode LOAD_DEREF None pc=258 frame=0(0x7dd9b30)
tracing opcode LOAD_ATTR None pc=260 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=262 frame=0(0x7dd9b30)
tracing opcode COMPARE_OP None pc=264 frame=0(0x7dd9b30)
tracing opcode EXTENDED_ARG None pc=266 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:1009
tracing opcode LOAD_FAST None pc=394 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=396 frame=0(0x7dd9b30)
tracing opcode BINARY_SUBSCR None pc=398 frame=0(0x7dd9b30)
tracing opcode STORE_FAST None pc=400 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:1011
tracing opcode LOAD_FAST None pc=402 frame=0(0x7dd9b30)
tracing opcode EXTENDED_ARG None pc=404 frame=0(0x7dd9b30)
tracing line /home/drc/frontend/test/test_model_deberta.py:1012
tracing opcode LOAD_FAST None pc=408 frame=0(0x7dd9b30)
tracing opcode BUILD_TUPLE None pc=410 frame=0(0x7dd9b30)
tracing opcode LOAD_FAST None pc=412 frame=0(0x7dd9b30)
tracing opcode LOAD_FAST None pc=414 frame=0(0x7dd9b30)
tracing opcode EXTENDED_ARG None pc=416 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=424 frame=0(0x7dd9b30)
tracing opcode LOAD_CONST None pc=426 frame=0(0x7dd9b30)
tracing opcode BUILD_SLICE None pc=428 frame=0(0x7dd9b30)
tracing opcode BINARY_SUBSCR None pc=430 frame=0(0x7dd9b30)
tracing opcode BINARY_ADD None pc=432 frame=0(0x7dd9b30)
tracing opcode EXTENDED_ARG None pc=434 frame=0(0x7dd9b30)
restart: running injected code (f_lasti=434)
commiting 0 0 215 [32mRETURN_VALUE[0m(None, None)  434
graph graph():
    %tensor_1 : [#users=1] = placeholder[target=tensor_1]
    %tensor_2 : [#users=2] = placeholder[target=tensor_2]
    %tensor_3 : [#users=0] = placeholder[target=tensor_3]
    %tensor_10 : [#users=1] = placeholder[target=tensor_10]
    %getitem : [#users=0] = call_function[target=operator.getitem](args = (%tensor_10, [slice(None, None, None), slice(None, 256, None)]), kwargs = {})
    %word_embeddings : [#users=5] = call_module[target=embeddings.word_embeddings](args = (%tensor_1,), kwargs = {})
    %zeros_like : [#users=0] = call_function[target=torch.zeros_like](args = (%word_embeddings,), kwargs = {})
    %float_1 : [#users=0] = call_method[target=float](args = (%word_embeddings,), kwargs = {})
    %mean : [#users=2] = call_method[target=mean](args = (%word_embeddings, -1), kwargs = {keepdim: True})
    %sub : [#users=1] = call_function[target=operator.sub](args = (%word_embeddings, %mean), kwargs = {})
    %pow_1 : [#users=1] = call_method[target=pow](args = (%sub, 2), kwargs = {})
    %mean_1 : [#users=1] = call_method[target=mean](args = (%pow_1, -1), kwargs = {keepdim: True})
    %sub_1 : [#users=1] = call_function[target=operator.sub](args = (%word_embeddings, %mean), kwargs = {})
    %add : [#users=1] = call_function[target=operator.add](args = (%mean_1, 1e-07), kwargs = {})
    %sqrt : [#users=1] = call_function[target=torch.sqrt](args = (%add,), kwargs = {})
    %truediv : [#users=2] = call_function[target=operator.truediv](args = (%sub_1, %sqrt), kwargs = {})
    %to : [#users=0] = call_method[target=to](args = (%truediv, torch.float32), kwargs = {})
    %weight : [#users=1] = get_attr[target=embeddings.LayerNorm.weight]
    %mul : [#users=1] = call_function[target=operator.mul](args = (%weight, %truediv), kwargs = {})
    %bias : [#users=1] = get_attr[target=embeddings.LayerNorm.bias]
    %add_1 : [#users=1] = call_function[target=operator.add](args = (%mul, %bias), kwargs = {})
    %unsqueeze : [#users=1] = call_method[target=unsqueeze](args = (%tensor_2, 2), kwargs = {})
    %to_1 : [#users=1] = call_method[target=to](args = (%unsqueeze, torch.float32), kwargs = {})
    %mul_1 : [#users=2] = call_function[target=operator.mul](args = (%add_1, %to_1), kwargs = {})
    %unsqueeze_1 : [#users=1] = call_method[target=unsqueeze](args = (%tensor_2, 1), kwargs = {})
    %unsqueeze_2 : [#users=2] = call_method[target=unsqueeze](args = (%unsqueeze_1, 2), kwargs = {})
    %squeeze : [#users=1] = call_method[target=squeeze](args = (%unsqueeze_2, -2), kwargs = {})
    %unsqueeze_3 : [#users=1] = call_method[target=unsqueeze](args = (%squeeze, -1), kwargs = {})
    %mul_2 : [#users=1] = call_function[target=operator.mul](args = (%unsqueeze_2, %unsqueeze_3), kwargs = {})
    %byte : [#users=12] = call_method[target=byte](args = (%mul_2,), kwargs = {})
    %arange : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %arange_1 : [#users=1] = call_function[target=torch.arange](args = (256,), kwargs = {dtype: torch.int64, device: cpu})
    %getitem_1 : [#users=1] = call_function[target=operator.getitem](args = (%arange, [slice(None, None, None), None]), kwargs = {})
    %view : [#users=1] = call_method[target=view](args = (%arange_1, 1, -1), kwargs = {})
    %repeat : [#users=1] = call_method[target=repeat](args = (%view, 256, 1), kwargs = {})
    %sub_2 : [#users=1] = call_function[target=operator.sub](args = (%getitem_1, %repeat), kwargs = {})
    %getitem_2 : [#users=1] = call_function[target=operator.getitem](args = (%sub_2, [slice(None, 256, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_4 : [#users=12] = call_method[target=unsqueeze](args = (%getitem_2, 0), kwargs = {})
    %in_proj : [#users=1] = call_module[target=encoder.layer.0.attention.self.in_proj](args = (%mul_1,), kwargs = {})
    %view_1 : [#users=1] = call_method[target=view](args = (%in_proj, [1, 256, 12, -1]), kwargs = {})
    %permute : [#users=1] = call_method[target=permute](args = (%view_1, 0, 2, 1, 3), kwargs = {})
    %chunk : [#users=3] = call_method[target=chunk](args = (%permute, 3), kwargs = {dim: -1})
    %getitem_3 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 0), kwargs = {})
    %getitem_4 : [#users=2] = call_function[target=operator.getitem](args = (%chunk, 1), kwargs = {})
    %getitem_5 : [#users=1] = call_function[target=operator.getitem](args = (%chunk, 2), kwargs = {})
    %q_bias : [#users=1] = get_attr[target=encoder.layer.0.attention.self.q_bias]
    %getitem_6 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_2 : [#users=1] = call_method[target=view](args = (%getitem_6, [1, 1, 12, -1]), kwargs = {})
    %permute_1 : [#users=1] = call_method[target=permute](args = (%view_2, 0, 2, 1, 3), kwargs = {})
    %add_2 : [#users=1] = call_function[target=operator.add](args = (%getitem_3, %permute_1), kwargs = {})
    %v_bias : [#users=1] = get_attr[target=encoder.layer.0.attention.self.v_bias]
    %getitem_7 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias, [None, None, slice(None, None, None)]), kwargs = {})
    %view_3 : [#users=1] = call_method[target=view](args = (%getitem_7, [1, 1, 12, -1]), kwargs = {})
    %permute_2 : [#users=1] = call_method[target=permute](args = (%view_3, 0, 2, 1, 3), kwargs = {})
    %add_3 : [#users=1] = call_function[target=operator.add](args = (%getitem_5, %permute_2), kwargs = {})
    %tensor : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_3 : [#users=1] = call_function[target=operator.mul](args = (%tensor, 3), kwargs = {})
    %sqrt_1 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_3,), kwargs = {})
    %to_2 : [#users=0] = call_method[target=to](args = (%sqrt_1,), kwargs = {dtype: torch.float32})
    %truediv_1 : [#users=2] = call_function[target=operator.truediv](args = (%add_2, %sqrt_1), kwargs = {})
    %transpose : [#users=1] = call_method[target=transpose](args = (%getitem_4, -1, -2), kwargs = {})
    %matmul : [#users=1] = call_function[target=torch.matmul](args = (%truediv_1, %transpose), kwargs = {})
    %unsqueeze_5 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long : [#users=0] = call_method[target=long](args = (%unsqueeze_5,), kwargs = {})
    %to_3 : [#users=0] = call_method[target=to](args = (%unsqueeze_5, cpu), kwargs = {})
    %__external_param__6 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_8 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__6, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_6 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_8, 0), kwargs = {})
    %pos_proj : [#users=1] = call_module[target=encoder.layer.0.attention.self.pos_proj](args = (%unsqueeze_6,), kwargs = {})
    %view_4 : [#users=1] = call_method[target=view](args = (%pos_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_3 : [#users=1] = call_method[target=permute](args = (%view_4, 0, 2, 1, 3), kwargs = {})
    %transpose_1 : [#users=1] = call_method[target=transpose](args = (%permute_3, -1, -2), kwargs = {})
    %matmul_1 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_1, %transpose_1), kwargs = {})
    %add_4 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_5, 256), kwargs = {})
    %clamp : [#users=1] = call_function[target=torch.clamp](args = (%add_4, 0, 511), kwargs = {})
    %expand : [#users=1] = call_method[target=expand](args = (%clamp, [1, 12, 256, 256]), kwargs = {})
    %gather : [#users=2] = call_function[target=torch.gather](args = (%matmul_1,), kwargs = {dim: -1, index: %expand})
    %full_like : [#users=1] = call_function[target=torch.full_like](args = (%gather, 0), kwargs = {})
    %iadd : [#users=1] = call_function[target=operator.iadd](args = (%full_like, %gather), kwargs = {})
    %pos_q_proj : [#users=1] = call_module[target=encoder.layer.0.attention.self.pos_q_proj](args = (%unsqueeze_6,), kwargs = {})
    %view_5 : [#users=1] = call_method[target=view](args = (%pos_q_proj, [1, 512, 12, -1]), kwargs = {})
    %permute_4 : [#users=1] = call_method[target=permute](args = (%view_5, 0, 2, 1, 3), kwargs = {})
    %tensor_27 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_4 : [#users=1] = call_function[target=operator.mul](args = (%tensor_27, 3), kwargs = {})
    %sqrt_2 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_4,), kwargs = {})
    %itruediv : [#users=1] = call_function[target=operator.itruediv](args = (%permute_4, %sqrt_2), kwargs = {})
    %neg : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_5,), kwargs = {})
    %add_5 : [#users=1] = call_function[target=operator.add](args = (%neg, 256), kwargs = {})
    %clamp_1 : [#users=1] = call_function[target=torch.clamp](args = (%add_5, 0, 511), kwargs = {})
    %transpose_2 : [#users=2] = call_method[target=transpose](args = (%itruediv, -1, -2), kwargs = {})
    %to_4 : [#users=0] = call_method[target=to](args = (%transpose_2,), kwargs = {dtype: torch.float32})
    %matmul_2 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_4, %transpose_2), kwargs = {})
    %expand_1 : [#users=1] = call_method[target=expand](args = (%clamp_1, [1, 12, 256, 256]), kwargs = {})
    %gather_1 : [#users=1] = call_function[target=torch.gather](args = (%matmul_2,), kwargs = {dim: -1, index: %expand_1})
    %transpose_3 : [#users=1] = call_method[target=transpose](args = (%gather_1, -1, -2), kwargs = {})
    %iadd_1 : [#users=1] = call_function[target=operator.iadd](args = (%iadd, %transpose_3), kwargs = {})
    %add_6 : [#users=1] = call_function[target=operator.add](args = (%matmul, %iadd_1), kwargs = {})
    %to_5 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert : [#users=2] = call_function[target=operator.invert](args = (%to_5,), kwargs = {})
    %tensor_39 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill : [#users=1] = call_method[target=masked_fill](args = (%add_6, %invert, %tensor_39), kwargs = {})
    %softmax : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill, -1), kwargs = {})
    %masked_fill_ : [#users=0] = call_method[target=masked_fill_](args = (%softmax, %invert, 0), kwargs = {})
    %matmul_3 : [#users=1] = call_function[target=torch.matmul](args = (%softmax, %add_3), kwargs = {})
    %permute_5 : [#users=1] = call_method[target=permute](args = (%matmul_3, 0, 2, 1, 3), kwargs = {})
    %contiguous : [#users=1] = call_method[target=contiguous](args = (%permute_5,), kwargs = {})
    %view_6 : [#users=1] = call_method[target=view](args = (%contiguous, [1, 256, -1]), kwargs = {})
    %dense : [#users=1] = call_module[target=encoder.layer.0.attention.output.dense](args = (%view_6,), kwargs = {})
    %add_7 : [#users=4] = call_function[target=operator.add](args = (%dense, %mul_1), kwargs = {})
    %float_2 : [#users=0] = call_method[target=float](args = (%add_7,), kwargs = {})
    %mean_2 : [#users=2] = call_method[target=mean](args = (%add_7, -1), kwargs = {keepdim: True})
    %sub_3 : [#users=1] = call_function[target=operator.sub](args = (%add_7, %mean_2), kwargs = {})
    %pow_2 : [#users=1] = call_method[target=pow](args = (%sub_3, 2), kwargs = {})
    %mean_3 : [#users=1] = call_method[target=mean](args = (%pow_2, -1), kwargs = {keepdim: True})
    %sub_4 : [#users=1] = call_function[target=operator.sub](args = (%add_7, %mean_2), kwargs = {})
    %add_8 : [#users=1] = call_function[target=operator.add](args = (%mean_3, 1e-07), kwargs = {})
    %sqrt_3 : [#users=1] = call_function[target=torch.sqrt](args = (%add_8,), kwargs = {})
    %truediv_2 : [#users=2] = call_function[target=operator.truediv](args = (%sub_4, %sqrt_3), kwargs = {})
    %to_6 : [#users=0] = call_method[target=to](args = (%truediv_2, torch.float32), kwargs = {})
    %weight_1 : [#users=1] = get_attr[target=encoder.layer.0.attention.output.LayerNorm.weight]
    %mul_5 : [#users=1] = call_function[target=operator.mul](args = (%weight_1, %truediv_2), kwargs = {})
    %bias_1 : [#users=1] = get_attr[target=encoder.layer.0.attention.output.LayerNorm.bias]
    %add_9 : [#users=2] = call_function[target=operator.add](args = (%mul_5, %bias_1), kwargs = {})
    %dense_1 : [#users=1] = call_module[target=encoder.layer.0.intermediate.dense](args = (%add_9,), kwargs = {})
    %gelu : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_1,), kwargs = {})
    %dense_2 : [#users=1] = call_module[target=encoder.layer.0.output.dense](args = (%gelu,), kwargs = {})
    %add_10 : [#users=4] = call_function[target=operator.add](args = (%dense_2, %add_9), kwargs = {})
    %float_3 : [#users=0] = call_method[target=float](args = (%add_10,), kwargs = {})
    %mean_4 : [#users=2] = call_method[target=mean](args = (%add_10, -1), kwargs = {keepdim: True})
    %sub_5 : [#users=1] = call_function[target=operator.sub](args = (%add_10, %mean_4), kwargs = {})
    %pow_3 : [#users=1] = call_method[target=pow](args = (%sub_5, 2), kwargs = {})
    %mean_5 : [#users=1] = call_method[target=mean](args = (%pow_3, -1), kwargs = {keepdim: True})
    %sub_6 : [#users=1] = call_function[target=operator.sub](args = (%add_10, %mean_4), kwargs = {})
    %add_11 : [#users=1] = call_function[target=operator.add](args = (%mean_5, 1e-07), kwargs = {})
    %sqrt_4 : [#users=1] = call_function[target=torch.sqrt](args = (%add_11,), kwargs = {})
    %truediv_3 : [#users=2] = call_function[target=operator.truediv](args = (%sub_6, %sqrt_4), kwargs = {})
    %to_7 : [#users=0] = call_method[target=to](args = (%truediv_3, torch.float32), kwargs = {})
    %weight_2 : [#users=1] = get_attr[target=encoder.layer.0.output.LayerNorm.weight]
    %mul_6 : [#users=1] = call_function[target=operator.mul](args = (%weight_2, %truediv_3), kwargs = {})
    %bias_2 : [#users=1] = get_attr[target=encoder.layer.0.output.LayerNorm.bias]
    %add_12 : [#users=2] = call_function[target=operator.add](args = (%mul_6, %bias_2), kwargs = {})
    %in_proj_1 : [#users=1] = call_module[target=encoder.layer.1.attention.self.in_proj](args = (%add_12,), kwargs = {})
    %view_7 : [#users=1] = call_method[target=view](args = (%in_proj_1, [1, 256, 12, -1]), kwargs = {})
    %permute_6 : [#users=1] = call_method[target=permute](args = (%view_7, 0, 2, 1, 3), kwargs = {})
    %chunk_1 : [#users=3] = call_method[target=chunk](args = (%permute_6, 3), kwargs = {dim: -1})
    %getitem_9 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_1, 0), kwargs = {})
    %getitem_10 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_1, 1), kwargs = {})
    %getitem_11 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_1, 2), kwargs = {})
    %q_bias_1 : [#users=1] = get_attr[target=encoder.layer.1.attention.self.q_bias]
    %getitem_12 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_1, [None, None, slice(None, None, None)]), kwargs = {})
    %view_8 : [#users=1] = call_method[target=view](args = (%getitem_12, [1, 1, 12, -1]), kwargs = {})
    %permute_7 : [#users=1] = call_method[target=permute](args = (%view_8, 0, 2, 1, 3), kwargs = {})
    %add_13 : [#users=1] = call_function[target=operator.add](args = (%getitem_9, %permute_7), kwargs = {})
    %v_bias_1 : [#users=1] = get_attr[target=encoder.layer.1.attention.self.v_bias]
    %getitem_13 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_1, [None, None, slice(None, None, None)]), kwargs = {})
    %view_9 : [#users=1] = call_method[target=view](args = (%getitem_13, [1, 1, 12, -1]), kwargs = {})
    %permute_8 : [#users=1] = call_method[target=permute](args = (%view_9, 0, 2, 1, 3), kwargs = {})
    %add_14 : [#users=1] = call_function[target=operator.add](args = (%getitem_11, %permute_8), kwargs = {})
    %tensor_40 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_7 : [#users=1] = call_function[target=operator.mul](args = (%tensor_40, 3), kwargs = {})
    %sqrt_5 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_7,), kwargs = {})
    %to_8 : [#users=0] = call_method[target=to](args = (%sqrt_5,), kwargs = {dtype: torch.float32})
    %truediv_4 : [#users=2] = call_function[target=operator.truediv](args = (%add_13, %sqrt_5), kwargs = {})
    %transpose_4 : [#users=1] = call_method[target=transpose](args = (%getitem_10, -1, -2), kwargs = {})
    %matmul_4 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_4, %transpose_4), kwargs = {})
    %unsqueeze_7 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_1 : [#users=0] = call_method[target=long](args = (%unsqueeze_7,), kwargs = {})
    %to_9 : [#users=0] = call_method[target=to](args = (%unsqueeze_7, cpu), kwargs = {})
    %__external_param__7 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_14 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__7, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_8 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_14, 0), kwargs = {})
    %pos_proj_1 : [#users=1] = call_module[target=encoder.layer.1.attention.self.pos_proj](args = (%unsqueeze_8,), kwargs = {})
    %view_10 : [#users=1] = call_method[target=view](args = (%pos_proj_1, [1, 512, 12, -1]), kwargs = {})
    %permute_9 : [#users=1] = call_method[target=permute](args = (%view_10, 0, 2, 1, 3), kwargs = {})
    %transpose_5 : [#users=1] = call_method[target=transpose](args = (%permute_9, -1, -2), kwargs = {})
    %matmul_5 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_4, %transpose_5), kwargs = {})
    %add_15 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_7, 256), kwargs = {})
    %clamp_2 : [#users=1] = call_function[target=torch.clamp](args = (%add_15, 0, 511), kwargs = {})
    %expand_2 : [#users=1] = call_method[target=expand](args = (%clamp_2, [1, 12, 256, 256]), kwargs = {})
    %gather_2 : [#users=2] = call_function[target=torch.gather](args = (%matmul_5,), kwargs = {dim: -1, index: %expand_2})
    %full_like_1 : [#users=1] = call_function[target=torch.full_like](args = (%gather_2, 0), kwargs = {})
    %iadd_2 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_1, %gather_2), kwargs = {})
    %pos_q_proj_1 : [#users=1] = call_module[target=encoder.layer.1.attention.self.pos_q_proj](args = (%unsqueeze_8,), kwargs = {})
    %view_11 : [#users=1] = call_method[target=view](args = (%pos_q_proj_1, [1, 512, 12, -1]), kwargs = {})
    %permute_10 : [#users=1] = call_method[target=permute](args = (%view_11, 0, 2, 1, 3), kwargs = {})
    %tensor_63 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_8 : [#users=1] = call_function[target=operator.mul](args = (%tensor_63, 3), kwargs = {})
    %sqrt_6 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_8,), kwargs = {})
    %itruediv_1 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_10, %sqrt_6), kwargs = {})
    %neg_1 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_7,), kwargs = {})
    %add_16 : [#users=1] = call_function[target=operator.add](args = (%neg_1, 256), kwargs = {})
    %clamp_3 : [#users=1] = call_function[target=torch.clamp](args = (%add_16, 0, 511), kwargs = {})
    %transpose_6 : [#users=2] = call_method[target=transpose](args = (%itruediv_1, -1, -2), kwargs = {})
    %to_10 : [#users=0] = call_method[target=to](args = (%transpose_6,), kwargs = {dtype: torch.float32})
    %matmul_6 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_10, %transpose_6), kwargs = {})
    %expand_3 : [#users=1] = call_method[target=expand](args = (%clamp_3, [1, 12, 256, 256]), kwargs = {})
    %gather_3 : [#users=1] = call_function[target=torch.gather](args = (%matmul_6,), kwargs = {dim: -1, index: %expand_3})
    %transpose_7 : [#users=1] = call_method[target=transpose](args = (%gather_3, -1, -2), kwargs = {})
    %iadd_3 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_2, %transpose_7), kwargs = {})
    %add_17 : [#users=1] = call_function[target=operator.add](args = (%matmul_4, %iadd_3), kwargs = {})
    %to_11 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_1 : [#users=2] = call_function[target=operator.invert](args = (%to_11,), kwargs = {})
    %tensor_75 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_1 : [#users=1] = call_method[target=masked_fill](args = (%add_17, %invert_1, %tensor_75), kwargs = {})
    %softmax_1 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_1, -1), kwargs = {})
    %masked_fill__1 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_1, %invert_1, 0), kwargs = {})
    %matmul_7 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_1, %add_14), kwargs = {})
    %permute_11 : [#users=1] = call_method[target=permute](args = (%matmul_7, 0, 2, 1, 3), kwargs = {})
    %contiguous_1 : [#users=1] = call_method[target=contiguous](args = (%permute_11,), kwargs = {})
    %view_12 : [#users=1] = call_method[target=view](args = (%contiguous_1, [1, 256, -1]), kwargs = {})
    %dense_3 : [#users=1] = call_module[target=encoder.layer.1.attention.output.dense](args = (%view_12,), kwargs = {})
    %add_18 : [#users=4] = call_function[target=operator.add](args = (%dense_3, %add_12), kwargs = {})
    %float_4 : [#users=0] = call_method[target=float](args = (%add_18,), kwargs = {})
    %mean_6 : [#users=2] = call_method[target=mean](args = (%add_18, -1), kwargs = {keepdim: True})
    %sub_7 : [#users=1] = call_function[target=operator.sub](args = (%add_18, %mean_6), kwargs = {})
    %pow_4 : [#users=1] = call_method[target=pow](args = (%sub_7, 2), kwargs = {})
    %mean_7 : [#users=1] = call_method[target=mean](args = (%pow_4, -1), kwargs = {keepdim: True})
    %sub_8 : [#users=1] = call_function[target=operator.sub](args = (%add_18, %mean_6), kwargs = {})
    %add_19 : [#users=1] = call_function[target=operator.add](args = (%mean_7, 1e-07), kwargs = {})
    %sqrt_7 : [#users=1] = call_function[target=torch.sqrt](args = (%add_19,), kwargs = {})
    %truediv_5 : [#users=2] = call_function[target=operator.truediv](args = (%sub_8, %sqrt_7), kwargs = {})
    %to_12 : [#users=0] = call_method[target=to](args = (%truediv_5, torch.float32), kwargs = {})
    %weight_3 : [#users=1] = get_attr[target=encoder.layer.1.attention.output.LayerNorm.weight]
    %mul_9 : [#users=1] = call_function[target=operator.mul](args = (%weight_3, %truediv_5), kwargs = {})
    %bias_3 : [#users=1] = get_attr[target=encoder.layer.1.attention.output.LayerNorm.bias]
    %add_20 : [#users=2] = call_function[target=operator.add](args = (%mul_9, %bias_3), kwargs = {})
    %dense_4 : [#users=1] = call_module[target=encoder.layer.1.intermediate.dense](args = (%add_20,), kwargs = {})
    %gelu_1 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_4,), kwargs = {})
    %dense_5 : [#users=1] = call_module[target=encoder.layer.1.output.dense](args = (%gelu_1,), kwargs = {})
    %add_21 : [#users=4] = call_function[target=operator.add](args = (%dense_5, %add_20), kwargs = {})
    %float_5 : [#users=0] = call_method[target=float](args = (%add_21,), kwargs = {})
    %mean_8 : [#users=2] = call_method[target=mean](args = (%add_21, -1), kwargs = {keepdim: True})
    %sub_9 : [#users=1] = call_function[target=operator.sub](args = (%add_21, %mean_8), kwargs = {})
    %pow_5 : [#users=1] = call_method[target=pow](args = (%sub_9, 2), kwargs = {})
    %mean_9 : [#users=1] = call_method[target=mean](args = (%pow_5, -1), kwargs = {keepdim: True})
    %sub_10 : [#users=1] = call_function[target=operator.sub](args = (%add_21, %mean_8), kwargs = {})
    %add_22 : [#users=1] = call_function[target=operator.add](args = (%mean_9, 1e-07), kwargs = {})
    %sqrt_8 : [#users=1] = call_function[target=torch.sqrt](args = (%add_22,), kwargs = {})
    %truediv_6 : [#users=2] = call_function[target=operator.truediv](args = (%sub_10, %sqrt_8), kwargs = {})
    %to_13 : [#users=0] = call_method[target=to](args = (%truediv_6, torch.float32), kwargs = {})
    %weight_4 : [#users=1] = get_attr[target=encoder.layer.1.output.LayerNorm.weight]
    %mul_10 : [#users=1] = call_function[target=operator.mul](args = (%weight_4, %truediv_6), kwargs = {})
    %bias_4 : [#users=1] = get_attr[target=encoder.layer.1.output.LayerNorm.bias]
    %add_23 : [#users=2] = call_function[target=operator.add](args = (%mul_10, %bias_4), kwargs = {})
    %in_proj_2 : [#users=1] = call_module[target=encoder.layer.2.attention.self.in_proj](args = (%add_23,), kwargs = {})
    %view_13 : [#users=1] = call_method[target=view](args = (%in_proj_2, [1, 256, 12, -1]), kwargs = {})
    %permute_12 : [#users=1] = call_method[target=permute](args = (%view_13, 0, 2, 1, 3), kwargs = {})
    %chunk_2 : [#users=3] = call_method[target=chunk](args = (%permute_12, 3), kwargs = {dim: -1})
    %getitem_15 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_2, 0), kwargs = {})
    %getitem_16 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_2, 1), kwargs = {})
    %getitem_17 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_2, 2), kwargs = {})
    %q_bias_2 : [#users=1] = get_attr[target=encoder.layer.2.attention.self.q_bias]
    %getitem_18 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_2, [None, None, slice(None, None, None)]), kwargs = {})
    %view_14 : [#users=1] = call_method[target=view](args = (%getitem_18, [1, 1, 12, -1]), kwargs = {})
    %permute_13 : [#users=1] = call_method[target=permute](args = (%view_14, 0, 2, 1, 3), kwargs = {})
    %add_24 : [#users=1] = call_function[target=operator.add](args = (%getitem_15, %permute_13), kwargs = {})
    %v_bias_2 : [#users=1] = get_attr[target=encoder.layer.2.attention.self.v_bias]
    %getitem_19 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_2, [None, None, slice(None, None, None)]), kwargs = {})
    %view_15 : [#users=1] = call_method[target=view](args = (%getitem_19, [1, 1, 12, -1]), kwargs = {})
    %permute_14 : [#users=1] = call_method[target=permute](args = (%view_15, 0, 2, 1, 3), kwargs = {})
    %add_25 : [#users=1] = call_function[target=operator.add](args = (%getitem_17, %permute_14), kwargs = {})
    %tensor_76 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_11 : [#users=1] = call_function[target=operator.mul](args = (%tensor_76, 3), kwargs = {})
    %sqrt_9 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_11,), kwargs = {})
    %to_14 : [#users=0] = call_method[target=to](args = (%sqrt_9,), kwargs = {dtype: torch.float32})
    %truediv_7 : [#users=2] = call_function[target=operator.truediv](args = (%add_24, %sqrt_9), kwargs = {})
    %transpose_8 : [#users=1] = call_method[target=transpose](args = (%getitem_16, -1, -2), kwargs = {})
    %matmul_8 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_7, %transpose_8), kwargs = {})
    %unsqueeze_9 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_2 : [#users=0] = call_method[target=long](args = (%unsqueeze_9,), kwargs = {})
    %to_15 : [#users=0] = call_method[target=to](args = (%unsqueeze_9, cpu), kwargs = {})
    %__external_param__8 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_20 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__8, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_10 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_20, 0), kwargs = {})
    %pos_proj_2 : [#users=1] = call_module[target=encoder.layer.2.attention.self.pos_proj](args = (%unsqueeze_10,), kwargs = {})
    %view_16 : [#users=1] = call_method[target=view](args = (%pos_proj_2, [1, 512, 12, -1]), kwargs = {})
    %permute_15 : [#users=1] = call_method[target=permute](args = (%view_16, 0, 2, 1, 3), kwargs = {})
    %transpose_9 : [#users=1] = call_method[target=transpose](args = (%permute_15, -1, -2), kwargs = {})
    %matmul_9 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_7, %transpose_9), kwargs = {})
    %add_26 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_9, 256), kwargs = {})
    %clamp_4 : [#users=1] = call_function[target=torch.clamp](args = (%add_26, 0, 511), kwargs = {})
    %expand_4 : [#users=1] = call_method[target=expand](args = (%clamp_4, [1, 12, 256, 256]), kwargs = {})
    %gather_4 : [#users=2] = call_function[target=torch.gather](args = (%matmul_9,), kwargs = {dim: -1, index: %expand_4})
    %full_like_2 : [#users=1] = call_function[target=torch.full_like](args = (%gather_4, 0), kwargs = {})
    %iadd_4 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_2, %gather_4), kwargs = {})
    %pos_q_proj_2 : [#users=1] = call_module[target=encoder.layer.2.attention.self.pos_q_proj](args = (%unsqueeze_10,), kwargs = {})
    %view_17 : [#users=1] = call_method[target=view](args = (%pos_q_proj_2, [1, 512, 12, -1]), kwargs = {})
    %permute_16 : [#users=1] = call_method[target=permute](args = (%view_17, 0, 2, 1, 3), kwargs = {})
    %tensor_99 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_12 : [#users=1] = call_function[target=operator.mul](args = (%tensor_99, 3), kwargs = {})
    %sqrt_10 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_12,), kwargs = {})
    %itruediv_2 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_16, %sqrt_10), kwargs = {})
    %neg_2 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_9,), kwargs = {})
    %add_27 : [#users=1] = call_function[target=operator.add](args = (%neg_2, 256), kwargs = {})
    %clamp_5 : [#users=1] = call_function[target=torch.clamp](args = (%add_27, 0, 511), kwargs = {})
    %transpose_10 : [#users=2] = call_method[target=transpose](args = (%itruediv_2, -1, -2), kwargs = {})
    %to_16 : [#users=0] = call_method[target=to](args = (%transpose_10,), kwargs = {dtype: torch.float32})
    %matmul_10 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_16, %transpose_10), kwargs = {})
    %expand_5 : [#users=1] = call_method[target=expand](args = (%clamp_5, [1, 12, 256, 256]), kwargs = {})
    %gather_5 : [#users=1] = call_function[target=torch.gather](args = (%matmul_10,), kwargs = {dim: -1, index: %expand_5})
    %transpose_11 : [#users=1] = call_method[target=transpose](args = (%gather_5, -1, -2), kwargs = {})
    %iadd_5 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_4, %transpose_11), kwargs = {})
    %add_28 : [#users=1] = call_function[target=operator.add](args = (%matmul_8, %iadd_5), kwargs = {})
    %to_17 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_2 : [#users=2] = call_function[target=operator.invert](args = (%to_17,), kwargs = {})
    %tensor_111 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_2 : [#users=1] = call_method[target=masked_fill](args = (%add_28, %invert_2, %tensor_111), kwargs = {})
    %softmax_2 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_2, -1), kwargs = {})
    %masked_fill__2 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_2, %invert_2, 0), kwargs = {})
    %matmul_11 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_2, %add_25), kwargs = {})
    %permute_17 : [#users=1] = call_method[target=permute](args = (%matmul_11, 0, 2, 1, 3), kwargs = {})
    %contiguous_2 : [#users=1] = call_method[target=contiguous](args = (%permute_17,), kwargs = {})
    %view_18 : [#users=1] = call_method[target=view](args = (%contiguous_2, [1, 256, -1]), kwargs = {})
    %dense_6 : [#users=1] = call_module[target=encoder.layer.2.attention.output.dense](args = (%view_18,), kwargs = {})
    %add_29 : [#users=4] = call_function[target=operator.add](args = (%dense_6, %add_23), kwargs = {})
    %float_6 : [#users=0] = call_method[target=float](args = (%add_29,), kwargs = {})
    %mean_10 : [#users=2] = call_method[target=mean](args = (%add_29, -1), kwargs = {keepdim: True})
    %sub_11 : [#users=1] = call_function[target=operator.sub](args = (%add_29, %mean_10), kwargs = {})
    %pow_6 : [#users=1] = call_method[target=pow](args = (%sub_11, 2), kwargs = {})
    %mean_11 : [#users=1] = call_method[target=mean](args = (%pow_6, -1), kwargs = {keepdim: True})
    %sub_12 : [#users=1] = call_function[target=operator.sub](args = (%add_29, %mean_10), kwargs = {})
    %add_30 : [#users=1] = call_function[target=operator.add](args = (%mean_11, 1e-07), kwargs = {})
    %sqrt_11 : [#users=1] = call_function[target=torch.sqrt](args = (%add_30,), kwargs = {})
    %truediv_8 : [#users=2] = call_function[target=operator.truediv](args = (%sub_12, %sqrt_11), kwargs = {})
    %to_18 : [#users=0] = call_method[target=to](args = (%truediv_8, torch.float32), kwargs = {})
    %weight_5 : [#users=1] = get_attr[target=encoder.layer.2.attention.output.LayerNorm.weight]
    %mul_13 : [#users=1] = call_function[target=operator.mul](args = (%weight_5, %truediv_8), kwargs = {})
    %bias_5 : [#users=1] = get_attr[target=encoder.layer.2.attention.output.LayerNorm.bias]
    %add_31 : [#users=2] = call_function[target=operator.add](args = (%mul_13, %bias_5), kwargs = {})
    %dense_7 : [#users=1] = call_module[target=encoder.layer.2.intermediate.dense](args = (%add_31,), kwargs = {})
    %gelu_2 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_7,), kwargs = {})
    %dense_8 : [#users=1] = call_module[target=encoder.layer.2.output.dense](args = (%gelu_2,), kwargs = {})
    %add_32 : [#users=4] = call_function[target=operator.add](args = (%dense_8, %add_31), kwargs = {})
    %float_7 : [#users=0] = call_method[target=float](args = (%add_32,), kwargs = {})
    %mean_12 : [#users=2] = call_method[target=mean](args = (%add_32, -1), kwargs = {keepdim: True})
    %sub_13 : [#users=1] = call_function[target=operator.sub](args = (%add_32, %mean_12), kwargs = {})
    %pow_7 : [#users=1] = call_method[target=pow](args = (%sub_13, 2), kwargs = {})
    %mean_13 : [#users=1] = call_method[target=mean](args = (%pow_7, -1), kwargs = {keepdim: True})
    %sub_14 : [#users=1] = call_function[target=operator.sub](args = (%add_32, %mean_12), kwargs = {})
    %add_33 : [#users=1] = call_function[target=operator.add](args = (%mean_13, 1e-07), kwargs = {})
    %sqrt_12 : [#users=1] = call_function[target=torch.sqrt](args = (%add_33,), kwargs = {})
    %truediv_9 : [#users=2] = call_function[target=operator.truediv](args = (%sub_14, %sqrt_12), kwargs = {})
    %to_19 : [#users=0] = call_method[target=to](args = (%truediv_9, torch.float32), kwargs = {})
    %weight_6 : [#users=1] = get_attr[target=encoder.layer.2.output.LayerNorm.weight]
    %mul_14 : [#users=1] = call_function[target=operator.mul](args = (%weight_6, %truediv_9), kwargs = {})
    %bias_6 : [#users=1] = get_attr[target=encoder.layer.2.output.LayerNorm.bias]
    %add_34 : [#users=2] = call_function[target=operator.add](args = (%mul_14, %bias_6), kwargs = {})
    %in_proj_3 : [#users=1] = call_module[target=encoder.layer.3.attention.self.in_proj](args = (%add_34,), kwargs = {})
    %view_19 : [#users=1] = call_method[target=view](args = (%in_proj_3, [1, 256, 12, -1]), kwargs = {})
    %permute_18 : [#users=1] = call_method[target=permute](args = (%view_19, 0, 2, 1, 3), kwargs = {})
    %chunk_3 : [#users=3] = call_method[target=chunk](args = (%permute_18, 3), kwargs = {dim: -1})
    %getitem_21 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_3, 0), kwargs = {})
    %getitem_22 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_3, 1), kwargs = {})
    %getitem_23 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_3, 2), kwargs = {})
    %q_bias_3 : [#users=1] = get_attr[target=encoder.layer.3.attention.self.q_bias]
    %getitem_24 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_3, [None, None, slice(None, None, None)]), kwargs = {})
    %view_20 : [#users=1] = call_method[target=view](args = (%getitem_24, [1, 1, 12, -1]), kwargs = {})
    %permute_19 : [#users=1] = call_method[target=permute](args = (%view_20, 0, 2, 1, 3), kwargs = {})
    %add_35 : [#users=1] = call_function[target=operator.add](args = (%getitem_21, %permute_19), kwargs = {})
    %v_bias_3 : [#users=1] = get_attr[target=encoder.layer.3.attention.self.v_bias]
    %getitem_25 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_3, [None, None, slice(None, None, None)]), kwargs = {})
    %view_21 : [#users=1] = call_method[target=view](args = (%getitem_25, [1, 1, 12, -1]), kwargs = {})
    %permute_20 : [#users=1] = call_method[target=permute](args = (%view_21, 0, 2, 1, 3), kwargs = {})
    %add_36 : [#users=1] = call_function[target=operator.add](args = (%getitem_23, %permute_20), kwargs = {})
    %tensor_112 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_15 : [#users=1] = call_function[target=operator.mul](args = (%tensor_112, 3), kwargs = {})
    %sqrt_13 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_15,), kwargs = {})
    %to_20 : [#users=0] = call_method[target=to](args = (%sqrt_13,), kwargs = {dtype: torch.float32})
    %truediv_10 : [#users=2] = call_function[target=operator.truediv](args = (%add_35, %sqrt_13), kwargs = {})
    %transpose_12 : [#users=1] = call_method[target=transpose](args = (%getitem_22, -1, -2), kwargs = {})
    %matmul_12 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_10, %transpose_12), kwargs = {})
    %unsqueeze_11 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_3 : [#users=0] = call_method[target=long](args = (%unsqueeze_11,), kwargs = {})
    %to_21 : [#users=0] = call_method[target=to](args = (%unsqueeze_11, cpu), kwargs = {})
    %__external_param__9 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_26 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__9, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_12 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_26, 0), kwargs = {})
    %pos_proj_3 : [#users=1] = call_module[target=encoder.layer.3.attention.self.pos_proj](args = (%unsqueeze_12,), kwargs = {})
    %view_22 : [#users=1] = call_method[target=view](args = (%pos_proj_3, [1, 512, 12, -1]), kwargs = {})
    %permute_21 : [#users=1] = call_method[target=permute](args = (%view_22, 0, 2, 1, 3), kwargs = {})
    %transpose_13 : [#users=1] = call_method[target=transpose](args = (%permute_21, -1, -2), kwargs = {})
    %matmul_13 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_10, %transpose_13), kwargs = {})
    %add_37 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_11, 256), kwargs = {})
    %clamp_6 : [#users=1] = call_function[target=torch.clamp](args = (%add_37, 0, 511), kwargs = {})
    %expand_6 : [#users=1] = call_method[target=expand](args = (%clamp_6, [1, 12, 256, 256]), kwargs = {})
    %gather_6 : [#users=2] = call_function[target=torch.gather](args = (%matmul_13,), kwargs = {dim: -1, index: %expand_6})
    %full_like_3 : [#users=1] = call_function[target=torch.full_like](args = (%gather_6, 0), kwargs = {})
    %iadd_6 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_3, %gather_6), kwargs = {})
    %pos_q_proj_3 : [#users=1] = call_module[target=encoder.layer.3.attention.self.pos_q_proj](args = (%unsqueeze_12,), kwargs = {})
    %view_23 : [#users=1] = call_method[target=view](args = (%pos_q_proj_3, [1, 512, 12, -1]), kwargs = {})
    %permute_22 : [#users=1] = call_method[target=permute](args = (%view_23, 0, 2, 1, 3), kwargs = {})
    %tensor_135 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_16 : [#users=1] = call_function[target=operator.mul](args = (%tensor_135, 3), kwargs = {})
    %sqrt_14 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_16,), kwargs = {})
    %itruediv_3 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_22, %sqrt_14), kwargs = {})
    %neg_3 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_11,), kwargs = {})
    %add_38 : [#users=1] = call_function[target=operator.add](args = (%neg_3, 256), kwargs = {})
    %clamp_7 : [#users=1] = call_function[target=torch.clamp](args = (%add_38, 0, 511), kwargs = {})
    %transpose_14 : [#users=2] = call_method[target=transpose](args = (%itruediv_3, -1, -2), kwargs = {})
    %to_22 : [#users=0] = call_method[target=to](args = (%transpose_14,), kwargs = {dtype: torch.float32})
    %matmul_14 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_22, %transpose_14), kwargs = {})
    %expand_7 : [#users=1] = call_method[target=expand](args = (%clamp_7, [1, 12, 256, 256]), kwargs = {})
    %gather_7 : [#users=1] = call_function[target=torch.gather](args = (%matmul_14,), kwargs = {dim: -1, index: %expand_7})
    %transpose_15 : [#users=1] = call_method[target=transpose](args = (%gather_7, -1, -2), kwargs = {})
    %iadd_7 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_6, %transpose_15), kwargs = {})
    %add_39 : [#users=1] = call_function[target=operator.add](args = (%matmul_12, %iadd_7), kwargs = {})
    %to_23 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_3 : [#users=2] = call_function[target=operator.invert](args = (%to_23,), kwargs = {})
    %tensor_147 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_3 : [#users=1] = call_method[target=masked_fill](args = (%add_39, %invert_3, %tensor_147), kwargs = {})
    %softmax_3 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_3, -1), kwargs = {})
    %masked_fill__3 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_3, %invert_3, 0), kwargs = {})
    %matmul_15 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_3, %add_36), kwargs = {})
    %permute_23 : [#users=1] = call_method[target=permute](args = (%matmul_15, 0, 2, 1, 3), kwargs = {})
    %contiguous_3 : [#users=1] = call_method[target=contiguous](args = (%permute_23,), kwargs = {})
    %view_24 : [#users=1] = call_method[target=view](args = (%contiguous_3, [1, 256, -1]), kwargs = {})
    %dense_9 : [#users=1] = call_module[target=encoder.layer.3.attention.output.dense](args = (%view_24,), kwargs = {})
    %add_40 : [#users=4] = call_function[target=operator.add](args = (%dense_9, %add_34), kwargs = {})
    %float_8 : [#users=0] = call_method[target=float](args = (%add_40,), kwargs = {})
    %mean_14 : [#users=2] = call_method[target=mean](args = (%add_40, -1), kwargs = {keepdim: True})
    %sub_15 : [#users=1] = call_function[target=operator.sub](args = (%add_40, %mean_14), kwargs = {})
    %pow_8 : [#users=1] = call_method[target=pow](args = (%sub_15, 2), kwargs = {})
    %mean_15 : [#users=1] = call_method[target=mean](args = (%pow_8, -1), kwargs = {keepdim: True})
    %sub_16 : [#users=1] = call_function[target=operator.sub](args = (%add_40, %mean_14), kwargs = {})
    %add_41 : [#users=1] = call_function[target=operator.add](args = (%mean_15, 1e-07), kwargs = {})
    %sqrt_15 : [#users=1] = call_function[target=torch.sqrt](args = (%add_41,), kwargs = {})
    %truediv_11 : [#users=2] = call_function[target=operator.truediv](args = (%sub_16, %sqrt_15), kwargs = {})
    %to_24 : [#users=0] = call_method[target=to](args = (%truediv_11, torch.float32), kwargs = {})
    %weight_7 : [#users=1] = get_attr[target=encoder.layer.3.attention.output.LayerNorm.weight]
    %mul_17 : [#users=1] = call_function[target=operator.mul](args = (%weight_7, %truediv_11), kwargs = {})
    %bias_7 : [#users=1] = get_attr[target=encoder.layer.3.attention.output.LayerNorm.bias]
    %add_42 : [#users=2] = call_function[target=operator.add](args = (%mul_17, %bias_7), kwargs = {})
    %dense_10 : [#users=1] = call_module[target=encoder.layer.3.intermediate.dense](args = (%add_42,), kwargs = {})
    %gelu_3 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_10,), kwargs = {})
    %dense_11 : [#users=1] = call_module[target=encoder.layer.3.output.dense](args = (%gelu_3,), kwargs = {})
    %add_43 : [#users=4] = call_function[target=operator.add](args = (%dense_11, %add_42), kwargs = {})
    %float_9 : [#users=0] = call_method[target=float](args = (%add_43,), kwargs = {})
    %mean_16 : [#users=2] = call_method[target=mean](args = (%add_43, -1), kwargs = {keepdim: True})
    %sub_17 : [#users=1] = call_function[target=operator.sub](args = (%add_43, %mean_16), kwargs = {})
    %pow_9 : [#users=1] = call_method[target=pow](args = (%sub_17, 2), kwargs = {})
    %mean_17 : [#users=1] = call_method[target=mean](args = (%pow_9, -1), kwargs = {keepdim: True})
    %sub_18 : [#users=1] = call_function[target=operator.sub](args = (%add_43, %mean_16), kwargs = {})
    %add_44 : [#users=1] = call_function[target=operator.add](args = (%mean_17, 1e-07), kwargs = {})
    %sqrt_16 : [#users=1] = call_function[target=torch.sqrt](args = (%add_44,), kwargs = {})
    %truediv_12 : [#users=2] = call_function[target=operator.truediv](args = (%sub_18, %sqrt_16), kwargs = {})
    %to_25 : [#users=0] = call_method[target=to](args = (%truediv_12, torch.float32), kwargs = {})
    %weight_8 : [#users=1] = get_attr[target=encoder.layer.3.output.LayerNorm.weight]
    %mul_18 : [#users=1] = call_function[target=operator.mul](args = (%weight_8, %truediv_12), kwargs = {})
    %bias_8 : [#users=1] = get_attr[target=encoder.layer.3.output.LayerNorm.bias]
    %add_45 : [#users=2] = call_function[target=operator.add](args = (%mul_18, %bias_8), kwargs = {})
    %in_proj_4 : [#users=1] = call_module[target=encoder.layer.4.attention.self.in_proj](args = (%add_45,), kwargs = {})
    %view_25 : [#users=1] = call_method[target=view](args = (%in_proj_4, [1, 256, 12, -1]), kwargs = {})
    %permute_24 : [#users=1] = call_method[target=permute](args = (%view_25, 0, 2, 1, 3), kwargs = {})
    %chunk_4 : [#users=3] = call_method[target=chunk](args = (%permute_24, 3), kwargs = {dim: -1})
    %getitem_27 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_4, 0), kwargs = {})
    %getitem_28 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_4, 1), kwargs = {})
    %getitem_29 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_4, 2), kwargs = {})
    %q_bias_4 : [#users=1] = get_attr[target=encoder.layer.4.attention.self.q_bias]
    %getitem_30 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_4, [None, None, slice(None, None, None)]), kwargs = {})
    %view_26 : [#users=1] = call_method[target=view](args = (%getitem_30, [1, 1, 12, -1]), kwargs = {})
    %permute_25 : [#users=1] = call_method[target=permute](args = (%view_26, 0, 2, 1, 3), kwargs = {})
    %add_46 : [#users=1] = call_function[target=operator.add](args = (%getitem_27, %permute_25), kwargs = {})
    %v_bias_4 : [#users=1] = get_attr[target=encoder.layer.4.attention.self.v_bias]
    %getitem_31 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_4, [None, None, slice(None, None, None)]), kwargs = {})
    %view_27 : [#users=1] = call_method[target=view](args = (%getitem_31, [1, 1, 12, -1]), kwargs = {})
    %permute_26 : [#users=1] = call_method[target=permute](args = (%view_27, 0, 2, 1, 3), kwargs = {})
    %add_47 : [#users=1] = call_function[target=operator.add](args = (%getitem_29, %permute_26), kwargs = {})
    %tensor_148 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_19 : [#users=1] = call_function[target=operator.mul](args = (%tensor_148, 3), kwargs = {})
    %sqrt_17 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_19,), kwargs = {})
    %to_26 : [#users=0] = call_method[target=to](args = (%sqrt_17,), kwargs = {dtype: torch.float32})
    %truediv_13 : [#users=2] = call_function[target=operator.truediv](args = (%add_46, %sqrt_17), kwargs = {})
    %transpose_16 : [#users=1] = call_method[target=transpose](args = (%getitem_28, -1, -2), kwargs = {})
    %matmul_16 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_13, %transpose_16), kwargs = {})
    %unsqueeze_13 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_4 : [#users=0] = call_method[target=long](args = (%unsqueeze_13,), kwargs = {})
    %to_27 : [#users=0] = call_method[target=to](args = (%unsqueeze_13, cpu), kwargs = {})
    %__external_param__10 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_32 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__10, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_14 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_32, 0), kwargs = {})
    %pos_proj_4 : [#users=1] = call_module[target=encoder.layer.4.attention.self.pos_proj](args = (%unsqueeze_14,), kwargs = {})
    %view_28 : [#users=1] = call_method[target=view](args = (%pos_proj_4, [1, 512, 12, -1]), kwargs = {})
    %permute_27 : [#users=1] = call_method[target=permute](args = (%view_28, 0, 2, 1, 3), kwargs = {})
    %transpose_17 : [#users=1] = call_method[target=transpose](args = (%permute_27, -1, -2), kwargs = {})
    %matmul_17 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_13, %transpose_17), kwargs = {})
    %add_48 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_13, 256), kwargs = {})
    %clamp_8 : [#users=1] = call_function[target=torch.clamp](args = (%add_48, 0, 511), kwargs = {})
    %expand_8 : [#users=1] = call_method[target=expand](args = (%clamp_8, [1, 12, 256, 256]), kwargs = {})
    %gather_8 : [#users=2] = call_function[target=torch.gather](args = (%matmul_17,), kwargs = {dim: -1, index: %expand_8})
    %full_like_4 : [#users=1] = call_function[target=torch.full_like](args = (%gather_8, 0), kwargs = {})
    %iadd_8 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_4, %gather_8), kwargs = {})
    %pos_q_proj_4 : [#users=1] = call_module[target=encoder.layer.4.attention.self.pos_q_proj](args = (%unsqueeze_14,), kwargs = {})
    %view_29 : [#users=1] = call_method[target=view](args = (%pos_q_proj_4, [1, 512, 12, -1]), kwargs = {})
    %permute_28 : [#users=1] = call_method[target=permute](args = (%view_29, 0, 2, 1, 3), kwargs = {})
    %tensor_171 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_20 : [#users=1] = call_function[target=operator.mul](args = (%tensor_171, 3), kwargs = {})
    %sqrt_18 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_20,), kwargs = {})
    %itruediv_4 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_28, %sqrt_18), kwargs = {})
    %neg_4 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_13,), kwargs = {})
    %add_49 : [#users=1] = call_function[target=operator.add](args = (%neg_4, 256), kwargs = {})
    %clamp_9 : [#users=1] = call_function[target=torch.clamp](args = (%add_49, 0, 511), kwargs = {})
    %transpose_18 : [#users=2] = call_method[target=transpose](args = (%itruediv_4, -1, -2), kwargs = {})
    %to_28 : [#users=0] = call_method[target=to](args = (%transpose_18,), kwargs = {dtype: torch.float32})
    %matmul_18 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_28, %transpose_18), kwargs = {})
    %expand_9 : [#users=1] = call_method[target=expand](args = (%clamp_9, [1, 12, 256, 256]), kwargs = {})
    %gather_9 : [#users=1] = call_function[target=torch.gather](args = (%matmul_18,), kwargs = {dim: -1, index: %expand_9})
    %transpose_19 : [#users=1] = call_method[target=transpose](args = (%gather_9, -1, -2), kwargs = {})
    %iadd_9 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_8, %transpose_19), kwargs = {})
    %add_50 : [#users=1] = call_function[target=operator.add](args = (%matmul_16, %iadd_9), kwargs = {})
    %to_29 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_4 : [#users=2] = call_function[target=operator.invert](args = (%to_29,), kwargs = {})
    %tensor_183 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_4 : [#users=1] = call_method[target=masked_fill](args = (%add_50, %invert_4, %tensor_183), kwargs = {})
    %softmax_4 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_4, -1), kwargs = {})
    %masked_fill__4 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_4, %invert_4, 0), kwargs = {})
    %matmul_19 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_4, %add_47), kwargs = {})
    %permute_29 : [#users=1] = call_method[target=permute](args = (%matmul_19, 0, 2, 1, 3), kwargs = {})
    %contiguous_4 : [#users=1] = call_method[target=contiguous](args = (%permute_29,), kwargs = {})
    %view_30 : [#users=1] = call_method[target=view](args = (%contiguous_4, [1, 256, -1]), kwargs = {})
    %dense_12 : [#users=1] = call_module[target=encoder.layer.4.attention.output.dense](args = (%view_30,), kwargs = {})
    %add_51 : [#users=4] = call_function[target=operator.add](args = (%dense_12, %add_45), kwargs = {})
    %float_10 : [#users=0] = call_method[target=float](args = (%add_51,), kwargs = {})
    %mean_18 : [#users=2] = call_method[target=mean](args = (%add_51, -1), kwargs = {keepdim: True})
    %sub_19 : [#users=1] = call_function[target=operator.sub](args = (%add_51, %mean_18), kwargs = {})
    %pow_10 : [#users=1] = call_method[target=pow](args = (%sub_19, 2), kwargs = {})
    %mean_19 : [#users=1] = call_method[target=mean](args = (%pow_10, -1), kwargs = {keepdim: True})
    %sub_20 : [#users=1] = call_function[target=operator.sub](args = (%add_51, %mean_18), kwargs = {})
    %add_52 : [#users=1] = call_function[target=operator.add](args = (%mean_19, 1e-07), kwargs = {})
    %sqrt_19 : [#users=1] = call_function[target=torch.sqrt](args = (%add_52,), kwargs = {})
    %truediv_14 : [#users=2] = call_function[target=operator.truediv](args = (%sub_20, %sqrt_19), kwargs = {})
    %to_30 : [#users=0] = call_method[target=to](args = (%truediv_14, torch.float32), kwargs = {})
    %weight_9 : [#users=1] = get_attr[target=encoder.layer.4.attention.output.LayerNorm.weight]
    %mul_21 : [#users=1] = call_function[target=operator.mul](args = (%weight_9, %truediv_14), kwargs = {})
    %bias_9 : [#users=1] = get_attr[target=encoder.layer.4.attention.output.LayerNorm.bias]
    %add_53 : [#users=2] = call_function[target=operator.add](args = (%mul_21, %bias_9), kwargs = {})
    %dense_13 : [#users=1] = call_module[target=encoder.layer.4.intermediate.dense](args = (%add_53,), kwargs = {})
    %gelu_4 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_13,), kwargs = {})
    %dense_14 : [#users=1] = call_module[target=encoder.layer.4.output.dense](args = (%gelu_4,), kwargs = {})
    %add_54 : [#users=4] = call_function[target=operator.add](args = (%dense_14, %add_53), kwargs = {})
    %float_11 : [#users=0] = call_method[target=float](args = (%add_54,), kwargs = {})
    %mean_20 : [#users=2] = call_method[target=mean](args = (%add_54, -1), kwargs = {keepdim: True})
    %sub_21 : [#users=1] = call_function[target=operator.sub](args = (%add_54, %mean_20), kwargs = {})
    %pow_11 : [#users=1] = call_method[target=pow](args = (%sub_21, 2), kwargs = {})
    %mean_21 : [#users=1] = call_method[target=mean](args = (%pow_11, -1), kwargs = {keepdim: True})
    %sub_22 : [#users=1] = call_function[target=operator.sub](args = (%add_54, %mean_20), kwargs = {})
    %add_55 : [#users=1] = call_function[target=operator.add](args = (%mean_21, 1e-07), kwargs = {})
    %sqrt_20 : [#users=1] = call_function[target=torch.sqrt](args = (%add_55,), kwargs = {})
    %truediv_15 : [#users=2] = call_function[target=operator.truediv](args = (%sub_22, %sqrt_20), kwargs = {})
    %to_31 : [#users=0] = call_method[target=to](args = (%truediv_15, torch.float32), kwargs = {})
    %weight_10 : [#users=1] = get_attr[target=encoder.layer.4.output.LayerNorm.weight]
    %mul_22 : [#users=1] = call_function[target=operator.mul](args = (%weight_10, %truediv_15), kwargs = {})
    %bias_10 : [#users=1] = get_attr[target=encoder.layer.4.output.LayerNorm.bias]
    %add_56 : [#users=2] = call_function[target=operator.add](args = (%mul_22, %bias_10), kwargs = {})
    %in_proj_5 : [#users=1] = call_module[target=encoder.layer.5.attention.self.in_proj](args = (%add_56,), kwargs = {})
    %view_31 : [#users=1] = call_method[target=view](args = (%in_proj_5, [1, 256, 12, -1]), kwargs = {})
    %permute_30 : [#users=1] = call_method[target=permute](args = (%view_31, 0, 2, 1, 3), kwargs = {})
    %chunk_5 : [#users=3] = call_method[target=chunk](args = (%permute_30, 3), kwargs = {dim: -1})
    %getitem_33 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_5, 0), kwargs = {})
    %getitem_34 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_5, 1), kwargs = {})
    %getitem_35 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_5, 2), kwargs = {})
    %q_bias_5 : [#users=1] = get_attr[target=encoder.layer.5.attention.self.q_bias]
    %getitem_36 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_5, [None, None, slice(None, None, None)]), kwargs = {})
    %view_32 : [#users=1] = call_method[target=view](args = (%getitem_36, [1, 1, 12, -1]), kwargs = {})
    %permute_31 : [#users=1] = call_method[target=permute](args = (%view_32, 0, 2, 1, 3), kwargs = {})
    %add_57 : [#users=1] = call_function[target=operator.add](args = (%getitem_33, %permute_31), kwargs = {})
    %v_bias_5 : [#users=1] = get_attr[target=encoder.layer.5.attention.self.v_bias]
    %getitem_37 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_5, [None, None, slice(None, None, None)]), kwargs = {})
    %view_33 : [#users=1] = call_method[target=view](args = (%getitem_37, [1, 1, 12, -1]), kwargs = {})
    %permute_32 : [#users=1] = call_method[target=permute](args = (%view_33, 0, 2, 1, 3), kwargs = {})
    %add_58 : [#users=1] = call_function[target=operator.add](args = (%getitem_35, %permute_32), kwargs = {})
    %tensor_184 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_23 : [#users=1] = call_function[target=operator.mul](args = (%tensor_184, 3), kwargs = {})
    %sqrt_21 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_23,), kwargs = {})
    %to_32 : [#users=0] = call_method[target=to](args = (%sqrt_21,), kwargs = {dtype: torch.float32})
    %truediv_16 : [#users=2] = call_function[target=operator.truediv](args = (%add_57, %sqrt_21), kwargs = {})
    %transpose_20 : [#users=1] = call_method[target=transpose](args = (%getitem_34, -1, -2), kwargs = {})
    %matmul_20 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_16, %transpose_20), kwargs = {})
    %unsqueeze_15 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_5 : [#users=0] = call_method[target=long](args = (%unsqueeze_15,), kwargs = {})
    %to_33 : [#users=0] = call_method[target=to](args = (%unsqueeze_15, cpu), kwargs = {})
    %__external_param__11 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_38 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__11, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_16 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_38, 0), kwargs = {})
    %pos_proj_5 : [#users=1] = call_module[target=encoder.layer.5.attention.self.pos_proj](args = (%unsqueeze_16,), kwargs = {})
    %view_34 : [#users=1] = call_method[target=view](args = (%pos_proj_5, [1, 512, 12, -1]), kwargs = {})
    %permute_33 : [#users=1] = call_method[target=permute](args = (%view_34, 0, 2, 1, 3), kwargs = {})
    %transpose_21 : [#users=1] = call_method[target=transpose](args = (%permute_33, -1, -2), kwargs = {})
    %matmul_21 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_16, %transpose_21), kwargs = {})
    %add_59 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_15, 256), kwargs = {})
    %clamp_10 : [#users=1] = call_function[target=torch.clamp](args = (%add_59, 0, 511), kwargs = {})
    %expand_10 : [#users=1] = call_method[target=expand](args = (%clamp_10, [1, 12, 256, 256]), kwargs = {})
    %gather_10 : [#users=2] = call_function[target=torch.gather](args = (%matmul_21,), kwargs = {dim: -1, index: %expand_10})
    %full_like_5 : [#users=1] = call_function[target=torch.full_like](args = (%gather_10, 0), kwargs = {})
    %iadd_10 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_5, %gather_10), kwargs = {})
    %pos_q_proj_5 : [#users=1] = call_module[target=encoder.layer.5.attention.self.pos_q_proj](args = (%unsqueeze_16,), kwargs = {})
    %view_35 : [#users=1] = call_method[target=view](args = (%pos_q_proj_5, [1, 512, 12, -1]), kwargs = {})
    %permute_34 : [#users=1] = call_method[target=permute](args = (%view_35, 0, 2, 1, 3), kwargs = {})
    %tensor_207 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_24 : [#users=1] = call_function[target=operator.mul](args = (%tensor_207, 3), kwargs = {})
    %sqrt_22 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_24,), kwargs = {})
    %itruediv_5 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_34, %sqrt_22), kwargs = {})
    %neg_5 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_15,), kwargs = {})
    %add_60 : [#users=1] = call_function[target=operator.add](args = (%neg_5, 256), kwargs = {})
    %clamp_11 : [#users=1] = call_function[target=torch.clamp](args = (%add_60, 0, 511), kwargs = {})
    %transpose_22 : [#users=2] = call_method[target=transpose](args = (%itruediv_5, -1, -2), kwargs = {})
    %to_34 : [#users=0] = call_method[target=to](args = (%transpose_22,), kwargs = {dtype: torch.float32})
    %matmul_22 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_34, %transpose_22), kwargs = {})
    %expand_11 : [#users=1] = call_method[target=expand](args = (%clamp_11, [1, 12, 256, 256]), kwargs = {})
    %gather_11 : [#users=1] = call_function[target=torch.gather](args = (%matmul_22,), kwargs = {dim: -1, index: %expand_11})
    %transpose_23 : [#users=1] = call_method[target=transpose](args = (%gather_11, -1, -2), kwargs = {})
    %iadd_11 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_10, %transpose_23), kwargs = {})
    %add_61 : [#users=1] = call_function[target=operator.add](args = (%matmul_20, %iadd_11), kwargs = {})
    %to_35 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_5 : [#users=2] = call_function[target=operator.invert](args = (%to_35,), kwargs = {})
    %tensor_219 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_5 : [#users=1] = call_method[target=masked_fill](args = (%add_61, %invert_5, %tensor_219), kwargs = {})
    %softmax_5 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_5, -1), kwargs = {})
    %masked_fill__5 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_5, %invert_5, 0), kwargs = {})
    %matmul_23 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_5, %add_58), kwargs = {})
    %permute_35 : [#users=1] = call_method[target=permute](args = (%matmul_23, 0, 2, 1, 3), kwargs = {})
    %contiguous_5 : [#users=1] = call_method[target=contiguous](args = (%permute_35,), kwargs = {})
    %view_36 : [#users=1] = call_method[target=view](args = (%contiguous_5, [1, 256, -1]), kwargs = {})
    %dense_15 : [#users=1] = call_module[target=encoder.layer.5.attention.output.dense](args = (%view_36,), kwargs = {})
    %add_62 : [#users=4] = call_function[target=operator.add](args = (%dense_15, %add_56), kwargs = {})
    %float_12 : [#users=0] = call_method[target=float](args = (%add_62,), kwargs = {})
    %mean_22 : [#users=2] = call_method[target=mean](args = (%add_62, -1), kwargs = {keepdim: True})
    %sub_23 : [#users=1] = call_function[target=operator.sub](args = (%add_62, %mean_22), kwargs = {})
    %pow_12 : [#users=1] = call_method[target=pow](args = (%sub_23, 2), kwargs = {})
    %mean_23 : [#users=1] = call_method[target=mean](args = (%pow_12, -1), kwargs = {keepdim: True})
    %sub_24 : [#users=1] = call_function[target=operator.sub](args = (%add_62, %mean_22), kwargs = {})
    %add_63 : [#users=1] = call_function[target=operator.add](args = (%mean_23, 1e-07), kwargs = {})
    %sqrt_23 : [#users=1] = call_function[target=torch.sqrt](args = (%add_63,), kwargs = {})
    %truediv_17 : [#users=2] = call_function[target=operator.truediv](args = (%sub_24, %sqrt_23), kwargs = {})
    %to_36 : [#users=0] = call_method[target=to](args = (%truediv_17, torch.float32), kwargs = {})
    %weight_11 : [#users=1] = get_attr[target=encoder.layer.5.attention.output.LayerNorm.weight]
    %mul_25 : [#users=1] = call_function[target=operator.mul](args = (%weight_11, %truediv_17), kwargs = {})
    %bias_11 : [#users=1] = get_attr[target=encoder.layer.5.attention.output.LayerNorm.bias]
    %add_64 : [#users=2] = call_function[target=operator.add](args = (%mul_25, %bias_11), kwargs = {})
    %dense_16 : [#users=1] = call_module[target=encoder.layer.5.intermediate.dense](args = (%add_64,), kwargs = {})
    %gelu_5 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_16,), kwargs = {})
    %dense_17 : [#users=1] = call_module[target=encoder.layer.5.output.dense](args = (%gelu_5,), kwargs = {})
    %add_65 : [#users=4] = call_function[target=operator.add](args = (%dense_17, %add_64), kwargs = {})
    %float_13 : [#users=0] = call_method[target=float](args = (%add_65,), kwargs = {})
    %mean_24 : [#users=2] = call_method[target=mean](args = (%add_65, -1), kwargs = {keepdim: True})
    %sub_25 : [#users=1] = call_function[target=operator.sub](args = (%add_65, %mean_24), kwargs = {})
    %pow_13 : [#users=1] = call_method[target=pow](args = (%sub_25, 2), kwargs = {})
    %mean_25 : [#users=1] = call_method[target=mean](args = (%pow_13, -1), kwargs = {keepdim: True})
    %sub_26 : [#users=1] = call_function[target=operator.sub](args = (%add_65, %mean_24), kwargs = {})
    %add_66 : [#users=1] = call_function[target=operator.add](args = (%mean_25, 1e-07), kwargs = {})
    %sqrt_24 : [#users=1] = call_function[target=torch.sqrt](args = (%add_66,), kwargs = {})
    %truediv_18 : [#users=2] = call_function[target=operator.truediv](args = (%sub_26, %sqrt_24), kwargs = {})
    %to_37 : [#users=0] = call_method[target=to](args = (%truediv_18, torch.float32), kwargs = {})
    %weight_12 : [#users=1] = get_attr[target=encoder.layer.5.output.LayerNorm.weight]
    %mul_26 : [#users=1] = call_function[target=operator.mul](args = (%weight_12, %truediv_18), kwargs = {})
    %bias_12 : [#users=1] = get_attr[target=encoder.layer.5.output.LayerNorm.bias]
    %add_67 : [#users=2] = call_function[target=operator.add](args = (%mul_26, %bias_12), kwargs = {})
    %in_proj_6 : [#users=1] = call_module[target=encoder.layer.6.attention.self.in_proj](args = (%add_67,), kwargs = {})
    %view_37 : [#users=1] = call_method[target=view](args = (%in_proj_6, [1, 256, 12, -1]), kwargs = {})
    %permute_36 : [#users=1] = call_method[target=permute](args = (%view_37, 0, 2, 1, 3), kwargs = {})
    %chunk_6 : [#users=3] = call_method[target=chunk](args = (%permute_36, 3), kwargs = {dim: -1})
    %getitem_39 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_6, 0), kwargs = {})
    %getitem_40 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_6, 1), kwargs = {})
    %getitem_41 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_6, 2), kwargs = {})
    %q_bias_6 : [#users=1] = get_attr[target=encoder.layer.6.attention.self.q_bias]
    %getitem_42 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_6, [None, None, slice(None, None, None)]), kwargs = {})
    %view_38 : [#users=1] = call_method[target=view](args = (%getitem_42, [1, 1, 12, -1]), kwargs = {})
    %permute_37 : [#users=1] = call_method[target=permute](args = (%view_38, 0, 2, 1, 3), kwargs = {})
    %add_68 : [#users=1] = call_function[target=operator.add](args = (%getitem_39, %permute_37), kwargs = {})
    %v_bias_6 : [#users=1] = get_attr[target=encoder.layer.6.attention.self.v_bias]
    %getitem_43 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_6, [None, None, slice(None, None, None)]), kwargs = {})
    %view_39 : [#users=1] = call_method[target=view](args = (%getitem_43, [1, 1, 12, -1]), kwargs = {})
    %permute_38 : [#users=1] = call_method[target=permute](args = (%view_39, 0, 2, 1, 3), kwargs = {})
    %add_69 : [#users=1] = call_function[target=operator.add](args = (%getitem_41, %permute_38), kwargs = {})
    %tensor_220 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_27 : [#users=1] = call_function[target=operator.mul](args = (%tensor_220, 3), kwargs = {})
    %sqrt_25 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_27,), kwargs = {})
    %to_38 : [#users=0] = call_method[target=to](args = (%sqrt_25,), kwargs = {dtype: torch.float32})
    %truediv_19 : [#users=2] = call_function[target=operator.truediv](args = (%add_68, %sqrt_25), kwargs = {})
    %transpose_24 : [#users=1] = call_method[target=transpose](args = (%getitem_40, -1, -2), kwargs = {})
    %matmul_24 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_19, %transpose_24), kwargs = {})
    %unsqueeze_17 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_6 : [#users=0] = call_method[target=long](args = (%unsqueeze_17,), kwargs = {})
    %to_39 : [#users=0] = call_method[target=to](args = (%unsqueeze_17, cpu), kwargs = {})
    %__external_param__12 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_44 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__12, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_18 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_44, 0), kwargs = {})
    %pos_proj_6 : [#users=1] = call_module[target=encoder.layer.6.attention.self.pos_proj](args = (%unsqueeze_18,), kwargs = {})
    %view_40 : [#users=1] = call_method[target=view](args = (%pos_proj_6, [1, 512, 12, -1]), kwargs = {})
    %permute_39 : [#users=1] = call_method[target=permute](args = (%view_40, 0, 2, 1, 3), kwargs = {})
    %transpose_25 : [#users=1] = call_method[target=transpose](args = (%permute_39, -1, -2), kwargs = {})
    %matmul_25 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_19, %transpose_25), kwargs = {})
    %add_70 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_17, 256), kwargs = {})
    %clamp_12 : [#users=1] = call_function[target=torch.clamp](args = (%add_70, 0, 511), kwargs = {})
    %expand_12 : [#users=1] = call_method[target=expand](args = (%clamp_12, [1, 12, 256, 256]), kwargs = {})
    %gather_12 : [#users=2] = call_function[target=torch.gather](args = (%matmul_25,), kwargs = {dim: -1, index: %expand_12})
    %full_like_6 : [#users=1] = call_function[target=torch.full_like](args = (%gather_12, 0), kwargs = {})
    %iadd_12 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_6, %gather_12), kwargs = {})
    %pos_q_proj_6 : [#users=1] = call_module[target=encoder.layer.6.attention.self.pos_q_proj](args = (%unsqueeze_18,), kwargs = {})
    %view_41 : [#users=1] = call_method[target=view](args = (%pos_q_proj_6, [1, 512, 12, -1]), kwargs = {})
    %permute_40 : [#users=1] = call_method[target=permute](args = (%view_41, 0, 2, 1, 3), kwargs = {})
    %tensor_243 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_28 : [#users=1] = call_function[target=operator.mul](args = (%tensor_243, 3), kwargs = {})
    %sqrt_26 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_28,), kwargs = {})
    %itruediv_6 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_40, %sqrt_26), kwargs = {})
    %neg_6 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_17,), kwargs = {})
    %add_71 : [#users=1] = call_function[target=operator.add](args = (%neg_6, 256), kwargs = {})
    %clamp_13 : [#users=1] = call_function[target=torch.clamp](args = (%add_71, 0, 511), kwargs = {})
    %transpose_26 : [#users=2] = call_method[target=transpose](args = (%itruediv_6, -1, -2), kwargs = {})
    %to_40 : [#users=0] = call_method[target=to](args = (%transpose_26,), kwargs = {dtype: torch.float32})
    %matmul_26 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_40, %transpose_26), kwargs = {})
    %expand_13 : [#users=1] = call_method[target=expand](args = (%clamp_13, [1, 12, 256, 256]), kwargs = {})
    %gather_13 : [#users=1] = call_function[target=torch.gather](args = (%matmul_26,), kwargs = {dim: -1, index: %expand_13})
    %transpose_27 : [#users=1] = call_method[target=transpose](args = (%gather_13, -1, -2), kwargs = {})
    %iadd_13 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_12, %transpose_27), kwargs = {})
    %add_72 : [#users=1] = call_function[target=operator.add](args = (%matmul_24, %iadd_13), kwargs = {})
    %to_41 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_6 : [#users=2] = call_function[target=operator.invert](args = (%to_41,), kwargs = {})
    %tensor_255 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_6 : [#users=1] = call_method[target=masked_fill](args = (%add_72, %invert_6, %tensor_255), kwargs = {})
    %softmax_6 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_6, -1), kwargs = {})
    %masked_fill__6 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_6, %invert_6, 0), kwargs = {})
    %matmul_27 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_6, %add_69), kwargs = {})
    %permute_41 : [#users=1] = call_method[target=permute](args = (%matmul_27, 0, 2, 1, 3), kwargs = {})
    %contiguous_6 : [#users=1] = call_method[target=contiguous](args = (%permute_41,), kwargs = {})
    %view_42 : [#users=1] = call_method[target=view](args = (%contiguous_6, [1, 256, -1]), kwargs = {})
    %dense_18 : [#users=1] = call_module[target=encoder.layer.6.attention.output.dense](args = (%view_42,), kwargs = {})
    %add_73 : [#users=4] = call_function[target=operator.add](args = (%dense_18, %add_67), kwargs = {})
    %float_14 : [#users=0] = call_method[target=float](args = (%add_73,), kwargs = {})
    %mean_26 : [#users=2] = call_method[target=mean](args = (%add_73, -1), kwargs = {keepdim: True})
    %sub_27 : [#users=1] = call_function[target=operator.sub](args = (%add_73, %mean_26), kwargs = {})
    %pow_14 : [#users=1] = call_method[target=pow](args = (%sub_27, 2), kwargs = {})
    %mean_27 : [#users=1] = call_method[target=mean](args = (%pow_14, -1), kwargs = {keepdim: True})
    %sub_28 : [#users=1] = call_function[target=operator.sub](args = (%add_73, %mean_26), kwargs = {})
    %add_74 : [#users=1] = call_function[target=operator.add](args = (%mean_27, 1e-07), kwargs = {})
    %sqrt_27 : [#users=1] = call_function[target=torch.sqrt](args = (%add_74,), kwargs = {})
    %truediv_20 : [#users=2] = call_function[target=operator.truediv](args = (%sub_28, %sqrt_27), kwargs = {})
    %to_42 : [#users=0] = call_method[target=to](args = (%truediv_20, torch.float32), kwargs = {})
    %weight_13 : [#users=1] = get_attr[target=encoder.layer.6.attention.output.LayerNorm.weight]
    %mul_29 : [#users=1] = call_function[target=operator.mul](args = (%weight_13, %truediv_20), kwargs = {})
    %bias_13 : [#users=1] = get_attr[target=encoder.layer.6.attention.output.LayerNorm.bias]
    %add_75 : [#users=2] = call_function[target=operator.add](args = (%mul_29, %bias_13), kwargs = {})
    %dense_19 : [#users=1] = call_module[target=encoder.layer.6.intermediate.dense](args = (%add_75,), kwargs = {})
    %gelu_6 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_19,), kwargs = {})
    %dense_20 : [#users=1] = call_module[target=encoder.layer.6.output.dense](args = (%gelu_6,), kwargs = {})
    %add_76 : [#users=4] = call_function[target=operator.add](args = (%dense_20, %add_75), kwargs = {})
    %float_15 : [#users=0] = call_method[target=float](args = (%add_76,), kwargs = {})
    %mean_28 : [#users=2] = call_method[target=mean](args = (%add_76, -1), kwargs = {keepdim: True})
    %sub_29 : [#users=1] = call_function[target=operator.sub](args = (%add_76, %mean_28), kwargs = {})
    %pow_15 : [#users=1] = call_method[target=pow](args = (%sub_29, 2), kwargs = {})
    %mean_29 : [#users=1] = call_method[target=mean](args = (%pow_15, -1), kwargs = {keepdim: True})
    %sub_30 : [#users=1] = call_function[target=operator.sub](args = (%add_76, %mean_28), kwargs = {})
    %add_77 : [#users=1] = call_function[target=operator.add](args = (%mean_29, 1e-07), kwargs = {})
    %sqrt_28 : [#users=1] = call_function[target=torch.sqrt](args = (%add_77,), kwargs = {})
    %truediv_21 : [#users=2] = call_function[target=operator.truediv](args = (%sub_30, %sqrt_28), kwargs = {})
    %to_43 : [#users=0] = call_method[target=to](args = (%truediv_21, torch.float32), kwargs = {})
    %weight_14 : [#users=1] = get_attr[target=encoder.layer.6.output.LayerNorm.weight]
    %mul_30 : [#users=1] = call_function[target=operator.mul](args = (%weight_14, %truediv_21), kwargs = {})
    %bias_14 : [#users=1] = get_attr[target=encoder.layer.6.output.LayerNorm.bias]
    %add_78 : [#users=2] = call_function[target=operator.add](args = (%mul_30, %bias_14), kwargs = {})
    %in_proj_7 : [#users=1] = call_module[target=encoder.layer.7.attention.self.in_proj](args = (%add_78,), kwargs = {})
    %view_43 : [#users=1] = call_method[target=view](args = (%in_proj_7, [1, 256, 12, -1]), kwargs = {})
    %permute_42 : [#users=1] = call_method[target=permute](args = (%view_43, 0, 2, 1, 3), kwargs = {})
    %chunk_7 : [#users=3] = call_method[target=chunk](args = (%permute_42, 3), kwargs = {dim: -1})
    %getitem_45 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_7, 0), kwargs = {})
    %getitem_46 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_7, 1), kwargs = {})
    %getitem_47 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_7, 2), kwargs = {})
    %q_bias_7 : [#users=1] = get_attr[target=encoder.layer.7.attention.self.q_bias]
    %getitem_48 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_7, [None, None, slice(None, None, None)]), kwargs = {})
    %view_44 : [#users=1] = call_method[target=view](args = (%getitem_48, [1, 1, 12, -1]), kwargs = {})
    %permute_43 : [#users=1] = call_method[target=permute](args = (%view_44, 0, 2, 1, 3), kwargs = {})
    %add_79 : [#users=1] = call_function[target=operator.add](args = (%getitem_45, %permute_43), kwargs = {})
    %v_bias_7 : [#users=1] = get_attr[target=encoder.layer.7.attention.self.v_bias]
    %getitem_49 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_7, [None, None, slice(None, None, None)]), kwargs = {})
    %view_45 : [#users=1] = call_method[target=view](args = (%getitem_49, [1, 1, 12, -1]), kwargs = {})
    %permute_44 : [#users=1] = call_method[target=permute](args = (%view_45, 0, 2, 1, 3), kwargs = {})
    %add_80 : [#users=1] = call_function[target=operator.add](args = (%getitem_47, %permute_44), kwargs = {})
    %tensor_256 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_31 : [#users=1] = call_function[target=operator.mul](args = (%tensor_256, 3), kwargs = {})
    %sqrt_29 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_31,), kwargs = {})
    %to_44 : [#users=0] = call_method[target=to](args = (%sqrt_29,), kwargs = {dtype: torch.float32})
    %truediv_22 : [#users=2] = call_function[target=operator.truediv](args = (%add_79, %sqrt_29), kwargs = {})
    %transpose_28 : [#users=1] = call_method[target=transpose](args = (%getitem_46, -1, -2), kwargs = {})
    %matmul_28 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_22, %transpose_28), kwargs = {})
    %unsqueeze_19 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_7 : [#users=0] = call_method[target=long](args = (%unsqueeze_19,), kwargs = {})
    %to_45 : [#users=0] = call_method[target=to](args = (%unsqueeze_19, cpu), kwargs = {})
    %__external_param__13 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_50 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__13, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_20 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_50, 0), kwargs = {})
    %pos_proj_7 : [#users=1] = call_module[target=encoder.layer.7.attention.self.pos_proj](args = (%unsqueeze_20,), kwargs = {})
    %view_46 : [#users=1] = call_method[target=view](args = (%pos_proj_7, [1, 512, 12, -1]), kwargs = {})
    %permute_45 : [#users=1] = call_method[target=permute](args = (%view_46, 0, 2, 1, 3), kwargs = {})
    %transpose_29 : [#users=1] = call_method[target=transpose](args = (%permute_45, -1, -2), kwargs = {})
    %matmul_29 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_22, %transpose_29), kwargs = {})
    %add_81 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_19, 256), kwargs = {})
    %clamp_14 : [#users=1] = call_function[target=torch.clamp](args = (%add_81, 0, 511), kwargs = {})
    %expand_14 : [#users=1] = call_method[target=expand](args = (%clamp_14, [1, 12, 256, 256]), kwargs = {})
    %gather_14 : [#users=2] = call_function[target=torch.gather](args = (%matmul_29,), kwargs = {dim: -1, index: %expand_14})
    %full_like_7 : [#users=1] = call_function[target=torch.full_like](args = (%gather_14, 0), kwargs = {})
    %iadd_14 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_7, %gather_14), kwargs = {})
    %pos_q_proj_7 : [#users=1] = call_module[target=encoder.layer.7.attention.self.pos_q_proj](args = (%unsqueeze_20,), kwargs = {})
    %view_47 : [#users=1] = call_method[target=view](args = (%pos_q_proj_7, [1, 512, 12, -1]), kwargs = {})
    %permute_46 : [#users=1] = call_method[target=permute](args = (%view_47, 0, 2, 1, 3), kwargs = {})
    %tensor_279 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_32 : [#users=1] = call_function[target=operator.mul](args = (%tensor_279, 3), kwargs = {})
    %sqrt_30 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_32,), kwargs = {})
    %itruediv_7 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_46, %sqrt_30), kwargs = {})
    %neg_7 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_19,), kwargs = {})
    %add_82 : [#users=1] = call_function[target=operator.add](args = (%neg_7, 256), kwargs = {})
    %clamp_15 : [#users=1] = call_function[target=torch.clamp](args = (%add_82, 0, 511), kwargs = {})
    %transpose_30 : [#users=2] = call_method[target=transpose](args = (%itruediv_7, -1, -2), kwargs = {})
    %to_46 : [#users=0] = call_method[target=to](args = (%transpose_30,), kwargs = {dtype: torch.float32})
    %matmul_30 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_46, %transpose_30), kwargs = {})
    %expand_15 : [#users=1] = call_method[target=expand](args = (%clamp_15, [1, 12, 256, 256]), kwargs = {})
    %gather_15 : [#users=1] = call_function[target=torch.gather](args = (%matmul_30,), kwargs = {dim: -1, index: %expand_15})
    %transpose_31 : [#users=1] = call_method[target=transpose](args = (%gather_15, -1, -2), kwargs = {})
    %iadd_15 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_14, %transpose_31), kwargs = {})
    %add_83 : [#users=1] = call_function[target=operator.add](args = (%matmul_28, %iadd_15), kwargs = {})
    %to_47 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_7 : [#users=2] = call_function[target=operator.invert](args = (%to_47,), kwargs = {})
    %tensor_291 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_7 : [#users=1] = call_method[target=masked_fill](args = (%add_83, %invert_7, %tensor_291), kwargs = {})
    %softmax_7 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_7, -1), kwargs = {})
    %masked_fill__7 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_7, %invert_7, 0), kwargs = {})
    %matmul_31 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_7, %add_80), kwargs = {})
    %permute_47 : [#users=1] = call_method[target=permute](args = (%matmul_31, 0, 2, 1, 3), kwargs = {})
    %contiguous_7 : [#users=1] = call_method[target=contiguous](args = (%permute_47,), kwargs = {})
    %view_48 : [#users=1] = call_method[target=view](args = (%contiguous_7, [1, 256, -1]), kwargs = {})
    %dense_21 : [#users=1] = call_module[target=encoder.layer.7.attention.output.dense](args = (%view_48,), kwargs = {})
    %add_84 : [#users=4] = call_function[target=operator.add](args = (%dense_21, %add_78), kwargs = {})
    %float_16 : [#users=0] = call_method[target=float](args = (%add_84,), kwargs = {})
    %mean_30 : [#users=2] = call_method[target=mean](args = (%add_84, -1), kwargs = {keepdim: True})
    %sub_31 : [#users=1] = call_function[target=operator.sub](args = (%add_84, %mean_30), kwargs = {})
    %pow_16 : [#users=1] = call_method[target=pow](args = (%sub_31, 2), kwargs = {})
    %mean_31 : [#users=1] = call_method[target=mean](args = (%pow_16, -1), kwargs = {keepdim: True})
    %sub_32 : [#users=1] = call_function[target=operator.sub](args = (%add_84, %mean_30), kwargs = {})
    %add_85 : [#users=1] = call_function[target=operator.add](args = (%mean_31, 1e-07), kwargs = {})
    %sqrt_31 : [#users=1] = call_function[target=torch.sqrt](args = (%add_85,), kwargs = {})
    %truediv_23 : [#users=2] = call_function[target=operator.truediv](args = (%sub_32, %sqrt_31), kwargs = {})
    %to_48 : [#users=0] = call_method[target=to](args = (%truediv_23, torch.float32), kwargs = {})
    %weight_15 : [#users=1] = get_attr[target=encoder.layer.7.attention.output.LayerNorm.weight]
    %mul_33 : [#users=1] = call_function[target=operator.mul](args = (%weight_15, %truediv_23), kwargs = {})
    %bias_15 : [#users=1] = get_attr[target=encoder.layer.7.attention.output.LayerNorm.bias]
    %add_86 : [#users=2] = call_function[target=operator.add](args = (%mul_33, %bias_15), kwargs = {})
    %dense_22 : [#users=1] = call_module[target=encoder.layer.7.intermediate.dense](args = (%add_86,), kwargs = {})
    %gelu_7 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_22,), kwargs = {})
    %dense_23 : [#users=1] = call_module[target=encoder.layer.7.output.dense](args = (%gelu_7,), kwargs = {})
    %add_87 : [#users=4] = call_function[target=operator.add](args = (%dense_23, %add_86), kwargs = {})
    %float_17 : [#users=0] = call_method[target=float](args = (%add_87,), kwargs = {})
    %mean_32 : [#users=2] = call_method[target=mean](args = (%add_87, -1), kwargs = {keepdim: True})
    %sub_33 : [#users=1] = call_function[target=operator.sub](args = (%add_87, %mean_32), kwargs = {})
    %pow_17 : [#users=1] = call_method[target=pow](args = (%sub_33, 2), kwargs = {})
    %mean_33 : [#users=1] = call_method[target=mean](args = (%pow_17, -1), kwargs = {keepdim: True})
    %sub_34 : [#users=1] = call_function[target=operator.sub](args = (%add_87, %mean_32), kwargs = {})
    %add_88 : [#users=1] = call_function[target=operator.add](args = (%mean_33, 1e-07), kwargs = {})
    %sqrt_32 : [#users=1] = call_function[target=torch.sqrt](args = (%add_88,), kwargs = {})
    %truediv_24 : [#users=2] = call_function[target=operator.truediv](args = (%sub_34, %sqrt_32), kwargs = {})
    %to_49 : [#users=0] = call_method[target=to](args = (%truediv_24, torch.float32), kwargs = {})
    %weight_16 : [#users=1] = get_attr[target=encoder.layer.7.output.LayerNorm.weight]
    %mul_34 : [#users=1] = call_function[target=operator.mul](args = (%weight_16, %truediv_24), kwargs = {})
    %bias_16 : [#users=1] = get_attr[target=encoder.layer.7.output.LayerNorm.bias]
    %add_89 : [#users=2] = call_function[target=operator.add](args = (%mul_34, %bias_16), kwargs = {})
    %in_proj_8 : [#users=1] = call_module[target=encoder.layer.8.attention.self.in_proj](args = (%add_89,), kwargs = {})
    %view_49 : [#users=1] = call_method[target=view](args = (%in_proj_8, [1, 256, 12, -1]), kwargs = {})
    %permute_48 : [#users=1] = call_method[target=permute](args = (%view_49, 0, 2, 1, 3), kwargs = {})
    %chunk_8 : [#users=3] = call_method[target=chunk](args = (%permute_48, 3), kwargs = {dim: -1})
    %getitem_51 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_8, 0), kwargs = {})
    %getitem_52 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_8, 1), kwargs = {})
    %getitem_53 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_8, 2), kwargs = {})
    %q_bias_8 : [#users=1] = get_attr[target=encoder.layer.8.attention.self.q_bias]
    %getitem_54 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_8, [None, None, slice(None, None, None)]), kwargs = {})
    %view_50 : [#users=1] = call_method[target=view](args = (%getitem_54, [1, 1, 12, -1]), kwargs = {})
    %permute_49 : [#users=1] = call_method[target=permute](args = (%view_50, 0, 2, 1, 3), kwargs = {})
    %add_90 : [#users=1] = call_function[target=operator.add](args = (%getitem_51, %permute_49), kwargs = {})
    %v_bias_8 : [#users=1] = get_attr[target=encoder.layer.8.attention.self.v_bias]
    %getitem_55 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_8, [None, None, slice(None, None, None)]), kwargs = {})
    %view_51 : [#users=1] = call_method[target=view](args = (%getitem_55, [1, 1, 12, -1]), kwargs = {})
    %permute_50 : [#users=1] = call_method[target=permute](args = (%view_51, 0, 2, 1, 3), kwargs = {})
    %add_91 : [#users=1] = call_function[target=operator.add](args = (%getitem_53, %permute_50), kwargs = {})
    %tensor_292 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_35 : [#users=1] = call_function[target=operator.mul](args = (%tensor_292, 3), kwargs = {})
    %sqrt_33 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_35,), kwargs = {})
    %to_50 : [#users=0] = call_method[target=to](args = (%sqrt_33,), kwargs = {dtype: torch.float32})
    %truediv_25 : [#users=2] = call_function[target=operator.truediv](args = (%add_90, %sqrt_33), kwargs = {})
    %transpose_32 : [#users=1] = call_method[target=transpose](args = (%getitem_52, -1, -2), kwargs = {})
    %matmul_32 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_25, %transpose_32), kwargs = {})
    %unsqueeze_21 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_8 : [#users=0] = call_method[target=long](args = (%unsqueeze_21,), kwargs = {})
    %to_51 : [#users=0] = call_method[target=to](args = (%unsqueeze_21, cpu), kwargs = {})
    %__external_param__14 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_56 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__14, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_22 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_56, 0), kwargs = {})
    %pos_proj_8 : [#users=1] = call_module[target=encoder.layer.8.attention.self.pos_proj](args = (%unsqueeze_22,), kwargs = {})
    %view_52 : [#users=1] = call_method[target=view](args = (%pos_proj_8, [1, 512, 12, -1]), kwargs = {})
    %permute_51 : [#users=1] = call_method[target=permute](args = (%view_52, 0, 2, 1, 3), kwargs = {})
    %transpose_33 : [#users=1] = call_method[target=transpose](args = (%permute_51, -1, -2), kwargs = {})
    %matmul_33 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_25, %transpose_33), kwargs = {})
    %add_92 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_21, 256), kwargs = {})
    %clamp_16 : [#users=1] = call_function[target=torch.clamp](args = (%add_92, 0, 511), kwargs = {})
    %expand_16 : [#users=1] = call_method[target=expand](args = (%clamp_16, [1, 12, 256, 256]), kwargs = {})
    %gather_16 : [#users=2] = call_function[target=torch.gather](args = (%matmul_33,), kwargs = {dim: -1, index: %expand_16})
    %full_like_8 : [#users=1] = call_function[target=torch.full_like](args = (%gather_16, 0), kwargs = {})
    %iadd_16 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_8, %gather_16), kwargs = {})
    %pos_q_proj_8 : [#users=1] = call_module[target=encoder.layer.8.attention.self.pos_q_proj](args = (%unsqueeze_22,), kwargs = {})
    %view_53 : [#users=1] = call_method[target=view](args = (%pos_q_proj_8, [1, 512, 12, -1]), kwargs = {})
    %permute_52 : [#users=1] = call_method[target=permute](args = (%view_53, 0, 2, 1, 3), kwargs = {})
    %tensor_315 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_36 : [#users=1] = call_function[target=operator.mul](args = (%tensor_315, 3), kwargs = {})
    %sqrt_34 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_36,), kwargs = {})
    %itruediv_8 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_52, %sqrt_34), kwargs = {})
    %neg_8 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_21,), kwargs = {})
    %add_93 : [#users=1] = call_function[target=operator.add](args = (%neg_8, 256), kwargs = {})
    %clamp_17 : [#users=1] = call_function[target=torch.clamp](args = (%add_93, 0, 511), kwargs = {})
    %transpose_34 : [#users=2] = call_method[target=transpose](args = (%itruediv_8, -1, -2), kwargs = {})
    %to_52 : [#users=0] = call_method[target=to](args = (%transpose_34,), kwargs = {dtype: torch.float32})
    %matmul_34 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_52, %transpose_34), kwargs = {})
    %expand_17 : [#users=1] = call_method[target=expand](args = (%clamp_17, [1, 12, 256, 256]), kwargs = {})
    %gather_17 : [#users=1] = call_function[target=torch.gather](args = (%matmul_34,), kwargs = {dim: -1, index: %expand_17})
    %transpose_35 : [#users=1] = call_method[target=transpose](args = (%gather_17, -1, -2), kwargs = {})
    %iadd_17 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_16, %transpose_35), kwargs = {})
    %add_94 : [#users=1] = call_function[target=operator.add](args = (%matmul_32, %iadd_17), kwargs = {})
    %to_53 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_8 : [#users=2] = call_function[target=operator.invert](args = (%to_53,), kwargs = {})
    %tensor_327 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_8 : [#users=1] = call_method[target=masked_fill](args = (%add_94, %invert_8, %tensor_327), kwargs = {})
    %softmax_8 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_8, -1), kwargs = {})
    %masked_fill__8 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_8, %invert_8, 0), kwargs = {})
    %matmul_35 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_8, %add_91), kwargs = {})
    %permute_53 : [#users=1] = call_method[target=permute](args = (%matmul_35, 0, 2, 1, 3), kwargs = {})
    %contiguous_8 : [#users=1] = call_method[target=contiguous](args = (%permute_53,), kwargs = {})
    %view_54 : [#users=1] = call_method[target=view](args = (%contiguous_8, [1, 256, -1]), kwargs = {})
    %dense_24 : [#users=1] = call_module[target=encoder.layer.8.attention.output.dense](args = (%view_54,), kwargs = {})
    %add_95 : [#users=4] = call_function[target=operator.add](args = (%dense_24, %add_89), kwargs = {})
    %float_18 : [#users=0] = call_method[target=float](args = (%add_95,), kwargs = {})
    %mean_34 : [#users=2] = call_method[target=mean](args = (%add_95, -1), kwargs = {keepdim: True})
    %sub_35 : [#users=1] = call_function[target=operator.sub](args = (%add_95, %mean_34), kwargs = {})
    %pow_18 : [#users=1] = call_method[target=pow](args = (%sub_35, 2), kwargs = {})
    %mean_35 : [#users=1] = call_method[target=mean](args = (%pow_18, -1), kwargs = {keepdim: True})
    %sub_36 : [#users=1] = call_function[target=operator.sub](args = (%add_95, %mean_34), kwargs = {})
    %add_96 : [#users=1] = call_function[target=operator.add](args = (%mean_35, 1e-07), kwargs = {})
    %sqrt_35 : [#users=1] = call_function[target=torch.sqrt](args = (%add_96,), kwargs = {})
    %truediv_26 : [#users=2] = call_function[target=operator.truediv](args = (%sub_36, %sqrt_35), kwargs = {})
    %to_54 : [#users=0] = call_method[target=to](args = (%truediv_26, torch.float32), kwargs = {})
    %weight_17 : [#users=1] = get_attr[target=encoder.layer.8.attention.output.LayerNorm.weight]
    %mul_37 : [#users=1] = call_function[target=operator.mul](args = (%weight_17, %truediv_26), kwargs = {})
    %bias_17 : [#users=1] = get_attr[target=encoder.layer.8.attention.output.LayerNorm.bias]
    %add_97 : [#users=2] = call_function[target=operator.add](args = (%mul_37, %bias_17), kwargs = {})
    %dense_25 : [#users=1] = call_module[target=encoder.layer.8.intermediate.dense](args = (%add_97,), kwargs = {})
    %gelu_8 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_25,), kwargs = {})
    %dense_26 : [#users=1] = call_module[target=encoder.layer.8.output.dense](args = (%gelu_8,), kwargs = {})
    %add_98 : [#users=4] = call_function[target=operator.add](args = (%dense_26, %add_97), kwargs = {})
    %float_19 : [#users=0] = call_method[target=float](args = (%add_98,), kwargs = {})
    %mean_36 : [#users=2] = call_method[target=mean](args = (%add_98, -1), kwargs = {keepdim: True})
    %sub_37 : [#users=1] = call_function[target=operator.sub](args = (%add_98, %mean_36), kwargs = {})
    %pow_19 : [#users=1] = call_method[target=pow](args = (%sub_37, 2), kwargs = {})
    %mean_37 : [#users=1] = call_method[target=mean](args = (%pow_19, -1), kwargs = {keepdim: True})
    %sub_38 : [#users=1] = call_function[target=operator.sub](args = (%add_98, %mean_36), kwargs = {})
    %add_99 : [#users=1] = call_function[target=operator.add](args = (%mean_37, 1e-07), kwargs = {})
    %sqrt_36 : [#users=1] = call_function[target=torch.sqrt](args = (%add_99,), kwargs = {})
    %truediv_27 : [#users=2] = call_function[target=operator.truediv](args = (%sub_38, %sqrt_36), kwargs = {})
    %to_55 : [#users=0] = call_method[target=to](args = (%truediv_27, torch.float32), kwargs = {})
    %weight_18 : [#users=1] = get_attr[target=encoder.layer.8.output.LayerNorm.weight]
    %mul_38 : [#users=1] = call_function[target=operator.mul](args = (%weight_18, %truediv_27), kwargs = {})
    %bias_18 : [#users=1] = get_attr[target=encoder.layer.8.output.LayerNorm.bias]
    %add_100 : [#users=2] = call_function[target=operator.add](args = (%mul_38, %bias_18), kwargs = {})
    %in_proj_9 : [#users=1] = call_module[target=encoder.layer.9.attention.self.in_proj](args = (%add_100,), kwargs = {})
    %view_55 : [#users=1] = call_method[target=view](args = (%in_proj_9, [1, 256, 12, -1]), kwargs = {})
    %permute_54 : [#users=1] = call_method[target=permute](args = (%view_55, 0, 2, 1, 3), kwargs = {})
    %chunk_9 : [#users=3] = call_method[target=chunk](args = (%permute_54, 3), kwargs = {dim: -1})
    %getitem_57 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_9, 0), kwargs = {})
    %getitem_58 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_9, 1), kwargs = {})
    %getitem_59 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_9, 2), kwargs = {})
    %q_bias_9 : [#users=1] = get_attr[target=encoder.layer.9.attention.self.q_bias]
    %getitem_60 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_9, [None, None, slice(None, None, None)]), kwargs = {})
    %view_56 : [#users=1] = call_method[target=view](args = (%getitem_60, [1, 1, 12, -1]), kwargs = {})
    %permute_55 : [#users=1] = call_method[target=permute](args = (%view_56, 0, 2, 1, 3), kwargs = {})
    %add_101 : [#users=1] = call_function[target=operator.add](args = (%getitem_57, %permute_55), kwargs = {})
    %v_bias_9 : [#users=1] = get_attr[target=encoder.layer.9.attention.self.v_bias]
    %getitem_61 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_9, [None, None, slice(None, None, None)]), kwargs = {})
    %view_57 : [#users=1] = call_method[target=view](args = (%getitem_61, [1, 1, 12, -1]), kwargs = {})
    %permute_56 : [#users=1] = call_method[target=permute](args = (%view_57, 0, 2, 1, 3), kwargs = {})
    %add_102 : [#users=1] = call_function[target=operator.add](args = (%getitem_59, %permute_56), kwargs = {})
    %tensor_328 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_39 : [#users=1] = call_function[target=operator.mul](args = (%tensor_328, 3), kwargs = {})
    %sqrt_37 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_39,), kwargs = {})
    %to_56 : [#users=0] = call_method[target=to](args = (%sqrt_37,), kwargs = {dtype: torch.float32})
    %truediv_28 : [#users=2] = call_function[target=operator.truediv](args = (%add_101, %sqrt_37), kwargs = {})
    %transpose_36 : [#users=1] = call_method[target=transpose](args = (%getitem_58, -1, -2), kwargs = {})
    %matmul_36 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_28, %transpose_36), kwargs = {})
    %unsqueeze_23 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_9 : [#users=0] = call_method[target=long](args = (%unsqueeze_23,), kwargs = {})
    %to_57 : [#users=0] = call_method[target=to](args = (%unsqueeze_23, cpu), kwargs = {})
    %__external_param__15 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_62 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__15, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_24 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_62, 0), kwargs = {})
    %pos_proj_9 : [#users=1] = call_module[target=encoder.layer.9.attention.self.pos_proj](args = (%unsqueeze_24,), kwargs = {})
    %view_58 : [#users=1] = call_method[target=view](args = (%pos_proj_9, [1, 512, 12, -1]), kwargs = {})
    %permute_57 : [#users=1] = call_method[target=permute](args = (%view_58, 0, 2, 1, 3), kwargs = {})
    %transpose_37 : [#users=1] = call_method[target=transpose](args = (%permute_57, -1, -2), kwargs = {})
    %matmul_37 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_28, %transpose_37), kwargs = {})
    %add_103 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_23, 256), kwargs = {})
    %clamp_18 : [#users=1] = call_function[target=torch.clamp](args = (%add_103, 0, 511), kwargs = {})
    %expand_18 : [#users=1] = call_method[target=expand](args = (%clamp_18, [1, 12, 256, 256]), kwargs = {})
    %gather_18 : [#users=2] = call_function[target=torch.gather](args = (%matmul_37,), kwargs = {dim: -1, index: %expand_18})
    %full_like_9 : [#users=1] = call_function[target=torch.full_like](args = (%gather_18, 0), kwargs = {})
    %iadd_18 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_9, %gather_18), kwargs = {})
    %pos_q_proj_9 : [#users=1] = call_module[target=encoder.layer.9.attention.self.pos_q_proj](args = (%unsqueeze_24,), kwargs = {})
    %view_59 : [#users=1] = call_method[target=view](args = (%pos_q_proj_9, [1, 512, 12, -1]), kwargs = {})
    %permute_58 : [#users=1] = call_method[target=permute](args = (%view_59, 0, 2, 1, 3), kwargs = {})
    %tensor_351 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_40 : [#users=1] = call_function[target=operator.mul](args = (%tensor_351, 3), kwargs = {})
    %sqrt_38 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_40,), kwargs = {})
    %itruediv_9 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_58, %sqrt_38), kwargs = {})
    %neg_9 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_23,), kwargs = {})
    %add_104 : [#users=1] = call_function[target=operator.add](args = (%neg_9, 256), kwargs = {})
    %clamp_19 : [#users=1] = call_function[target=torch.clamp](args = (%add_104, 0, 511), kwargs = {})
    %transpose_38 : [#users=2] = call_method[target=transpose](args = (%itruediv_9, -1, -2), kwargs = {})
    %to_58 : [#users=0] = call_method[target=to](args = (%transpose_38,), kwargs = {dtype: torch.float32})
    %matmul_38 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_58, %transpose_38), kwargs = {})
    %expand_19 : [#users=1] = call_method[target=expand](args = (%clamp_19, [1, 12, 256, 256]), kwargs = {})
    %gather_19 : [#users=1] = call_function[target=torch.gather](args = (%matmul_38,), kwargs = {dim: -1, index: %expand_19})
    %transpose_39 : [#users=1] = call_method[target=transpose](args = (%gather_19, -1, -2), kwargs = {})
    %iadd_19 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_18, %transpose_39), kwargs = {})
    %add_105 : [#users=1] = call_function[target=operator.add](args = (%matmul_36, %iadd_19), kwargs = {})
    %to_59 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_9 : [#users=2] = call_function[target=operator.invert](args = (%to_59,), kwargs = {})
    %tensor_363 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_9 : [#users=1] = call_method[target=masked_fill](args = (%add_105, %invert_9, %tensor_363), kwargs = {})
    %softmax_9 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_9, -1), kwargs = {})
    %masked_fill__9 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_9, %invert_9, 0), kwargs = {})
    %matmul_39 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_9, %add_102), kwargs = {})
    %permute_59 : [#users=1] = call_method[target=permute](args = (%matmul_39, 0, 2, 1, 3), kwargs = {})
    %contiguous_9 : [#users=1] = call_method[target=contiguous](args = (%permute_59,), kwargs = {})
    %view_60 : [#users=1] = call_method[target=view](args = (%contiguous_9, [1, 256, -1]), kwargs = {})
    %dense_27 : [#users=1] = call_module[target=encoder.layer.9.attention.output.dense](args = (%view_60,), kwargs = {})
    %add_106 : [#users=4] = call_function[target=operator.add](args = (%dense_27, %add_100), kwargs = {})
    %float_20 : [#users=0] = call_method[target=float](args = (%add_106,), kwargs = {})
    %mean_38 : [#users=2] = call_method[target=mean](args = (%add_106, -1), kwargs = {keepdim: True})
    %sub_39 : [#users=1] = call_function[target=operator.sub](args = (%add_106, %mean_38), kwargs = {})
    %pow_20 : [#users=1] = call_method[target=pow](args = (%sub_39, 2), kwargs = {})
    %mean_39 : [#users=1] = call_method[target=mean](args = (%pow_20, -1), kwargs = {keepdim: True})
    %sub_40 : [#users=1] = call_function[target=operator.sub](args = (%add_106, %mean_38), kwargs = {})
    %add_107 : [#users=1] = call_function[target=operator.add](args = (%mean_39, 1e-07), kwargs = {})
    %sqrt_39 : [#users=1] = call_function[target=torch.sqrt](args = (%add_107,), kwargs = {})
    %truediv_29 : [#users=2] = call_function[target=operator.truediv](args = (%sub_40, %sqrt_39), kwargs = {})
    %to_60 : [#users=0] = call_method[target=to](args = (%truediv_29, torch.float32), kwargs = {})
    %weight_19 : [#users=1] = get_attr[target=encoder.layer.9.attention.output.LayerNorm.weight]
    %mul_41 : [#users=1] = call_function[target=operator.mul](args = (%weight_19, %truediv_29), kwargs = {})
    %bias_19 : [#users=1] = get_attr[target=encoder.layer.9.attention.output.LayerNorm.bias]
    %add_108 : [#users=2] = call_function[target=operator.add](args = (%mul_41, %bias_19), kwargs = {})
    %dense_28 : [#users=1] = call_module[target=encoder.layer.9.intermediate.dense](args = (%add_108,), kwargs = {})
    %gelu_9 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_28,), kwargs = {})
    %dense_29 : [#users=1] = call_module[target=encoder.layer.9.output.dense](args = (%gelu_9,), kwargs = {})
    %add_109 : [#users=4] = call_function[target=operator.add](args = (%dense_29, %add_108), kwargs = {})
    %float_21 : [#users=0] = call_method[target=float](args = (%add_109,), kwargs = {})
    %mean_40 : [#users=2] = call_method[target=mean](args = (%add_109, -1), kwargs = {keepdim: True})
    %sub_41 : [#users=1] = call_function[target=operator.sub](args = (%add_109, %mean_40), kwargs = {})
    %pow_21 : [#users=1] = call_method[target=pow](args = (%sub_41, 2), kwargs = {})
    %mean_41 : [#users=1] = call_method[target=mean](args = (%pow_21, -1), kwargs = {keepdim: True})
    %sub_42 : [#users=1] = call_function[target=operator.sub](args = (%add_109, %mean_40), kwargs = {})
    %add_110 : [#users=1] = call_function[target=operator.add](args = (%mean_41, 1e-07), kwargs = {})
    %sqrt_40 : [#users=1] = call_function[target=torch.sqrt](args = (%add_110,), kwargs = {})
    %truediv_30 : [#users=2] = call_function[target=operator.truediv](args = (%sub_42, %sqrt_40), kwargs = {})
    %to_61 : [#users=0] = call_method[target=to](args = (%truediv_30, torch.float32), kwargs = {})
    %weight_20 : [#users=1] = get_attr[target=encoder.layer.9.output.LayerNorm.weight]
    %mul_42 : [#users=1] = call_function[target=operator.mul](args = (%weight_20, %truediv_30), kwargs = {})
    %bias_20 : [#users=1] = get_attr[target=encoder.layer.9.output.LayerNorm.bias]
    %add_111 : [#users=2] = call_function[target=operator.add](args = (%mul_42, %bias_20), kwargs = {})
    %in_proj_10 : [#users=1] = call_module[target=encoder.layer.10.attention.self.in_proj](args = (%add_111,), kwargs = {})
    %view_61 : [#users=1] = call_method[target=view](args = (%in_proj_10, [1, 256, 12, -1]), kwargs = {})
    %permute_60 : [#users=1] = call_method[target=permute](args = (%view_61, 0, 2, 1, 3), kwargs = {})
    %chunk_10 : [#users=3] = call_method[target=chunk](args = (%permute_60, 3), kwargs = {dim: -1})
    %getitem_63 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_10, 0), kwargs = {})
    %getitem_64 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_10, 1), kwargs = {})
    %getitem_65 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_10, 2), kwargs = {})
    %q_bias_10 : [#users=1] = get_attr[target=encoder.layer.10.attention.self.q_bias]
    %getitem_66 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_10, [None, None, slice(None, None, None)]), kwargs = {})
    %view_62 : [#users=1] = call_method[target=view](args = (%getitem_66, [1, 1, 12, -1]), kwargs = {})
    %permute_61 : [#users=1] = call_method[target=permute](args = (%view_62, 0, 2, 1, 3), kwargs = {})
    %add_112 : [#users=1] = call_function[target=operator.add](args = (%getitem_63, %permute_61), kwargs = {})
    %v_bias_10 : [#users=1] = get_attr[target=encoder.layer.10.attention.self.v_bias]
    %getitem_67 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_10, [None, None, slice(None, None, None)]), kwargs = {})
    %view_63 : [#users=1] = call_method[target=view](args = (%getitem_67, [1, 1, 12, -1]), kwargs = {})
    %permute_62 : [#users=1] = call_method[target=permute](args = (%view_63, 0, 2, 1, 3), kwargs = {})
    %add_113 : [#users=1] = call_function[target=operator.add](args = (%getitem_65, %permute_62), kwargs = {})
    %tensor_364 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_43 : [#users=1] = call_function[target=operator.mul](args = (%tensor_364, 3), kwargs = {})
    %sqrt_41 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_43,), kwargs = {})
    %to_62 : [#users=0] = call_method[target=to](args = (%sqrt_41,), kwargs = {dtype: torch.float32})
    %truediv_31 : [#users=2] = call_function[target=operator.truediv](args = (%add_112, %sqrt_41), kwargs = {})
    %transpose_40 : [#users=1] = call_method[target=transpose](args = (%getitem_64, -1, -2), kwargs = {})
    %matmul_40 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_31, %transpose_40), kwargs = {})
    %unsqueeze_25 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_10 : [#users=0] = call_method[target=long](args = (%unsqueeze_25,), kwargs = {})
    %to_63 : [#users=0] = call_method[target=to](args = (%unsqueeze_25, cpu), kwargs = {})
    %__external_param__16 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_68 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__16, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_26 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_68, 0), kwargs = {})
    %pos_proj_10 : [#users=1] = call_module[target=encoder.layer.10.attention.self.pos_proj](args = (%unsqueeze_26,), kwargs = {})
    %view_64 : [#users=1] = call_method[target=view](args = (%pos_proj_10, [1, 512, 12, -1]), kwargs = {})
    %permute_63 : [#users=1] = call_method[target=permute](args = (%view_64, 0, 2, 1, 3), kwargs = {})
    %transpose_41 : [#users=1] = call_method[target=transpose](args = (%permute_63, -1, -2), kwargs = {})
    %matmul_41 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_31, %transpose_41), kwargs = {})
    %add_114 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_25, 256), kwargs = {})
    %clamp_20 : [#users=1] = call_function[target=torch.clamp](args = (%add_114, 0, 511), kwargs = {})
    %expand_20 : [#users=1] = call_method[target=expand](args = (%clamp_20, [1, 12, 256, 256]), kwargs = {})
    %gather_20 : [#users=2] = call_function[target=torch.gather](args = (%matmul_41,), kwargs = {dim: -1, index: %expand_20})
    %full_like_10 : [#users=1] = call_function[target=torch.full_like](args = (%gather_20, 0), kwargs = {})
    %iadd_20 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_10, %gather_20), kwargs = {})
    %pos_q_proj_10 : [#users=1] = call_module[target=encoder.layer.10.attention.self.pos_q_proj](args = (%unsqueeze_26,), kwargs = {})
    %view_65 : [#users=1] = call_method[target=view](args = (%pos_q_proj_10, [1, 512, 12, -1]), kwargs = {})
    %permute_64 : [#users=1] = call_method[target=permute](args = (%view_65, 0, 2, 1, 3), kwargs = {})
    %tensor_387 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_44 : [#users=1] = call_function[target=operator.mul](args = (%tensor_387, 3), kwargs = {})
    %sqrt_42 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_44,), kwargs = {})
    %itruediv_10 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_64, %sqrt_42), kwargs = {})
    %neg_10 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_25,), kwargs = {})
    %add_115 : [#users=1] = call_function[target=operator.add](args = (%neg_10, 256), kwargs = {})
    %clamp_21 : [#users=1] = call_function[target=torch.clamp](args = (%add_115, 0, 511), kwargs = {})
    %transpose_42 : [#users=2] = call_method[target=transpose](args = (%itruediv_10, -1, -2), kwargs = {})
    %to_64 : [#users=0] = call_method[target=to](args = (%transpose_42,), kwargs = {dtype: torch.float32})
    %matmul_42 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_64, %transpose_42), kwargs = {})
    %expand_21 : [#users=1] = call_method[target=expand](args = (%clamp_21, [1, 12, 256, 256]), kwargs = {})
    %gather_21 : [#users=1] = call_function[target=torch.gather](args = (%matmul_42,), kwargs = {dim: -1, index: %expand_21})
    %transpose_43 : [#users=1] = call_method[target=transpose](args = (%gather_21, -1, -2), kwargs = {})
    %iadd_21 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_20, %transpose_43), kwargs = {})
    %add_116 : [#users=1] = call_function[target=operator.add](args = (%matmul_40, %iadd_21), kwargs = {})
    %to_65 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_10 : [#users=2] = call_function[target=operator.invert](args = (%to_65,), kwargs = {})
    %tensor_399 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_10 : [#users=1] = call_method[target=masked_fill](args = (%add_116, %invert_10, %tensor_399), kwargs = {})
    %softmax_10 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_10, -1), kwargs = {})
    %masked_fill__10 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_10, %invert_10, 0), kwargs = {})
    %matmul_43 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_10, %add_113), kwargs = {})
    %permute_65 : [#users=1] = call_method[target=permute](args = (%matmul_43, 0, 2, 1, 3), kwargs = {})
    %contiguous_10 : [#users=1] = call_method[target=contiguous](args = (%permute_65,), kwargs = {})
    %view_66 : [#users=1] = call_method[target=view](args = (%contiguous_10, [1, 256, -1]), kwargs = {})
    %dense_30 : [#users=1] = call_module[target=encoder.layer.10.attention.output.dense](args = (%view_66,), kwargs = {})
    %add_117 : [#users=4] = call_function[target=operator.add](args = (%dense_30, %add_111), kwargs = {})
    %float_22 : [#users=0] = call_method[target=float](args = (%add_117,), kwargs = {})
    %mean_42 : [#users=2] = call_method[target=mean](args = (%add_117, -1), kwargs = {keepdim: True})
    %sub_43 : [#users=1] = call_function[target=operator.sub](args = (%add_117, %mean_42), kwargs = {})
    %pow_22 : [#users=1] = call_method[target=pow](args = (%sub_43, 2), kwargs = {})
    %mean_43 : [#users=1] = call_method[target=mean](args = (%pow_22, -1), kwargs = {keepdim: True})
    %sub_44 : [#users=1] = call_function[target=operator.sub](args = (%add_117, %mean_42), kwargs = {})
    %add_118 : [#users=1] = call_function[target=operator.add](args = (%mean_43, 1e-07), kwargs = {})
    %sqrt_43 : [#users=1] = call_function[target=torch.sqrt](args = (%add_118,), kwargs = {})
    %truediv_32 : [#users=2] = call_function[target=operator.truediv](args = (%sub_44, %sqrt_43), kwargs = {})
    %to_66 : [#users=0] = call_method[target=to](args = (%truediv_32, torch.float32), kwargs = {})
    %weight_21 : [#users=1] = get_attr[target=encoder.layer.10.attention.output.LayerNorm.weight]
    %mul_45 : [#users=1] = call_function[target=operator.mul](args = (%weight_21, %truediv_32), kwargs = {})
    %bias_21 : [#users=1] = get_attr[target=encoder.layer.10.attention.output.LayerNorm.bias]
    %add_119 : [#users=2] = call_function[target=operator.add](args = (%mul_45, %bias_21), kwargs = {})
    %dense_31 : [#users=1] = call_module[target=encoder.layer.10.intermediate.dense](args = (%add_119,), kwargs = {})
    %gelu_10 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_31,), kwargs = {})
    %dense_32 : [#users=1] = call_module[target=encoder.layer.10.output.dense](args = (%gelu_10,), kwargs = {})
    %add_120 : [#users=4] = call_function[target=operator.add](args = (%dense_32, %add_119), kwargs = {})
    %float_23 : [#users=0] = call_method[target=float](args = (%add_120,), kwargs = {})
    %mean_44 : [#users=2] = call_method[target=mean](args = (%add_120, -1), kwargs = {keepdim: True})
    %sub_45 : [#users=1] = call_function[target=operator.sub](args = (%add_120, %mean_44), kwargs = {})
    %pow_23 : [#users=1] = call_method[target=pow](args = (%sub_45, 2), kwargs = {})
    %mean_45 : [#users=1] = call_method[target=mean](args = (%pow_23, -1), kwargs = {keepdim: True})
    %sub_46 : [#users=1] = call_function[target=operator.sub](args = (%add_120, %mean_44), kwargs = {})
    %add_121 : [#users=1] = call_function[target=operator.add](args = (%mean_45, 1e-07), kwargs = {})
    %sqrt_44 : [#users=1] = call_function[target=torch.sqrt](args = (%add_121,), kwargs = {})
    %truediv_33 : [#users=2] = call_function[target=operator.truediv](args = (%sub_46, %sqrt_44), kwargs = {})
    %to_67 : [#users=0] = call_method[target=to](args = (%truediv_33, torch.float32), kwargs = {})
    %weight_22 : [#users=1] = get_attr[target=encoder.layer.10.output.LayerNorm.weight]
    %mul_46 : [#users=1] = call_function[target=operator.mul](args = (%weight_22, %truediv_33), kwargs = {})
    %bias_22 : [#users=1] = get_attr[target=encoder.layer.10.output.LayerNorm.bias]
    %add_122 : [#users=2] = call_function[target=operator.add](args = (%mul_46, %bias_22), kwargs = {})
    %in_proj_11 : [#users=1] = call_module[target=encoder.layer.11.attention.self.in_proj](args = (%add_122,), kwargs = {})
    %view_67 : [#users=1] = call_method[target=view](args = (%in_proj_11, [1, 256, 12, -1]), kwargs = {})
    %permute_66 : [#users=1] = call_method[target=permute](args = (%view_67, 0, 2, 1, 3), kwargs = {})
    %chunk_11 : [#users=3] = call_method[target=chunk](args = (%permute_66, 3), kwargs = {dim: -1})
    %getitem_69 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_11, 0), kwargs = {})
    %getitem_70 : [#users=2] = call_function[target=operator.getitem](args = (%chunk_11, 1), kwargs = {})
    %getitem_71 : [#users=1] = call_function[target=operator.getitem](args = (%chunk_11, 2), kwargs = {})
    %q_bias_11 : [#users=1] = get_attr[target=encoder.layer.11.attention.self.q_bias]
    %getitem_72 : [#users=1] = call_function[target=operator.getitem](args = (%q_bias_11, [None, None, slice(None, None, None)]), kwargs = {})
    %view_68 : [#users=1] = call_method[target=view](args = (%getitem_72, [1, 1, 12, -1]), kwargs = {})
    %permute_67 : [#users=1] = call_method[target=permute](args = (%view_68, 0, 2, 1, 3), kwargs = {})
    %add_123 : [#users=1] = call_function[target=operator.add](args = (%getitem_69, %permute_67), kwargs = {})
    %v_bias_11 : [#users=1] = get_attr[target=encoder.layer.11.attention.self.v_bias]
    %getitem_73 : [#users=1] = call_function[target=operator.getitem](args = (%v_bias_11, [None, None, slice(None, None, None)]), kwargs = {})
    %view_69 : [#users=1] = call_method[target=view](args = (%getitem_73, [1, 1, 12, -1]), kwargs = {})
    %permute_68 : [#users=1] = call_method[target=permute](args = (%view_69, 0, 2, 1, 3), kwargs = {})
    %add_124 : [#users=1] = call_function[target=operator.add](args = (%getitem_71, %permute_68), kwargs = {})
    %tensor_400 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_47 : [#users=1] = call_function[target=operator.mul](args = (%tensor_400, 3), kwargs = {})
    %sqrt_45 : [#users=2] = call_function[target=torch.sqrt](args = (%mul_47,), kwargs = {})
    %to_68 : [#users=0] = call_method[target=to](args = (%sqrt_45,), kwargs = {dtype: torch.float32})
    %truediv_34 : [#users=2] = call_function[target=operator.truediv](args = (%add_123, %sqrt_45), kwargs = {})
    %transpose_44 : [#users=1] = call_method[target=transpose](args = (%getitem_70, -1, -2), kwargs = {})
    %matmul_44 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_34, %transpose_44), kwargs = {})
    %unsqueeze_27 : [#users=4] = call_method[target=unsqueeze](args = (%unsqueeze_4, 1), kwargs = {})
    %long_11 : [#users=0] = call_method[target=long](args = (%unsqueeze_27,), kwargs = {})
    %to_69 : [#users=0] = call_method[target=to](args = (%unsqueeze_27, cpu), kwargs = {})
    %__external_param__17 : [#users=1] = get_attr[target=encoder.layer.0.attention.self.__external_param__6]
    %getitem_74 : [#users=1] = call_function[target=operator.getitem](args = (%__external_param__17, [slice(256, 768, None), slice(None, None, None)]), kwargs = {})
    %unsqueeze_28 : [#users=2] = call_method[target=unsqueeze](args = (%getitem_74, 0), kwargs = {})
    %pos_proj_11 : [#users=1] = call_module[target=encoder.layer.11.attention.self.pos_proj](args = (%unsqueeze_28,), kwargs = {})
    %view_70 : [#users=1] = call_method[target=view](args = (%pos_proj_11, [1, 512, 12, -1]), kwargs = {})
    %permute_69 : [#users=1] = call_method[target=permute](args = (%view_70, 0, 2, 1, 3), kwargs = {})
    %transpose_45 : [#users=1] = call_method[target=transpose](args = (%permute_69, -1, -2), kwargs = {})
    %matmul_45 : [#users=1] = call_function[target=torch.matmul](args = (%truediv_34, %transpose_45), kwargs = {})
    %add_125 : [#users=1] = call_function[target=operator.add](args = (%unsqueeze_27, 256), kwargs = {})
    %clamp_22 : [#users=1] = call_function[target=torch.clamp](args = (%add_125, 0, 511), kwargs = {})
    %expand_22 : [#users=1] = call_method[target=expand](args = (%clamp_22, [1, 12, 256, 256]), kwargs = {})
    %gather_22 : [#users=2] = call_function[target=torch.gather](args = (%matmul_45,), kwargs = {dim: -1, index: %expand_22})
    %full_like_11 : [#users=1] = call_function[target=torch.full_like](args = (%gather_22, 0), kwargs = {})
    %iadd_22 : [#users=1] = call_function[target=operator.iadd](args = (%full_like_11, %gather_22), kwargs = {})
    %pos_q_proj_11 : [#users=1] = call_module[target=encoder.layer.11.attention.self.pos_q_proj](args = (%unsqueeze_28,), kwargs = {})
    %view_71 : [#users=1] = call_method[target=view](args = (%pos_q_proj_11, [1, 512, 12, -1]), kwargs = {})
    %permute_70 : [#users=1] = call_method[target=permute](args = (%view_71, 0, 2, 1, 3), kwargs = {})
    %tensor_423 : [#users=1] = call_function[target=torch.tensor](args = (64,), kwargs = {dtype: torch.float32})
    %mul_48 : [#users=1] = call_function[target=operator.mul](args = (%tensor_423, 3), kwargs = {})
    %sqrt_46 : [#users=1] = call_function[target=torch.sqrt](args = (%mul_48,), kwargs = {})
    %itruediv_11 : [#users=1] = call_function[target=operator.itruediv](args = (%permute_70, %sqrt_46), kwargs = {})
    %neg_11 : [#users=1] = call_function[target=operator.neg](args = (%unsqueeze_27,), kwargs = {})
    %add_126 : [#users=1] = call_function[target=operator.add](args = (%neg_11, 256), kwargs = {})
    %clamp_23 : [#users=1] = call_function[target=torch.clamp](args = (%add_126, 0, 511), kwargs = {})
    %transpose_46 : [#users=2] = call_method[target=transpose](args = (%itruediv_11, -1, -2), kwargs = {})
    %to_70 : [#users=0] = call_method[target=to](args = (%transpose_46,), kwargs = {dtype: torch.float32})
    %matmul_46 : [#users=1] = call_function[target=torch.matmul](args = (%getitem_70, %transpose_46), kwargs = {})
    %expand_23 : [#users=1] = call_method[target=expand](args = (%clamp_23, [1, 12, 256, 256]), kwargs = {})
    %gather_23 : [#users=1] = call_function[target=torch.gather](args = (%matmul_46,), kwargs = {dim: -1, index: %expand_23})
    %transpose_47 : [#users=1] = call_method[target=transpose](args = (%gather_23, -1, -2), kwargs = {})
    %iadd_23 : [#users=1] = call_function[target=operator.iadd](args = (%iadd_22, %transpose_47), kwargs = {})
    %add_127 : [#users=1] = call_function[target=operator.add](args = (%matmul_44, %iadd_23), kwargs = {})
    %to_71 : [#users=1] = call_method[target=to](args = (%byte, torch.bool), kwargs = {})
    %invert_11 : [#users=2] = call_function[target=operator.invert](args = (%to_71,), kwargs = {})
    %tensor_435 : [#users=1] = call_function[target=torch.tensor](args = (-3.4028234663852886e+38,), kwargs = {})
    %masked_fill_11 : [#users=1] = call_method[target=masked_fill](args = (%add_127, %invert_11, %tensor_435), kwargs = {})
    %softmax_11 : [#users=2] = call_function[target=torch.softmax](args = (%masked_fill_11, -1), kwargs = {})
    %masked_fill__11 : [#users=0] = call_method[target=masked_fill_](args = (%softmax_11, %invert_11, 0), kwargs = {})
    %matmul_47 : [#users=1] = call_function[target=torch.matmul](args = (%softmax_11, %add_124), kwargs = {})
    %permute_71 : [#users=1] = call_method[target=permute](args = (%matmul_47, 0, 2, 1, 3), kwargs = {})
    %contiguous_11 : [#users=1] = call_method[target=contiguous](args = (%permute_71,), kwargs = {})
    %view_72 : [#users=1] = call_method[target=view](args = (%contiguous_11, [1, 256, -1]), kwargs = {})
    %dense_33 : [#users=1] = call_module[target=encoder.layer.11.attention.output.dense](args = (%view_72,), kwargs = {})
    %add_128 : [#users=4] = call_function[target=operator.add](args = (%dense_33, %add_122), kwargs = {})
    %float_24 : [#users=0] = call_method[target=float](args = (%add_128,), kwargs = {})
    %mean_46 : [#users=2] = call_method[target=mean](args = (%add_128, -1), kwargs = {keepdim: True})
    %sub_47 : [#users=1] = call_function[target=operator.sub](args = (%add_128, %mean_46), kwargs = {})
    %pow_24 : [#users=1] = call_method[target=pow](args = (%sub_47, 2), kwargs = {})
    %mean_47 : [#users=1] = call_method[target=mean](args = (%pow_24, -1), kwargs = {keepdim: True})
    %sub_48 : [#users=1] = call_function[target=operator.sub](args = (%add_128, %mean_46), kwargs = {})
    %add_129 : [#users=1] = call_function[target=operator.add](args = (%mean_47, 1e-07), kwargs = {})
    %sqrt_47 : [#users=1] = call_function[target=torch.sqrt](args = (%add_129,), kwargs = {})
    %truediv_35 : [#users=2] = call_function[target=operator.truediv](args = (%sub_48, %sqrt_47), kwargs = {})
    %to_72 : [#users=0] = call_method[target=to](args = (%truediv_35, torch.float32), kwargs = {})
    %weight_23 : [#users=1] = get_attr[target=encoder.layer.11.attention.output.LayerNorm.weight]
    %mul_49 : [#users=1] = call_function[target=operator.mul](args = (%weight_23, %truediv_35), kwargs = {})
    %bias_23 : [#users=1] = get_attr[target=encoder.layer.11.attention.output.LayerNorm.bias]
    %add_130 : [#users=2] = call_function[target=operator.add](args = (%mul_49, %bias_23), kwargs = {})
    %dense_34 : [#users=1] = call_module[target=encoder.layer.11.intermediate.dense](args = (%add_130,), kwargs = {})
    %gelu_11 : [#users=1] = call_function[target=torch._C._nn.gelu](args = (%dense_34,), kwargs = {})
    %dense_35 : [#users=1] = call_module[target=encoder.layer.11.output.dense](args = (%gelu_11,), kwargs = {})
    %add_131 : [#users=4] = call_function[target=operator.add](args = (%dense_35, %add_130), kwargs = {})
    %float_25 : [#users=0] = call_method[target=float](args = (%add_131,), kwargs = {})
    %mean_48 : [#users=2] = call_method[target=mean](args = (%add_131, -1), kwargs = {keepdim: True})
    %sub_49 : [#users=1] = call_function[target=operator.sub](args = (%add_131, %mean_48), kwargs = {})
    %pow_25 : [#users=1] = call_method[target=pow](args = (%sub_49, 2), kwargs = {})
    %mean_49 : [#users=1] = call_method[target=mean](args = (%pow_25, -1), kwargs = {keepdim: True})
    %sub_50 : [#users=1] = call_function[target=operator.sub](args = (%add_131, %mean_48), kwargs = {})
    %add_132 : [#users=1] = call_function[target=operator.add](args = (%mean_49, 1e-07), kwargs = {})
    %sqrt_48 : [#users=1] = call_function[target=torch.sqrt](args = (%add_132,), kwargs = {})
    %truediv_36 : [#users=2] = call_function[target=operator.truediv](args = (%sub_50, %sqrt_48), kwargs = {})
    %to_73 : [#users=0] = call_method[target=to](args = (%truediv_36, torch.float32), kwargs = {})
    %weight_24 : [#users=1] = get_attr[target=encoder.layer.11.output.LayerNorm.weight]
    %mul_50 : [#users=1] = call_function[target=operator.mul](args = (%weight_24, %truediv_36), kwargs = {})
    %bias_24 : [#users=1] = get_attr[target=encoder.layer.11.output.LayerNorm.bias]
    %add_133 : [#users=1] = call_function[target=operator.add](args = (%mul_50, %bias_24), kwargs = {})
    return (add_133,)
RUNNING PY CODE
def ___make_graph_fn(compiled_graph):
    def fn(locals):
        print('running graph_fn (key = 5840)', locals.keys())
        graph_out = compiled_graph(locals['input_ids'].contiguous(), locals['attention_mask'].contiguous(), locals['token_type_ids'].contiguous(), locals['self'].embeddings.position_ids.contiguous())
        __stack__0_0 = graph_out[0]
        __stack__0 = (__stack__0_0,)
        return __stack__0
    return fn
def ___make_guard_fn(var_450, var_451, var_452, var_453):
    def fn(locals):
        try:
            print('running guard_fn (key = 5840)', locals.keys())
            ok = (var_451.tensor_guard_check(locals['attention_mask'])) and (locals['output_attentions'] is None) and (locals['position_ids'] is None) and (id(locals['self'].encoder) == 23346416248480) and (locals['return_dict'] is None) and (locals['self'].config.output_attentions == False) and (isinstance(locals['self'].config.output_attentions, bool)) and (var_453.tensor_guard_check(locals['self'].embeddings.position_ids)) and (isinstance(locals['self'].config.use_return_dict, bool)) and (var_452.tensor_guard_check(locals['token_type_ids'])) and (id(locals['self'].embeddings) == 23346416248288) and (locals['self'].config.use_return_dict == False) and (isinstance(locals['self'].config.output_hidden_states, bool)) and (locals['self'].z_steps == 0) and (locals['input_ids'].device == torch.device('cpu')) and (isinstance(locals['self'].z_steps, int)) and (id(locals['self']) == 23346416248240) and (locals['self'].config.output_hidden_states == False) and (locals['output_hidden_states'] is None) and (locals['inputs_embeds'] is None) and (var_450.tensor_guard_check(locals['input_ids']))
            print('ok = ', ok)
        except Exception as e:
            print('exception in guard_fn:', e, type(e))
            import traceback
            print(traceback.format_exc())
            return False
        return ok
    return fn
                
guard_fn: <function ___make_guard_fn.<locals>.fn at 0x153a4c077670>
pc: 0 215
stack: 0 1
tracing opcode LOAD_GLOBAL None pc=496 frame=0(0x7dd9b30)
restart: running injected code (f_lasti=496)
tracing opcode LOAD_CONST None pc=498 frame=0(0x7dd9b30)
restart: running injected code (f_lasti=498)
tracing opcode CALL_FUNCTION None pc=500 frame=0(0x7dd9b30)
restart: running injected code (f_lasti=500)
disable_trace
before pop_tracker [0] frame_id 0
postprocess frame /home/drc/frontend/test/test_model_deberta.py
new bytecode: 

0: [33mLOAD_FAST[0m(6, output_attentions) 
1: [33mLOAD_CONST[0m(0, None) 
2: [33mIS_OP[0m(1, 1) 
3: [33mPOP_JUMP_IF_FALSE[0m(12, 12)  -> inst 6
4: [33mLOAD_FAST[0m(6, output_attentions) 
5: [33mJUMP_FORWARD[0m(6, 18)  -> inst 9
6: [33mLOAD_DEREF[0m(0, self) 
7: [33mLOAD_ATTR[0m(0, config) 
8: [33mLOAD_ATTR[0m(1, output_attentions) 
9: [33mSTORE_FAST[0m(6, output_attentions) 
10: [33mLOAD_FAST[0m(7, output_hidden_states) 
11: [33mLOAD_CONST[0m(0, None) 
12: [33mIS_OP[0m(1, 1) 
13: [33mPOP_JUMP_IF_FALSE[0m(32, 32)  -> inst 16
14: [33mLOAD_FAST[0m(7, output_hidden_states) 
15: [33mJUMP_FORWARD[0m(6, 38)  -> inst 19
16: [33mLOAD_DEREF[0m(0, self) 
17: [33mLOAD_ATTR[0m(0, config) 
18: [33mLOAD_ATTR[0m(2, output_hidden_states) 
19: [33mSTORE_FAST[0m(7, output_hidden_states) 
20: [33mLOAD_FAST[0m(8, return_dict) 
21: [33mLOAD_CONST[0m(0, None) 
22: [33mIS_OP[0m(1, 1) 
23: [33mPOP_JUMP_IF_FALSE[0m(52, 52)  -> inst 26
24: [33mLOAD_FAST[0m(8, return_dict) 
25: [33mJUMP_FORWARD[0m(6, 58)  -> inst 29
26: [33mLOAD_DEREF[0m(0, self) 
27: [33mLOAD_ATTR[0m(0, config) 
28: [33mLOAD_ATTR[0m(3, use_return_dict) 
29: [33mSTORE_FAST[0m(8, return_dict) 
30: [33mLOAD_FAST[0m(1, input_ids) 
31: [33mLOAD_CONST[0m(0, None) 
32: [33mIS_OP[0m(1, 1) 
33: [33mPOP_JUMP_IF_FALSE[0m(86, 86)  -> inst 43
34: [33mLOAD_FAST[0m(5, inputs_embeds) 
35: [33mLOAD_CONST[0m(0, None) 
36: [33mIS_OP[0m(1, 1) 
37: [33mPOP_JUMP_IF_FALSE[0m(86, 86)  -> inst 43
38: [33mLOAD_GLOBAL[0m(4, ValueError) 
39: [33mLOAD_CONST[0m(1, You cannot specify both input_ids and inputs_embeds at the same time) 
40: [33mCALL_FUNCTION[0m(1, 1) 
41: [33mRAISE_VARARGS[0m(1, 1) 
42: [33mJUMP_FORWARD[0m(52, 138)  -> inst 69
43: [33mLOAD_FAST[0m(1, input_ids) 
44: [33mLOAD_CONST[0m(0, None) 
45: [33mIS_OP[0m(1, 1) 
46: [33mPOP_JUMP_IF_FALSE[0m(104, 104)  -> inst 52
47: [33mLOAD_FAST[0m(1, input_ids) 
48: [33mLOAD_METHOD[0m(5, size) 
49: [33mCALL_METHOD[0m(0, 0) 
50: [33mSTORE_FAST[0m(9, input_shape) 
51: [33mJUMP_FORWARD[0m(34, 138)  -> inst 69
52: [33mLOAD_FAST[0m(5, inputs_embeds) 
53: [33mLOAD_CONST[0m(0, None) 
54: [33mIS_OP[0m(1, 1) 
55: [33mPOP_JUMP_IF_FALSE[0m(130, 130)  -> inst 65
56: [33mLOAD_FAST[0m(5, inputs_embeds) 
57: [33mLOAD_METHOD[0m(5, size) 
58: [33mCALL_METHOD[0m(0, 0) 
59: [33mLOAD_CONST[0m(0, None) 
60: [33mLOAD_CONST[0m(2, -1) 
61: [33mBUILD_SLICE[0m(2, 2) 
62: [33mBINARY_SUBSCR[0m(None, None) 
63: [33mSTORE_FAST[0m(9, input_shape) 
64: [33mJUMP_FORWARD[0m(8, 138)  -> inst 69
65: [33mLOAD_GLOBAL[0m(4, ValueError) 
66: [33mLOAD_CONST[0m(3, You have to specify either input_ids or inputs_embeds) 
67: [33mCALL_FUNCTION[0m(1, 1) 
68: [33mRAISE_VARARGS[0m(1, 1) 
69: [33mLOAD_FAST[0m(1, input_ids) 
70: [33mLOAD_CONST[0m(0, None) 
71: [33mIS_OP[0m(1, 1) 
72: [33mPOP_JUMP_IF_FALSE[0m(152, 152)  -> inst 76
73: [33mLOAD_FAST[0m(1, input_ids) 
74: [33mLOAD_ATTR[0m(6, device) 
75: [33mJUMP_FORWARD[0m(4, 156)  -> inst 78
76: [33mLOAD_FAST[0m(5, inputs_embeds) 
77: [33mLOAD_ATTR[0m(6, device) 
78: [33mSTORE_FAST[0m(10, device) 
79: [33mLOAD_FAST[0m(2, attention_mask) 
80: [33mLOAD_CONST[0m(0, None) 
81: [33mIS_OP[0m(0, 0) 
82: [33mPOP_JUMP_IF_FALSE[0m(180, 180)  -> inst 90
83: [33mLOAD_GLOBAL[0m(7, torch) 
84: [33mLOAD_ATTR[0m(8, ones) 
85: [33mLOAD_FAST[0m(9, input_shape) 
86: [33mLOAD_FAST[0m(10, device) 
87: [33mLOAD_CONST[0m(4, ('device',)) 
88: [33mCALL_FUNCTION_KW[0m(2, 2) 
89: [33mSTORE_FAST[0m(2, attention_mask) 
90: [33mLOAD_FAST[0m(3, token_type_ids) 
91: [33mLOAD_CONST[0m(0, None) 
92: [33mIS_OP[0m(0, 0) 
93: [33mPOP_JUMP_IF_FALSE[0m(206, 206)  -> inst 103
94: [33mLOAD_GLOBAL[0m(7, torch) 
95: [33mLOAD_ATTR[0m(9, zeros) 
96: [33mLOAD_FAST[0m(9, input_shape) 
97: [33mLOAD_GLOBAL[0m(7, torch) 
98: [33mLOAD_ATTR[0m(10, long) 
99: [33mLOAD_FAST[0m(10, device) 
100: [33mLOAD_CONST[0m(5, ('dtype', 'device')) 
101: [33mCALL_FUNCTION_KW[0m(3, 3) 
102: [33mSTORE_FAST[0m(3, token_type_ids) 
103: [33mLOAD_DEREF[0m(0, self) 
104: [33mLOAD_ATTR[0m(11, embeddings) 
105: [33mLOAD_FAST[0m(1, input_ids) 
106: [33mLOAD_FAST[0m(3, token_type_ids) 
107: [33mLOAD_FAST[0m(4, position_ids) 
108: [33mLOAD_FAST[0m(2, attention_mask) 
109: [33mLOAD_FAST[0m(5, inputs_embeds) 
110: [33mLOAD_CONST[0m(6, ('input_ids', 'token_type_ids', 'position_ids', 'mask', 'inputs_embeds')) 
111: [33mCALL_FUNCTION_KW[0m(5, 5) 
112: [33mSTORE_FAST[0m(11, embedding_output) 
113: [33mLOAD_DEREF[0m(0, self) 
114: [33mLOAD_ATTR[0m(12, encoder) 
115: [33mLOAD_FAST[0m(11, embedding_output) 
116: [33mLOAD_FAST[0m(2, attention_mask) 
117: [33mLOAD_CONST[0m(7, True) 
118: [33mLOAD_FAST[0m(6, output_attentions) 
119: [33mLOAD_FAST[0m(8, return_dict) 
120: [33mLOAD_CONST[0m(8, ('output_hidden_states', 'output_attentions', 'return_dict')) 
121: [33mCALL_FUNCTION_KW[0m(5, 5) 
122: [33mSTORE_FAST[0m(12, encoder_outputs) 
123: [33mLOAD_FAST[0m(12, encoder_outputs) 
124: [33mLOAD_CONST[0m(9, 1) 
125: [33mBINARY_SUBSCR[0m(None, None) 
126: [33mSTORE_FAST[0m(13, encoded_layers) 
127: [33mLOAD_DEREF[0m(0, self) 
128: [33mLOAD_ATTR[0m(13, z_steps) 
129: [33mLOAD_CONST[0m(9, 1) 
130: [33mCOMPARE_OP[0m(4, >) 
131: [33mEXTENDED_ARG[0m(1, 1) 
132: [33mPOP_JUMP_IF_FALSE[0m(390, 390)  -> inst 195
133: [33mLOAD_FAST[0m(13, encoded_layers) 
134: [33mLOAD_CONST[0m(10, -2) 
135: [33mBINARY_SUBSCR[0m(None, None) 
136: [33mSTORE_FAST[0m(14, hidden_states) 
137: [33mLOAD_CLOSURE[0m(0, self) 
138: [33mBUILD_TUPLE[0m(1, 1) 
139: [33mLOAD_CONST[0m(11, <code object <listcomp> at 0x153c7df4abe0, file "/home/drc/frontend/test/test_model_deberta.py", line 993>) 
140: [33mLOAD_CONST[0m(12, DebertaModel.forward.<locals>.<listcomp>) 
141: [33mMAKE_FUNCTION[0m(8, 8) 
142: [33mLOAD_GLOBAL[0m(14, range) 
143: [33mLOAD_DEREF[0m(0, self) 
144: [33mLOAD_ATTR[0m(13, z_steps) 
145: [33mCALL_FUNCTION[0m(1, 1) 
146: [33mGET_ITER[0m(None, None) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mSTORE_FAST[0m(15, layers) 
149: [33mLOAD_FAST[0m(13, encoded_layers) 
150: [33mLOAD_CONST[0m(2, -1) 
151: [33mBINARY_SUBSCR[0m(None, None) 
152: [33mSTORE_FAST[0m(16, query_states) 
153: [33mLOAD_DEREF[0m(0, self) 
154: [33mLOAD_ATTR[0m(12, encoder) 
155: [33mLOAD_METHOD[0m(15, get_rel_embedding) 
156: [33mCALL_METHOD[0m(0, 0) 
157: [33mSTORE_FAST[0m(17, rel_embeddings) 
158: [33mLOAD_DEREF[0m(0, self) 
159: [33mLOAD_ATTR[0m(12, encoder) 
160: [33mLOAD_METHOD[0m(16, get_attention_mask) 
161: [33mLOAD_FAST[0m(2, attention_mask) 
162: [33mCALL_METHOD[0m(1, 1) 
163: [33mSTORE_FAST[0m(2, attention_mask) 
164: [33mLOAD_DEREF[0m(0, self) 
165: [33mLOAD_ATTR[0m(12, encoder) 
166: [33mLOAD_METHOD[0m(17, get_rel_pos) 
167: [33mLOAD_FAST[0m(11, embedding_output) 
168: [33mCALL_METHOD[0m(1, 1) 
169: [33mSTORE_FAST[0m(18, rel_pos) 
170: [33mLOAD_FAST[0m(15, layers) 
171: [33mLOAD_CONST[0m(9, 1) 
172: [33mLOAD_CONST[0m(0, None) 
173: [33mBUILD_SLICE[0m(2, 2) 
174: [33mBINARY_SUBSCR[0m(None, None) 
175: [33mGET_ITER[0m(None, None) 
176: [33mFOR_ITER[0m(36, 390)  -> inst 195
177: [33mSTORE_FAST[0m(19, layer) 
178: [33mLOAD_FAST[0m(19, layer) 
179: [33mLOAD_FAST[0m(14, hidden_states) 
180: [33mLOAD_FAST[0m(2, attention_mask) 
181: [33mLOAD_CONST[0m(13, False) 
182: [33mLOAD_FAST[0m(16, query_states) 
183: [33mLOAD_FAST[0m(18, rel_pos) 
184: [33mLOAD_FAST[0m(17, rel_embeddings) 
185: [33mLOAD_CONST[0m(14, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
186: [33mCALL_FUNCTION_KW[0m(6, 6) 
187: [33mSTORE_FAST[0m(16, query_states) 
188: [33mLOAD_FAST[0m(13, encoded_layers) 
189: [33mLOAD_METHOD[0m(18, append) 
190: [33mLOAD_FAST[0m(16, query_states) 
191: [33mCALL_METHOD[0m(1, 1) 
192: [33mPOP_TOP[0m(None, None) 
193: [33mEXTENDED_ARG[0m(1, 1) 
194: [33mJUMP_ABSOLUTE[0m(352, 352)  -> inst 176
195: [33mLOAD_FAST[0m(13, encoded_layers) 
196: [33mLOAD_CONST[0m(2, -1) 
197: [33mBINARY_SUBSCR[0m(None, None) 
198: [33mSTORE_FAST[0m(20, sequence_output) 
199: [33mLOAD_FAST[0m(8, return_dict) 
200: [33mEXTENDED_ARG[0m(1, 1) 
201: [33mPOP_JUMP_IF_TRUE[0m(432, 432)  -> inst 216
202: [33mLOAD_FAST[0m(20, sequence_output) 
203: [33mBUILD_TUPLE[0m(1, 1) 
204: [33mLOAD_FAST[0m(12, encoder_outputs) 
205: [33mLOAD_FAST[0m(7, output_hidden_states) 
206: [33mEXTENDED_ARG[0m(1, 1) 
207: [33mPOP_JUMP_IF_FALSE[0m(420, 420)  -> inst 210
208: [33mLOAD_CONST[0m(9, 1) 
209: [33mJUMP_FORWARD[0m(2, 422)  -> inst 211
210: [33mLOAD_CONST[0m(15, 2) 
211: [33mLOAD_CONST[0m(0, None) 
212: [33mBUILD_SLICE[0m(2, 2) 
213: [33mBINARY_SUBSCR[0m(None, None) 
214: [33mBINARY_ADD[0m(None, None) 
215: [33mRETURN_VALUE[0m(None, None) 
216: [33mLOAD_GLOBAL[0m(19, BaseModelOutput) 
217: [33mLOAD_FAST[0m(20, sequence_output) 
218: [33mLOAD_FAST[0m(7, output_hidden_states) 
219: [33mEXTENDED_ARG[0m(1, 1) 
220: [33mPOP_JUMP_IF_FALSE[0m(448, 448)  -> inst 224
221: [33mLOAD_FAST[0m(12, encoder_outputs) 
222: [33mLOAD_ATTR[0m(20, hidden_states) 
223: [33mJUMP_FORWARD[0m(2, 450)  -> inst 225
224: [33mLOAD_CONST[0m(0, None) 
225: [33mLOAD_FAST[0m(12, encoder_outputs) 
226: [33mLOAD_ATTR[0m(21, attentions) 
227: [33mLOAD_CONST[0m(16, ('last_hidden_state', 'hidden_states', 'attentions')) 
228: [33mCALL_FUNCTION_KW[0m(3, 3) 
229: [33mRETURN_VALUE[0m(None, None) 

const_list [(<class 'int'>, 1), (<class 'str'>, 'You have to specify either input_ids or inputs_embeds'), (<class 'int'>, -1), (<class 'tuple'>, ('input_ids', 'token_type_ids', 'position_ids', 'mask', 'inputs_embeds')), (<class 'int'>, -2), (<class 'tuple'>, ('output_hidden_states', 'output_attentions', 'return_dict')), (<class 'str'>, 'DebertaModel.forward.<locals>.<listcomp>'), (<class 'tuple'>, ('last_hidden_state', 'hidden_states', 'attentions')), (<class 'NoneType'>, None), (<class 'tuple'>, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')), (<class 'str'>, 'You cannot specify both input_ids and inputs_embeds at the same time'), (<class 'bool'>, True), (<class 'tuple'>, ('device',)), (<class 'tuple'>, ('dtype', 'device')), (<class 'bool'>, False), (<class 'int'>, 2), (<class 'code'>, <code object <listcomp> at 0x153c7df4abe0, file "/home/drc/frontend/test/test_model_deberta.py", line 993>), (<class 'int'>, 0)]
guarded code
0: [32mEXTENDED_ARG[0m(1, 1) 
1: [32mJUMP_ABSOLUTE[0m(468, 468)  -> inst 234
2: [33mLOAD_FAST[0m(6, output_attentions) 
3: [33mLOAD_CONST[0m(8, None) 
4: [33mIS_OP[0m(1, 1) 
5: [33mPOP_JUMP_IF_FALSE[0m(16, 16)  -> inst 8
6: [33mLOAD_FAST[0m(6, output_attentions) 
7: [33mJUMP_FORWARD[0m(6, 22)  -> inst 11
8: [33mLOAD_DEREF[0m(0, self) 
9: [33mLOAD_ATTR[0m(0, config) 
10: [33mLOAD_ATTR[0m(1, output_attentions) 
11: [33mSTORE_FAST[0m(6, output_attentions) 
12: [33mLOAD_FAST[0m(7, output_hidden_states) 
13: [33mLOAD_CONST[0m(8, None) 
14: [33mIS_OP[0m(1, 1) 
15: [33mPOP_JUMP_IF_FALSE[0m(36, 36)  -> inst 18
16: [33mLOAD_FAST[0m(7, output_hidden_states) 
17: [33mJUMP_FORWARD[0m(6, 42)  -> inst 21
18: [33mLOAD_DEREF[0m(0, self) 
19: [33mLOAD_ATTR[0m(0, config) 
20: [33mLOAD_ATTR[0m(2, output_hidden_states) 
21: [33mSTORE_FAST[0m(7, output_hidden_states) 
22: [33mLOAD_FAST[0m(8, return_dict) 
23: [33mLOAD_CONST[0m(8, None) 
24: [33mIS_OP[0m(1, 1) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(8, return_dict) 
27: [33mJUMP_FORWARD[0m(6, 62)  -> inst 31
28: [33mLOAD_DEREF[0m(0, self) 
29: [33mLOAD_ATTR[0m(0, config) 
30: [33mLOAD_ATTR[0m(3, use_return_dict) 
31: [33mSTORE_FAST[0m(8, return_dict) 
32: [33mLOAD_FAST[0m(1, input_ids) 
33: [33mLOAD_CONST[0m(8, None) 
34: [33mIS_OP[0m(1, 1) 
35: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
36: [33mLOAD_FAST[0m(5, inputs_embeds) 
37: [33mLOAD_CONST[0m(8, None) 
38: [33mIS_OP[0m(1, 1) 
39: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
40: [33mLOAD_GLOBAL[0m(4, ValueError) 
41: [33mLOAD_CONST[0m(10, You cannot specify both input_ids and inputs_embeds at the same time) 
42: [33mCALL_FUNCTION[0m(1, 1) 
43: [33mRAISE_VARARGS[0m(1, 1) 
44: [33mJUMP_FORWARD[0m(52, 142)  -> inst 71
45: [33mLOAD_FAST[0m(1, input_ids) 
46: [33mLOAD_CONST[0m(8, None) 
47: [33mIS_OP[0m(1, 1) 
48: [33mPOP_JUMP_IF_FALSE[0m(108, 108)  -> inst 54
49: [33mLOAD_FAST[0m(1, input_ids) 
50: [33mLOAD_METHOD[0m(5, size) 
51: [33mCALL_METHOD[0m(0, 0) 
52: [33mSTORE_FAST[0m(9, input_shape) 
53: [33mJUMP_FORWARD[0m(34, 142)  -> inst 71
54: [33mLOAD_FAST[0m(5, inputs_embeds) 
55: [33mLOAD_CONST[0m(8, None) 
56: [33mIS_OP[0m(1, 1) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_FAST[0m(5, inputs_embeds) 
59: [33mLOAD_METHOD[0m(5, size) 
60: [33mCALL_METHOD[0m(0, 0) 
61: [33mLOAD_CONST[0m(8, None) 
62: [33mLOAD_CONST[0m(2, -1) 
63: [33mBUILD_SLICE[0m(2, 2) 
64: [33mBINARY_SUBSCR[0m(None, None) 
65: [33mSTORE_FAST[0m(9, input_shape) 
66: [33mJUMP_FORWARD[0m(8, 142)  -> inst 71
67: [33mLOAD_GLOBAL[0m(4, ValueError) 
68: [33mLOAD_CONST[0m(1, You have to specify either input_ids or inputs_embeds) 
69: [33mCALL_FUNCTION[0m(1, 1) 
70: [33mRAISE_VARARGS[0m(1, 1) 
71: [33mLOAD_FAST[0m(1, input_ids) 
72: [33mLOAD_CONST[0m(8, None) 
73: [33mIS_OP[0m(1, 1) 
74: [33mPOP_JUMP_IF_FALSE[0m(156, 156)  -> inst 78
75: [33mLOAD_FAST[0m(1, input_ids) 
76: [33mLOAD_ATTR[0m(6, device) 
77: [33mJUMP_FORWARD[0m(4, 160)  -> inst 80
78: [33mLOAD_FAST[0m(5, inputs_embeds) 
79: [33mLOAD_ATTR[0m(6, device) 
80: [33mSTORE_FAST[0m(10, device) 
81: [33mLOAD_FAST[0m(2, attention_mask) 
82: [33mLOAD_CONST[0m(8, None) 
83: [33mIS_OP[0m(0, 0) 
84: [33mPOP_JUMP_IF_FALSE[0m(184, 184)  -> inst 92
85: [33mLOAD_GLOBAL[0m(7, torch) 
86: [33mLOAD_ATTR[0m(8, ones) 
87: [33mLOAD_FAST[0m(9, input_shape) 
88: [33mLOAD_FAST[0m(10, device) 
89: [33mLOAD_CONST[0m(12, ('device',)) 
90: [33mCALL_FUNCTION_KW[0m(2, 2) 
91: [33mSTORE_FAST[0m(2, attention_mask) 
92: [33mLOAD_FAST[0m(3, token_type_ids) 
93: [33mLOAD_CONST[0m(8, None) 
94: [33mIS_OP[0m(0, 0) 
95: [33mPOP_JUMP_IF_FALSE[0m(210, 210)  -> inst 105
96: [33mLOAD_GLOBAL[0m(7, torch) 
97: [33mLOAD_ATTR[0m(9, zeros) 
98: [33mLOAD_FAST[0m(9, input_shape) 
99: [33mLOAD_GLOBAL[0m(7, torch) 
100: [33mLOAD_ATTR[0m(10, long) 
101: [33mLOAD_FAST[0m(10, device) 
102: [33mLOAD_CONST[0m(13, ('dtype', 'device')) 
103: [33mCALL_FUNCTION_KW[0m(3, 3) 
104: [33mSTORE_FAST[0m(3, token_type_ids) 
105: [33mLOAD_DEREF[0m(0, self) 
106: [33mLOAD_ATTR[0m(11, embeddings) 
107: [33mLOAD_FAST[0m(1, input_ids) 
108: [33mLOAD_FAST[0m(3, token_type_ids) 
109: [33mLOAD_FAST[0m(4, position_ids) 
110: [33mLOAD_FAST[0m(2, attention_mask) 
111: [33mLOAD_FAST[0m(5, inputs_embeds) 
112: [33mLOAD_CONST[0m(3, ('input_ids', 'token_type_ids', 'position_ids', 'mask', 'inputs_embeds')) 
113: [33mCALL_FUNCTION_KW[0m(5, 5) 
114: [33mSTORE_FAST[0m(11, embedding_output) 
115: [33mLOAD_DEREF[0m(0, self) 
116: [33mLOAD_ATTR[0m(12, encoder) 
117: [33mLOAD_FAST[0m(11, embedding_output) 
118: [33mLOAD_FAST[0m(2, attention_mask) 
119: [33mLOAD_CONST[0m(11, True) 
120: [33mLOAD_FAST[0m(6, output_attentions) 
121: [33mLOAD_FAST[0m(8, return_dict) 
122: [33mLOAD_CONST[0m(5, ('output_hidden_states', 'output_attentions', 'return_dict')) 
123: [33mCALL_FUNCTION_KW[0m(5, 5) 
124: [33mSTORE_FAST[0m(12, encoder_outputs) 
125: [33mLOAD_FAST[0m(12, encoder_outputs) 
126: [33mLOAD_CONST[0m(0, 1) 
127: [33mBINARY_SUBSCR[0m(None, None) 
128: [33mSTORE_FAST[0m(13, encoded_layers) 
129: [33mLOAD_DEREF[0m(0, self) 
130: [33mLOAD_ATTR[0m(13, z_steps) 
131: [33mLOAD_CONST[0m(0, 1) 
132: [33mCOMPARE_OP[0m(4, >) 
133: [32mEXTENDED_ARG[0m(1, 1) 
134: [33mPOP_JUMP_IF_FALSE[0m(394, 394)  -> inst 197
135: [33mLOAD_FAST[0m(13, encoded_layers) 
136: [33mLOAD_CONST[0m(4, -2) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mSTORE_FAST[0m(14, hidden_states) 
139: [33mLOAD_CLOSURE[0m(0, self) 
140: [33mBUILD_TUPLE[0m(1, 1) 
141: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4abe0, file "/home/drc/frontend/test/test_model_deberta.py", line 993>) 
142: [33mLOAD_CONST[0m(6, DebertaModel.forward.<locals>.<listcomp>) 
143: [33mMAKE_FUNCTION[0m(8, 8) 
144: [33mLOAD_GLOBAL[0m(14, range) 
145: [33mLOAD_DEREF[0m(0, self) 
146: [33mLOAD_ATTR[0m(13, z_steps) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mGET_ITER[0m(None, None) 
149: [33mCALL_FUNCTION[0m(1, 1) 
150: [33mSTORE_FAST[0m(15, layers) 
151: [33mLOAD_FAST[0m(13, encoded_layers) 
152: [33mLOAD_CONST[0m(2, -1) 
153: [33mBINARY_SUBSCR[0m(None, None) 
154: [33mSTORE_FAST[0m(16, query_states) 
155: [33mLOAD_DEREF[0m(0, self) 
156: [33mLOAD_ATTR[0m(12, encoder) 
157: [33mLOAD_METHOD[0m(15, get_rel_embedding) 
158: [33mCALL_METHOD[0m(0, 0) 
159: [33mSTORE_FAST[0m(17, rel_embeddings) 
160: [33mLOAD_DEREF[0m(0, self) 
161: [33mLOAD_ATTR[0m(12, encoder) 
162: [33mLOAD_METHOD[0m(16, get_attention_mask) 
163: [33mLOAD_FAST[0m(2, attention_mask) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(2, attention_mask) 
166: [33mLOAD_DEREF[0m(0, self) 
167: [33mLOAD_ATTR[0m(12, encoder) 
168: [33mLOAD_METHOD[0m(17, get_rel_pos) 
169: [33mLOAD_FAST[0m(11, embedding_output) 
170: [33mCALL_METHOD[0m(1, 1) 
171: [33mSTORE_FAST[0m(18, rel_pos) 
172: [33mLOAD_FAST[0m(15, layers) 
173: [33mLOAD_CONST[0m(0, 1) 
174: [33mLOAD_CONST[0m(8, None) 
175: [33mBUILD_SLICE[0m(2, 2) 
176: [33mBINARY_SUBSCR[0m(None, None) 
177: [33mGET_ITER[0m(None, None) 
178: [33mFOR_ITER[0m(36, 394)  -> inst 197
179: [33mSTORE_FAST[0m(19, layer) 
180: [33mLOAD_FAST[0m(19, layer) 
181: [33mLOAD_FAST[0m(14, hidden_states) 
182: [33mLOAD_FAST[0m(2, attention_mask) 
183: [33mLOAD_CONST[0m(14, False) 
184: [33mLOAD_FAST[0m(16, query_states) 
185: [33mLOAD_FAST[0m(18, rel_pos) 
186: [33mLOAD_FAST[0m(17, rel_embeddings) 
187: [33mLOAD_CONST[0m(9, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
188: [33mCALL_FUNCTION_KW[0m(6, 6) 
189: [33mSTORE_FAST[0m(16, query_states) 
190: [33mLOAD_FAST[0m(13, encoded_layers) 
191: [33mLOAD_METHOD[0m(18, append) 
192: [33mLOAD_FAST[0m(16, query_states) 
193: [33mCALL_METHOD[0m(1, 1) 
194: [33mPOP_TOP[0m(None, None) 
195: [32mEXTENDED_ARG[0m(1, 1) 
196: [33mJUMP_ABSOLUTE[0m(356, 356)  -> inst 178
197: [33mLOAD_FAST[0m(13, encoded_layers) 
198: [33mLOAD_CONST[0m(2, -1) 
199: [33mBINARY_SUBSCR[0m(None, None) 
200: [33mSTORE_FAST[0m(20, sequence_output) 
201: [33mLOAD_FAST[0m(8, return_dict) 
202: [32mEXTENDED_ARG[0m(1, 1) 
203: [33mPOP_JUMP_IF_TRUE[0m(438, 438)  -> inst 219
204: [33mLOAD_FAST[0m(20, sequence_output) 
205: [33mBUILD_TUPLE[0m(1, 1) 
206: [33mLOAD_FAST[0m(12, encoder_outputs) 
207: [33mLOAD_FAST[0m(7, output_hidden_states) 
208: [32mEXTENDED_ARG[0m(1, 1) 
209: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
210: [33mLOAD_CONST[0m(0, 1) 
211: [33mJUMP_FORWARD[0m(2, 426)  -> inst 213
212: [33mLOAD_CONST[0m(15, 2) 
213: [33mLOAD_CONST[0m(8, None) 
214: [33mBUILD_SLICE[0m(2, 2) 
215: [33mBINARY_SUBSCR[0m(None, None) 
216: [33mBINARY_ADD[0m(None, None) 
217: [32mEXTENDED_ARG[0m(2, 2) 
218: [32mJUMP_ABSOLUTE[0m(516, 516)  -> inst 258
219: [33mLOAD_GLOBAL[0m(19, BaseModelOutput) 
220: [33mLOAD_FAST[0m(20, sequence_output) 
221: [33mLOAD_FAST[0m(7, output_hidden_states) 
222: [32mEXTENDED_ARG[0m(1, 1) 
223: [33mPOP_JUMP_IF_FALSE[0m(454, 454)  -> inst 227
224: [33mLOAD_FAST[0m(12, encoder_outputs) 
225: [33mLOAD_ATTR[0m(20, hidden_states) 
226: [33mJUMP_FORWARD[0m(2, 456)  -> inst 228
227: [33mLOAD_CONST[0m(8, None) 
228: [33mLOAD_FAST[0m(12, encoder_outputs) 
229: [33mLOAD_ATTR[0m(21, attentions) 
230: [33mLOAD_CONST[0m(7, ('last_hidden_state', 'hidden_states', 'attentions')) 
231: [33mCALL_FUNCTION_KW[0m(3, 3) 
232: [32mEXTENDED_ARG[0m(2, 2) 
233: [32mJUMP_ABSOLUTE[0m(516, 516)  -> inst 258
234: [32mLOAD_GLOBAL[0m(25, guard_match) 
235: [32mLOAD_CONST[0m(17, 0) 
236: [32mLOAD_CONST[0m(17, 0) 
237: [32mLOAD_GLOBAL[0m(26, locals) 
238: [32mCALL_FUNCTION[0m(0, 0) 
239: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
240: [32mUNPACK_SEQUENCE[0m(2, 2) 
241: [32mSTORE_FAST[0m(22, __case_idx) 
242: [32mSTORE_FAST[0m(21, __graph_fn) 
243: [32mLOAD_FAST[0m(22, __case_idx) 
244: [32mLOAD_CONST[0m(17, 0) 
245: [32mCOMPARE_OP[0m(2, ==) 
246: [32mEXTENDED_ARG[0m(1, 1) 
247: [32mPOP_JUMP_IF_FALSE[0m(506, 506)  -> inst 253
248: [32mLOAD_FAST[0m(21, __graph_fn) 
249: [32mLOAD_GLOBAL[0m(26, locals) 
250: [32mCALL_FUNCTION[0m(0, 0) 
251: [32mCALL_FUNCTION[0m(1, 1) [90m# call graph_fn (key=5840) [0m
252: [32mRETURN_VALUE[0m(None, None) 
253: [32mLOAD_GLOBAL[0m(23, enable_trace) 
254: [32mLOAD_CONST[0m(17, 0) 
255: [32mCALL_FUNCTION[0m(1, 1) 
256: [32mPOP_TOP[0m(None, None) 
257: [32mJUMP_ABSOLUTE[0m(4, 4)  -> inst 2
258: [32mLOAD_GLOBAL[0m(22, disable_trace) 
259: [32mLOAD_CONST[0m(17, 0) 
260: [32mCALL_FUNCTION[0m(1, 1) 
261: [32mPOP_TOP[0m(None, None) 
262: [32mRETURN_VALUE[0m(None, None) 

restoring frame, prior = None
(tensor([[[ 0.4186,  0.5426,  0.6940,  ..., -0.6678, -1.5092,  0.7814],
         [ 1.2343,  0.5733, -0.2966,  ..., -1.0547,  0.4952,  2.2875],
         [-1.3067,  0.6904,  0.3220,  ..., -1.7382, -1.2329,  1.3649],
         ...,
         [ 1.3000,  1.5730, -0.9127,  ..., -0.6530,  0.0760,  1.9931],
         [ 1.9489,  0.0645, -1.2444,  ...,  1.2270, -1.0421,  0.8862],
         [-1.1054,  0.5104, -0.5496,  ..., -1.8275,  0.1475,  0.6112]]]),)
preprocess frame /home/drc/frontend/test/test_model_deberta.py 0 0x7dc9ac0 forward
old bytecode: 

0: [32mEXTENDED_ARG[0m(1, 1) 
1: [32mJUMP_ABSOLUTE[0m(468, 468)  -> inst 234
2: [33mLOAD_FAST[0m(6, output_attentions) 
3: [33mLOAD_CONST[0m(8, None) 
4: [33mIS_OP[0m(1, 1) 
5: [33mPOP_JUMP_IF_FALSE[0m(16, 16)  -> inst 8
6: [33mLOAD_FAST[0m(6, output_attentions) 
7: [33mJUMP_FORWARD[0m(6, 22)  -> inst 11
8: [33mLOAD_DEREF[0m(0, self) 
9: [33mLOAD_ATTR[0m(0, config) 
10: [33mLOAD_ATTR[0m(1, output_attentions) 
11: [33mSTORE_FAST[0m(6, output_attentions) 
12: [33mLOAD_FAST[0m(7, output_hidden_states) 
13: [33mLOAD_CONST[0m(8, None) 
14: [33mIS_OP[0m(1, 1) 
15: [33mPOP_JUMP_IF_FALSE[0m(36, 36)  -> inst 18
16: [33mLOAD_FAST[0m(7, output_hidden_states) 
17: [33mJUMP_FORWARD[0m(6, 42)  -> inst 21
18: [33mLOAD_DEREF[0m(0, self) 
19: [33mLOAD_ATTR[0m(0, config) 
20: [33mLOAD_ATTR[0m(2, output_hidden_states) 
21: [33mSTORE_FAST[0m(7, output_hidden_states) 
22: [33mLOAD_FAST[0m(8, return_dict) 
23: [33mLOAD_CONST[0m(8, None) 
24: [33mIS_OP[0m(1, 1) 
25: [33mPOP_JUMP_IF_FALSE[0m(56, 56)  -> inst 28
26: [33mLOAD_FAST[0m(8, return_dict) 
27: [33mJUMP_FORWARD[0m(6, 62)  -> inst 31
28: [33mLOAD_DEREF[0m(0, self) 
29: [33mLOAD_ATTR[0m(0, config) 
30: [33mLOAD_ATTR[0m(3, use_return_dict) 
31: [33mSTORE_FAST[0m(8, return_dict) 
32: [33mLOAD_FAST[0m(1, input_ids) 
33: [33mLOAD_CONST[0m(8, None) 
34: [33mIS_OP[0m(1, 1) 
35: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
36: [33mLOAD_FAST[0m(5, inputs_embeds) 
37: [33mLOAD_CONST[0m(8, None) 
38: [33mIS_OP[0m(1, 1) 
39: [33mPOP_JUMP_IF_FALSE[0m(90, 90)  -> inst 45
40: [33mLOAD_GLOBAL[0m(4, ValueError) 
41: [33mLOAD_CONST[0m(10, You cannot specify both input_ids and inputs_embeds at the same time) 
42: [33mCALL_FUNCTION[0m(1, 1) 
43: [33mRAISE_VARARGS[0m(1, 1) 
44: [33mJUMP_FORWARD[0m(52, 142)  -> inst 71
45: [33mLOAD_FAST[0m(1, input_ids) 
46: [33mLOAD_CONST[0m(8, None) 
47: [33mIS_OP[0m(1, 1) 
48: [33mPOP_JUMP_IF_FALSE[0m(108, 108)  -> inst 54
49: [33mLOAD_FAST[0m(1, input_ids) 
50: [33mLOAD_METHOD[0m(5, size) 
51: [33mCALL_METHOD[0m(0, 0) 
52: [33mSTORE_FAST[0m(9, input_shape) 
53: [33mJUMP_FORWARD[0m(34, 142)  -> inst 71
54: [33mLOAD_FAST[0m(5, inputs_embeds) 
55: [33mLOAD_CONST[0m(8, None) 
56: [33mIS_OP[0m(1, 1) 
57: [33mPOP_JUMP_IF_FALSE[0m(134, 134)  -> inst 67
58: [33mLOAD_FAST[0m(5, inputs_embeds) 
59: [33mLOAD_METHOD[0m(5, size) 
60: [33mCALL_METHOD[0m(0, 0) 
61: [33mLOAD_CONST[0m(8, None) 
62: [33mLOAD_CONST[0m(2, -1) 
63: [33mBUILD_SLICE[0m(2, 2) 
64: [33mBINARY_SUBSCR[0m(None, None) 
65: [33mSTORE_FAST[0m(9, input_shape) 
66: [33mJUMP_FORWARD[0m(8, 142)  -> inst 71
67: [33mLOAD_GLOBAL[0m(4, ValueError) 
68: [33mLOAD_CONST[0m(1, You have to specify either input_ids or inputs_embeds) 
69: [33mCALL_FUNCTION[0m(1, 1) 
70: [33mRAISE_VARARGS[0m(1, 1) 
71: [33mLOAD_FAST[0m(1, input_ids) 
72: [33mLOAD_CONST[0m(8, None) 
73: [33mIS_OP[0m(1, 1) 
74: [33mPOP_JUMP_IF_FALSE[0m(156, 156)  -> inst 78
75: [33mLOAD_FAST[0m(1, input_ids) 
76: [33mLOAD_ATTR[0m(6, device) 
77: [33mJUMP_FORWARD[0m(4, 160)  -> inst 80
78: [33mLOAD_FAST[0m(5, inputs_embeds) 
79: [33mLOAD_ATTR[0m(6, device) 
80: [33mSTORE_FAST[0m(10, device) 
81: [33mLOAD_FAST[0m(2, attention_mask) 
82: [33mLOAD_CONST[0m(8, None) 
83: [33mIS_OP[0m(0, 0) 
84: [33mPOP_JUMP_IF_FALSE[0m(184, 184)  -> inst 92
85: [33mLOAD_GLOBAL[0m(7, torch) 
86: [33mLOAD_ATTR[0m(8, ones) 
87: [33mLOAD_FAST[0m(9, input_shape) 
88: [33mLOAD_FAST[0m(10, device) 
89: [33mLOAD_CONST[0m(12, ('device',)) 
90: [33mCALL_FUNCTION_KW[0m(2, 2) 
91: [33mSTORE_FAST[0m(2, attention_mask) 
92: [33mLOAD_FAST[0m(3, token_type_ids) 
93: [33mLOAD_CONST[0m(8, None) 
94: [33mIS_OP[0m(0, 0) 
95: [33mPOP_JUMP_IF_FALSE[0m(210, 210)  -> inst 105
96: [33mLOAD_GLOBAL[0m(7, torch) 
97: [33mLOAD_ATTR[0m(9, zeros) 
98: [33mLOAD_FAST[0m(9, input_shape) 
99: [33mLOAD_GLOBAL[0m(7, torch) 
100: [33mLOAD_ATTR[0m(10, long) 
101: [33mLOAD_FAST[0m(10, device) 
102: [33mLOAD_CONST[0m(13, ('dtype', 'device')) 
103: [33mCALL_FUNCTION_KW[0m(3, 3) 
104: [33mSTORE_FAST[0m(3, token_type_ids) 
105: [33mLOAD_DEREF[0m(0, self) 
106: [33mLOAD_ATTR[0m(11, embeddings) 
107: [33mLOAD_FAST[0m(1, input_ids) 
108: [33mLOAD_FAST[0m(3, token_type_ids) 
109: [33mLOAD_FAST[0m(4, position_ids) 
110: [33mLOAD_FAST[0m(2, attention_mask) 
111: [33mLOAD_FAST[0m(5, inputs_embeds) 
112: [33mLOAD_CONST[0m(3, ('input_ids', 'token_type_ids', 'position_ids', 'mask', 'inputs_embeds')) 
113: [33mCALL_FUNCTION_KW[0m(5, 5) 
114: [33mSTORE_FAST[0m(11, embedding_output) 
115: [33mLOAD_DEREF[0m(0, self) 
116: [33mLOAD_ATTR[0m(12, encoder) 
117: [33mLOAD_FAST[0m(11, embedding_output) 
118: [33mLOAD_FAST[0m(2, attention_mask) 
119: [33mLOAD_CONST[0m(11, True) 
120: [33mLOAD_FAST[0m(6, output_attentions) 
121: [33mLOAD_FAST[0m(8, return_dict) 
122: [33mLOAD_CONST[0m(5, ('output_hidden_states', 'output_attentions', 'return_dict')) 
123: [33mCALL_FUNCTION_KW[0m(5, 5) 
124: [33mSTORE_FAST[0m(12, encoder_outputs) 
125: [33mLOAD_FAST[0m(12, encoder_outputs) 
126: [33mLOAD_CONST[0m(0, 1) 
127: [33mBINARY_SUBSCR[0m(None, None) 
128: [33mSTORE_FAST[0m(13, encoded_layers) 
129: [33mLOAD_DEREF[0m(0, self) 
130: [33mLOAD_ATTR[0m(13, z_steps) 
131: [33mLOAD_CONST[0m(0, 1) 
132: [33mCOMPARE_OP[0m(4, >) 
133: [32mEXTENDED_ARG[0m(1, 1) 
134: [33mPOP_JUMP_IF_FALSE[0m(394, 394)  -> inst 197
135: [33mLOAD_FAST[0m(13, encoded_layers) 
136: [33mLOAD_CONST[0m(4, -2) 
137: [33mBINARY_SUBSCR[0m(None, None) 
138: [33mSTORE_FAST[0m(14, hidden_states) 
139: [33mLOAD_CLOSURE[0m(0, self) 
140: [33mBUILD_TUPLE[0m(1, 1) 
141: [33mLOAD_CONST[0m(16, <code object <listcomp> at 0x153c7df4abe0, file "/home/drc/frontend/test/test_model_deberta.py", line 993>) 
142: [33mLOAD_CONST[0m(6, DebertaModel.forward.<locals>.<listcomp>) 
143: [33mMAKE_FUNCTION[0m(8, 8) 
144: [33mLOAD_GLOBAL[0m(14, range) 
145: [33mLOAD_DEREF[0m(0, self) 
146: [33mLOAD_ATTR[0m(13, z_steps) 
147: [33mCALL_FUNCTION[0m(1, 1) 
148: [33mGET_ITER[0m(None, None) 
149: [33mCALL_FUNCTION[0m(1, 1) 
150: [33mSTORE_FAST[0m(15, layers) 
151: [33mLOAD_FAST[0m(13, encoded_layers) 
152: [33mLOAD_CONST[0m(2, -1) 
153: [33mBINARY_SUBSCR[0m(None, None) 
154: [33mSTORE_FAST[0m(16, query_states) 
155: [33mLOAD_DEREF[0m(0, self) 
156: [33mLOAD_ATTR[0m(12, encoder) 
157: [33mLOAD_METHOD[0m(15, get_rel_embedding) 
158: [33mCALL_METHOD[0m(0, 0) 
159: [33mSTORE_FAST[0m(17, rel_embeddings) 
160: [33mLOAD_DEREF[0m(0, self) 
161: [33mLOAD_ATTR[0m(12, encoder) 
162: [33mLOAD_METHOD[0m(16, get_attention_mask) 
163: [33mLOAD_FAST[0m(2, attention_mask) 
164: [33mCALL_METHOD[0m(1, 1) 
165: [33mSTORE_FAST[0m(2, attention_mask) 
166: [33mLOAD_DEREF[0m(0, self) 
167: [33mLOAD_ATTR[0m(12, encoder) 
168: [33mLOAD_METHOD[0m(17, get_rel_pos) 
169: [33mLOAD_FAST[0m(11, embedding_output) 
170: [33mCALL_METHOD[0m(1, 1) 
171: [33mSTORE_FAST[0m(18, rel_pos) 
172: [33mLOAD_FAST[0m(15, layers) 
173: [33mLOAD_CONST[0m(0, 1) 
174: [33mLOAD_CONST[0m(8, None) 
175: [33mBUILD_SLICE[0m(2, 2) 
176: [33mBINARY_SUBSCR[0m(None, None) 
177: [33mGET_ITER[0m(None, None) 
178: [33mFOR_ITER[0m(36, 394)  -> inst 197
179: [33mSTORE_FAST[0m(19, layer) 
180: [33mLOAD_FAST[0m(19, layer) 
181: [33mLOAD_FAST[0m(14, hidden_states) 
182: [33mLOAD_FAST[0m(2, attention_mask) 
183: [33mLOAD_CONST[0m(14, False) 
184: [33mLOAD_FAST[0m(16, query_states) 
185: [33mLOAD_FAST[0m(18, rel_pos) 
186: [33mLOAD_FAST[0m(17, rel_embeddings) 
187: [33mLOAD_CONST[0m(9, ('output_attentions', 'query_states', 'relative_pos', 'rel_embeddings')) 
188: [33mCALL_FUNCTION_KW[0m(6, 6) 
189: [33mSTORE_FAST[0m(16, query_states) 
190: [33mLOAD_FAST[0m(13, encoded_layers) 
191: [33mLOAD_METHOD[0m(18, append) 
192: [33mLOAD_FAST[0m(16, query_states) 
193: [33mCALL_METHOD[0m(1, 1) 
194: [33mPOP_TOP[0m(None, None) 
195: [32mEXTENDED_ARG[0m(1, 1) 
196: [33mJUMP_ABSOLUTE[0m(356, 356)  -> inst 178
197: [33mLOAD_FAST[0m(13, encoded_layers) 
198: [33mLOAD_CONST[0m(2, -1) 
199: [33mBINARY_SUBSCR[0m(None, None) 
200: [33mSTORE_FAST[0m(20, sequence_output) 
201: [33mLOAD_FAST[0m(8, return_dict) 
202: [32mEXTENDED_ARG[0m(1, 1) 
203: [33mPOP_JUMP_IF_TRUE[0m(438, 438)  -> inst 219
204: [33mLOAD_FAST[0m(20, sequence_output) 
205: [33mBUILD_TUPLE[0m(1, 1) 
206: [33mLOAD_FAST[0m(12, encoder_outputs) 
207: [33mLOAD_FAST[0m(7, output_hidden_states) 
208: [32mEXTENDED_ARG[0m(1, 1) 
209: [33mPOP_JUMP_IF_FALSE[0m(424, 424)  -> inst 212
210: [33mLOAD_CONST[0m(0, 1) 
211: [33mJUMP_FORWARD[0m(2, 426)  -> inst 213
212: [33mLOAD_CONST[0m(15, 2) 
213: [33mLOAD_CONST[0m(8, None) 
214: [33mBUILD_SLICE[0m(2, 2) 
215: [33mBINARY_SUBSCR[0m(None, None) 
216: [33mBINARY_ADD[0m(None, None) 
217: [32mEXTENDED_ARG[0m(2, 2) 
218: [32mJUMP_ABSOLUTE[0m(516, 516)  -> inst 258
219: [33mLOAD_GLOBAL[0m(19, BaseModelOutput) 
220: [33mLOAD_FAST[0m(20, sequence_output) 
221: [33mLOAD_FAST[0m(7, output_hidden_states) 
222: [32mEXTENDED_ARG[0m(1, 1) 
223: [33mPOP_JUMP_IF_FALSE[0m(454, 454)  -> inst 227
224: [33mLOAD_FAST[0m(12, encoder_outputs) 
225: [33mLOAD_ATTR[0m(20, hidden_states) 
226: [33mJUMP_FORWARD[0m(2, 456)  -> inst 228
227: [33mLOAD_CONST[0m(8, None) 
228: [33mLOAD_FAST[0m(12, encoder_outputs) 
229: [33mLOAD_ATTR[0m(21, attentions) 
230: [33mLOAD_CONST[0m(7, ('last_hidden_state', 'hidden_states', 'attentions')) 
231: [33mCALL_FUNCTION_KW[0m(3, 3) 
232: [32mEXTENDED_ARG[0m(2, 2) 
233: [32mJUMP_ABSOLUTE[0m(516, 516)  -> inst 258
234: [32mLOAD_GLOBAL[0m(25, guard_match) 
235: [32mLOAD_CONST[0m(17, 0) 
236: [32mLOAD_CONST[0m(17, 0) 
237: [32mLOAD_GLOBAL[0m(26, locals) 
238: [32mCALL_FUNCTION[0m(0, 0) 
239: [32mCALL_FUNCTION[0m(3, 3) [90m# call guard_match(frame_id, callsite_id, locals) [0m
240: [32mUNPACK_SEQUENCE[0m(2, 2) 
241: [32mSTORE_FAST[0m(22, __case_idx) 
242: [32mSTORE_FAST[0m(21, __graph_fn) 
243: [32mLOAD_FAST[0m(22, __case_idx) 
244: [32mLOAD_CONST[0m(17, 0) 
245: [32mCOMPARE_OP[0m(2, ==) 
246: [32mEXTENDED_ARG[0m(1, 1) 
247: [32mPOP_JUMP_IF_FALSE[0m(506, 506)  -> inst 253
248: [32mLOAD_FAST[0m(21, __graph_fn) 
249: [32mLOAD_GLOBAL[0m(26, locals) 
250: [32mCALL_FUNCTION[0m(0, 0) 
251: [32mCALL_FUNCTION[0m(1, 1) [90m# call graph_fn (key=5840) [0m
252: [32mRETURN_VALUE[0m(None, None) 
253: [32mLOAD_GLOBAL[0m(23, enable_trace) 
254: [32mLOAD_CONST[0m(17, 0) 
255: [32mCALL_FUNCTION[0m(1, 1) 
256: [32mPOP_TOP[0m(None, None) 
257: [32mJUMP_ABSOLUTE[0m(4, 4)  -> inst 2
258: [32mLOAD_GLOBAL[0m(22, disable_trace) 
259: [32mLOAD_CONST[0m(17, 0) 
260: [32mCALL_FUNCTION[0m(1, 1) 
261: [32mPOP_TOP[0m(None, None) 
262: [32mRETURN_VALUE[0m(None, None) 

running guard_fn (key = 5840) dict_keys(['input_ids', 'attention_mask', 'token_type_ids', 'position_ids', 'inputs_embeds', 'output_attentions', 'output_hidden_states', 'return_dict', 'self'])
ok =  True
running graph_fn (key = 5840) dict_keys(['input_ids', 'attention_mask', 'token_type_ids', 'position_ids', 'inputs_embeds', 'output_attentions', 'output_hidden_states', 'return_dict', '__graph_fn', '__case_idx', 'self'])
restoring frame, prior = None
(tensor([[[ 0.4186,  0.5426,  0.6940,  ..., -0.6678, -1.5092,  0.7814],
         [ 1.2343,  0.5733, -0.2966,  ..., -1.0547,  0.4952,  2.2875],
         [-1.3067,  0.6904,  0.3220,  ..., -1.7382, -1.2329,  1.3649],
         ...,
         [ 1.3000,  1.5730, -0.9127,  ..., -0.6530,  0.0760,  1.9931],
         [ 1.9489,  0.0645, -1.2444,  ...,  1.2270, -1.0421,  0.8862],
         [-1.1054,  0.5104, -0.5496,  ..., -1.8275,  0.1475,  0.6112]]]),)
